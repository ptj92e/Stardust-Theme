{"ast":null,"code":"/**\n * @licstart The following is the entire license notice for the\n * JavaScript code in this page\n *\n * Copyright 2023 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * @licend The above is the entire license notice for the\n * JavaScript code in this page\n */\n\n/******/var __webpack_modules__ = {\n  /***/640: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    // EXPORTS\n    __webpack_require__.d(__webpack_exports__, {\n      AnnotationLayer: () => /* binding */AnnotationLayer,\n      FreeTextAnnotationElement: () => /* binding */FreeTextAnnotationElement,\n      InkAnnotationElement: () => /* binding */InkAnnotationElement,\n      StampAnnotationElement: () => /* binding */StampAnnotationElement\n    });\n\n    // EXTERNAL MODULE: ./src/shared/util.js\n    var util = __webpack_require__(266);\n    // EXTERNAL MODULE: ./src/display/display_utils.js\n    var display_utils = __webpack_require__(473);\n    // EXTERNAL MODULE: ./src/display/annotation_storage.js\n    var annotation_storage = __webpack_require__(780);\n    ; // CONCATENATED MODULE: ./src/shared/scripting_utils.js\n    function makeColorComp(n) {\n      return Math.floor(Math.max(0, Math.min(1, n)) * 255).toString(16).padStart(2, \"0\");\n    }\n    function scaleAndClamp(x) {\n      return Math.max(0, Math.min(255, 255 * x));\n    }\n    class ColorConverters {\n      static CMYK_G([c, y, m, k]) {\n        return [\"G\", 1 - Math.min(1, 0.3 * c + 0.59 * m + 0.11 * y + k)];\n      }\n      static G_CMYK([g]) {\n        return [\"CMYK\", 0, 0, 0, 1 - g];\n      }\n      static G_RGB([g]) {\n        return [\"RGB\", g, g, g];\n      }\n      static G_rgb([g]) {\n        g = scaleAndClamp(g);\n        return [g, g, g];\n      }\n      static G_HTML([g]) {\n        const G = makeColorComp(g);\n        return `#${G}${G}${G}`;\n      }\n      static RGB_G([r, g, b]) {\n        return [\"G\", 0.3 * r + 0.59 * g + 0.11 * b];\n      }\n      static RGB_rgb(color) {\n        return color.map(scaleAndClamp);\n      }\n      static RGB_HTML(color) {\n        return `#${color.map(makeColorComp).join(\"\")}`;\n      }\n      static T_HTML() {\n        return \"#00000000\";\n      }\n      static T_rgb() {\n        return [null];\n      }\n      static CMYK_RGB([c, y, m, k]) {\n        return [\"RGB\", 1 - Math.min(1, c + k), 1 - Math.min(1, m + k), 1 - Math.min(1, y + k)];\n      }\n      static CMYK_rgb([c, y, m, k]) {\n        return [scaleAndClamp(1 - Math.min(1, c + k)), scaleAndClamp(1 - Math.min(1, m + k)), scaleAndClamp(1 - Math.min(1, y + k))];\n      }\n      static CMYK_HTML(components) {\n        const rgb = this.CMYK_RGB(components).slice(1);\n        return this.RGB_HTML(rgb);\n      }\n      static RGB_CMYK([r, g, b]) {\n        const c = 1 - r;\n        const m = 1 - g;\n        const y = 1 - b;\n        const k = Math.min(c, m, y);\n        return [\"CMYK\", c, m, y, k];\n      }\n    }\n\n    // EXTERNAL MODULE: ./src/display/xfa_layer.js\n    var xfa_layer = __webpack_require__(160);\n    ; // CONCATENATED MODULE: ./src/display/annotation_layer.js\n\n    const DEFAULT_TAB_INDEX = 1000;\n    const DEFAULT_FONT_SIZE = 9;\n    const GetElementsByNameSet = new WeakSet();\n    function getRectDims(rect) {\n      return {\n        width: rect[2] - rect[0],\n        height: rect[3] - rect[1]\n      };\n    }\n    class AnnotationElementFactory {\n      static create(parameters) {\n        const subtype = parameters.data.annotationType;\n        switch (subtype) {\n          case util.AnnotationType.LINK:\n            return new LinkAnnotationElement(parameters);\n          case util.AnnotationType.TEXT:\n            return new TextAnnotationElement(parameters);\n          case util.AnnotationType.WIDGET:\n            const fieldType = parameters.data.fieldType;\n            switch (fieldType) {\n              case \"Tx\":\n                return new TextWidgetAnnotationElement(parameters);\n              case \"Btn\":\n                if (parameters.data.radioButton) {\n                  return new RadioButtonWidgetAnnotationElement(parameters);\n                } else if (parameters.data.checkBox) {\n                  return new CheckboxWidgetAnnotationElement(parameters);\n                }\n                return new PushButtonWidgetAnnotationElement(parameters);\n              case \"Ch\":\n                return new ChoiceWidgetAnnotationElement(parameters);\n              case \"Sig\":\n                return new SignatureWidgetAnnotationElement(parameters);\n            }\n            return new WidgetAnnotationElement(parameters);\n          case util.AnnotationType.POPUP:\n            return new PopupAnnotationElement(parameters);\n          case util.AnnotationType.FREETEXT:\n            return new FreeTextAnnotationElement(parameters);\n          case util.AnnotationType.LINE:\n            return new LineAnnotationElement(parameters);\n          case util.AnnotationType.SQUARE:\n            return new SquareAnnotationElement(parameters);\n          case util.AnnotationType.CIRCLE:\n            return new CircleAnnotationElement(parameters);\n          case util.AnnotationType.POLYLINE:\n            return new PolylineAnnotationElement(parameters);\n          case util.AnnotationType.CARET:\n            return new CaretAnnotationElement(parameters);\n          case util.AnnotationType.INK:\n            return new InkAnnotationElement(parameters);\n          case util.AnnotationType.POLYGON:\n            return new PolygonAnnotationElement(parameters);\n          case util.AnnotationType.HIGHLIGHT:\n            return new HighlightAnnotationElement(parameters);\n          case util.AnnotationType.UNDERLINE:\n            return new UnderlineAnnotationElement(parameters);\n          case util.AnnotationType.SQUIGGLY:\n            return new SquigglyAnnotationElement(parameters);\n          case util.AnnotationType.STRIKEOUT:\n            return new StrikeOutAnnotationElement(parameters);\n          case util.AnnotationType.STAMP:\n            return new StampAnnotationElement(parameters);\n          case util.AnnotationType.FILEATTACHMENT:\n            return new FileAttachmentAnnotationElement(parameters);\n          default:\n            return new AnnotationElement(parameters);\n        }\n      }\n    }\n    class AnnotationElement {\n      #hasBorder = false;\n      constructor(parameters, {\n        isRenderable = false,\n        ignoreBorder = false,\n        createQuadrilaterals = false\n      } = {}) {\n        this.isRenderable = isRenderable;\n        this.data = parameters.data;\n        this.layer = parameters.layer;\n        this.linkService = parameters.linkService;\n        this.downloadManager = parameters.downloadManager;\n        this.imageResourcesPath = parameters.imageResourcesPath;\n        this.renderForms = parameters.renderForms;\n        this.svgFactory = parameters.svgFactory;\n        this.annotationStorage = parameters.annotationStorage;\n        this.enableScripting = parameters.enableScripting;\n        this.hasJSActions = parameters.hasJSActions;\n        this._fieldObjects = parameters.fieldObjects;\n        this.parent = parameters.parent;\n        if (isRenderable) {\n          this.container = this._createContainer(ignoreBorder);\n        }\n        if (createQuadrilaterals) {\n          this._createQuadrilaterals();\n        }\n      }\n      static _hasPopupData({\n        titleObj,\n        contentsObj,\n        richText\n      }) {\n        return !!(titleObj?.str || contentsObj?.str || richText?.str);\n      }\n      get hasPopupData() {\n        return AnnotationElement._hasPopupData(this.data);\n      }\n      _createContainer(ignoreBorder) {\n        const {\n          data,\n          parent: {\n            page,\n            viewport\n          }\n        } = this;\n        const container = document.createElement(\"section\");\n        container.setAttribute(\"data-annotation-id\", data.id);\n        if (!(this instanceof WidgetAnnotationElement)) {\n          container.tabIndex = DEFAULT_TAB_INDEX;\n        }\n        container.style.zIndex = this.parent.zIndex++;\n        if (this.data.popupRef) {\n          container.setAttribute(\"aria-haspopup\", \"dialog\");\n        }\n        if (data.noRotate) {\n          container.classList.add(\"norotate\");\n        }\n        const {\n          pageWidth,\n          pageHeight,\n          pageX,\n          pageY\n        } = viewport.rawDims;\n        if (!data.rect || this instanceof PopupAnnotationElement) {\n          const {\n            rotation\n          } = data;\n          if (!data.hasOwnCanvas && rotation !== 0) {\n            this.setRotation(rotation, container);\n          }\n          return container;\n        }\n        const {\n          width,\n          height\n        } = getRectDims(data.rect);\n        const rect = util.Util.normalizeRect([data.rect[0], page.view[3] - data.rect[1] + page.view[1], data.rect[2], page.view[3] - data.rect[3] + page.view[1]]);\n        if (!ignoreBorder && data.borderStyle.width > 0) {\n          container.style.borderWidth = `${data.borderStyle.width}px`;\n          const horizontalRadius = data.borderStyle.horizontalCornerRadius;\n          const verticalRadius = data.borderStyle.verticalCornerRadius;\n          if (horizontalRadius > 0 || verticalRadius > 0) {\n            const radius = `calc(${horizontalRadius}px * var(--scale-factor)) / calc(${verticalRadius}px * var(--scale-factor))`;\n            container.style.borderRadius = radius;\n          } else if (this instanceof RadioButtonWidgetAnnotationElement) {\n            const radius = `calc(${width}px * var(--scale-factor)) / calc(${height}px * var(--scale-factor))`;\n            container.style.borderRadius = radius;\n          }\n          switch (data.borderStyle.style) {\n            case util.AnnotationBorderStyleType.SOLID:\n              container.style.borderStyle = \"solid\";\n              break;\n            case util.AnnotationBorderStyleType.DASHED:\n              container.style.borderStyle = \"dashed\";\n              break;\n            case util.AnnotationBorderStyleType.BEVELED:\n              (0, util.warn)(\"Unimplemented border style: beveled\");\n              break;\n            case util.AnnotationBorderStyleType.INSET:\n              (0, util.warn)(\"Unimplemented border style: inset\");\n              break;\n            case util.AnnotationBorderStyleType.UNDERLINE:\n              container.style.borderBottomStyle = \"solid\";\n              break;\n            default:\n              break;\n          }\n          const borderColor = data.borderColor || null;\n          if (borderColor) {\n            this.#hasBorder = true;\n            container.style.borderColor = util.Util.makeHexColor(borderColor[0] | 0, borderColor[1] | 0, borderColor[2] | 0);\n          } else {\n            container.style.borderWidth = 0;\n          }\n        }\n        container.style.left = `${100 * (rect[0] - pageX) / pageWidth}%`;\n        container.style.top = `${100 * (rect[1] - pageY) / pageHeight}%`;\n        const {\n          rotation\n        } = data;\n        if (data.hasOwnCanvas || rotation === 0) {\n          container.style.width = `${100 * width / pageWidth}%`;\n          container.style.height = `${100 * height / pageHeight}%`;\n        } else {\n          this.setRotation(rotation, container);\n        }\n        return container;\n      }\n      setRotation(angle, container = this.container) {\n        if (!this.data.rect) {\n          return;\n        }\n        const {\n          pageWidth,\n          pageHeight\n        } = this.parent.viewport.rawDims;\n        const {\n          width,\n          height\n        } = getRectDims(this.data.rect);\n        let elementWidth, elementHeight;\n        if (angle % 180 === 0) {\n          elementWidth = 100 * width / pageWidth;\n          elementHeight = 100 * height / pageHeight;\n        } else {\n          elementWidth = 100 * height / pageWidth;\n          elementHeight = 100 * width / pageHeight;\n        }\n        container.style.width = `${elementWidth}%`;\n        container.style.height = `${elementHeight}%`;\n        container.setAttribute(\"data-main-rotation\", (360 - angle) % 360);\n      }\n      get _commonActions() {\n        const setColor = (jsName, styleName, event) => {\n          const color = event.detail[jsName];\n          const colorType = color[0];\n          const colorArray = color.slice(1);\n          event.target.style[styleName] = ColorConverters[`${colorType}_HTML`](colorArray);\n          this.annotationStorage.setValue(this.data.id, {\n            [styleName]: ColorConverters[`${colorType}_rgb`](colorArray)\n          });\n        };\n        return (0, util.shadow)(this, \"_commonActions\", {\n          display: event => {\n            const {\n              display\n            } = event.detail;\n            const hidden = display % 2 === 1;\n            this.container.style.visibility = hidden ? \"hidden\" : \"visible\";\n            this.annotationStorage.setValue(this.data.id, {\n              noView: hidden,\n              noPrint: display === 1 || display === 2\n            });\n          },\n          print: event => {\n            this.annotationStorage.setValue(this.data.id, {\n              noPrint: !event.detail.print\n            });\n          },\n          hidden: event => {\n            const {\n              hidden\n            } = event.detail;\n            this.container.style.visibility = hidden ? \"hidden\" : \"visible\";\n            this.annotationStorage.setValue(this.data.id, {\n              noPrint: hidden,\n              noView: hidden\n            });\n          },\n          focus: event => {\n            setTimeout(() => event.target.focus({\n              preventScroll: false\n            }), 0);\n          },\n          userName: event => {\n            event.target.title = event.detail.userName;\n          },\n          readonly: event => {\n            event.target.disabled = event.detail.readonly;\n          },\n          required: event => {\n            this._setRequired(event.target, event.detail.required);\n          },\n          bgColor: event => {\n            setColor(\"bgColor\", \"backgroundColor\", event);\n          },\n          fillColor: event => {\n            setColor(\"fillColor\", \"backgroundColor\", event);\n          },\n          fgColor: event => {\n            setColor(\"fgColor\", \"color\", event);\n          },\n          textColor: event => {\n            setColor(\"textColor\", \"color\", event);\n          },\n          borderColor: event => {\n            setColor(\"borderColor\", \"borderColor\", event);\n          },\n          strokeColor: event => {\n            setColor(\"strokeColor\", \"borderColor\", event);\n          },\n          rotation: event => {\n            const angle = event.detail.rotation;\n            this.setRotation(angle);\n            this.annotationStorage.setValue(this.data.id, {\n              rotation: angle\n            });\n          }\n        });\n      }\n      _dispatchEventFromSandbox(actions, jsEvent) {\n        const commonActions = this._commonActions;\n        for (const name of Object.keys(jsEvent.detail)) {\n          const action = actions[name] || commonActions[name];\n          action?.(jsEvent);\n        }\n      }\n      _setDefaultPropertiesFromJS(element) {\n        if (!this.enableScripting) {\n          return;\n        }\n        const storedData = this.annotationStorage.getRawValue(this.data.id);\n        if (!storedData) {\n          return;\n        }\n        const commonActions = this._commonActions;\n        for (const [actionName, detail] of Object.entries(storedData)) {\n          const action = commonActions[actionName];\n          if (action) {\n            const eventProxy = {\n              detail: {\n                [actionName]: detail\n              },\n              target: element\n            };\n            action(eventProxy);\n            delete storedData[actionName];\n          }\n        }\n      }\n      _createQuadrilaterals() {\n        if (!this.container) {\n          return;\n        }\n        const {\n          quadPoints\n        } = this.data;\n        if (!quadPoints) {\n          return;\n        }\n        const [rectBlX, rectBlY, rectTrX, rectTrY] = this.data.rect;\n        if (quadPoints.length === 1) {\n          const [, {\n            x: trX,\n            y: trY\n          }, {\n            x: blX,\n            y: blY\n          }] = quadPoints[0];\n          if (rectTrX === trX && rectTrY === trY && rectBlX === blX && rectBlY === blY) {\n            return;\n          }\n        }\n        const {\n          style\n        } = this.container;\n        let svgBuffer;\n        if (this.#hasBorder) {\n          const {\n            borderColor,\n            borderWidth\n          } = style;\n          style.borderWidth = 0;\n          svgBuffer = [\"url('data:image/svg+xml;utf8,\", `<svg xmlns=\"http://www.w3.org/2000/svg\"`, ` preserveAspectRatio=\"none\" viewBox=\"0 0 1 1\">`, `<g fill=\"transparent\" stroke=\"${borderColor}\" stroke-width=\"${borderWidth}\">`];\n          this.container.classList.add(\"hasBorder\");\n        }\n        const width = rectTrX - rectBlX;\n        const height = rectTrY - rectBlY;\n        const {\n          svgFactory\n        } = this;\n        const svg = svgFactory.createElement(\"svg\");\n        svg.classList.add(\"quadrilateralsContainer\");\n        svg.setAttribute(\"width\", 0);\n        svg.setAttribute(\"height\", 0);\n        const defs = svgFactory.createElement(\"defs\");\n        svg.append(defs);\n        const clipPath = svgFactory.createElement(\"clipPath\");\n        const id = `clippath_${this.data.id}`;\n        clipPath.setAttribute(\"id\", id);\n        clipPath.setAttribute(\"clipPathUnits\", \"objectBoundingBox\");\n        defs.append(clipPath);\n        for (const [, {\n          x: trX,\n          y: trY\n        }, {\n          x: blX,\n          y: blY\n        }] of quadPoints) {\n          const rect = svgFactory.createElement(\"rect\");\n          const x = (blX - rectBlX) / width;\n          const y = (rectTrY - trY) / height;\n          const rectWidth = (trX - blX) / width;\n          const rectHeight = (trY - blY) / height;\n          rect.setAttribute(\"x\", x);\n          rect.setAttribute(\"y\", y);\n          rect.setAttribute(\"width\", rectWidth);\n          rect.setAttribute(\"height\", rectHeight);\n          clipPath.append(rect);\n          svgBuffer?.push(`<rect vector-effect=\"non-scaling-stroke\" x=\"${x}\" y=\"${y}\" width=\"${rectWidth}\" height=\"${rectHeight}\"/>`);\n        }\n        if (this.#hasBorder) {\n          svgBuffer.push(`</g></svg>')`);\n          style.backgroundImage = svgBuffer.join(\"\");\n        }\n        this.container.append(svg);\n        this.container.style.clipPath = `url(#${id})`;\n      }\n      _createPopup() {\n        const {\n          container,\n          data\n        } = this;\n        container.setAttribute(\"aria-haspopup\", \"dialog\");\n        const popup = new PopupAnnotationElement({\n          data: {\n            color: data.color,\n            titleObj: data.titleObj,\n            modificationDate: data.modificationDate,\n            contentsObj: data.contentsObj,\n            richText: data.richText,\n            parentRect: data.rect,\n            borderStyle: 0,\n            id: `popup_${data.id}`,\n            rotation: data.rotation\n          },\n          parent: this.parent,\n          elements: [this]\n        });\n        this.parent.div.append(popup.render());\n      }\n      render() {\n        (0, util.unreachable)(\"Abstract method `AnnotationElement.render` called\");\n      }\n      _getElementsByName(name, skipId = null) {\n        const fields = [];\n        if (this._fieldObjects) {\n          const fieldObj = this._fieldObjects[name];\n          if (fieldObj) {\n            for (const {\n              page,\n              id,\n              exportValues\n            } of fieldObj) {\n              if (page === -1) {\n                continue;\n              }\n              if (id === skipId) {\n                continue;\n              }\n              const exportValue = typeof exportValues === \"string\" ? exportValues : null;\n              const domElement = document.querySelector(`[data-element-id=\"${id}\"]`);\n              if (domElement && !GetElementsByNameSet.has(domElement)) {\n                (0, util.warn)(`_getElementsByName - element not allowed: ${id}`);\n                continue;\n              }\n              fields.push({\n                id,\n                exportValue,\n                domElement\n              });\n            }\n          }\n          return fields;\n        }\n        for (const domElement of document.getElementsByName(name)) {\n          const {\n            exportValue\n          } = domElement;\n          const id = domElement.getAttribute(\"data-element-id\");\n          if (id === skipId) {\n            continue;\n          }\n          if (!GetElementsByNameSet.has(domElement)) {\n            continue;\n          }\n          fields.push({\n            id,\n            exportValue,\n            domElement\n          });\n        }\n        return fields;\n      }\n      show() {\n        if (this.container) {\n          this.container.hidden = false;\n        }\n        this.popup?.maybeShow();\n      }\n      hide() {\n        if (this.container) {\n          this.container.hidden = true;\n        }\n        this.popup?.forceHide();\n      }\n      getElementsToTriggerPopup() {\n        return this.container;\n      }\n      addHighlightArea() {\n        const triggers = this.getElementsToTriggerPopup();\n        if (Array.isArray(triggers)) {\n          for (const element of triggers) {\n            element.classList.add(\"highlightArea\");\n          }\n        } else {\n          triggers.classList.add(\"highlightArea\");\n        }\n      }\n      get _isEditable() {\n        return false;\n      }\n      _editOnDoubleClick() {\n        if (!this._isEditable) {\n          return;\n        }\n        const {\n          annotationEditorType: mode,\n          data: {\n            id: editId\n          }\n        } = this;\n        this.container.addEventListener(\"dblclick\", () => {\n          this.linkService.eventBus?.dispatch(\"switchannotationeditormode\", {\n            source: this,\n            mode,\n            editId\n          });\n        });\n      }\n    }\n    class LinkAnnotationElement extends AnnotationElement {\n      constructor(parameters, options = null) {\n        super(parameters, {\n          isRenderable: true,\n          ignoreBorder: !!options?.ignoreBorder,\n          createQuadrilaterals: true\n        });\n        this.isTooltipOnly = parameters.data.isTooltipOnly;\n      }\n      render() {\n        const {\n          data,\n          linkService\n        } = this;\n        const link = document.createElement(\"a\");\n        link.setAttribute(\"data-element-id\", data.id);\n        let isBound = false;\n        if (data.url) {\n          linkService.addLinkAttributes(link, data.url, data.newWindow);\n          isBound = true;\n        } else if (data.action) {\n          this._bindNamedAction(link, data.action);\n          isBound = true;\n        } else if (data.attachment) {\n          this.#bindAttachment(link, data.attachment, data.attachmentDest);\n          isBound = true;\n        } else if (data.setOCGState) {\n          this.#bindSetOCGState(link, data.setOCGState);\n          isBound = true;\n        } else if (data.dest) {\n          this._bindLink(link, data.dest);\n          isBound = true;\n        } else {\n          if (data.actions && (data.actions.Action || data.actions[\"Mouse Up\"] || data.actions[\"Mouse Down\"]) && this.enableScripting && this.hasJSActions) {\n            this._bindJSAction(link, data);\n            isBound = true;\n          }\n          if (data.resetForm) {\n            this._bindResetFormAction(link, data.resetForm);\n            isBound = true;\n          } else if (this.isTooltipOnly && !isBound) {\n            this._bindLink(link, \"\");\n            isBound = true;\n          }\n        }\n        this.container.classList.add(\"linkAnnotation\");\n        if (isBound) {\n          this.container.append(link);\n        }\n        return this.container;\n      }\n      #setInternalLink() {\n        this.container.setAttribute(\"data-internal-link\", \"\");\n      }\n      _bindLink(link, destination) {\n        link.href = this.linkService.getDestinationHash(destination);\n        link.onclick = () => {\n          if (destination) {\n            this.linkService.goToDestination(destination);\n          }\n          return false;\n        };\n        if (destination || destination === \"\") {\n          this.#setInternalLink();\n        }\n      }\n      _bindNamedAction(link, action) {\n        link.href = this.linkService.getAnchorUrl(\"\");\n        link.onclick = () => {\n          this.linkService.executeNamedAction(action);\n          return false;\n        };\n        this.#setInternalLink();\n      }\n      #bindAttachment(link, attachment, dest = null) {\n        link.href = this.linkService.getAnchorUrl(\"\");\n        link.onclick = () => {\n          this.downloadManager?.openOrDownloadData(attachment.content, attachment.filename, dest);\n          return false;\n        };\n        this.#setInternalLink();\n      }\n      #bindSetOCGState(link, action) {\n        link.href = this.linkService.getAnchorUrl(\"\");\n        link.onclick = () => {\n          this.linkService.executeSetOCGState(action);\n          return false;\n        };\n        this.#setInternalLink();\n      }\n      _bindJSAction(link, data) {\n        link.href = this.linkService.getAnchorUrl(\"\");\n        const map = new Map([[\"Action\", \"onclick\"], [\"Mouse Up\", \"onmouseup\"], [\"Mouse Down\", \"onmousedown\"]]);\n        for (const name of Object.keys(data.actions)) {\n          const jsName = map.get(name);\n          if (!jsName) {\n            continue;\n          }\n          link[jsName] = () => {\n            this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n              source: this,\n              detail: {\n                id: data.id,\n                name\n              }\n            });\n            return false;\n          };\n        }\n        if (!link.onclick) {\n          link.onclick = () => false;\n        }\n        this.#setInternalLink();\n      }\n      _bindResetFormAction(link, resetForm) {\n        const otherClickAction = link.onclick;\n        if (!otherClickAction) {\n          link.href = this.linkService.getAnchorUrl(\"\");\n        }\n        this.#setInternalLink();\n        if (!this._fieldObjects) {\n          (0, util.warn)(`_bindResetFormAction - \"resetForm\" action not supported, ` + \"ensure that the `fieldObjects` parameter is provided.\");\n          if (!otherClickAction) {\n            link.onclick = () => false;\n          }\n          return;\n        }\n        link.onclick = () => {\n          otherClickAction?.();\n          const {\n            fields: resetFormFields,\n            refs: resetFormRefs,\n            include\n          } = resetForm;\n          const allFields = [];\n          if (resetFormFields.length !== 0 || resetFormRefs.length !== 0) {\n            const fieldIds = new Set(resetFormRefs);\n            for (const fieldName of resetFormFields) {\n              const fields = this._fieldObjects[fieldName] || [];\n              for (const {\n                id\n              } of fields) {\n                fieldIds.add(id);\n              }\n            }\n            for (const fields of Object.values(this._fieldObjects)) {\n              for (const field of fields) {\n                if (fieldIds.has(field.id) === include) {\n                  allFields.push(field);\n                }\n              }\n            }\n          } else {\n            for (const fields of Object.values(this._fieldObjects)) {\n              allFields.push(...fields);\n            }\n          }\n          const storage = this.annotationStorage;\n          const allIds = [];\n          for (const field of allFields) {\n            const {\n              id\n            } = field;\n            allIds.push(id);\n            switch (field.type) {\n              case \"text\":\n                {\n                  const value = field.defaultValue || \"\";\n                  storage.setValue(id, {\n                    value\n                  });\n                  break;\n                }\n              case \"checkbox\":\n              case \"radiobutton\":\n                {\n                  const value = field.defaultValue === field.exportValues;\n                  storage.setValue(id, {\n                    value\n                  });\n                  break;\n                }\n              case \"combobox\":\n              case \"listbox\":\n                {\n                  const value = field.defaultValue || \"\";\n                  storage.setValue(id, {\n                    value\n                  });\n                  break;\n                }\n              default:\n                continue;\n            }\n            const domElement = document.querySelector(`[data-element-id=\"${id}\"]`);\n            if (!domElement) {\n              continue;\n            } else if (!GetElementsByNameSet.has(domElement)) {\n              (0, util.warn)(`_bindResetFormAction - element not allowed: ${id}`);\n              continue;\n            }\n            domElement.dispatchEvent(new Event(\"resetform\"));\n          }\n          if (this.enableScripting) {\n            this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n              source: this,\n              detail: {\n                id: \"app\",\n                ids: allIds,\n                name: \"ResetForm\"\n              }\n            });\n          }\n          return false;\n        };\n      }\n    }\n    class TextAnnotationElement extends AnnotationElement {\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true\n        });\n      }\n      render() {\n        this.container.classList.add(\"textAnnotation\");\n        const image = document.createElement(\"img\");\n        image.src = this.imageResourcesPath + \"annotation-\" + this.data.name.toLowerCase() + \".svg\";\n        image.setAttribute(\"data-l10n-id\", \"pdfjs-text-annotation-type\");\n        image.setAttribute(\"data-l10n-args\", JSON.stringify({\n          type: this.data.name\n        }));\n        if (!this.data.popupRef && this.hasPopupData) {\n          this._createPopup();\n        }\n        this.container.append(image);\n        return this.container;\n      }\n    }\n    class WidgetAnnotationElement extends AnnotationElement {\n      render() {\n        if (this.data.alternativeText) {\n          this.container.title = this.data.alternativeText;\n        }\n        return this.container;\n      }\n      showElementAndHideCanvas(element) {\n        if (this.data.hasOwnCanvas) {\n          if (element.previousSibling?.nodeName === \"CANVAS\") {\n            element.previousSibling.hidden = true;\n          }\n          element.hidden = false;\n        }\n      }\n      _getKeyModifier(event) {\n        return util.FeatureTest.platform.isMac ? event.metaKey : event.ctrlKey;\n      }\n      _setEventListener(element, elementData, baseName, eventName, valueGetter) {\n        if (baseName.includes(\"mouse\")) {\n          element.addEventListener(baseName, event => {\n            this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n              source: this,\n              detail: {\n                id: this.data.id,\n                name: eventName,\n                value: valueGetter(event),\n                shift: event.shiftKey,\n                modifier: this._getKeyModifier(event)\n              }\n            });\n          });\n        } else {\n          element.addEventListener(baseName, event => {\n            if (baseName === \"blur\") {\n              if (!elementData.focused || !event.relatedTarget) {\n                return;\n              }\n              elementData.focused = false;\n            } else if (baseName === \"focus\") {\n              if (elementData.focused) {\n                return;\n              }\n              elementData.focused = true;\n            }\n            if (!valueGetter) {\n              return;\n            }\n            this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n              source: this,\n              detail: {\n                id: this.data.id,\n                name: eventName,\n                value: valueGetter(event)\n              }\n            });\n          });\n        }\n      }\n      _setEventListeners(element, elementData, names, getter) {\n        for (const [baseName, eventName] of names) {\n          if (eventName === \"Action\" || this.data.actions?.[eventName]) {\n            if (eventName === \"Focus\" || eventName === \"Blur\") {\n              elementData ||= {\n                focused: false\n              };\n            }\n            this._setEventListener(element, elementData, baseName, eventName, getter);\n            if (eventName === \"Focus\" && !this.data.actions?.Blur) {\n              this._setEventListener(element, elementData, \"blur\", \"Blur\", null);\n            } else if (eventName === \"Blur\" && !this.data.actions?.Focus) {\n              this._setEventListener(element, elementData, \"focus\", \"Focus\", null);\n            }\n          }\n        }\n      }\n      _setBackgroundColor(element) {\n        const color = this.data.backgroundColor || null;\n        element.style.backgroundColor = color === null ? \"transparent\" : util.Util.makeHexColor(color[0], color[1], color[2]);\n      }\n      _setTextStyle(element) {\n        const TEXT_ALIGNMENT = [\"left\", \"center\", \"right\"];\n        const {\n          fontColor\n        } = this.data.defaultAppearanceData;\n        const fontSize = this.data.defaultAppearanceData.fontSize || DEFAULT_FONT_SIZE;\n        const style = element.style;\n        let computedFontSize;\n        const BORDER_SIZE = 2;\n        const roundToOneDecimal = x => Math.round(10 * x) / 10;\n        if (this.data.multiLine) {\n          const height = Math.abs(this.data.rect[3] - this.data.rect[1] - BORDER_SIZE);\n          const numberOfLines = Math.round(height / (util.LINE_FACTOR * fontSize)) || 1;\n          const lineHeight = height / numberOfLines;\n          computedFontSize = Math.min(fontSize, roundToOneDecimal(lineHeight / util.LINE_FACTOR));\n        } else {\n          const height = Math.abs(this.data.rect[3] - this.data.rect[1] - BORDER_SIZE);\n          computedFontSize = Math.min(fontSize, roundToOneDecimal(height / util.LINE_FACTOR));\n        }\n        style.fontSize = `calc(${computedFontSize}px * var(--scale-factor))`;\n        style.color = util.Util.makeHexColor(fontColor[0], fontColor[1], fontColor[2]);\n        if (this.data.textAlignment !== null) {\n          style.textAlign = TEXT_ALIGNMENT[this.data.textAlignment];\n        }\n      }\n      _setRequired(element, isRequired) {\n        if (isRequired) {\n          element.setAttribute(\"required\", true);\n        } else {\n          element.removeAttribute(\"required\");\n        }\n        element.setAttribute(\"aria-required\", isRequired);\n      }\n    }\n    class TextWidgetAnnotationElement extends WidgetAnnotationElement {\n      constructor(parameters) {\n        const isRenderable = parameters.renderForms || parameters.data.hasOwnCanvas || !parameters.data.hasAppearance && !!parameters.data.fieldValue;\n        super(parameters, {\n          isRenderable\n        });\n      }\n      setPropertyOnSiblings(base, key, value, keyInStorage) {\n        const storage = this.annotationStorage;\n        for (const element of this._getElementsByName(base.name, base.id)) {\n          if (element.domElement) {\n            element.domElement[key] = value;\n          }\n          storage.setValue(element.id, {\n            [keyInStorage]: value\n          });\n        }\n      }\n      render() {\n        const storage = this.annotationStorage;\n        const id = this.data.id;\n        this.container.classList.add(\"textWidgetAnnotation\");\n        let element = null;\n        if (this.renderForms) {\n          const storedData = storage.getValue(id, {\n            value: this.data.fieldValue\n          });\n          let textContent = storedData.value || \"\";\n          const maxLen = storage.getValue(id, {\n            charLimit: this.data.maxLen\n          }).charLimit;\n          if (maxLen && textContent.length > maxLen) {\n            textContent = textContent.slice(0, maxLen);\n          }\n          let fieldFormattedValues = storedData.formattedValue || this.data.textContent?.join(\"\\n\") || null;\n          if (fieldFormattedValues && this.data.comb) {\n            fieldFormattedValues = fieldFormattedValues.replaceAll(/\\s+/g, \"\");\n          }\n          const elementData = {\n            userValue: textContent,\n            formattedValue: fieldFormattedValues,\n            lastCommittedValue: null,\n            commitKey: 1,\n            focused: false\n          };\n          if (this.data.multiLine) {\n            element = document.createElement(\"textarea\");\n            element.textContent = fieldFormattedValues ?? textContent;\n            if (this.data.doNotScroll) {\n              element.style.overflowY = \"hidden\";\n            }\n          } else {\n            element = document.createElement(\"input\");\n            element.type = \"text\";\n            element.setAttribute(\"value\", fieldFormattedValues ?? textContent);\n            if (this.data.doNotScroll) {\n              element.style.overflowX = \"hidden\";\n            }\n          }\n          if (this.data.hasOwnCanvas) {\n            element.hidden = true;\n          }\n          GetElementsByNameSet.add(element);\n          element.setAttribute(\"data-element-id\", id);\n          element.disabled = this.data.readOnly;\n          element.name = this.data.fieldName;\n          element.tabIndex = DEFAULT_TAB_INDEX;\n          this._setRequired(element, this.data.required);\n          if (maxLen) {\n            element.maxLength = maxLen;\n          }\n          element.addEventListener(\"input\", event => {\n            storage.setValue(id, {\n              value: event.target.value\n            });\n            this.setPropertyOnSiblings(element, \"value\", event.target.value, \"value\");\n            elementData.formattedValue = null;\n          });\n          element.addEventListener(\"resetform\", event => {\n            const defaultValue = this.data.defaultFieldValue ?? \"\";\n            element.value = elementData.userValue = defaultValue;\n            elementData.formattedValue = null;\n          });\n          let blurListener = event => {\n            const {\n              formattedValue\n            } = elementData;\n            if (formattedValue !== null && formattedValue !== undefined) {\n              event.target.value = formattedValue;\n            }\n            event.target.scrollLeft = 0;\n          };\n          if (this.enableScripting && this.hasJSActions) {\n            element.addEventListener(\"focus\", event => {\n              if (elementData.focused) {\n                return;\n              }\n              const {\n                target\n              } = event;\n              if (elementData.userValue) {\n                target.value = elementData.userValue;\n              }\n              elementData.lastCommittedValue = target.value;\n              elementData.commitKey = 1;\n              if (!this.data.actions?.Focus) {\n                elementData.focused = true;\n              }\n            });\n            element.addEventListener(\"updatefromsandbox\", jsEvent => {\n              this.showElementAndHideCanvas(jsEvent.target);\n              const actions = {\n                value(event) {\n                  elementData.userValue = event.detail.value ?? \"\";\n                  storage.setValue(id, {\n                    value: elementData.userValue.toString()\n                  });\n                  event.target.value = elementData.userValue;\n                },\n                formattedValue(event) {\n                  const {\n                    formattedValue\n                  } = event.detail;\n                  elementData.formattedValue = formattedValue;\n                  if (formattedValue !== null && formattedValue !== undefined && event.target !== document.activeElement) {\n                    event.target.value = formattedValue;\n                  }\n                  storage.setValue(id, {\n                    formattedValue\n                  });\n                },\n                selRange(event) {\n                  event.target.setSelectionRange(...event.detail.selRange);\n                },\n                charLimit: event => {\n                  const {\n                    charLimit\n                  } = event.detail;\n                  const {\n                    target\n                  } = event;\n                  if (charLimit === 0) {\n                    target.removeAttribute(\"maxLength\");\n                    return;\n                  }\n                  target.setAttribute(\"maxLength\", charLimit);\n                  let value = elementData.userValue;\n                  if (!value || value.length <= charLimit) {\n                    return;\n                  }\n                  value = value.slice(0, charLimit);\n                  target.value = elementData.userValue = value;\n                  storage.setValue(id, {\n                    value\n                  });\n                  this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n                    source: this,\n                    detail: {\n                      id,\n                      name: \"Keystroke\",\n                      value,\n                      willCommit: true,\n                      commitKey: 1,\n                      selStart: target.selectionStart,\n                      selEnd: target.selectionEnd\n                    }\n                  });\n                }\n              };\n              this._dispatchEventFromSandbox(actions, jsEvent);\n            });\n            element.addEventListener(\"keydown\", event => {\n              elementData.commitKey = 1;\n              let commitKey = -1;\n              if (event.key === \"Escape\") {\n                commitKey = 0;\n              } else if (event.key === \"Enter\" && !this.data.multiLine) {\n                commitKey = 2;\n              } else if (event.key === \"Tab\") {\n                elementData.commitKey = 3;\n              }\n              if (commitKey === -1) {\n                return;\n              }\n              const {\n                value\n              } = event.target;\n              if (elementData.lastCommittedValue === value) {\n                return;\n              }\n              elementData.lastCommittedValue = value;\n              elementData.userValue = value;\n              this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n                source: this,\n                detail: {\n                  id,\n                  name: \"Keystroke\",\n                  value,\n                  willCommit: true,\n                  commitKey,\n                  selStart: event.target.selectionStart,\n                  selEnd: event.target.selectionEnd\n                }\n              });\n            });\n            const _blurListener = blurListener;\n            blurListener = null;\n            element.addEventListener(\"blur\", event => {\n              if (!elementData.focused || !event.relatedTarget) {\n                return;\n              }\n              if (!this.data.actions?.Blur) {\n                elementData.focused = false;\n              }\n              const {\n                value\n              } = event.target;\n              elementData.userValue = value;\n              if (elementData.lastCommittedValue !== value) {\n                this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n                  source: this,\n                  detail: {\n                    id,\n                    name: \"Keystroke\",\n                    value,\n                    willCommit: true,\n                    commitKey: elementData.commitKey,\n                    selStart: event.target.selectionStart,\n                    selEnd: event.target.selectionEnd\n                  }\n                });\n              }\n              _blurListener(event);\n            });\n            if (this.data.actions?.Keystroke) {\n              element.addEventListener(\"beforeinput\", event => {\n                elementData.lastCommittedValue = null;\n                const {\n                  data,\n                  target\n                } = event;\n                const {\n                  value,\n                  selectionStart,\n                  selectionEnd\n                } = target;\n                let selStart = selectionStart,\n                  selEnd = selectionEnd;\n                switch (event.inputType) {\n                  case \"deleteWordBackward\":\n                    {\n                      const match = value.substring(0, selectionStart).match(/\\w*[^\\w]*$/);\n                      if (match) {\n                        selStart -= match[0].length;\n                      }\n                      break;\n                    }\n                  case \"deleteWordForward\":\n                    {\n                      const match = value.substring(selectionStart).match(/^[^\\w]*\\w*/);\n                      if (match) {\n                        selEnd += match[0].length;\n                      }\n                      break;\n                    }\n                  case \"deleteContentBackward\":\n                    if (selectionStart === selectionEnd) {\n                      selStart -= 1;\n                    }\n                    break;\n                  case \"deleteContentForward\":\n                    if (selectionStart === selectionEnd) {\n                      selEnd += 1;\n                    }\n                    break;\n                }\n                event.preventDefault();\n                this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n                  source: this,\n                  detail: {\n                    id,\n                    name: \"Keystroke\",\n                    value,\n                    change: data || \"\",\n                    willCommit: false,\n                    selStart,\n                    selEnd\n                  }\n                });\n              });\n            }\n            this._setEventListeners(element, elementData, [[\"focus\", \"Focus\"], [\"blur\", \"Blur\"], [\"mousedown\", \"Mouse Down\"], [\"mouseenter\", \"Mouse Enter\"], [\"mouseleave\", \"Mouse Exit\"], [\"mouseup\", \"Mouse Up\"]], event => event.target.value);\n          }\n          if (blurListener) {\n            element.addEventListener(\"blur\", blurListener);\n          }\n          if (this.data.comb) {\n            const fieldWidth = this.data.rect[2] - this.data.rect[0];\n            const combWidth = fieldWidth / maxLen;\n            element.classList.add(\"comb\");\n            element.style.letterSpacing = `calc(${combWidth}px * var(--scale-factor) - 1ch)`;\n          }\n        } else {\n          element = document.createElement(\"div\");\n          element.textContent = this.data.fieldValue;\n          element.style.verticalAlign = \"middle\";\n          element.style.display = \"table-cell\";\n          if (this.data.hasOwnCanvas) {\n            element.hidden = true;\n          }\n        }\n        this._setTextStyle(element);\n        this._setBackgroundColor(element);\n        this._setDefaultPropertiesFromJS(element);\n        this.container.append(element);\n        return this.container;\n      }\n    }\n    class SignatureWidgetAnnotationElement extends WidgetAnnotationElement {\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: !!parameters.data.hasOwnCanvas\n        });\n      }\n    }\n    class CheckboxWidgetAnnotationElement extends WidgetAnnotationElement {\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: parameters.renderForms\n        });\n      }\n      render() {\n        const storage = this.annotationStorage;\n        const data = this.data;\n        const id = data.id;\n        let value = storage.getValue(id, {\n          value: data.exportValue === data.fieldValue\n        }).value;\n        if (typeof value === \"string\") {\n          value = value !== \"Off\";\n          storage.setValue(id, {\n            value\n          });\n        }\n        this.container.classList.add(\"buttonWidgetAnnotation\", \"checkBox\");\n        const element = document.createElement(\"input\");\n        GetElementsByNameSet.add(element);\n        element.setAttribute(\"data-element-id\", id);\n        element.disabled = data.readOnly;\n        this._setRequired(element, this.data.required);\n        element.type = \"checkbox\";\n        element.name = data.fieldName;\n        if (value) {\n          element.setAttribute(\"checked\", true);\n        }\n        element.setAttribute(\"exportValue\", data.exportValue);\n        element.tabIndex = DEFAULT_TAB_INDEX;\n        element.addEventListener(\"change\", event => {\n          const {\n            name,\n            checked\n          } = event.target;\n          for (const checkbox of this._getElementsByName(name, id)) {\n            const curChecked = checked && checkbox.exportValue === data.exportValue;\n            if (checkbox.domElement) {\n              checkbox.domElement.checked = curChecked;\n            }\n            storage.setValue(checkbox.id, {\n              value: curChecked\n            });\n          }\n          storage.setValue(id, {\n            value: checked\n          });\n        });\n        element.addEventListener(\"resetform\", event => {\n          const defaultValue = data.defaultFieldValue || \"Off\";\n          event.target.checked = defaultValue === data.exportValue;\n        });\n        if (this.enableScripting && this.hasJSActions) {\n          element.addEventListener(\"updatefromsandbox\", jsEvent => {\n            const actions = {\n              value(event) {\n                event.target.checked = event.detail.value !== \"Off\";\n                storage.setValue(id, {\n                  value: event.target.checked\n                });\n              }\n            };\n            this._dispatchEventFromSandbox(actions, jsEvent);\n          });\n          this._setEventListeners(element, null, [[\"change\", \"Validate\"], [\"change\", \"Action\"], [\"focus\", \"Focus\"], [\"blur\", \"Blur\"], [\"mousedown\", \"Mouse Down\"], [\"mouseenter\", \"Mouse Enter\"], [\"mouseleave\", \"Mouse Exit\"], [\"mouseup\", \"Mouse Up\"]], event => event.target.checked);\n        }\n        this._setBackgroundColor(element);\n        this._setDefaultPropertiesFromJS(element);\n        this.container.append(element);\n        return this.container;\n      }\n    }\n    class RadioButtonWidgetAnnotationElement extends WidgetAnnotationElement {\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: parameters.renderForms\n        });\n      }\n      render() {\n        this.container.classList.add(\"buttonWidgetAnnotation\", \"radioButton\");\n        const storage = this.annotationStorage;\n        const data = this.data;\n        const id = data.id;\n        let value = storage.getValue(id, {\n          value: data.fieldValue === data.buttonValue\n        }).value;\n        if (typeof value === \"string\") {\n          value = value !== data.buttonValue;\n          storage.setValue(id, {\n            value\n          });\n        }\n        if (value) {\n          for (const radio of this._getElementsByName(data.fieldName, id)) {\n            storage.setValue(radio.id, {\n              value: false\n            });\n          }\n        }\n        const element = document.createElement(\"input\");\n        GetElementsByNameSet.add(element);\n        element.setAttribute(\"data-element-id\", id);\n        element.disabled = data.readOnly;\n        this._setRequired(element, this.data.required);\n        element.type = \"radio\";\n        element.name = data.fieldName;\n        if (value) {\n          element.setAttribute(\"checked\", true);\n        }\n        element.tabIndex = DEFAULT_TAB_INDEX;\n        element.addEventListener(\"change\", event => {\n          const {\n            name,\n            checked\n          } = event.target;\n          for (const radio of this._getElementsByName(name, id)) {\n            storage.setValue(radio.id, {\n              value: false\n            });\n          }\n          storage.setValue(id, {\n            value: checked\n          });\n        });\n        element.addEventListener(\"resetform\", event => {\n          const defaultValue = data.defaultFieldValue;\n          event.target.checked = defaultValue !== null && defaultValue !== undefined && defaultValue === data.buttonValue;\n        });\n        if (this.enableScripting && this.hasJSActions) {\n          const pdfButtonValue = data.buttonValue;\n          element.addEventListener(\"updatefromsandbox\", jsEvent => {\n            const actions = {\n              value: event => {\n                const checked = pdfButtonValue === event.detail.value;\n                for (const radio of this._getElementsByName(event.target.name)) {\n                  const curChecked = checked && radio.id === id;\n                  if (radio.domElement) {\n                    radio.domElement.checked = curChecked;\n                  }\n                  storage.setValue(radio.id, {\n                    value: curChecked\n                  });\n                }\n              }\n            };\n            this._dispatchEventFromSandbox(actions, jsEvent);\n          });\n          this._setEventListeners(element, null, [[\"change\", \"Validate\"], [\"change\", \"Action\"], [\"focus\", \"Focus\"], [\"blur\", \"Blur\"], [\"mousedown\", \"Mouse Down\"], [\"mouseenter\", \"Mouse Enter\"], [\"mouseleave\", \"Mouse Exit\"], [\"mouseup\", \"Mouse Up\"]], event => event.target.checked);\n        }\n        this._setBackgroundColor(element);\n        this._setDefaultPropertiesFromJS(element);\n        this.container.append(element);\n        return this.container;\n      }\n    }\n    class PushButtonWidgetAnnotationElement extends LinkAnnotationElement {\n      constructor(parameters) {\n        super(parameters, {\n          ignoreBorder: parameters.data.hasAppearance\n        });\n      }\n      render() {\n        const container = super.render();\n        container.classList.add(\"buttonWidgetAnnotation\", \"pushButton\");\n        if (this.data.alternativeText) {\n          container.title = this.data.alternativeText;\n        }\n        const linkElement = container.lastChild;\n        if (this.enableScripting && this.hasJSActions && linkElement) {\n          this._setDefaultPropertiesFromJS(linkElement);\n          linkElement.addEventListener(\"updatefromsandbox\", jsEvent => {\n            this._dispatchEventFromSandbox({}, jsEvent);\n          });\n        }\n        return container;\n      }\n    }\n    class ChoiceWidgetAnnotationElement extends WidgetAnnotationElement {\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: parameters.renderForms\n        });\n      }\n      render() {\n        this.container.classList.add(\"choiceWidgetAnnotation\");\n        const storage = this.annotationStorage;\n        const id = this.data.id;\n        const storedData = storage.getValue(id, {\n          value: this.data.fieldValue\n        });\n        const selectElement = document.createElement(\"select\");\n        GetElementsByNameSet.add(selectElement);\n        selectElement.setAttribute(\"data-element-id\", id);\n        selectElement.disabled = this.data.readOnly;\n        this._setRequired(selectElement, this.data.required);\n        selectElement.name = this.data.fieldName;\n        selectElement.tabIndex = DEFAULT_TAB_INDEX;\n        let addAnEmptyEntry = this.data.combo && this.data.options.length > 0;\n        if (!this.data.combo) {\n          selectElement.size = this.data.options.length;\n          if (this.data.multiSelect) {\n            selectElement.multiple = true;\n          }\n        }\n        selectElement.addEventListener(\"resetform\", event => {\n          const defaultValue = this.data.defaultFieldValue;\n          for (const option of selectElement.options) {\n            option.selected = option.value === defaultValue;\n          }\n        });\n        for (const option of this.data.options) {\n          const optionElement = document.createElement(\"option\");\n          optionElement.textContent = option.displayValue;\n          optionElement.value = option.exportValue;\n          if (storedData.value.includes(option.exportValue)) {\n            optionElement.setAttribute(\"selected\", true);\n            addAnEmptyEntry = false;\n          }\n          selectElement.append(optionElement);\n        }\n        let removeEmptyEntry = null;\n        if (addAnEmptyEntry) {\n          const noneOptionElement = document.createElement(\"option\");\n          noneOptionElement.value = \" \";\n          noneOptionElement.setAttribute(\"hidden\", true);\n          noneOptionElement.setAttribute(\"selected\", true);\n          selectElement.prepend(noneOptionElement);\n          removeEmptyEntry = () => {\n            noneOptionElement.remove();\n            selectElement.removeEventListener(\"input\", removeEmptyEntry);\n            removeEmptyEntry = null;\n          };\n          selectElement.addEventListener(\"input\", removeEmptyEntry);\n        }\n        const getValue = isExport => {\n          const name = isExport ? \"value\" : \"textContent\";\n          const {\n            options,\n            multiple\n          } = selectElement;\n          if (!multiple) {\n            return options.selectedIndex === -1 ? null : options[options.selectedIndex][name];\n          }\n          return Array.prototype.filter.call(options, option => option.selected).map(option => option[name]);\n        };\n        let selectedValues = getValue(false);\n        const getItems = event => {\n          const options = event.target.options;\n          return Array.prototype.map.call(options, option => {\n            return {\n              displayValue: option.textContent,\n              exportValue: option.value\n            };\n          });\n        };\n        if (this.enableScripting && this.hasJSActions) {\n          selectElement.addEventListener(\"updatefromsandbox\", jsEvent => {\n            const actions = {\n              value(event) {\n                removeEmptyEntry?.();\n                const value = event.detail.value;\n                const values = new Set(Array.isArray(value) ? value : [value]);\n                for (const option of selectElement.options) {\n                  option.selected = values.has(option.value);\n                }\n                storage.setValue(id, {\n                  value: getValue(true)\n                });\n                selectedValues = getValue(false);\n              },\n              multipleSelection(event) {\n                selectElement.multiple = true;\n              },\n              remove(event) {\n                const options = selectElement.options;\n                const index = event.detail.remove;\n                options[index].selected = false;\n                selectElement.remove(index);\n                if (options.length > 0) {\n                  const i = Array.prototype.findIndex.call(options, option => option.selected);\n                  if (i === -1) {\n                    options[0].selected = true;\n                  }\n                }\n                storage.setValue(id, {\n                  value: getValue(true),\n                  items: getItems(event)\n                });\n                selectedValues = getValue(false);\n              },\n              clear(event) {\n                while (selectElement.length !== 0) {\n                  selectElement.remove(0);\n                }\n                storage.setValue(id, {\n                  value: null,\n                  items: []\n                });\n                selectedValues = getValue(false);\n              },\n              insert(event) {\n                const {\n                  index,\n                  displayValue,\n                  exportValue\n                } = event.detail.insert;\n                const selectChild = selectElement.children[index];\n                const optionElement = document.createElement(\"option\");\n                optionElement.textContent = displayValue;\n                optionElement.value = exportValue;\n                if (selectChild) {\n                  selectChild.before(optionElement);\n                } else {\n                  selectElement.append(optionElement);\n                }\n                storage.setValue(id, {\n                  value: getValue(true),\n                  items: getItems(event)\n                });\n                selectedValues = getValue(false);\n              },\n              items(event) {\n                const {\n                  items\n                } = event.detail;\n                while (selectElement.length !== 0) {\n                  selectElement.remove(0);\n                }\n                for (const item of items) {\n                  const {\n                    displayValue,\n                    exportValue\n                  } = item;\n                  const optionElement = document.createElement(\"option\");\n                  optionElement.textContent = displayValue;\n                  optionElement.value = exportValue;\n                  selectElement.append(optionElement);\n                }\n                if (selectElement.options.length > 0) {\n                  selectElement.options[0].selected = true;\n                }\n                storage.setValue(id, {\n                  value: getValue(true),\n                  items: getItems(event)\n                });\n                selectedValues = getValue(false);\n              },\n              indices(event) {\n                const indices = new Set(event.detail.indices);\n                for (const option of event.target.options) {\n                  option.selected = indices.has(option.index);\n                }\n                storage.setValue(id, {\n                  value: getValue(true)\n                });\n                selectedValues = getValue(false);\n              },\n              editable(event) {\n                event.target.disabled = !event.detail.editable;\n              }\n            };\n            this._dispatchEventFromSandbox(actions, jsEvent);\n          });\n          selectElement.addEventListener(\"input\", event => {\n            const exportValue = getValue(true);\n            storage.setValue(id, {\n              value: exportValue\n            });\n            event.preventDefault();\n            this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n              source: this,\n              detail: {\n                id,\n                name: \"Keystroke\",\n                value: selectedValues,\n                changeEx: exportValue,\n                willCommit: false,\n                commitKey: 1,\n                keyDown: false\n              }\n            });\n          });\n          this._setEventListeners(selectElement, null, [[\"focus\", \"Focus\"], [\"blur\", \"Blur\"], [\"mousedown\", \"Mouse Down\"], [\"mouseenter\", \"Mouse Enter\"], [\"mouseleave\", \"Mouse Exit\"], [\"mouseup\", \"Mouse Up\"], [\"input\", \"Action\"], [\"input\", \"Validate\"]], event => event.target.value);\n        } else {\n          selectElement.addEventListener(\"input\", function (event) {\n            storage.setValue(id, {\n              value: getValue(true)\n            });\n          });\n        }\n        if (this.data.combo) {\n          this._setTextStyle(selectElement);\n        } else {}\n        this._setBackgroundColor(selectElement);\n        this._setDefaultPropertiesFromJS(selectElement);\n        this.container.append(selectElement);\n        return this.container;\n      }\n    }\n    class PopupAnnotationElement extends AnnotationElement {\n      constructor(parameters) {\n        const {\n          data,\n          elements\n        } = parameters;\n        super(parameters, {\n          isRenderable: AnnotationElement._hasPopupData(data)\n        });\n        this.elements = elements;\n      }\n      render() {\n        this.container.classList.add(\"popupAnnotation\");\n        const popup = new PopupElement({\n          container: this.container,\n          color: this.data.color,\n          titleObj: this.data.titleObj,\n          modificationDate: this.data.modificationDate,\n          contentsObj: this.data.contentsObj,\n          richText: this.data.richText,\n          rect: this.data.rect,\n          parentRect: this.data.parentRect || null,\n          parent: this.parent,\n          elements: this.elements,\n          open: this.data.open\n        });\n        const elementIds = [];\n        for (const element of this.elements) {\n          element.popup = popup;\n          elementIds.push(element.data.id);\n          element.addHighlightArea();\n        }\n        this.container.setAttribute(\"aria-controls\", elementIds.map(id => `${util.AnnotationPrefix}${id}`).join(\",\"));\n        return this.container;\n      }\n    }\n    class PopupElement {\n      #boundKeyDown = this.#keyDown.bind(this);\n      #boundHide = this.#hide.bind(this);\n      #boundShow = this.#show.bind(this);\n      #boundToggle = this.#toggle.bind(this);\n      #color = null;\n      #container = null;\n      #contentsObj = null;\n      #dateObj = null;\n      #elements = null;\n      #parent = null;\n      #parentRect = null;\n      #pinned = false;\n      #popup = null;\n      #rect = null;\n      #richText = null;\n      #titleObj = null;\n      #wasVisible = false;\n      constructor({\n        container,\n        color,\n        elements,\n        titleObj,\n        modificationDate,\n        contentsObj,\n        richText,\n        parent,\n        rect,\n        parentRect,\n        open\n      }) {\n        this.#container = container;\n        this.#titleObj = titleObj;\n        this.#contentsObj = contentsObj;\n        this.#richText = richText;\n        this.#parent = parent;\n        this.#color = color;\n        this.#rect = rect;\n        this.#parentRect = parentRect;\n        this.#elements = elements;\n        this.#dateObj = display_utils.PDFDateString.toDateObject(modificationDate);\n        this.trigger = elements.flatMap(e => e.getElementsToTriggerPopup());\n        for (const element of this.trigger) {\n          element.addEventListener(\"click\", this.#boundToggle);\n          element.addEventListener(\"mouseenter\", this.#boundShow);\n          element.addEventListener(\"mouseleave\", this.#boundHide);\n          element.classList.add(\"popupTriggerArea\");\n        }\n        for (const element of elements) {\n          element.container?.addEventListener(\"keydown\", this.#boundKeyDown);\n        }\n        this.#container.hidden = true;\n        if (open) {\n          this.#toggle();\n        }\n      }\n      render() {\n        if (this.#popup) {\n          return;\n        }\n        const {\n          page: {\n            view\n          },\n          viewport: {\n            rawDims: {\n              pageWidth,\n              pageHeight,\n              pageX,\n              pageY\n            }\n          }\n        } = this.#parent;\n        const popup = this.#popup = document.createElement(\"div\");\n        popup.className = \"popup\";\n        if (this.#color) {\n          const baseColor = popup.style.outlineColor = util.Util.makeHexColor(...this.#color);\n          if (CSS.supports(\"background-color\", \"color-mix(in srgb, red 30%, white)\")) {\n            popup.style.backgroundColor = `color-mix(in srgb, ${baseColor} 30%, white)`;\n          } else {\n            const BACKGROUND_ENLIGHT = 0.7;\n            popup.style.backgroundColor = util.Util.makeHexColor(...this.#color.map(c => Math.floor(BACKGROUND_ENLIGHT * (255 - c) + c)));\n          }\n        }\n        const header = document.createElement(\"span\");\n        header.className = \"header\";\n        const title = document.createElement(\"h1\");\n        header.append(title);\n        ({\n          dir: title.dir,\n          str: title.textContent\n        } = this.#titleObj);\n        popup.append(header);\n        if (this.#dateObj) {\n          const modificationDate = document.createElement(\"span\");\n          modificationDate.classList.add(\"popupDate\");\n          modificationDate.setAttribute(\"data-l10n-id\", \"pdfjs-annotation-date-string\");\n          modificationDate.setAttribute(\"data-l10n-args\", JSON.stringify({\n            date: this.#dateObj.toLocaleDateString(),\n            time: this.#dateObj.toLocaleTimeString()\n          }));\n          header.append(modificationDate);\n        }\n        const contentsObj = this.#contentsObj;\n        const richText = this.#richText;\n        if (richText?.str && (!contentsObj?.str || contentsObj.str === richText.str)) {\n          xfa_layer.XfaLayer.render({\n            xfaHtml: richText.html,\n            intent: \"richText\",\n            div: popup\n          });\n          popup.lastChild.classList.add(\"richText\", \"popupContent\");\n        } else {\n          const contents = this._formatContents(contentsObj);\n          popup.append(contents);\n        }\n        let useParentRect = !!this.#parentRect;\n        let rect = useParentRect ? this.#parentRect : this.#rect;\n        for (const element of this.#elements) {\n          if (!rect || util.Util.intersect(element.data.rect, rect) !== null) {\n            rect = element.data.rect;\n            useParentRect = true;\n            break;\n          }\n        }\n        const normalizedRect = util.Util.normalizeRect([rect[0], view[3] - rect[1] + view[1], rect[2], view[3] - rect[3] + view[1]]);\n        const HORIZONTAL_SPACE_AFTER_ANNOTATION = 5;\n        const parentWidth = useParentRect ? rect[2] - rect[0] + HORIZONTAL_SPACE_AFTER_ANNOTATION : 0;\n        const popupLeft = normalizedRect[0] + parentWidth;\n        const popupTop = normalizedRect[1];\n        const {\n          style\n        } = this.#container;\n        style.left = `${100 * (popupLeft - pageX) / pageWidth}%`;\n        style.top = `${100 * (popupTop - pageY) / pageHeight}%`;\n        this.#container.append(popup);\n      }\n      _formatContents({\n        str,\n        dir\n      }) {\n        const p = document.createElement(\"p\");\n        p.classList.add(\"popupContent\");\n        p.dir = dir;\n        const lines = str.split(/(?:\\r\\n?|\\n)/);\n        for (let i = 0, ii = lines.length; i < ii; ++i) {\n          const line = lines[i];\n          p.append(document.createTextNode(line));\n          if (i < ii - 1) {\n            p.append(document.createElement(\"br\"));\n          }\n        }\n        return p;\n      }\n      #keyDown(event) {\n        if (event.altKey || event.shiftKey || event.ctrlKey || event.metaKey) {\n          return;\n        }\n        if (event.key === \"Enter\" || event.key === \"Escape\" && this.#pinned) {\n          this.#toggle();\n        }\n      }\n      #toggle() {\n        this.#pinned = !this.#pinned;\n        if (this.#pinned) {\n          this.#show();\n          this.#container.addEventListener(\"click\", this.#boundToggle);\n          this.#container.addEventListener(\"keydown\", this.#boundKeyDown);\n        } else {\n          this.#hide();\n          this.#container.removeEventListener(\"click\", this.#boundToggle);\n          this.#container.removeEventListener(\"keydown\", this.#boundKeyDown);\n        }\n      }\n      #show() {\n        if (!this.#popup) {\n          this.render();\n        }\n        if (!this.isVisible) {\n          this.#container.hidden = false;\n          this.#container.style.zIndex = parseInt(this.#container.style.zIndex) + 1000;\n        } else if (this.#pinned) {\n          this.#container.classList.add(\"focused\");\n        }\n      }\n      #hide() {\n        this.#container.classList.remove(\"focused\");\n        if (this.#pinned || !this.isVisible) {\n          return;\n        }\n        this.#container.hidden = true;\n        this.#container.style.zIndex = parseInt(this.#container.style.zIndex) - 1000;\n      }\n      forceHide() {\n        this.#wasVisible = this.isVisible;\n        if (!this.#wasVisible) {\n          return;\n        }\n        this.#container.hidden = true;\n      }\n      maybeShow() {\n        if (!this.#wasVisible) {\n          return;\n        }\n        this.#wasVisible = false;\n        this.#container.hidden = false;\n      }\n      get isVisible() {\n        return this.#container.hidden === false;\n      }\n    }\n    class FreeTextAnnotationElement extends AnnotationElement {\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true,\n          ignoreBorder: true\n        });\n        this.textContent = parameters.data.textContent;\n        this.textPosition = parameters.data.textPosition;\n        this.annotationEditorType = util.AnnotationEditorType.FREETEXT;\n      }\n      render() {\n        this.container.classList.add(\"freeTextAnnotation\");\n        if (this.textContent) {\n          const content = document.createElement(\"div\");\n          content.classList.add(\"annotationTextContent\");\n          content.setAttribute(\"role\", \"comment\");\n          for (const line of this.textContent) {\n            const lineSpan = document.createElement(\"span\");\n            lineSpan.textContent = line;\n            content.append(lineSpan);\n          }\n          this.container.append(content);\n        }\n        if (!this.data.popupRef && this.hasPopupData) {\n          this._createPopup();\n        }\n        this._editOnDoubleClick();\n        return this.container;\n      }\n      get _isEditable() {\n        return this.data.hasOwnCanvas;\n      }\n    }\n    class LineAnnotationElement extends AnnotationElement {\n      #line = null;\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true,\n          ignoreBorder: true\n        });\n      }\n      render() {\n        this.container.classList.add(\"lineAnnotation\");\n        const data = this.data;\n        const {\n          width,\n          height\n        } = getRectDims(data.rect);\n        const svg = this.svgFactory.create(width, height, true);\n        const line = this.#line = this.svgFactory.createElement(\"svg:line\");\n        line.setAttribute(\"x1\", data.rect[2] - data.lineCoordinates[0]);\n        line.setAttribute(\"y1\", data.rect[3] - data.lineCoordinates[1]);\n        line.setAttribute(\"x2\", data.rect[2] - data.lineCoordinates[2]);\n        line.setAttribute(\"y2\", data.rect[3] - data.lineCoordinates[3]);\n        line.setAttribute(\"stroke-width\", data.borderStyle.width || 1);\n        line.setAttribute(\"stroke\", \"transparent\");\n        line.setAttribute(\"fill\", \"transparent\");\n        svg.append(line);\n        this.container.append(svg);\n        if (!data.popupRef && this.hasPopupData) {\n          this._createPopup();\n        }\n        return this.container;\n      }\n      getElementsToTriggerPopup() {\n        return this.#line;\n      }\n      addHighlightArea() {\n        this.container.classList.add(\"highlightArea\");\n      }\n    }\n    class SquareAnnotationElement extends AnnotationElement {\n      #square = null;\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true,\n          ignoreBorder: true\n        });\n      }\n      render() {\n        this.container.classList.add(\"squareAnnotation\");\n        const data = this.data;\n        const {\n          width,\n          height\n        } = getRectDims(data.rect);\n        const svg = this.svgFactory.create(width, height, true);\n        const borderWidth = data.borderStyle.width;\n        const square = this.#square = this.svgFactory.createElement(\"svg:rect\");\n        square.setAttribute(\"x\", borderWidth / 2);\n        square.setAttribute(\"y\", borderWidth / 2);\n        square.setAttribute(\"width\", width - borderWidth);\n        square.setAttribute(\"height\", height - borderWidth);\n        square.setAttribute(\"stroke-width\", borderWidth || 1);\n        square.setAttribute(\"stroke\", \"transparent\");\n        square.setAttribute(\"fill\", \"transparent\");\n        svg.append(square);\n        this.container.append(svg);\n        if (!data.popupRef && this.hasPopupData) {\n          this._createPopup();\n        }\n        return this.container;\n      }\n      getElementsToTriggerPopup() {\n        return this.#square;\n      }\n      addHighlightArea() {\n        this.container.classList.add(\"highlightArea\");\n      }\n    }\n    class CircleAnnotationElement extends AnnotationElement {\n      #circle = null;\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true,\n          ignoreBorder: true\n        });\n      }\n      render() {\n        this.container.classList.add(\"circleAnnotation\");\n        const data = this.data;\n        const {\n          width,\n          height\n        } = getRectDims(data.rect);\n        const svg = this.svgFactory.create(width, height, true);\n        const borderWidth = data.borderStyle.width;\n        const circle = this.#circle = this.svgFactory.createElement(\"svg:ellipse\");\n        circle.setAttribute(\"cx\", width / 2);\n        circle.setAttribute(\"cy\", height / 2);\n        circle.setAttribute(\"rx\", width / 2 - borderWidth / 2);\n        circle.setAttribute(\"ry\", height / 2 - borderWidth / 2);\n        circle.setAttribute(\"stroke-width\", borderWidth || 1);\n        circle.setAttribute(\"stroke\", \"transparent\");\n        circle.setAttribute(\"fill\", \"transparent\");\n        svg.append(circle);\n        this.container.append(svg);\n        if (!data.popupRef && this.hasPopupData) {\n          this._createPopup();\n        }\n        return this.container;\n      }\n      getElementsToTriggerPopup() {\n        return this.#circle;\n      }\n      addHighlightArea() {\n        this.container.classList.add(\"highlightArea\");\n      }\n    }\n    class PolylineAnnotationElement extends AnnotationElement {\n      #polyline = null;\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true,\n          ignoreBorder: true\n        });\n        this.containerClassName = \"polylineAnnotation\";\n        this.svgElementName = \"svg:polyline\";\n      }\n      render() {\n        this.container.classList.add(this.containerClassName);\n        const data = this.data;\n        const {\n          width,\n          height\n        } = getRectDims(data.rect);\n        const svg = this.svgFactory.create(width, height, true);\n        let points = [];\n        for (const coordinate of data.vertices) {\n          const x = coordinate.x - data.rect[0];\n          const y = data.rect[3] - coordinate.y;\n          points.push(x + \",\" + y);\n        }\n        points = points.join(\" \");\n        const polyline = this.#polyline = this.svgFactory.createElement(this.svgElementName);\n        polyline.setAttribute(\"points\", points);\n        polyline.setAttribute(\"stroke-width\", data.borderStyle.width || 1);\n        polyline.setAttribute(\"stroke\", \"transparent\");\n        polyline.setAttribute(\"fill\", \"transparent\");\n        svg.append(polyline);\n        this.container.append(svg);\n        if (!data.popupRef && this.hasPopupData) {\n          this._createPopup();\n        }\n        return this.container;\n      }\n      getElementsToTriggerPopup() {\n        return this.#polyline;\n      }\n      addHighlightArea() {\n        this.container.classList.add(\"highlightArea\");\n      }\n    }\n    class PolygonAnnotationElement extends PolylineAnnotationElement {\n      constructor(parameters) {\n        super(parameters);\n        this.containerClassName = \"polygonAnnotation\";\n        this.svgElementName = \"svg:polygon\";\n      }\n    }\n    class CaretAnnotationElement extends AnnotationElement {\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true,\n          ignoreBorder: true\n        });\n      }\n      render() {\n        this.container.classList.add(\"caretAnnotation\");\n        if (!this.data.popupRef && this.hasPopupData) {\n          this._createPopup();\n        }\n        return this.container;\n      }\n    }\n    class InkAnnotationElement extends AnnotationElement {\n      #polylines = [];\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true,\n          ignoreBorder: true\n        });\n        this.containerClassName = \"inkAnnotation\";\n        this.svgElementName = \"svg:polyline\";\n        this.annotationEditorType = util.AnnotationEditorType.INK;\n      }\n      render() {\n        this.container.classList.add(this.containerClassName);\n        const data = this.data;\n        const {\n          width,\n          height\n        } = getRectDims(data.rect);\n        const svg = this.svgFactory.create(width, height, true);\n        for (const inkList of data.inkLists) {\n          let points = [];\n          for (const coordinate of inkList) {\n            const x = coordinate.x - data.rect[0];\n            const y = data.rect[3] - coordinate.y;\n            points.push(`${x},${y}`);\n          }\n          points = points.join(\" \");\n          const polyline = this.svgFactory.createElement(this.svgElementName);\n          this.#polylines.push(polyline);\n          polyline.setAttribute(\"points\", points);\n          polyline.setAttribute(\"stroke-width\", data.borderStyle.width || 1);\n          polyline.setAttribute(\"stroke\", \"transparent\");\n          polyline.setAttribute(\"fill\", \"transparent\");\n          if (!data.popupRef && this.hasPopupData) {\n            this._createPopup();\n          }\n          svg.append(polyline);\n        }\n        this.container.append(svg);\n        return this.container;\n      }\n      getElementsToTriggerPopup() {\n        return this.#polylines;\n      }\n      addHighlightArea() {\n        this.container.classList.add(\"highlightArea\");\n      }\n    }\n    class HighlightAnnotationElement extends AnnotationElement {\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true,\n          ignoreBorder: true,\n          createQuadrilaterals: true\n        });\n      }\n      render() {\n        if (!this.data.popupRef && this.hasPopupData) {\n          this._createPopup();\n        }\n        this.container.classList.add(\"highlightAnnotation\");\n        return this.container;\n      }\n    }\n    class UnderlineAnnotationElement extends AnnotationElement {\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true,\n          ignoreBorder: true,\n          createQuadrilaterals: true\n        });\n      }\n      render() {\n        if (!this.data.popupRef && this.hasPopupData) {\n          this._createPopup();\n        }\n        this.container.classList.add(\"underlineAnnotation\");\n        return this.container;\n      }\n    }\n    class SquigglyAnnotationElement extends AnnotationElement {\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true,\n          ignoreBorder: true,\n          createQuadrilaterals: true\n        });\n      }\n      render() {\n        if (!this.data.popupRef && this.hasPopupData) {\n          this._createPopup();\n        }\n        this.container.classList.add(\"squigglyAnnotation\");\n        return this.container;\n      }\n    }\n    class StrikeOutAnnotationElement extends AnnotationElement {\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true,\n          ignoreBorder: true,\n          createQuadrilaterals: true\n        });\n      }\n      render() {\n        if (!this.data.popupRef && this.hasPopupData) {\n          this._createPopup();\n        }\n        this.container.classList.add(\"strikeoutAnnotation\");\n        return this.container;\n      }\n    }\n    class StampAnnotationElement extends AnnotationElement {\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true,\n          ignoreBorder: true\n        });\n      }\n      render() {\n        this.container.classList.add(\"stampAnnotation\");\n        if (!this.data.popupRef && this.hasPopupData) {\n          this._createPopup();\n        }\n        return this.container;\n      }\n    }\n    class FileAttachmentAnnotationElement extends AnnotationElement {\n      #trigger = null;\n      constructor(parameters) {\n        super(parameters, {\n          isRenderable: true\n        });\n        const {\n          filename,\n          content\n        } = this.data.file;\n        this.filename = (0, display_utils.getFilenameFromUrl)(filename, true);\n        this.content = content;\n        this.linkService.eventBus?.dispatch(\"fileattachmentannotation\", {\n          source: this,\n          filename,\n          content\n        });\n      }\n      render() {\n        this.container.classList.add(\"fileAttachmentAnnotation\");\n        const {\n          container,\n          data\n        } = this;\n        let trigger;\n        if (data.hasAppearance || data.fillAlpha === 0) {\n          trigger = document.createElement(\"div\");\n        } else {\n          trigger = document.createElement(\"img\");\n          trigger.src = `${this.imageResourcesPath}annotation-${/paperclip/i.test(data.name) ? \"paperclip\" : \"pushpin\"}.svg`;\n          if (data.fillAlpha && data.fillAlpha < 1) {\n            trigger.style = `filter: opacity(${Math.round(data.fillAlpha * 100)}%);`;\n          }\n        }\n        trigger.addEventListener(\"dblclick\", this.#download.bind(this));\n        this.#trigger = trigger;\n        const {\n          isMac\n        } = util.FeatureTest.platform;\n        container.addEventListener(\"keydown\", evt => {\n          if (evt.key === \"Enter\" && (isMac ? evt.metaKey : evt.ctrlKey)) {\n            this.#download();\n          }\n        });\n        if (!data.popupRef && this.hasPopupData) {\n          this._createPopup();\n        } else {\n          trigger.classList.add(\"popupTriggerArea\");\n        }\n        container.append(trigger);\n        return container;\n      }\n      getElementsToTriggerPopup() {\n        return this.#trigger;\n      }\n      addHighlightArea() {\n        this.container.classList.add(\"highlightArea\");\n      }\n      #download() {\n        this.downloadManager?.openOrDownloadData(this.content, this.filename);\n      }\n    }\n    class AnnotationLayer {\n      #accessibilityManager = null;\n      #annotationCanvasMap = null;\n      #editableAnnotations = new Map();\n      constructor({\n        div,\n        accessibilityManager,\n        annotationCanvasMap,\n        page,\n        viewport\n      }) {\n        this.div = div;\n        this.#accessibilityManager = accessibilityManager;\n        this.#annotationCanvasMap = annotationCanvasMap;\n        this.page = page;\n        this.viewport = viewport;\n        this.zIndex = 0;\n      }\n      #appendElement(element, id) {\n        const contentElement = element.firstChild || element;\n        contentElement.id = `${util.AnnotationPrefix}${id}`;\n        this.div.append(element);\n        this.#accessibilityManager?.moveElementInDOM(this.div, element, contentElement, false);\n      }\n      async render(params) {\n        const {\n          annotations\n        } = params;\n        const layer = this.div;\n        (0, display_utils.setLayerDimensions)(layer, this.viewport);\n        const popupToElements = new Map();\n        const elementParams = {\n          data: null,\n          layer,\n          linkService: params.linkService,\n          downloadManager: params.downloadManager,\n          imageResourcesPath: params.imageResourcesPath || \"\",\n          renderForms: params.renderForms !== false,\n          svgFactory: new display_utils.DOMSVGFactory(),\n          annotationStorage: params.annotationStorage || new annotation_storage.AnnotationStorage(),\n          enableScripting: params.enableScripting === true,\n          hasJSActions: params.hasJSActions,\n          fieldObjects: params.fieldObjects,\n          parent: this,\n          elements: null\n        };\n        for (const data of annotations) {\n          if (data.noHTML) {\n            continue;\n          }\n          const isPopupAnnotation = data.annotationType === util.AnnotationType.POPUP;\n          if (!isPopupAnnotation) {\n            const {\n              width,\n              height\n            } = getRectDims(data.rect);\n            if (width <= 0 || height <= 0) {\n              continue;\n            }\n          } else {\n            const elements = popupToElements.get(data.id);\n            if (!elements) {\n              continue;\n            }\n            elementParams.elements = elements;\n          }\n          elementParams.data = data;\n          const element = AnnotationElementFactory.create(elementParams);\n          if (!element.isRenderable) {\n            continue;\n          }\n          if (!isPopupAnnotation && data.popupRef) {\n            const elements = popupToElements.get(data.popupRef);\n            if (!elements) {\n              popupToElements.set(data.popupRef, [element]);\n            } else {\n              elements.push(element);\n            }\n          }\n          if (element.annotationEditorType > 0) {\n            this.#editableAnnotations.set(element.data.id, element);\n          }\n          const rendered = element.render();\n          if (data.hidden) {\n            rendered.style.visibility = \"hidden\";\n          }\n          this.#appendElement(rendered, data.id);\n        }\n        this.#setAnnotationCanvasMap();\n      }\n      update({\n        viewport\n      }) {\n        const layer = this.div;\n        this.viewport = viewport;\n        (0, display_utils.setLayerDimensions)(layer, {\n          rotation: viewport.rotation\n        });\n        this.#setAnnotationCanvasMap();\n        layer.hidden = false;\n      }\n      #setAnnotationCanvasMap() {\n        if (!this.#annotationCanvasMap) {\n          return;\n        }\n        const layer = this.div;\n        for (const [id, canvas] of this.#annotationCanvasMap) {\n          const element = layer.querySelector(`[data-annotation-id=\"${id}\"]`);\n          if (!element) {\n            continue;\n          }\n          const {\n            firstChild\n          } = element;\n          if (!firstChild) {\n            element.append(canvas);\n          } else if (firstChild.nodeName === \"CANVAS\") {\n            firstChild.replaceWith(canvas);\n          } else {\n            firstChild.before(canvas);\n          }\n        }\n        this.#annotationCanvasMap.clear();\n      }\n      getEditableAnnotations() {\n        return Array.from(this.#editableAnnotations.values());\n      }\n      getEditableAnnotation(id) {\n        return this.#editableAnnotations.get(id);\n      }\n    }\n\n    /***/\n  },\n\n  /***/780: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */AnnotationStorage: () => /* binding */AnnotationStorage,\n      /* harmony export */PrintAnnotationStorage: () => /* binding */PrintAnnotationStorage,\n      /* harmony export */SerializableEmpty: () => /* binding */SerializableEmpty\n      /* harmony export */\n    });\n    /* harmony import */\n    var _shared_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n    /* harmony import */\n    var _editor_editor_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(796);\n    /* harmony import */\n    var _shared_murmurhash3_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(825);\n    const SerializableEmpty = Object.freeze({\n      map: null,\n      hash: \"\",\n      transfer: undefined\n    });\n    class AnnotationStorage {\n      #modified = false;\n      #storage = new Map();\n      constructor() {\n        this.onSetModified = null;\n        this.onResetModified = null;\n        this.onAnnotationEditor = null;\n      }\n      getValue(key, defaultValue) {\n        const value = this.#storage.get(key);\n        if (value === undefined) {\n          return defaultValue;\n        }\n        return Object.assign(defaultValue, value);\n      }\n      getRawValue(key) {\n        return this.#storage.get(key);\n      }\n      remove(key) {\n        this.#storage.delete(key);\n        if (this.#storage.size === 0) {\n          this.resetModified();\n        }\n        if (typeof this.onAnnotationEditor === \"function\") {\n          for (const value of this.#storage.values()) {\n            if (value instanceof _editor_editor_js__WEBPACK_IMPORTED_MODULE_1__.AnnotationEditor) {\n              return;\n            }\n          }\n          this.onAnnotationEditor(null);\n        }\n      }\n      setValue(key, value) {\n        const obj = this.#storage.get(key);\n        let modified = false;\n        if (obj !== undefined) {\n          for (const [entry, val] of Object.entries(value)) {\n            if (obj[entry] !== val) {\n              modified = true;\n              obj[entry] = val;\n            }\n          }\n        } else {\n          modified = true;\n          this.#storage.set(key, value);\n        }\n        if (modified) {\n          this.#setModified();\n        }\n        if (value instanceof _editor_editor_js__WEBPACK_IMPORTED_MODULE_1__.AnnotationEditor && typeof this.onAnnotationEditor === \"function\") {\n          this.onAnnotationEditor(value.constructor._type);\n        }\n      }\n      has(key) {\n        return this.#storage.has(key);\n      }\n      getAll() {\n        return this.#storage.size > 0 ? (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.objectFromMap)(this.#storage) : null;\n      }\n      setAll(obj) {\n        for (const [key, val] of Object.entries(obj)) {\n          this.setValue(key, val);\n        }\n      }\n      get size() {\n        return this.#storage.size;\n      }\n      #setModified() {\n        if (!this.#modified) {\n          this.#modified = true;\n          if (typeof this.onSetModified === \"function\") {\n            this.onSetModified();\n          }\n        }\n      }\n      resetModified() {\n        if (this.#modified) {\n          this.#modified = false;\n          if (typeof this.onResetModified === \"function\") {\n            this.onResetModified();\n          }\n        }\n      }\n      get print() {\n        return new PrintAnnotationStorage(this);\n      }\n      get serializable() {\n        if (this.#storage.size === 0) {\n          return SerializableEmpty;\n        }\n        const map = new Map(),\n          hash = new _shared_murmurhash3_js__WEBPACK_IMPORTED_MODULE_2__.MurmurHash3_64(),\n          transfer = [];\n        const context = Object.create(null);\n        let hasBitmap = false;\n        for (const [key, val] of this.#storage) {\n          const serialized = val instanceof _editor_editor_js__WEBPACK_IMPORTED_MODULE_1__.AnnotationEditor ? val.serialize(false, context) : val;\n          if (serialized) {\n            map.set(key, serialized);\n            hash.update(`${key}:${JSON.stringify(serialized)}`);\n            hasBitmap ||= !!serialized.bitmap;\n          }\n        }\n        if (hasBitmap) {\n          for (const value of map.values()) {\n            if (value.bitmap) {\n              transfer.push(value.bitmap);\n            }\n          }\n        }\n        return map.size > 0 ? {\n          map,\n          hash: hash.hexdigest(),\n          transfer\n        } : SerializableEmpty;\n      }\n    }\n    class PrintAnnotationStorage extends AnnotationStorage {\n      #serializable;\n      constructor(parent) {\n        super();\n        const {\n          map,\n          hash,\n          transfer\n        } = parent.serializable;\n        const clone = structuredClone(map, transfer ? {\n          transfer\n        } : null);\n        this.#serializable = {\n          map: clone,\n          hash,\n          transfer\n        };\n      }\n      get print() {\n        (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"Should not call PrintAnnotationStorage.print\");\n      }\n      get serializable() {\n        return this.#serializable;\n      }\n    }\n\n    /***/\n  },\n\n  /***/406: /***/(__webpack_module__, __webpack_exports__, __webpack_require__) => {\n    __webpack_require__.a(__webpack_module__, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => {\n      try {\n        /* harmony export */__webpack_require__.d(__webpack_exports__, {\n          /* harmony export */PDFDataRangeTransport: () => /* binding */PDFDataRangeTransport,\n          /* harmony export */PDFWorker: () => /* binding */PDFWorker,\n          /* harmony export */build: () => /* binding */build,\n          /* harmony export */getDocument: () => /* binding */getDocument,\n          /* harmony export */version: () => /* binding */version\n          /* harmony export */\n        });\n        /* unused harmony exports DefaultCanvasFactory, DefaultCMapReaderFactory, DefaultFilterFactory, DefaultStandardFontDataFactory, LoopbackPort, PDFDocumentLoadingTask, PDFDocumentProxy, PDFPageProxy, PDFWorkerUtil, RenderTask */\n        /* harmony import */\n        var _shared_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n        /* harmony import */\n        var _annotation_storage_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(780);\n        /* harmony import */\n        var _display_utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(473);\n        /* harmony import */\n        var _font_loader_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(742);\n        /* harmony import */\n        var display_node_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(738);\n        /* harmony import */\n        var _canvas_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(250);\n        /* harmony import */\n        var _worker_options_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(368);\n        /* harmony import */\n        var _shared_message_handler_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(694);\n        /* harmony import */\n        var _metadata_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(472);\n        /* harmony import */\n        var _optional_content_config_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(890);\n        /* harmony import */\n        var _transport_stream_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(92);\n        /* harmony import */\n        var display_fetch_stream__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(171);\n        /* harmony import */\n        var display_network__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(474);\n        /* harmony import */\n        var display_node_stream__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(498);\n        /* harmony import */\n        var _xfa_text_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(521);\n        var __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([display_node_utils__WEBPACK_IMPORTED_MODULE_4__, display_node_stream__WEBPACK_IMPORTED_MODULE_13__]);\n        [display_node_utils__WEBPACK_IMPORTED_MODULE_4__, display_node_stream__WEBPACK_IMPORTED_MODULE_13__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__;\n        const DEFAULT_RANGE_CHUNK_SIZE = 65536;\n        const RENDERING_CANCELLED_TIMEOUT = 100;\n        const DELAYED_CLEANUP_TIMEOUT = 5000;\n        const DefaultCanvasFactory = _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isNodeJS ? display_node_utils__WEBPACK_IMPORTED_MODULE_4__.NodeCanvasFactory : _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.DOMCanvasFactory;\n        const DefaultCMapReaderFactory = _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isNodeJS ? display_node_utils__WEBPACK_IMPORTED_MODULE_4__.NodeCMapReaderFactory : _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.DOMCMapReaderFactory;\n        const DefaultFilterFactory = _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isNodeJS ? display_node_utils__WEBPACK_IMPORTED_MODULE_4__.NodeFilterFactory : _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.DOMFilterFactory;\n        const DefaultStandardFontDataFactory = _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isNodeJS ? display_node_utils__WEBPACK_IMPORTED_MODULE_4__.NodeStandardFontDataFactory : _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.DOMStandardFontDataFactory;\n        function getDocument(src) {\n          if (typeof src === \"string\" || src instanceof URL) {\n            src = {\n              url: src\n            };\n          } else if ((0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isArrayBuffer)(src)) {\n            src = {\n              data: src\n            };\n          }\n          if (typeof src !== \"object\") {\n            throw new Error(\"Invalid parameter in getDocument, need parameter object.\");\n          }\n          if (!src.url && !src.data && !src.range) {\n            throw new Error(\"Invalid parameter object: need either .data, .range or .url\");\n          }\n          const task = new PDFDocumentLoadingTask();\n          const {\n            docId\n          } = task;\n          const url = src.url ? getUrlProp(src.url) : null;\n          const data = src.data ? getDataProp(src.data) : null;\n          const httpHeaders = src.httpHeaders || null;\n          const withCredentials = src.withCredentials === true;\n          const password = src.password ?? null;\n          const rangeTransport = src.range instanceof PDFDataRangeTransport ? src.range : null;\n          const rangeChunkSize = Number.isInteger(src.rangeChunkSize) && src.rangeChunkSize > 0 ? src.rangeChunkSize : DEFAULT_RANGE_CHUNK_SIZE;\n          let worker = src.worker instanceof PDFWorker ? src.worker : null;\n          const verbosity = src.verbosity;\n          const docBaseUrl = typeof src.docBaseUrl === \"string\" && !(0, _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.isDataScheme)(src.docBaseUrl) ? src.docBaseUrl : null;\n          const cMapUrl = typeof src.cMapUrl === \"string\" ? src.cMapUrl : null;\n          const cMapPacked = src.cMapPacked !== false;\n          const CMapReaderFactory = src.CMapReaderFactory || DefaultCMapReaderFactory;\n          const standardFontDataUrl = typeof src.standardFontDataUrl === \"string\" ? src.standardFontDataUrl : null;\n          const StandardFontDataFactory = src.StandardFontDataFactory || DefaultStandardFontDataFactory;\n          const ignoreErrors = src.stopAtErrors !== true;\n          const maxImageSize = Number.isInteger(src.maxImageSize) && src.maxImageSize > -1 ? src.maxImageSize : -1;\n          const isEvalSupported = src.isEvalSupported !== false;\n          const isOffscreenCanvasSupported = typeof src.isOffscreenCanvasSupported === \"boolean\" ? src.isOffscreenCanvasSupported : !_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isNodeJS;\n          const canvasMaxAreaInBytes = Number.isInteger(src.canvasMaxAreaInBytes) ? src.canvasMaxAreaInBytes : -1;\n          const disableFontFace = typeof src.disableFontFace === \"boolean\" ? src.disableFontFace : _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isNodeJS;\n          const fontExtraProperties = src.fontExtraProperties === true;\n          const enableXfa = src.enableXfa === true;\n          const ownerDocument = src.ownerDocument || globalThis.document;\n          const disableRange = src.disableRange === true;\n          const disableStream = src.disableStream === true;\n          const disableAutoFetch = src.disableAutoFetch === true;\n          const pdfBug = src.pdfBug === true;\n          const length = rangeTransport ? rangeTransport.length : src.length ?? NaN;\n          const useSystemFonts = typeof src.useSystemFonts === \"boolean\" ? src.useSystemFonts : !_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isNodeJS && !disableFontFace;\n          const useWorkerFetch = typeof src.useWorkerFetch === \"boolean\" ? src.useWorkerFetch : CMapReaderFactory === _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.DOMCMapReaderFactory && StandardFontDataFactory === _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.DOMStandardFontDataFactory && cMapUrl && standardFontDataUrl && (0, _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.isValidFetchUrl)(cMapUrl, document.baseURI) && (0, _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.isValidFetchUrl)(standardFontDataUrl, document.baseURI);\n          const canvasFactory = src.canvasFactory || new DefaultCanvasFactory({\n            ownerDocument\n          });\n          const filterFactory = src.filterFactory || new DefaultFilterFactory({\n            docId,\n            ownerDocument\n          });\n          const styleElement = null;\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.setVerbosityLevel)(verbosity);\n          const transportFactory = {\n            canvasFactory,\n            filterFactory\n          };\n          if (!useWorkerFetch) {\n            transportFactory.cMapReaderFactory = new CMapReaderFactory({\n              baseUrl: cMapUrl,\n              isCompressed: cMapPacked\n            });\n            transportFactory.standardFontDataFactory = new StandardFontDataFactory({\n              baseUrl: standardFontDataUrl\n            });\n          }\n          if (!worker) {\n            const workerParams = {\n              verbosity,\n              port: _worker_options_js__WEBPACK_IMPORTED_MODULE_6__.GlobalWorkerOptions.workerPort\n            };\n            worker = workerParams.port ? PDFWorker.fromPort(workerParams) : new PDFWorker(workerParams);\n            task._worker = worker;\n          }\n          const fetchDocParams = {\n            docId,\n            apiVersion: '4.0.269',\n            data,\n            password,\n            disableAutoFetch,\n            rangeChunkSize,\n            length,\n            docBaseUrl,\n            enableXfa,\n            evaluatorOptions: {\n              maxImageSize,\n              disableFontFace,\n              ignoreErrors,\n              isEvalSupported,\n              isOffscreenCanvasSupported,\n              canvasMaxAreaInBytes,\n              fontExtraProperties,\n              useSystemFonts,\n              cMapUrl: useWorkerFetch ? cMapUrl : null,\n              standardFontDataUrl: useWorkerFetch ? standardFontDataUrl : null\n            }\n          };\n          const transportParams = {\n            ignoreErrors,\n            isEvalSupported,\n            disableFontFace,\n            fontExtraProperties,\n            enableXfa,\n            ownerDocument,\n            disableAutoFetch,\n            pdfBug,\n            styleElement\n          };\n          worker.promise.then(function () {\n            if (task.destroyed) {\n              throw new Error(\"Loading aborted\");\n            }\n            const workerIdPromise = _fetchDocument(worker, fetchDocParams);\n            const networkStreamPromise = new Promise(function (resolve) {\n              let networkStream;\n              if (rangeTransport) {\n                networkStream = new _transport_stream_js__WEBPACK_IMPORTED_MODULE_10__.PDFDataTransportStream({\n                  length,\n                  initialData: rangeTransport.initialData,\n                  progressiveDone: rangeTransport.progressiveDone,\n                  contentDispositionFilename: rangeTransport.contentDispositionFilename,\n                  disableRange,\n                  disableStream\n                }, rangeTransport);\n              } else if (!data) {\n                const createPDFNetworkStream = params => {\n                  if (_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isNodeJS) {\n                    return new display_node_stream__WEBPACK_IMPORTED_MODULE_13__.PDFNodeStream(params);\n                  }\n                  return (0, _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.isValidFetchUrl)(params.url) ? new display_fetch_stream__WEBPACK_IMPORTED_MODULE_11__.PDFFetchStream(params) : new display_network__WEBPACK_IMPORTED_MODULE_12__.PDFNetworkStream(params);\n                };\n                networkStream = createPDFNetworkStream({\n                  url,\n                  length,\n                  httpHeaders,\n                  withCredentials,\n                  rangeChunkSize,\n                  disableRange,\n                  disableStream\n                });\n              }\n              resolve(networkStream);\n            });\n            return Promise.all([workerIdPromise, networkStreamPromise]).then(function ([workerId, networkStream]) {\n              if (task.destroyed) {\n                throw new Error(\"Loading aborted\");\n              }\n              const messageHandler = new _shared_message_handler_js__WEBPACK_IMPORTED_MODULE_7__.MessageHandler(docId, workerId, worker.port);\n              const transport = new WorkerTransport(messageHandler, task, networkStream, transportParams, transportFactory);\n              task._transport = transport;\n              messageHandler.send(\"Ready\", null);\n            });\n          }).catch(task._capability.reject);\n          return task;\n        }\n        async function _fetchDocument(worker, source) {\n          if (worker.destroyed) {\n            throw new Error(\"Worker was destroyed\");\n          }\n          const workerId = await worker.messageHandler.sendWithPromise(\"GetDocRequest\", source, source.data ? [source.data.buffer] : null);\n          if (worker.destroyed) {\n            throw new Error(\"Worker was destroyed\");\n          }\n          return workerId;\n        }\n        function getUrlProp(val) {\n          if (val instanceof URL) {\n            return val.href;\n          }\n          try {\n            return new URL(val, window.location).href;\n          } catch {\n            if (_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isNodeJS && typeof val === \"string\") {\n              return val;\n            }\n          }\n          throw new Error(\"Invalid PDF url data: \" + \"either string or URL-object is expected in the url property.\");\n        }\n        function getDataProp(val) {\n          if (_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isNodeJS && typeof Buffer !== \"undefined\" && val instanceof Buffer) {\n            throw new Error(\"Please provide binary data as `Uint8Array`, rather than `Buffer`.\");\n          }\n          if (val instanceof Uint8Array && val.byteLength === val.buffer.byteLength) {\n            return val;\n          }\n          if (typeof val === \"string\") {\n            return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.stringToBytes)(val);\n          }\n          if (typeof val === \"object\" && !isNaN(val?.length) || (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isArrayBuffer)(val)) {\n            return new Uint8Array(val);\n          }\n          throw new Error(\"Invalid PDF binary data: either TypedArray, \" + \"string, or array-like object is expected in the data property.\");\n        }\n        class PDFDocumentLoadingTask {\n          static #docId = 0;\n          constructor() {\n            this._capability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n            this._transport = null;\n            this._worker = null;\n            this.docId = `d${PDFDocumentLoadingTask.#docId++}`;\n            this.destroyed = false;\n            this.onPassword = null;\n            this.onProgress = null;\n          }\n          get promise() {\n            return this._capability.promise;\n          }\n          async destroy() {\n            this.destroyed = true;\n            try {\n              if (this._worker?.port) {\n                this._worker._pendingDestroy = true;\n              }\n              await this._transport?.destroy();\n            } catch (ex) {\n              if (this._worker?.port) {\n                delete this._worker._pendingDestroy;\n              }\n              throw ex;\n            }\n            this._transport = null;\n            if (this._worker) {\n              this._worker.destroy();\n              this._worker = null;\n            }\n          }\n        }\n        class PDFDataRangeTransport {\n          constructor(length, initialData, progressiveDone = false, contentDispositionFilename = null) {\n            this.length = length;\n            this.initialData = initialData;\n            this.progressiveDone = progressiveDone;\n            this.contentDispositionFilename = contentDispositionFilename;\n            this._rangeListeners = [];\n            this._progressListeners = [];\n            this._progressiveReadListeners = [];\n            this._progressiveDoneListeners = [];\n            this._readyCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n          }\n          addRangeListener(listener) {\n            this._rangeListeners.push(listener);\n          }\n          addProgressListener(listener) {\n            this._progressListeners.push(listener);\n          }\n          addProgressiveReadListener(listener) {\n            this._progressiveReadListeners.push(listener);\n          }\n          addProgressiveDoneListener(listener) {\n            this._progressiveDoneListeners.push(listener);\n          }\n          onDataRange(begin, chunk) {\n            for (const listener of this._rangeListeners) {\n              listener(begin, chunk);\n            }\n          }\n          onDataProgress(loaded, total) {\n            this._readyCapability.promise.then(() => {\n              for (const listener of this._progressListeners) {\n                listener(loaded, total);\n              }\n            });\n          }\n          onDataProgressiveRead(chunk) {\n            this._readyCapability.promise.then(() => {\n              for (const listener of this._progressiveReadListeners) {\n                listener(chunk);\n              }\n            });\n          }\n          onDataProgressiveDone() {\n            this._readyCapability.promise.then(() => {\n              for (const listener of this._progressiveDoneListeners) {\n                listener();\n              }\n            });\n          }\n          transportReady() {\n            this._readyCapability.resolve();\n          }\n          requestDataRange(begin, end) {\n            (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"Abstract method PDFDataRangeTransport.requestDataRange\");\n          }\n          abort() {}\n        }\n        class PDFDocumentProxy {\n          constructor(pdfInfo, transport) {\n            this._pdfInfo = pdfInfo;\n            this._transport = transport;\n          }\n          get annotationStorage() {\n            return this._transport.annotationStorage;\n          }\n          get filterFactory() {\n            return this._transport.filterFactory;\n          }\n          get numPages() {\n            return this._pdfInfo.numPages;\n          }\n          get fingerprints() {\n            return this._pdfInfo.fingerprints;\n          }\n          get isPureXfa() {\n            return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"isPureXfa\", !!this._transport._htmlForXfa);\n          }\n          get allXfaHtml() {\n            return this._transport._htmlForXfa;\n          }\n          getPage(pageNumber) {\n            return this._transport.getPage(pageNumber);\n          }\n          getPageIndex(ref) {\n            return this._transport.getPageIndex(ref);\n          }\n          getDestinations() {\n            return this._transport.getDestinations();\n          }\n          getDestination(id) {\n            return this._transport.getDestination(id);\n          }\n          getPageLabels() {\n            return this._transport.getPageLabels();\n          }\n          getPageLayout() {\n            return this._transport.getPageLayout();\n          }\n          getPageMode() {\n            return this._transport.getPageMode();\n          }\n          getViewerPreferences() {\n            return this._transport.getViewerPreferences();\n          }\n          getOpenAction() {\n            return this._transport.getOpenAction();\n          }\n          getAttachments() {\n            return this._transport.getAttachments();\n          }\n          getJSActions() {\n            return this._transport.getDocJSActions();\n          }\n          getOutline() {\n            return this._transport.getOutline();\n          }\n          getOptionalContentConfig() {\n            return this._transport.getOptionalContentConfig();\n          }\n          getPermissions() {\n            return this._transport.getPermissions();\n          }\n          getMetadata() {\n            return this._transport.getMetadata();\n          }\n          getMarkInfo() {\n            return this._transport.getMarkInfo();\n          }\n          getData() {\n            return this._transport.getData();\n          }\n          saveDocument() {\n            return this._transport.saveDocument();\n          }\n          getDownloadInfo() {\n            return this._transport.downloadInfoCapability.promise;\n          }\n          cleanup(keepLoadedFonts = false) {\n            return this._transport.startCleanup(keepLoadedFonts || this.isPureXfa);\n          }\n          destroy() {\n            return this.loadingTask.destroy();\n          }\n          get loadingParams() {\n            return this._transport.loadingParams;\n          }\n          get loadingTask() {\n            return this._transport.loadingTask;\n          }\n          getFieldObjects() {\n            return this._transport.getFieldObjects();\n          }\n          hasJSActions() {\n            return this._transport.hasJSActions();\n          }\n          getCalculationOrderIds() {\n            return this._transport.getCalculationOrderIds();\n          }\n        }\n        class PDFPageProxy {\n          #delayedCleanupTimeout = null;\n          #pendingCleanup = false;\n          constructor(pageIndex, pageInfo, transport, pdfBug = false) {\n            this._pageIndex = pageIndex;\n            this._pageInfo = pageInfo;\n            this._transport = transport;\n            this._stats = pdfBug ? new _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.StatTimer() : null;\n            this._pdfBug = pdfBug;\n            this.commonObjs = transport.commonObjs;\n            this.objs = new PDFObjects();\n            this._maybeCleanupAfterRender = false;\n            this._intentStates = new Map();\n            this.destroyed = false;\n          }\n          get pageNumber() {\n            return this._pageIndex + 1;\n          }\n          get rotate() {\n            return this._pageInfo.rotate;\n          }\n          get ref() {\n            return this._pageInfo.ref;\n          }\n          get userUnit() {\n            return this._pageInfo.userUnit;\n          }\n          get view() {\n            return this._pageInfo.view;\n          }\n          getViewport({\n            scale,\n            rotation = this.rotate,\n            offsetX = 0,\n            offsetY = 0,\n            dontFlip = false\n          } = {}) {\n            return new _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.PageViewport({\n              viewBox: this.view,\n              scale,\n              rotation,\n              offsetX,\n              offsetY,\n              dontFlip\n            });\n          }\n          getAnnotations({\n            intent = \"display\"\n          } = {}) {\n            const intentArgs = this._transport.getRenderingIntent(intent);\n            return this._transport.getAnnotations(this._pageIndex, intentArgs.renderingIntent);\n          }\n          getJSActions() {\n            return this._transport.getPageJSActions(this._pageIndex);\n          }\n          get filterFactory() {\n            return this._transport.filterFactory;\n          }\n          get isPureXfa() {\n            return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"isPureXfa\", !!this._transport._htmlForXfa);\n          }\n          async getXfa() {\n            return this._transport._htmlForXfa?.children[this._pageIndex] || null;\n          }\n          render({\n            canvasContext,\n            viewport,\n            intent = \"display\",\n            annotationMode = _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationMode.ENABLE,\n            transform = null,\n            background = null,\n            optionalContentConfigPromise = null,\n            annotationCanvasMap = null,\n            pageColors = null,\n            printAnnotationStorage = null\n          }) {\n            this._stats?.time(\"Overall\");\n            const intentArgs = this._transport.getRenderingIntent(intent, annotationMode, printAnnotationStorage);\n            this.#pendingCleanup = false;\n            this.#abortDelayedCleanup();\n            if (!optionalContentConfigPromise) {\n              optionalContentConfigPromise = this._transport.getOptionalContentConfig();\n            }\n            let intentState = this._intentStates.get(intentArgs.cacheKey);\n            if (!intentState) {\n              intentState = Object.create(null);\n              this._intentStates.set(intentArgs.cacheKey, intentState);\n            }\n            if (intentState.streamReaderCancelTimeout) {\n              clearTimeout(intentState.streamReaderCancelTimeout);\n              intentState.streamReaderCancelTimeout = null;\n            }\n            const intentPrint = !!(intentArgs.renderingIntent & _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.RenderingIntentFlag.PRINT);\n            if (!intentState.displayReadyCapability) {\n              intentState.displayReadyCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n              intentState.operatorList = {\n                fnArray: [],\n                argsArray: [],\n                lastChunk: false,\n                separateAnnots: null\n              };\n              this._stats?.time(\"Page Request\");\n              this._pumpOperatorList(intentArgs);\n            }\n            const complete = error => {\n              intentState.renderTasks.delete(internalRenderTask);\n              if (this._maybeCleanupAfterRender || intentPrint) {\n                this.#pendingCleanup = true;\n              }\n              this.#tryCleanup(!intentPrint);\n              if (error) {\n                internalRenderTask.capability.reject(error);\n                this._abortOperatorList({\n                  intentState,\n                  reason: error instanceof Error ? error : new Error(error)\n                });\n              } else {\n                internalRenderTask.capability.resolve();\n              }\n              this._stats?.timeEnd(\"Rendering\");\n              this._stats?.timeEnd(\"Overall\");\n            };\n            const internalRenderTask = new InternalRenderTask({\n              callback: complete,\n              params: {\n                canvasContext,\n                viewport,\n                transform,\n                background\n              },\n              objs: this.objs,\n              commonObjs: this.commonObjs,\n              annotationCanvasMap,\n              operatorList: intentState.operatorList,\n              pageIndex: this._pageIndex,\n              canvasFactory: this._transport.canvasFactory,\n              filterFactory: this._transport.filterFactory,\n              useRequestAnimationFrame: !intentPrint,\n              pdfBug: this._pdfBug,\n              pageColors\n            });\n            (intentState.renderTasks ||= new Set()).add(internalRenderTask);\n            const renderTask = internalRenderTask.task;\n            Promise.all([intentState.displayReadyCapability.promise, optionalContentConfigPromise]).then(([transparency, optionalContentConfig]) => {\n              if (this.destroyed) {\n                complete();\n                return;\n              }\n              this._stats?.time(\"Rendering\");\n              internalRenderTask.initializeGraphics({\n                transparency,\n                optionalContentConfig\n              });\n              internalRenderTask.operatorListChanged();\n            }).catch(complete);\n            return renderTask;\n          }\n          getOperatorList({\n            intent = \"display\",\n            annotationMode = _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationMode.ENABLE,\n            printAnnotationStorage = null\n          } = {}) {\n            function operatorListChanged() {\n              if (intentState.operatorList.lastChunk) {\n                intentState.opListReadCapability.resolve(intentState.operatorList);\n                intentState.renderTasks.delete(opListTask);\n              }\n            }\n            const intentArgs = this._transport.getRenderingIntent(intent, annotationMode, printAnnotationStorage, true);\n            let intentState = this._intentStates.get(intentArgs.cacheKey);\n            if (!intentState) {\n              intentState = Object.create(null);\n              this._intentStates.set(intentArgs.cacheKey, intentState);\n            }\n            let opListTask;\n            if (!intentState.opListReadCapability) {\n              opListTask = Object.create(null);\n              opListTask.operatorListChanged = operatorListChanged;\n              intentState.opListReadCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n              (intentState.renderTasks ||= new Set()).add(opListTask);\n              intentState.operatorList = {\n                fnArray: [],\n                argsArray: [],\n                lastChunk: false,\n                separateAnnots: null\n              };\n              this._stats?.time(\"Page Request\");\n              this._pumpOperatorList(intentArgs);\n            }\n            return intentState.opListReadCapability.promise;\n          }\n          streamTextContent({\n            includeMarkedContent = false,\n            disableNormalization = false\n          } = {}) {\n            const TEXT_CONTENT_CHUNK_SIZE = 100;\n            return this._transport.messageHandler.sendWithStream(\"GetTextContent\", {\n              pageIndex: this._pageIndex,\n              includeMarkedContent: includeMarkedContent === true,\n              disableNormalization: disableNormalization === true\n            }, {\n              highWaterMark: TEXT_CONTENT_CHUNK_SIZE,\n              size(textContent) {\n                return textContent.items.length;\n              }\n            });\n          }\n          getTextContent(params = {}) {\n            if (this._transport._htmlForXfa) {\n              return this.getXfa().then(xfa => {\n                return _xfa_text_js__WEBPACK_IMPORTED_MODULE_14__.XfaText.textContent(xfa);\n              });\n            }\n            const readableStream = this.streamTextContent(params);\n            return new Promise(function (resolve, reject) {\n              function pump() {\n                reader.read().then(function ({\n                  value,\n                  done\n                }) {\n                  if (done) {\n                    resolve(textContent);\n                    return;\n                  }\n                  Object.assign(textContent.styles, value.styles);\n                  textContent.items.push(...value.items);\n                  pump();\n                }, reject);\n              }\n              const reader = readableStream.getReader();\n              const textContent = {\n                items: [],\n                styles: Object.create(null)\n              };\n              pump();\n            });\n          }\n          getStructTree() {\n            return this._transport.getStructTree(this._pageIndex);\n          }\n          _destroy() {\n            this.destroyed = true;\n            const waitOn = [];\n            for (const intentState of this._intentStates.values()) {\n              this._abortOperatorList({\n                intentState,\n                reason: new Error(\"Page was destroyed.\"),\n                force: true\n              });\n              if (intentState.opListReadCapability) {\n                continue;\n              }\n              for (const internalRenderTask of intentState.renderTasks) {\n                waitOn.push(internalRenderTask.completed);\n                internalRenderTask.cancel();\n              }\n            }\n            this.objs.clear();\n            this.#pendingCleanup = false;\n            this.#abortDelayedCleanup();\n            return Promise.all(waitOn);\n          }\n          cleanup(resetStats = false) {\n            this.#pendingCleanup = true;\n            const success = this.#tryCleanup(false);\n            if (resetStats && success) {\n              this._stats &&= new _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.StatTimer();\n            }\n            return success;\n          }\n          #tryCleanup(delayed = false) {\n            this.#abortDelayedCleanup();\n            if (!this.#pendingCleanup || this.destroyed) {\n              return false;\n            }\n            if (delayed) {\n              this.#delayedCleanupTimeout = setTimeout(() => {\n                this.#delayedCleanupTimeout = null;\n                this.#tryCleanup(false);\n              }, DELAYED_CLEANUP_TIMEOUT);\n              return false;\n            }\n            for (const {\n              renderTasks,\n              operatorList\n            } of this._intentStates.values()) {\n              if (renderTasks.size > 0 || !operatorList.lastChunk) {\n                return false;\n              }\n            }\n            this._intentStates.clear();\n            this.objs.clear();\n            this.#pendingCleanup = false;\n            return true;\n          }\n          #abortDelayedCleanup() {\n            if (this.#delayedCleanupTimeout) {\n              clearTimeout(this.#delayedCleanupTimeout);\n              this.#delayedCleanupTimeout = null;\n            }\n          }\n          _startRenderPage(transparency, cacheKey) {\n            const intentState = this._intentStates.get(cacheKey);\n            if (!intentState) {\n              return;\n            }\n            this._stats?.timeEnd(\"Page Request\");\n            intentState.displayReadyCapability?.resolve(transparency);\n          }\n          _renderPageChunk(operatorListChunk, intentState) {\n            for (let i = 0, ii = operatorListChunk.length; i < ii; i++) {\n              intentState.operatorList.fnArray.push(operatorListChunk.fnArray[i]);\n              intentState.operatorList.argsArray.push(operatorListChunk.argsArray[i]);\n            }\n            intentState.operatorList.lastChunk = operatorListChunk.lastChunk;\n            intentState.operatorList.separateAnnots = operatorListChunk.separateAnnots;\n            for (const internalRenderTask of intentState.renderTasks) {\n              internalRenderTask.operatorListChanged();\n            }\n            if (operatorListChunk.lastChunk) {\n              this.#tryCleanup(true);\n            }\n          }\n          _pumpOperatorList({\n            renderingIntent,\n            cacheKey,\n            annotationStorageSerializable\n          }) {\n            const {\n              map,\n              transfer\n            } = annotationStorageSerializable;\n            const readableStream = this._transport.messageHandler.sendWithStream(\"GetOperatorList\", {\n              pageIndex: this._pageIndex,\n              intent: renderingIntent,\n              cacheKey,\n              annotationStorage: map\n            }, transfer);\n            const reader = readableStream.getReader();\n            const intentState = this._intentStates.get(cacheKey);\n            intentState.streamReader = reader;\n            const pump = () => {\n              reader.read().then(({\n                value,\n                done\n              }) => {\n                if (done) {\n                  intentState.streamReader = null;\n                  return;\n                }\n                if (this._transport.destroyed) {\n                  return;\n                }\n                this._renderPageChunk(value, intentState);\n                pump();\n              }, reason => {\n                intentState.streamReader = null;\n                if (this._transport.destroyed) {\n                  return;\n                }\n                if (intentState.operatorList) {\n                  intentState.operatorList.lastChunk = true;\n                  for (const internalRenderTask of intentState.renderTasks) {\n                    internalRenderTask.operatorListChanged();\n                  }\n                  this.#tryCleanup(true);\n                }\n                if (intentState.displayReadyCapability) {\n                  intentState.displayReadyCapability.reject(reason);\n                } else if (intentState.opListReadCapability) {\n                  intentState.opListReadCapability.reject(reason);\n                } else {\n                  throw reason;\n                }\n              });\n            };\n            pump();\n          }\n          _abortOperatorList({\n            intentState,\n            reason,\n            force = false\n          }) {\n            if (!intentState.streamReader) {\n              return;\n            }\n            if (intentState.streamReaderCancelTimeout) {\n              clearTimeout(intentState.streamReaderCancelTimeout);\n              intentState.streamReaderCancelTimeout = null;\n            }\n            if (!force) {\n              if (intentState.renderTasks.size > 0) {\n                return;\n              }\n              if (reason instanceof _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.RenderingCancelledException) {\n                let delay = RENDERING_CANCELLED_TIMEOUT;\n                if (reason.extraDelay > 0 && reason.extraDelay < 1000) {\n                  delay += reason.extraDelay;\n                }\n                intentState.streamReaderCancelTimeout = setTimeout(() => {\n                  intentState.streamReaderCancelTimeout = null;\n                  this._abortOperatorList({\n                    intentState,\n                    reason,\n                    force: true\n                  });\n                }, delay);\n                return;\n              }\n            }\n            intentState.streamReader.cancel(new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AbortException(reason.message)).catch(() => {});\n            intentState.streamReader = null;\n            if (this._transport.destroyed) {\n              return;\n            }\n            for (const [curCacheKey, curIntentState] of this._intentStates) {\n              if (curIntentState === intentState) {\n                this._intentStates.delete(curCacheKey);\n                break;\n              }\n            }\n            this.cleanup();\n          }\n          get stats() {\n            return this._stats;\n          }\n        }\n        class LoopbackPort {\n          #listeners = new Set();\n          #deferred = Promise.resolve();\n          postMessage(obj, transfer) {\n            const event = {\n              data: structuredClone(obj, transfer ? {\n                transfer\n              } : null)\n            };\n            this.#deferred.then(() => {\n              for (const listener of this.#listeners) {\n                listener.call(this, event);\n              }\n            });\n          }\n          addEventListener(name, listener) {\n            this.#listeners.add(listener);\n          }\n          removeEventListener(name, listener) {\n            this.#listeners.delete(listener);\n          }\n          terminate() {\n            this.#listeners.clear();\n          }\n        }\n        const PDFWorkerUtil = {\n          isWorkerDisabled: false,\n          fakeWorkerId: 0\n        };\n        {\n          if (_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isNodeJS) {\n            PDFWorkerUtil.isWorkerDisabled = true;\n            _worker_options_js__WEBPACK_IMPORTED_MODULE_6__.GlobalWorkerOptions.workerSrc ||= \"./pdf.worker.mjs\";\n          }\n          PDFWorkerUtil.isSameOrigin = function (baseUrl, otherUrl) {\n            let base;\n            try {\n              base = new URL(baseUrl);\n              if (!base.origin || base.origin === \"null\") {\n                return false;\n              }\n            } catch {\n              return false;\n            }\n            const other = new URL(otherUrl, base);\n            return base.origin === other.origin;\n          };\n          PDFWorkerUtil.createCDNWrapper = function (url) {\n            const wrapper = `await import(\"${url}\");`;\n            return URL.createObjectURL(new Blob([wrapper], {\n              type: \"text/javascript\"\n            }));\n          };\n        }\n        class PDFWorker {\n          static #workerPorts;\n          constructor({\n            name = null,\n            port = null,\n            verbosity = (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.getVerbosityLevel)()\n          } = {}) {\n            this.name = name;\n            this.destroyed = false;\n            this.verbosity = verbosity;\n            this._readyCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n            this._port = null;\n            this._webWorker = null;\n            this._messageHandler = null;\n            if (port) {\n              if (PDFWorker.#workerPorts?.has(port)) {\n                throw new Error(\"Cannot use more than one PDFWorker per port.\");\n              }\n              (PDFWorker.#workerPorts ||= new WeakMap()).set(port, this);\n              this._initializeFromPort(port);\n              return;\n            }\n            this._initialize();\n          }\n          get promise() {\n            return this._readyCapability.promise;\n          }\n          get port() {\n            return this._port;\n          }\n          get messageHandler() {\n            return this._messageHandler;\n          }\n          _initializeFromPort(port) {\n            this._port = port;\n            this._messageHandler = new _shared_message_handler_js__WEBPACK_IMPORTED_MODULE_7__.MessageHandler(\"main\", \"worker\", port);\n            this._messageHandler.on(\"ready\", function () {});\n            this._readyCapability.resolve();\n            this._messageHandler.send(\"configure\", {\n              verbosity: this.verbosity\n            });\n          }\n          _initialize() {\n            if (!PDFWorkerUtil.isWorkerDisabled && !PDFWorker.#mainThreadWorkerMessageHandler) {\n              let {\n                workerSrc\n              } = PDFWorker;\n              try {\n                if (!PDFWorkerUtil.isSameOrigin(window.location.href, workerSrc)) {\n                  workerSrc = PDFWorkerUtil.createCDNWrapper(new URL(workerSrc, window.location).href);\n                }\n                const worker = new Worker(workerSrc, {\n                  type: \"module\"\n                });\n                const messageHandler = new _shared_message_handler_js__WEBPACK_IMPORTED_MODULE_7__.MessageHandler(\"main\", \"worker\", worker);\n                const terminateEarly = () => {\n                  worker.removeEventListener(\"error\", onWorkerError);\n                  messageHandler.destroy();\n                  worker.terminate();\n                  if (this.destroyed) {\n                    this._readyCapability.reject(new Error(\"Worker was destroyed\"));\n                  } else {\n                    this._setupFakeWorker();\n                  }\n                };\n                const onWorkerError = () => {\n                  if (!this._webWorker) {\n                    terminateEarly();\n                  }\n                };\n                worker.addEventListener(\"error\", onWorkerError);\n                messageHandler.on(\"test\", data => {\n                  worker.removeEventListener(\"error\", onWorkerError);\n                  if (this.destroyed) {\n                    terminateEarly();\n                    return;\n                  }\n                  if (data) {\n                    this._messageHandler = messageHandler;\n                    this._port = worker;\n                    this._webWorker = worker;\n                    this._readyCapability.resolve();\n                    messageHandler.send(\"configure\", {\n                      verbosity: this.verbosity\n                    });\n                  } else {\n                    this._setupFakeWorker();\n                    messageHandler.destroy();\n                    worker.terminate();\n                  }\n                });\n                messageHandler.on(\"ready\", data => {\n                  worker.removeEventListener(\"error\", onWorkerError);\n                  if (this.destroyed) {\n                    terminateEarly();\n                    return;\n                  }\n                  try {\n                    sendTest();\n                  } catch {\n                    this._setupFakeWorker();\n                  }\n                });\n                const sendTest = () => {\n                  const testObj = new Uint8Array();\n                  messageHandler.send(\"test\", testObj, [testObj.buffer]);\n                };\n                sendTest();\n                return;\n              } catch {\n                (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.info)(\"The worker has been disabled.\");\n              }\n            }\n            this._setupFakeWorker();\n          }\n          _setupFakeWorker() {\n            if (!PDFWorkerUtil.isWorkerDisabled) {\n              (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(\"Setting up fake worker.\");\n              PDFWorkerUtil.isWorkerDisabled = true;\n            }\n            PDFWorker._setupFakeWorkerGlobal.then(WorkerMessageHandler => {\n              if (this.destroyed) {\n                this._readyCapability.reject(new Error(\"Worker was destroyed\"));\n                return;\n              }\n              const port = new LoopbackPort();\n              this._port = port;\n              const id = `fake${PDFWorkerUtil.fakeWorkerId++}`;\n              const workerHandler = new _shared_message_handler_js__WEBPACK_IMPORTED_MODULE_7__.MessageHandler(id + \"_worker\", id, port);\n              WorkerMessageHandler.setup(workerHandler, port);\n              const messageHandler = new _shared_message_handler_js__WEBPACK_IMPORTED_MODULE_7__.MessageHandler(id, id + \"_worker\", port);\n              this._messageHandler = messageHandler;\n              this._readyCapability.resolve();\n              messageHandler.send(\"configure\", {\n                verbosity: this.verbosity\n              });\n            }).catch(reason => {\n              this._readyCapability.reject(new Error(`Setting up fake worker failed: \"${reason.message}\".`));\n            });\n          }\n          destroy() {\n            this.destroyed = true;\n            if (this._webWorker) {\n              this._webWorker.terminate();\n              this._webWorker = null;\n            }\n            PDFWorker.#workerPorts?.delete(this._port);\n            this._port = null;\n            if (this._messageHandler) {\n              this._messageHandler.destroy();\n              this._messageHandler = null;\n            }\n          }\n          static fromPort(params) {\n            if (!params?.port) {\n              throw new Error(\"PDFWorker.fromPort - invalid method signature.\");\n            }\n            const cachedPort = this.#workerPorts?.get(params.port);\n            if (cachedPort) {\n              if (cachedPort._pendingDestroy) {\n                throw new Error(\"PDFWorker.fromPort - the worker is being destroyed.\\n\" + \"Please remember to await `PDFDocumentLoadingTask.destroy()`-calls.\");\n              }\n              return cachedPort;\n            }\n            return new PDFWorker(params);\n          }\n          static get workerSrc() {\n            if (_worker_options_js__WEBPACK_IMPORTED_MODULE_6__.GlobalWorkerOptions.workerSrc) {\n              return _worker_options_js__WEBPACK_IMPORTED_MODULE_6__.GlobalWorkerOptions.workerSrc;\n            }\n            throw new Error('No \"GlobalWorkerOptions.workerSrc\" specified.');\n          }\n          static get #mainThreadWorkerMessageHandler() {\n            try {\n              return globalThis.pdfjsWorker?.WorkerMessageHandler || null;\n            } catch {\n              return null;\n            }\n          }\n          static get _setupFakeWorkerGlobal() {\n            const loader = async () => {\n              if (this.#mainThreadWorkerMessageHandler) {\n                return this.#mainThreadWorkerMessageHandler;\n              }\n              const worker = await import( /* webpackIgnore: true */this.workerSrc);\n              return worker.WorkerMessageHandler;\n            };\n            return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"_setupFakeWorkerGlobal\", loader());\n          }\n        }\n        class WorkerTransport {\n          #methodPromises = new Map();\n          #pageCache = new Map();\n          #pagePromises = new Map();\n          #passwordCapability = null;\n          constructor(messageHandler, loadingTask, networkStream, params, factory) {\n            this.messageHandler = messageHandler;\n            this.loadingTask = loadingTask;\n            this.commonObjs = new PDFObjects();\n            this.fontLoader = new _font_loader_js__WEBPACK_IMPORTED_MODULE_3__.FontLoader({\n              ownerDocument: params.ownerDocument,\n              styleElement: params.styleElement\n            });\n            this._params = params;\n            this.canvasFactory = factory.canvasFactory;\n            this.filterFactory = factory.filterFactory;\n            this.cMapReaderFactory = factory.cMapReaderFactory;\n            this.standardFontDataFactory = factory.standardFontDataFactory;\n            this.destroyed = false;\n            this.destroyCapability = null;\n            this._networkStream = networkStream;\n            this._fullReader = null;\n            this._lastProgress = null;\n            this.downloadInfoCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n            this.setupMessageHandler();\n          }\n          #cacheSimpleMethod(name, data = null) {\n            const cachedPromise = this.#methodPromises.get(name);\n            if (cachedPromise) {\n              return cachedPromise;\n            }\n            const promise = this.messageHandler.sendWithPromise(name, data);\n            this.#methodPromises.set(name, promise);\n            return promise;\n          }\n          get annotationStorage() {\n            return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"annotationStorage\", new _annotation_storage_js__WEBPACK_IMPORTED_MODULE_1__.AnnotationStorage());\n          }\n          getRenderingIntent(intent, annotationMode = _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationMode.ENABLE, printAnnotationStorage = null, isOpList = false) {\n            let renderingIntent = _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.RenderingIntentFlag.DISPLAY;\n            let annotationStorageSerializable = _annotation_storage_js__WEBPACK_IMPORTED_MODULE_1__.SerializableEmpty;\n            switch (intent) {\n              case \"any\":\n                renderingIntent = _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.RenderingIntentFlag.ANY;\n                break;\n              case \"display\":\n                break;\n              case \"print\":\n                renderingIntent = _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.RenderingIntentFlag.PRINT;\n                break;\n              default:\n                (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`getRenderingIntent - invalid intent: ${intent}`);\n            }\n            switch (annotationMode) {\n              case _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationMode.DISABLE:\n                renderingIntent += _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.RenderingIntentFlag.ANNOTATIONS_DISABLE;\n                break;\n              case _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationMode.ENABLE:\n                break;\n              case _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationMode.ENABLE_FORMS:\n                renderingIntent += _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.RenderingIntentFlag.ANNOTATIONS_FORMS;\n                break;\n              case _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationMode.ENABLE_STORAGE:\n                renderingIntent += _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.RenderingIntentFlag.ANNOTATIONS_STORAGE;\n                const annotationStorage = renderingIntent & _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.RenderingIntentFlag.PRINT && printAnnotationStorage instanceof _annotation_storage_js__WEBPACK_IMPORTED_MODULE_1__.PrintAnnotationStorage ? printAnnotationStorage : this.annotationStorage;\n                annotationStorageSerializable = annotationStorage.serializable;\n                break;\n              default:\n                (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`getRenderingIntent - invalid annotationMode: ${annotationMode}`);\n            }\n            if (isOpList) {\n              renderingIntent += _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.RenderingIntentFlag.OPLIST;\n            }\n            return {\n              renderingIntent,\n              cacheKey: `${renderingIntent}_${annotationStorageSerializable.hash}`,\n              annotationStorageSerializable\n            };\n          }\n          destroy() {\n            if (this.destroyCapability) {\n              return this.destroyCapability.promise;\n            }\n            this.destroyed = true;\n            this.destroyCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n            this.#passwordCapability?.reject(new Error(\"Worker was destroyed during onPassword callback\"));\n            const waitOn = [];\n            for (const page of this.#pageCache.values()) {\n              waitOn.push(page._destroy());\n            }\n            this.#pageCache.clear();\n            this.#pagePromises.clear();\n            if (this.hasOwnProperty(\"annotationStorage\")) {\n              this.annotationStorage.resetModified();\n            }\n            const terminated = this.messageHandler.sendWithPromise(\"Terminate\", null);\n            waitOn.push(terminated);\n            Promise.all(waitOn).then(() => {\n              this.commonObjs.clear();\n              this.fontLoader.clear();\n              this.#methodPromises.clear();\n              this.filterFactory.destroy();\n              this._networkStream?.cancelAllRequests(new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AbortException(\"Worker was terminated.\"));\n              if (this.messageHandler) {\n                this.messageHandler.destroy();\n                this.messageHandler = null;\n              }\n              this.destroyCapability.resolve();\n            }, this.destroyCapability.reject);\n            return this.destroyCapability.promise;\n          }\n          setupMessageHandler() {\n            const {\n              messageHandler,\n              loadingTask\n            } = this;\n            messageHandler.on(\"GetReader\", (data, sink) => {\n              (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(this._networkStream, \"GetReader - no `IPDFStream` instance available.\");\n              this._fullReader = this._networkStream.getFullReader();\n              this._fullReader.onProgress = evt => {\n                this._lastProgress = {\n                  loaded: evt.loaded,\n                  total: evt.total\n                };\n              };\n              sink.onPull = () => {\n                this._fullReader.read().then(function ({\n                  value,\n                  done\n                }) {\n                  if (done) {\n                    sink.close();\n                    return;\n                  }\n                  (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(value instanceof ArrayBuffer, \"GetReader - expected an ArrayBuffer.\");\n                  sink.enqueue(new Uint8Array(value), 1, [value]);\n                }).catch(reason => {\n                  sink.error(reason);\n                });\n              };\n              sink.onCancel = reason => {\n                this._fullReader.cancel(reason);\n                sink.ready.catch(readyReason => {\n                  if (this.destroyed) {\n                    return;\n                  }\n                  throw readyReason;\n                });\n              };\n            });\n            messageHandler.on(\"ReaderHeadersReady\", data => {\n              const headersCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n              const fullReader = this._fullReader;\n              fullReader.headersReady.then(() => {\n                if (!fullReader.isStreamingSupported || !fullReader.isRangeSupported) {\n                  if (this._lastProgress) {\n                    loadingTask.onProgress?.(this._lastProgress);\n                  }\n                  fullReader.onProgress = evt => {\n                    loadingTask.onProgress?.({\n                      loaded: evt.loaded,\n                      total: evt.total\n                    });\n                  };\n                }\n                headersCapability.resolve({\n                  isStreamingSupported: fullReader.isStreamingSupported,\n                  isRangeSupported: fullReader.isRangeSupported,\n                  contentLength: fullReader.contentLength\n                });\n              }, headersCapability.reject);\n              return headersCapability.promise;\n            });\n            messageHandler.on(\"GetRangeReader\", (data, sink) => {\n              (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(this._networkStream, \"GetRangeReader - no `IPDFStream` instance available.\");\n              const rangeReader = this._networkStream.getRangeReader(data.begin, data.end);\n              if (!rangeReader) {\n                sink.close();\n                return;\n              }\n              sink.onPull = () => {\n                rangeReader.read().then(function ({\n                  value,\n                  done\n                }) {\n                  if (done) {\n                    sink.close();\n                    return;\n                  }\n                  (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(value instanceof ArrayBuffer, \"GetRangeReader - expected an ArrayBuffer.\");\n                  sink.enqueue(new Uint8Array(value), 1, [value]);\n                }).catch(reason => {\n                  sink.error(reason);\n                });\n              };\n              sink.onCancel = reason => {\n                rangeReader.cancel(reason);\n                sink.ready.catch(readyReason => {\n                  if (this.destroyed) {\n                    return;\n                  }\n                  throw readyReason;\n                });\n              };\n            });\n            messageHandler.on(\"GetDoc\", ({\n              pdfInfo\n            }) => {\n              this._numPages = pdfInfo.numPages;\n              this._htmlForXfa = pdfInfo.htmlForXfa;\n              delete pdfInfo.htmlForXfa;\n              loadingTask._capability.resolve(new PDFDocumentProxy(pdfInfo, this));\n            });\n            messageHandler.on(\"DocException\", function (ex) {\n              let reason;\n              switch (ex.name) {\n                case \"PasswordException\":\n                  reason = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PasswordException(ex.message, ex.code);\n                  break;\n                case \"InvalidPDFException\":\n                  reason = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.InvalidPDFException(ex.message);\n                  break;\n                case \"MissingPDFException\":\n                  reason = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.MissingPDFException(ex.message);\n                  break;\n                case \"UnexpectedResponseException\":\n                  reason = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.UnexpectedResponseException(ex.message, ex.status);\n                  break;\n                case \"UnknownErrorException\":\n                  reason = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.UnknownErrorException(ex.message, ex.details);\n                  break;\n                default:\n                  (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"DocException - expected a valid Error.\");\n              }\n              loadingTask._capability.reject(reason);\n            });\n            messageHandler.on(\"PasswordRequest\", exception => {\n              this.#passwordCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n              if (loadingTask.onPassword) {\n                const updatePassword = password => {\n                  if (password instanceof Error) {\n                    this.#passwordCapability.reject(password);\n                  } else {\n                    this.#passwordCapability.resolve({\n                      password\n                    });\n                  }\n                };\n                try {\n                  loadingTask.onPassword(updatePassword, exception.code);\n                } catch (ex) {\n                  this.#passwordCapability.reject(ex);\n                }\n              } else {\n                this.#passwordCapability.reject(new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PasswordException(exception.message, exception.code));\n              }\n              return this.#passwordCapability.promise;\n            });\n            messageHandler.on(\"DataLoaded\", data => {\n              loadingTask.onProgress?.({\n                loaded: data.length,\n                total: data.length\n              });\n              this.downloadInfoCapability.resolve(data);\n            });\n            messageHandler.on(\"StartRenderPage\", data => {\n              if (this.destroyed) {\n                return;\n              }\n              const page = this.#pageCache.get(data.pageIndex);\n              page._startRenderPage(data.transparency, data.cacheKey);\n            });\n            messageHandler.on(\"commonobj\", ([id, type, exportedData]) => {\n              if (this.destroyed) {\n                return;\n              }\n              if (this.commonObjs.has(id)) {\n                return;\n              }\n              switch (type) {\n                case \"Font\":\n                  const params = this._params;\n                  if (\"error\" in exportedData) {\n                    const exportedError = exportedData.error;\n                    (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`Error during font loading: ${exportedError}`);\n                    this.commonObjs.resolve(id, exportedError);\n                    break;\n                  }\n                  const inspectFont = params.pdfBug && globalThis.FontInspector?.enabled ? (font, url) => globalThis.FontInspector.fontAdded(font, url) : null;\n                  const font = new _font_loader_js__WEBPACK_IMPORTED_MODULE_3__.FontFaceObject(exportedData, {\n                    isEvalSupported: params.isEvalSupported,\n                    disableFontFace: params.disableFontFace,\n                    ignoreErrors: params.ignoreErrors,\n                    inspectFont\n                  });\n                  this.fontLoader.bind(font).catch(reason => {\n                    return messageHandler.sendWithPromise(\"FontFallback\", {\n                      id\n                    });\n                  }).finally(() => {\n                    if (!params.fontExtraProperties && font.data) {\n                      font.data = null;\n                    }\n                    this.commonObjs.resolve(id, font);\n                  });\n                  break;\n                case \"FontPath\":\n                case \"Image\":\n                case \"Pattern\":\n                  this.commonObjs.resolve(id, exportedData);\n                  break;\n                default:\n                  throw new Error(`Got unknown common object type ${type}`);\n              }\n            });\n            messageHandler.on(\"obj\", ([id, pageIndex, type, imageData]) => {\n              if (this.destroyed) {\n                return;\n              }\n              const pageProxy = this.#pageCache.get(pageIndex);\n              if (pageProxy.objs.has(id)) {\n                return;\n              }\n              if (pageProxy._intentStates.size === 0) {\n                imageData?.bitmap?.close();\n                return;\n              }\n              switch (type) {\n                case \"Image\":\n                  pageProxy.objs.resolve(id, imageData);\n                  if (imageData) {\n                    let length;\n                    if (imageData.bitmap) {\n                      const {\n                        width,\n                        height\n                      } = imageData;\n                      length = width * height * 4;\n                    } else {\n                      length = imageData.data?.length || 0;\n                    }\n                    if (length > _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.MAX_IMAGE_SIZE_TO_CACHE) {\n                      pageProxy._maybeCleanupAfterRender = true;\n                    }\n                  }\n                  break;\n                case \"Pattern\":\n                  pageProxy.objs.resolve(id, imageData);\n                  break;\n                default:\n                  throw new Error(`Got unknown object type ${type}`);\n              }\n            });\n            messageHandler.on(\"DocProgress\", data => {\n              if (this.destroyed) {\n                return;\n              }\n              loadingTask.onProgress?.({\n                loaded: data.loaded,\n                total: data.total\n              });\n            });\n            messageHandler.on(\"FetchBuiltInCMap\", data => {\n              if (this.destroyed) {\n                return Promise.reject(new Error(\"Worker was destroyed.\"));\n              }\n              if (!this.cMapReaderFactory) {\n                return Promise.reject(new Error(\"CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.\"));\n              }\n              return this.cMapReaderFactory.fetch(data);\n            });\n            messageHandler.on(\"FetchStandardFontData\", data => {\n              if (this.destroyed) {\n                return Promise.reject(new Error(\"Worker was destroyed.\"));\n              }\n              if (!this.standardFontDataFactory) {\n                return Promise.reject(new Error(\"StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.\"));\n              }\n              return this.standardFontDataFactory.fetch(data);\n            });\n          }\n          getData() {\n            return this.messageHandler.sendWithPromise(\"GetData\", null);\n          }\n          saveDocument() {\n            if (this.annotationStorage.size <= 0) {\n              (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(\"saveDocument called while `annotationStorage` is empty, \" + \"please use the getData-method instead.\");\n            }\n            const {\n              map,\n              transfer\n            } = this.annotationStorage.serializable;\n            return this.messageHandler.sendWithPromise(\"SaveDocument\", {\n              isPureXfa: !!this._htmlForXfa,\n              numPages: this._numPages,\n              annotationStorage: map,\n              filename: this._fullReader?.filename ?? null\n            }, transfer).finally(() => {\n              this.annotationStorage.resetModified();\n            });\n          }\n          getPage(pageNumber) {\n            if (!Number.isInteger(pageNumber) || pageNumber <= 0 || pageNumber > this._numPages) {\n              return Promise.reject(new Error(\"Invalid page request.\"));\n            }\n            const pageIndex = pageNumber - 1,\n              cachedPromise = this.#pagePromises.get(pageIndex);\n            if (cachedPromise) {\n              return cachedPromise;\n            }\n            const promise = this.messageHandler.sendWithPromise(\"GetPage\", {\n              pageIndex\n            }).then(pageInfo => {\n              if (this.destroyed) {\n                throw new Error(\"Transport destroyed\");\n              }\n              const page = new PDFPageProxy(pageIndex, pageInfo, this, this._params.pdfBug);\n              this.#pageCache.set(pageIndex, page);\n              return page;\n            });\n            this.#pagePromises.set(pageIndex, promise);\n            return promise;\n          }\n          getPageIndex(ref) {\n            if (typeof ref !== \"object\" || ref === null || !Number.isInteger(ref.num) || ref.num < 0 || !Number.isInteger(ref.gen) || ref.gen < 0) {\n              return Promise.reject(new Error(\"Invalid pageIndex request.\"));\n            }\n            return this.messageHandler.sendWithPromise(\"GetPageIndex\", {\n              num: ref.num,\n              gen: ref.gen\n            });\n          }\n          getAnnotations(pageIndex, intent) {\n            return this.messageHandler.sendWithPromise(\"GetAnnotations\", {\n              pageIndex,\n              intent\n            });\n          }\n          getFieldObjects() {\n            return this.#cacheSimpleMethod(\"GetFieldObjects\");\n          }\n          hasJSActions() {\n            return this.#cacheSimpleMethod(\"HasJSActions\");\n          }\n          getCalculationOrderIds() {\n            return this.messageHandler.sendWithPromise(\"GetCalculationOrderIds\", null);\n          }\n          getDestinations() {\n            return this.messageHandler.sendWithPromise(\"GetDestinations\", null);\n          }\n          getDestination(id) {\n            if (typeof id !== \"string\") {\n              return Promise.reject(new Error(\"Invalid destination request.\"));\n            }\n            return this.messageHandler.sendWithPromise(\"GetDestination\", {\n              id\n            });\n          }\n          getPageLabels() {\n            return this.messageHandler.sendWithPromise(\"GetPageLabels\", null);\n          }\n          getPageLayout() {\n            return this.messageHandler.sendWithPromise(\"GetPageLayout\", null);\n          }\n          getPageMode() {\n            return this.messageHandler.sendWithPromise(\"GetPageMode\", null);\n          }\n          getViewerPreferences() {\n            return this.messageHandler.sendWithPromise(\"GetViewerPreferences\", null);\n          }\n          getOpenAction() {\n            return this.messageHandler.sendWithPromise(\"GetOpenAction\", null);\n          }\n          getAttachments() {\n            return this.messageHandler.sendWithPromise(\"GetAttachments\", null);\n          }\n          getDocJSActions() {\n            return this.#cacheSimpleMethod(\"GetDocJSActions\");\n          }\n          getPageJSActions(pageIndex) {\n            return this.messageHandler.sendWithPromise(\"GetPageJSActions\", {\n              pageIndex\n            });\n          }\n          getStructTree(pageIndex) {\n            return this.messageHandler.sendWithPromise(\"GetStructTree\", {\n              pageIndex\n            });\n          }\n          getOutline() {\n            return this.messageHandler.sendWithPromise(\"GetOutline\", null);\n          }\n          getOptionalContentConfig() {\n            return this.messageHandler.sendWithPromise(\"GetOptionalContentConfig\", null).then(results => {\n              return new _optional_content_config_js__WEBPACK_IMPORTED_MODULE_9__.OptionalContentConfig(results);\n            });\n          }\n          getPermissions() {\n            return this.messageHandler.sendWithPromise(\"GetPermissions\", null);\n          }\n          getMetadata() {\n            const name = \"GetMetadata\",\n              cachedPromise = this.#methodPromises.get(name);\n            if (cachedPromise) {\n              return cachedPromise;\n            }\n            const promise = this.messageHandler.sendWithPromise(name, null).then(results => {\n              return {\n                info: results[0],\n                metadata: results[1] ? new _metadata_js__WEBPACK_IMPORTED_MODULE_8__.Metadata(results[1]) : null,\n                contentDispositionFilename: this._fullReader?.filename ?? null,\n                contentLength: this._fullReader?.contentLength ?? null\n              };\n            });\n            this.#methodPromises.set(name, promise);\n            return promise;\n          }\n          getMarkInfo() {\n            return this.messageHandler.sendWithPromise(\"GetMarkInfo\", null);\n          }\n          async startCleanup(keepLoadedFonts = false) {\n            if (this.destroyed) {\n              return;\n            }\n            await this.messageHandler.sendWithPromise(\"Cleanup\", null);\n            for (const page of this.#pageCache.values()) {\n              const cleanupSuccessful = page.cleanup();\n              if (!cleanupSuccessful) {\n                throw new Error(`startCleanup: Page ${page.pageNumber} is currently rendering.`);\n              }\n            }\n            this.commonObjs.clear();\n            if (!keepLoadedFonts) {\n              this.fontLoader.clear();\n            }\n            this.#methodPromises.clear();\n            this.filterFactory.destroy(true);\n          }\n          get loadingParams() {\n            const {\n              disableAutoFetch,\n              enableXfa\n            } = this._params;\n            return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"loadingParams\", {\n              disableAutoFetch,\n              enableXfa\n            });\n          }\n        }\n        class PDFObjects {\n          #objs = Object.create(null);\n          #ensureObj(objId) {\n            return this.#objs[objId] ||= {\n              capability: new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability(),\n              data: null\n            };\n          }\n          get(objId, callback = null) {\n            if (callback) {\n              const obj = this.#ensureObj(objId);\n              obj.capability.promise.then(() => callback(obj.data));\n              return null;\n            }\n            const obj = this.#objs[objId];\n            if (!obj?.capability.settled) {\n              throw new Error(`Requesting object that isn't resolved yet ${objId}.`);\n            }\n            return obj.data;\n          }\n          has(objId) {\n            const obj = this.#objs[objId];\n            return obj?.capability.settled || false;\n          }\n          resolve(objId, data = null) {\n            const obj = this.#ensureObj(objId);\n            obj.data = data;\n            obj.capability.resolve();\n          }\n          clear() {\n            for (const objId in this.#objs) {\n              const {\n                data\n              } = this.#objs[objId];\n              data?.bitmap?.close();\n            }\n            this.#objs = Object.create(null);\n          }\n        }\n        class RenderTask {\n          #internalRenderTask = null;\n          constructor(internalRenderTask) {\n            this.#internalRenderTask = internalRenderTask;\n            this.onContinue = null;\n          }\n          get promise() {\n            return this.#internalRenderTask.capability.promise;\n          }\n          cancel(extraDelay = 0) {\n            this.#internalRenderTask.cancel(null, extraDelay);\n          }\n          get separateAnnots() {\n            const {\n              separateAnnots\n            } = this.#internalRenderTask.operatorList;\n            if (!separateAnnots) {\n              return false;\n            }\n            const {\n              annotationCanvasMap\n            } = this.#internalRenderTask;\n            return separateAnnots.form || separateAnnots.canvas && annotationCanvasMap?.size > 0;\n          }\n        }\n        class InternalRenderTask {\n          static #canvasInUse = new WeakSet();\n          constructor({\n            callback,\n            params,\n            objs,\n            commonObjs,\n            annotationCanvasMap,\n            operatorList,\n            pageIndex,\n            canvasFactory,\n            filterFactory,\n            useRequestAnimationFrame = false,\n            pdfBug = false,\n            pageColors = null\n          }) {\n            this.callback = callback;\n            this.params = params;\n            this.objs = objs;\n            this.commonObjs = commonObjs;\n            this.annotationCanvasMap = annotationCanvasMap;\n            this.operatorListIdx = null;\n            this.operatorList = operatorList;\n            this._pageIndex = pageIndex;\n            this.canvasFactory = canvasFactory;\n            this.filterFactory = filterFactory;\n            this._pdfBug = pdfBug;\n            this.pageColors = pageColors;\n            this.running = false;\n            this.graphicsReadyCallback = null;\n            this.graphicsReady = false;\n            this._useRequestAnimationFrame = useRequestAnimationFrame === true && typeof window !== \"undefined\";\n            this.cancelled = false;\n            this.capability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n            this.task = new RenderTask(this);\n            this._cancelBound = this.cancel.bind(this);\n            this._continueBound = this._continue.bind(this);\n            this._scheduleNextBound = this._scheduleNext.bind(this);\n            this._nextBound = this._next.bind(this);\n            this._canvas = params.canvasContext.canvas;\n          }\n          get completed() {\n            return this.capability.promise.catch(function () {});\n          }\n          initializeGraphics({\n            transparency = false,\n            optionalContentConfig\n          }) {\n            if (this.cancelled) {\n              return;\n            }\n            if (this._canvas) {\n              if (InternalRenderTask.#canvasInUse.has(this._canvas)) {\n                throw new Error(\"Cannot use the same canvas during multiple render() operations. \" + \"Use different canvas or ensure previous operations were \" + \"cancelled or completed.\");\n              }\n              InternalRenderTask.#canvasInUse.add(this._canvas);\n            }\n            if (this._pdfBug && globalThis.StepperManager?.enabled) {\n              this.stepper = globalThis.StepperManager.create(this._pageIndex);\n              this.stepper.init(this.operatorList);\n              this.stepper.nextBreakPoint = this.stepper.getNextBreakPoint();\n            }\n            const {\n              canvasContext,\n              viewport,\n              transform,\n              background\n            } = this.params;\n            this.gfx = new _canvas_js__WEBPACK_IMPORTED_MODULE_5__.CanvasGraphics(canvasContext, this.commonObjs, this.objs, this.canvasFactory, this.filterFactory, {\n              optionalContentConfig\n            }, this.annotationCanvasMap, this.pageColors);\n            this.gfx.beginDrawing({\n              transform,\n              viewport,\n              transparency,\n              background\n            });\n            this.operatorListIdx = 0;\n            this.graphicsReady = true;\n            this.graphicsReadyCallback?.();\n          }\n          cancel(error = null, extraDelay = 0) {\n            this.running = false;\n            this.cancelled = true;\n            this.gfx?.endDrawing();\n            InternalRenderTask.#canvasInUse.delete(this._canvas);\n            this.callback(error || new _display_utils_js__WEBPACK_IMPORTED_MODULE_2__.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex + 1}`, extraDelay));\n          }\n          operatorListChanged() {\n            if (!this.graphicsReady) {\n              this.graphicsReadyCallback ||= this._continueBound;\n              return;\n            }\n            this.stepper?.updateOperatorList(this.operatorList);\n            if (this.running) {\n              return;\n            }\n            this._continue();\n          }\n          _continue() {\n            this.running = true;\n            if (this.cancelled) {\n              return;\n            }\n            if (this.task.onContinue) {\n              this.task.onContinue(this._scheduleNextBound);\n            } else {\n              this._scheduleNext();\n            }\n          }\n          _scheduleNext() {\n            if (this._useRequestAnimationFrame) {\n              window.requestAnimationFrame(() => {\n                this._nextBound().catch(this._cancelBound);\n              });\n            } else {\n              Promise.resolve().then(this._nextBound).catch(this._cancelBound);\n            }\n          }\n          async _next() {\n            if (this.cancelled) {\n              return;\n            }\n            this.operatorListIdx = this.gfx.executeOperatorList(this.operatorList, this.operatorListIdx, this._continueBound, this.stepper);\n            if (this.operatorListIdx === this.operatorList.argsArray.length) {\n              this.running = false;\n              if (this.operatorList.lastChunk) {\n                this.gfx.endDrawing();\n                InternalRenderTask.#canvasInUse.delete(this._canvas);\n                this.callback();\n              }\n            }\n          }\n        }\n        const version = '4.0.269';\n        const build = 'f4b396f6c';\n        __webpack_async_result__();\n      } catch (e) {\n        __webpack_async_result__(e);\n      }\n    });\n\n    /***/\n  },\n\n  /***/822: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */BaseCMapReaderFactory: () => /* binding */BaseCMapReaderFactory,\n      /* harmony export */BaseCanvasFactory: () => /* binding */BaseCanvasFactory,\n      /* harmony export */BaseFilterFactory: () => /* binding */BaseFilterFactory,\n      /* harmony export */BaseSVGFactory: () => /* binding */BaseSVGFactory,\n      /* harmony export */BaseStandardFontDataFactory: () => /* binding */BaseStandardFontDataFactory\n      /* harmony export */\n    });\n    /* harmony import */\n    var _shared_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n    class BaseFilterFactory {\n      constructor() {\n        if (this.constructor === BaseFilterFactory) {\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"Cannot initialize BaseFilterFactory.\");\n        }\n      }\n      addFilter(maps) {\n        return \"none\";\n      }\n      addHCMFilter(fgColor, bgColor) {\n        return \"none\";\n      }\n      addHighlightHCMFilter(fgColor, bgColor, newFgColor, newBgColor) {\n        return \"none\";\n      }\n      destroy(keepHCM = false) {}\n    }\n    class BaseCanvasFactory {\n      constructor() {\n        if (this.constructor === BaseCanvasFactory) {\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"Cannot initialize BaseCanvasFactory.\");\n        }\n      }\n      create(width, height) {\n        if (width <= 0 || height <= 0) {\n          throw new Error(\"Invalid canvas size\");\n        }\n        const canvas = this._createCanvas(width, height);\n        return {\n          canvas,\n          context: canvas.getContext(\"2d\")\n        };\n      }\n      reset(canvasAndContext, width, height) {\n        if (!canvasAndContext.canvas) {\n          throw new Error(\"Canvas is not specified\");\n        }\n        if (width <= 0 || height <= 0) {\n          throw new Error(\"Invalid canvas size\");\n        }\n        canvasAndContext.canvas.width = width;\n        canvasAndContext.canvas.height = height;\n      }\n      destroy(canvasAndContext) {\n        if (!canvasAndContext.canvas) {\n          throw new Error(\"Canvas is not specified\");\n        }\n        canvasAndContext.canvas.width = 0;\n        canvasAndContext.canvas.height = 0;\n        canvasAndContext.canvas = null;\n        canvasAndContext.context = null;\n      }\n      _createCanvas(width, height) {\n        (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"Abstract method `_createCanvas` called.\");\n      }\n    }\n    class BaseCMapReaderFactory {\n      constructor({\n        baseUrl = null,\n        isCompressed = true\n      }) {\n        if (this.constructor === BaseCMapReaderFactory) {\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"Cannot initialize BaseCMapReaderFactory.\");\n        }\n        this.baseUrl = baseUrl;\n        this.isCompressed = isCompressed;\n      }\n      async fetch({\n        name\n      }) {\n        if (!this.baseUrl) {\n          throw new Error('The CMap \"baseUrl\" parameter must be specified, ensure that ' + 'the \"cMapUrl\" and \"cMapPacked\" API parameters are provided.');\n        }\n        if (!name) {\n          throw new Error(\"CMap name must be specified.\");\n        }\n        const url = this.baseUrl + name + (this.isCompressed ? \".bcmap\" : \"\");\n        const compressionType = this.isCompressed ? _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.CMapCompressionType.BINARY : _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.CMapCompressionType.NONE;\n        return this._fetchData(url, compressionType).catch(reason => {\n          throw new Error(`Unable to load ${this.isCompressed ? \"binary \" : \"\"}CMap at: ${url}`);\n        });\n      }\n      _fetchData(url, compressionType) {\n        (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"Abstract method `_fetchData` called.\");\n      }\n    }\n    class BaseStandardFontDataFactory {\n      constructor({\n        baseUrl = null\n      }) {\n        if (this.constructor === BaseStandardFontDataFactory) {\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"Cannot initialize BaseStandardFontDataFactory.\");\n        }\n        this.baseUrl = baseUrl;\n      }\n      async fetch({\n        filename\n      }) {\n        if (!this.baseUrl) {\n          throw new Error('The standard font \"baseUrl\" parameter must be specified, ensure that ' + 'the \"standardFontDataUrl\" API parameter is provided.');\n        }\n        if (!filename) {\n          throw new Error(\"Font filename must be specified.\");\n        }\n        const url = `${this.baseUrl}${filename}`;\n        return this._fetchData(url).catch(reason => {\n          throw new Error(`Unable to load font data at: ${url}`);\n        });\n      }\n      _fetchData(url) {\n        (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"Abstract method `_fetchData` called.\");\n      }\n    }\n    class BaseSVGFactory {\n      constructor() {\n        if (this.constructor === BaseSVGFactory) {\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"Cannot initialize BaseSVGFactory.\");\n        }\n      }\n      create(width, height, skipDimensions = false) {\n        if (width <= 0 || height <= 0) {\n          throw new Error(\"Invalid SVG dimensions\");\n        }\n        const svg = this._createSVG(\"svg:svg\");\n        svg.setAttribute(\"version\", \"1.1\");\n        if (!skipDimensions) {\n          svg.setAttribute(\"width\", `${width}px`);\n          svg.setAttribute(\"height\", `${height}px`);\n        }\n        svg.setAttribute(\"preserveAspectRatio\", \"none\");\n        svg.setAttribute(\"viewBox\", `0 0 ${width} ${height}`);\n        return svg;\n      }\n      createElement(type) {\n        if (typeof type !== \"string\") {\n          throw new Error(\"Invalid SVG element type\");\n        }\n        return this._createSVG(type);\n      }\n      _createSVG(type) {\n        (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"Abstract method `_createSVG` called.\");\n      }\n    }\n\n    /***/\n  },\n\n  /***/250: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    // EXPORTS\n    __webpack_require__.d(__webpack_exports__, {\n      CanvasGraphics: () => /* binding */CanvasGraphics\n    });\n\n    // EXTERNAL MODULE: ./src/shared/util.js\n    var util = __webpack_require__(266);\n    // EXTERNAL MODULE: ./src/display/display_utils.js\n    var display_utils = __webpack_require__(473);\n    ; // CONCATENATED MODULE: ./src/display/pattern_helper.js\n\n    const PathType = {\n      FILL: \"Fill\",\n      STROKE: \"Stroke\",\n      SHADING: \"Shading\"\n    };\n    function applyBoundingBox(ctx, bbox) {\n      if (!bbox) {\n        return;\n      }\n      const width = bbox[2] - bbox[0];\n      const height = bbox[3] - bbox[1];\n      const region = new Path2D();\n      region.rect(bbox[0], bbox[1], width, height);\n      ctx.clip(region);\n    }\n    class BaseShadingPattern {\n      constructor() {\n        if (this.constructor === BaseShadingPattern) {\n          (0, util.unreachable)(\"Cannot initialize BaseShadingPattern.\");\n        }\n      }\n      getPattern() {\n        (0, util.unreachable)(\"Abstract method `getPattern` called.\");\n      }\n    }\n    class RadialAxialShadingPattern extends BaseShadingPattern {\n      constructor(IR) {\n        super();\n        this._type = IR[1];\n        this._bbox = IR[2];\n        this._colorStops = IR[3];\n        this._p0 = IR[4];\n        this._p1 = IR[5];\n        this._r0 = IR[6];\n        this._r1 = IR[7];\n        this.matrix = null;\n      }\n      _createGradient(ctx) {\n        let grad;\n        if (this._type === \"axial\") {\n          grad = ctx.createLinearGradient(this._p0[0], this._p0[1], this._p1[0], this._p1[1]);\n        } else if (this._type === \"radial\") {\n          grad = ctx.createRadialGradient(this._p0[0], this._p0[1], this._r0, this._p1[0], this._p1[1], this._r1);\n        }\n        for (const colorStop of this._colorStops) {\n          grad.addColorStop(colorStop[0], colorStop[1]);\n        }\n        return grad;\n      }\n      getPattern(ctx, owner, inverse, pathType) {\n        let pattern;\n        if (pathType === PathType.STROKE || pathType === PathType.FILL) {\n          const ownerBBox = owner.current.getClippedPathBoundingBox(pathType, (0, display_utils.getCurrentTransform)(ctx)) || [0, 0, 0, 0];\n          const width = Math.ceil(ownerBBox[2] - ownerBBox[0]) || 1;\n          const height = Math.ceil(ownerBBox[3] - ownerBBox[1]) || 1;\n          const tmpCanvas = owner.cachedCanvases.getCanvas(\"pattern\", width, height, true);\n          const tmpCtx = tmpCanvas.context;\n          tmpCtx.clearRect(0, 0, tmpCtx.canvas.width, tmpCtx.canvas.height);\n          tmpCtx.beginPath();\n          tmpCtx.rect(0, 0, tmpCtx.canvas.width, tmpCtx.canvas.height);\n          tmpCtx.translate(-ownerBBox[0], -ownerBBox[1]);\n          inverse = util.Util.transform(inverse, [1, 0, 0, 1, ownerBBox[0], ownerBBox[1]]);\n          tmpCtx.transform(...owner.baseTransform);\n          if (this.matrix) {\n            tmpCtx.transform(...this.matrix);\n          }\n          applyBoundingBox(tmpCtx, this._bbox);\n          tmpCtx.fillStyle = this._createGradient(tmpCtx);\n          tmpCtx.fill();\n          pattern = ctx.createPattern(tmpCanvas.canvas, \"no-repeat\");\n          const domMatrix = new DOMMatrix(inverse);\n          pattern.setTransform(domMatrix);\n        } else {\n          applyBoundingBox(ctx, this._bbox);\n          pattern = this._createGradient(ctx);\n        }\n        return pattern;\n      }\n    }\n    function drawTriangle(data, context, p1, p2, p3, c1, c2, c3) {\n      const coords = context.coords,\n        colors = context.colors;\n      const bytes = data.data,\n        rowSize = data.width * 4;\n      let tmp;\n      if (coords[p1 + 1] > coords[p2 + 1]) {\n        tmp = p1;\n        p1 = p2;\n        p2 = tmp;\n        tmp = c1;\n        c1 = c2;\n        c2 = tmp;\n      }\n      if (coords[p2 + 1] > coords[p3 + 1]) {\n        tmp = p2;\n        p2 = p3;\n        p3 = tmp;\n        tmp = c2;\n        c2 = c3;\n        c3 = tmp;\n      }\n      if (coords[p1 + 1] > coords[p2 + 1]) {\n        tmp = p1;\n        p1 = p2;\n        p2 = tmp;\n        tmp = c1;\n        c1 = c2;\n        c2 = tmp;\n      }\n      const x1 = (coords[p1] + context.offsetX) * context.scaleX;\n      const y1 = (coords[p1 + 1] + context.offsetY) * context.scaleY;\n      const x2 = (coords[p2] + context.offsetX) * context.scaleX;\n      const y2 = (coords[p2 + 1] + context.offsetY) * context.scaleY;\n      const x3 = (coords[p3] + context.offsetX) * context.scaleX;\n      const y3 = (coords[p3 + 1] + context.offsetY) * context.scaleY;\n      if (y1 >= y3) {\n        return;\n      }\n      const c1r = colors[c1],\n        c1g = colors[c1 + 1],\n        c1b = colors[c1 + 2];\n      const c2r = colors[c2],\n        c2g = colors[c2 + 1],\n        c2b = colors[c2 + 2];\n      const c3r = colors[c3],\n        c3g = colors[c3 + 1],\n        c3b = colors[c3 + 2];\n      const minY = Math.round(y1),\n        maxY = Math.round(y3);\n      let xa, car, cag, cab;\n      let xb, cbr, cbg, cbb;\n      for (let y = minY; y <= maxY; y++) {\n        if (y < y2) {\n          const k = y < y1 ? 0 : (y1 - y) / (y1 - y2);\n          xa = x1 - (x1 - x2) * k;\n          car = c1r - (c1r - c2r) * k;\n          cag = c1g - (c1g - c2g) * k;\n          cab = c1b - (c1b - c2b) * k;\n        } else {\n          let k;\n          if (y > y3) {\n            k = 1;\n          } else if (y2 === y3) {\n            k = 0;\n          } else {\n            k = (y2 - y) / (y2 - y3);\n          }\n          xa = x2 - (x2 - x3) * k;\n          car = c2r - (c2r - c3r) * k;\n          cag = c2g - (c2g - c3g) * k;\n          cab = c2b - (c2b - c3b) * k;\n        }\n        let k;\n        if (y < y1) {\n          k = 0;\n        } else if (y > y3) {\n          k = 1;\n        } else {\n          k = (y1 - y) / (y1 - y3);\n        }\n        xb = x1 - (x1 - x3) * k;\n        cbr = c1r - (c1r - c3r) * k;\n        cbg = c1g - (c1g - c3g) * k;\n        cbb = c1b - (c1b - c3b) * k;\n        const x1_ = Math.round(Math.min(xa, xb));\n        const x2_ = Math.round(Math.max(xa, xb));\n        let j = rowSize * y + x1_ * 4;\n        for (let x = x1_; x <= x2_; x++) {\n          k = (xa - x) / (xa - xb);\n          if (k < 0) {\n            k = 0;\n          } else if (k > 1) {\n            k = 1;\n          }\n          bytes[j++] = car - (car - cbr) * k | 0;\n          bytes[j++] = cag - (cag - cbg) * k | 0;\n          bytes[j++] = cab - (cab - cbb) * k | 0;\n          bytes[j++] = 255;\n        }\n      }\n    }\n    function drawFigure(data, figure, context) {\n      const ps = figure.coords;\n      const cs = figure.colors;\n      let i, ii;\n      switch (figure.type) {\n        case \"lattice\":\n          const verticesPerRow = figure.verticesPerRow;\n          const rows = Math.floor(ps.length / verticesPerRow) - 1;\n          const cols = verticesPerRow - 1;\n          for (i = 0; i < rows; i++) {\n            let q = i * verticesPerRow;\n            for (let j = 0; j < cols; j++, q++) {\n              drawTriangle(data, context, ps[q], ps[q + 1], ps[q + verticesPerRow], cs[q], cs[q + 1], cs[q + verticesPerRow]);\n              drawTriangle(data, context, ps[q + verticesPerRow + 1], ps[q + 1], ps[q + verticesPerRow], cs[q + verticesPerRow + 1], cs[q + 1], cs[q + verticesPerRow]);\n            }\n          }\n          break;\n        case \"triangles\":\n          for (i = 0, ii = ps.length; i < ii; i += 3) {\n            drawTriangle(data, context, ps[i], ps[i + 1], ps[i + 2], cs[i], cs[i + 1], cs[i + 2]);\n          }\n          break;\n        default:\n          throw new Error(\"illegal figure\");\n      }\n    }\n    class MeshShadingPattern extends BaseShadingPattern {\n      constructor(IR) {\n        super();\n        this._coords = IR[2];\n        this._colors = IR[3];\n        this._figures = IR[4];\n        this._bounds = IR[5];\n        this._bbox = IR[7];\n        this._background = IR[8];\n        this.matrix = null;\n      }\n      _createMeshCanvas(combinedScale, backgroundColor, cachedCanvases) {\n        const EXPECTED_SCALE = 1.1;\n        const MAX_PATTERN_SIZE = 3000;\n        const BORDER_SIZE = 2;\n        const offsetX = Math.floor(this._bounds[0]);\n        const offsetY = Math.floor(this._bounds[1]);\n        const boundsWidth = Math.ceil(this._bounds[2]) - offsetX;\n        const boundsHeight = Math.ceil(this._bounds[3]) - offsetY;\n        const width = Math.min(Math.ceil(Math.abs(boundsWidth * combinedScale[0] * EXPECTED_SCALE)), MAX_PATTERN_SIZE);\n        const height = Math.min(Math.ceil(Math.abs(boundsHeight * combinedScale[1] * EXPECTED_SCALE)), MAX_PATTERN_SIZE);\n        const scaleX = boundsWidth / width;\n        const scaleY = boundsHeight / height;\n        const context = {\n          coords: this._coords,\n          colors: this._colors,\n          offsetX: -offsetX,\n          offsetY: -offsetY,\n          scaleX: 1 / scaleX,\n          scaleY: 1 / scaleY\n        };\n        const paddedWidth = width + BORDER_SIZE * 2;\n        const paddedHeight = height + BORDER_SIZE * 2;\n        const tmpCanvas = cachedCanvases.getCanvas(\"mesh\", paddedWidth, paddedHeight, false);\n        const tmpCtx = tmpCanvas.context;\n        const data = tmpCtx.createImageData(width, height);\n        if (backgroundColor) {\n          const bytes = data.data;\n          for (let i = 0, ii = bytes.length; i < ii; i += 4) {\n            bytes[i] = backgroundColor[0];\n            bytes[i + 1] = backgroundColor[1];\n            bytes[i + 2] = backgroundColor[2];\n            bytes[i + 3] = 255;\n          }\n        }\n        for (const figure of this._figures) {\n          drawFigure(data, figure, context);\n        }\n        tmpCtx.putImageData(data, BORDER_SIZE, BORDER_SIZE);\n        const canvas = tmpCanvas.canvas;\n        return {\n          canvas,\n          offsetX: offsetX - BORDER_SIZE * scaleX,\n          offsetY: offsetY - BORDER_SIZE * scaleY,\n          scaleX,\n          scaleY\n        };\n      }\n      getPattern(ctx, owner, inverse, pathType) {\n        applyBoundingBox(ctx, this._bbox);\n        let scale;\n        if (pathType === PathType.SHADING) {\n          scale = util.Util.singularValueDecompose2dScale((0, display_utils.getCurrentTransform)(ctx));\n        } else {\n          scale = util.Util.singularValueDecompose2dScale(owner.baseTransform);\n          if (this.matrix) {\n            const matrixScale = util.Util.singularValueDecompose2dScale(this.matrix);\n            scale = [scale[0] * matrixScale[0], scale[1] * matrixScale[1]];\n          }\n        }\n        const temporaryPatternCanvas = this._createMeshCanvas(scale, pathType === PathType.SHADING ? null : this._background, owner.cachedCanvases);\n        if (pathType !== PathType.SHADING) {\n          ctx.setTransform(...owner.baseTransform);\n          if (this.matrix) {\n            ctx.transform(...this.matrix);\n          }\n        }\n        ctx.translate(temporaryPatternCanvas.offsetX, temporaryPatternCanvas.offsetY);\n        ctx.scale(temporaryPatternCanvas.scaleX, temporaryPatternCanvas.scaleY);\n        return ctx.createPattern(temporaryPatternCanvas.canvas, \"no-repeat\");\n      }\n    }\n    class DummyShadingPattern extends BaseShadingPattern {\n      getPattern() {\n        return \"hotpink\";\n      }\n    }\n    function getShadingPattern(IR) {\n      switch (IR[0]) {\n        case \"RadialAxial\":\n          return new RadialAxialShadingPattern(IR);\n        case \"Mesh\":\n          return new MeshShadingPattern(IR);\n        case \"Dummy\":\n          return new DummyShadingPattern();\n      }\n      throw new Error(`Unknown IR type: ${IR[0]}`);\n    }\n    const PaintType = {\n      COLORED: 1,\n      UNCOLORED: 2\n    };\n    class TilingPattern {\n      static MAX_PATTERN_SIZE = 3000;\n      constructor(IR, color, ctx, canvasGraphicsFactory, baseTransform) {\n        this.operatorList = IR[2];\n        this.matrix = IR[3] || [1, 0, 0, 1, 0, 0];\n        this.bbox = IR[4];\n        this.xstep = IR[5];\n        this.ystep = IR[6];\n        this.paintType = IR[7];\n        this.tilingType = IR[8];\n        this.color = color;\n        this.ctx = ctx;\n        this.canvasGraphicsFactory = canvasGraphicsFactory;\n        this.baseTransform = baseTransform;\n      }\n      createPatternCanvas(owner) {\n        const operatorList = this.operatorList;\n        const bbox = this.bbox;\n        const xstep = this.xstep;\n        const ystep = this.ystep;\n        const paintType = this.paintType;\n        const tilingType = this.tilingType;\n        const color = this.color;\n        const canvasGraphicsFactory = this.canvasGraphicsFactory;\n        (0, util.info)(\"TilingType: \" + tilingType);\n        const x0 = bbox[0],\n          y0 = bbox[1],\n          x1 = bbox[2],\n          y1 = bbox[3];\n        const matrixScale = util.Util.singularValueDecompose2dScale(this.matrix);\n        const curMatrixScale = util.Util.singularValueDecompose2dScale(this.baseTransform);\n        const combinedScale = [matrixScale[0] * curMatrixScale[0], matrixScale[1] * curMatrixScale[1]];\n        const dimx = this.getSizeAndScale(xstep, this.ctx.canvas.width, combinedScale[0]);\n        const dimy = this.getSizeAndScale(ystep, this.ctx.canvas.height, combinedScale[1]);\n        const tmpCanvas = owner.cachedCanvases.getCanvas(\"pattern\", dimx.size, dimy.size, true);\n        const tmpCtx = tmpCanvas.context;\n        const graphics = canvasGraphicsFactory.createCanvasGraphics(tmpCtx);\n        graphics.groupLevel = owner.groupLevel;\n        this.setFillAndStrokeStyleToContext(graphics, paintType, color);\n        let adjustedX0 = x0;\n        let adjustedY0 = y0;\n        let adjustedX1 = x1;\n        let adjustedY1 = y1;\n        if (x0 < 0) {\n          adjustedX0 = 0;\n          adjustedX1 += Math.abs(x0);\n        }\n        if (y0 < 0) {\n          adjustedY0 = 0;\n          adjustedY1 += Math.abs(y0);\n        }\n        tmpCtx.translate(-(dimx.scale * adjustedX0), -(dimy.scale * adjustedY0));\n        graphics.transform(dimx.scale, 0, 0, dimy.scale, 0, 0);\n        tmpCtx.save();\n        this.clipBbox(graphics, adjustedX0, adjustedY0, adjustedX1, adjustedY1);\n        graphics.baseTransform = (0, display_utils.getCurrentTransform)(graphics.ctx);\n        graphics.executeOperatorList(operatorList);\n        graphics.endDrawing();\n        return {\n          canvas: tmpCanvas.canvas,\n          scaleX: dimx.scale,\n          scaleY: dimy.scale,\n          offsetX: adjustedX0,\n          offsetY: adjustedY0\n        };\n      }\n      getSizeAndScale(step, realOutputSize, scale) {\n        step = Math.abs(step);\n        const maxSize = Math.max(TilingPattern.MAX_PATTERN_SIZE, realOutputSize);\n        let size = Math.ceil(step * scale);\n        if (size >= maxSize) {\n          size = maxSize;\n        } else {\n          scale = size / step;\n        }\n        return {\n          scale,\n          size\n        };\n      }\n      clipBbox(graphics, x0, y0, x1, y1) {\n        const bboxWidth = x1 - x0;\n        const bboxHeight = y1 - y0;\n        graphics.ctx.rect(x0, y0, bboxWidth, bboxHeight);\n        graphics.current.updateRectMinMax((0, display_utils.getCurrentTransform)(graphics.ctx), [x0, y0, x1, y1]);\n        graphics.clip();\n        graphics.endPath();\n      }\n      setFillAndStrokeStyleToContext(graphics, paintType, color) {\n        const context = graphics.ctx,\n          current = graphics.current;\n        switch (paintType) {\n          case PaintType.COLORED:\n            const ctx = this.ctx;\n            context.fillStyle = ctx.fillStyle;\n            context.strokeStyle = ctx.strokeStyle;\n            current.fillColor = ctx.fillStyle;\n            current.strokeColor = ctx.strokeStyle;\n            break;\n          case PaintType.UNCOLORED:\n            const cssColor = util.Util.makeHexColor(color[0], color[1], color[2]);\n            context.fillStyle = cssColor;\n            context.strokeStyle = cssColor;\n            current.fillColor = cssColor;\n            current.strokeColor = cssColor;\n            break;\n          default:\n            throw new util.FormatError(`Unsupported paint type: ${paintType}`);\n        }\n      }\n      getPattern(ctx, owner, inverse, pathType) {\n        let matrix = inverse;\n        if (pathType !== PathType.SHADING) {\n          matrix = util.Util.transform(matrix, owner.baseTransform);\n          if (this.matrix) {\n            matrix = util.Util.transform(matrix, this.matrix);\n          }\n        }\n        const temporaryPatternCanvas = this.createPatternCanvas(owner);\n        let domMatrix = new DOMMatrix(matrix);\n        domMatrix = domMatrix.translate(temporaryPatternCanvas.offsetX, temporaryPatternCanvas.offsetY);\n        domMatrix = domMatrix.scale(1 / temporaryPatternCanvas.scaleX, 1 / temporaryPatternCanvas.scaleY);\n        const pattern = ctx.createPattern(temporaryPatternCanvas.canvas, \"repeat\");\n        pattern.setTransform(domMatrix);\n        return pattern;\n      }\n    }\n    ; // CONCATENATED MODULE: ./src/shared/image_utils.js\n\n    function convertToRGBA(params) {\n      switch (params.kind) {\n        case ImageKind.GRAYSCALE_1BPP:\n          return convertBlackAndWhiteToRGBA(params);\n        case ImageKind.RGB_24BPP:\n          return convertRGBToRGBA(params);\n      }\n      return null;\n    }\n    function convertBlackAndWhiteToRGBA({\n      src,\n      srcPos = 0,\n      dest,\n      width,\n      height,\n      nonBlackColor = 0xffffffff,\n      inverseDecode = false\n    }) {\n      const black = util.FeatureTest.isLittleEndian ? 0xff000000 : 0x000000ff;\n      const [zeroMapping, oneMapping] = inverseDecode ? [nonBlackColor, black] : [black, nonBlackColor];\n      const widthInSource = width >> 3;\n      const widthRemainder = width & 7;\n      const srcLength = src.length;\n      dest = new Uint32Array(dest.buffer);\n      let destPos = 0;\n      for (let i = 0; i < height; i++) {\n        for (const max = srcPos + widthInSource; srcPos < max; srcPos++) {\n          const elem = srcPos < srcLength ? src[srcPos] : 255;\n          dest[destPos++] = elem & 0b10000000 ? oneMapping : zeroMapping;\n          dest[destPos++] = elem & 0b1000000 ? oneMapping : zeroMapping;\n          dest[destPos++] = elem & 0b100000 ? oneMapping : zeroMapping;\n          dest[destPos++] = elem & 0b10000 ? oneMapping : zeroMapping;\n          dest[destPos++] = elem & 0b1000 ? oneMapping : zeroMapping;\n          dest[destPos++] = elem & 0b100 ? oneMapping : zeroMapping;\n          dest[destPos++] = elem & 0b10 ? oneMapping : zeroMapping;\n          dest[destPos++] = elem & 0b1 ? oneMapping : zeroMapping;\n        }\n        if (widthRemainder === 0) {\n          continue;\n        }\n        const elem = srcPos < srcLength ? src[srcPos++] : 255;\n        for (let j = 0; j < widthRemainder; j++) {\n          dest[destPos++] = elem & 1 << 7 - j ? oneMapping : zeroMapping;\n        }\n      }\n      return {\n        srcPos,\n        destPos\n      };\n    }\n    function convertRGBToRGBA({\n      src,\n      srcPos = 0,\n      dest,\n      destPos = 0,\n      width,\n      height\n    }) {\n      let i = 0;\n      const len32 = src.length >> 2;\n      const src32 = new Uint32Array(src.buffer, srcPos, len32);\n      if (FeatureTest.isLittleEndian) {\n        for (; i < len32 - 2; i += 3, destPos += 4) {\n          const s1 = src32[i];\n          const s2 = src32[i + 1];\n          const s3 = src32[i + 2];\n          dest[destPos] = s1 | 0xff000000;\n          dest[destPos + 1] = s1 >>> 24 | s2 << 8 | 0xff000000;\n          dest[destPos + 2] = s2 >>> 16 | s3 << 16 | 0xff000000;\n          dest[destPos + 3] = s3 >>> 8 | 0xff000000;\n        }\n        for (let j = i * 4, jj = src.length; j < jj; j += 3) {\n          dest[destPos++] = src[j] | src[j + 1] << 8 | src[j + 2] << 16 | 0xff000000;\n        }\n      } else {\n        for (; i < len32 - 2; i += 3, destPos += 4) {\n          const s1 = src32[i];\n          const s2 = src32[i + 1];\n          const s3 = src32[i + 2];\n          dest[destPos] = s1 | 0xff;\n          dest[destPos + 1] = s1 << 24 | s2 >>> 8 | 0xff;\n          dest[destPos + 2] = s2 << 16 | s3 >>> 16 | 0xff;\n          dest[destPos + 3] = s3 << 8 | 0xff;\n        }\n        for (let j = i * 4, jj = src.length; j < jj; j += 3) {\n          dest[destPos++] = src[j] << 24 | src[j + 1] << 16 | src[j + 2] << 8 | 0xff;\n        }\n      }\n      return {\n        srcPos,\n        destPos\n      };\n    }\n    function grayToRGBA(src, dest) {\n      if (FeatureTest.isLittleEndian) {\n        for (let i = 0, ii = src.length; i < ii; i++) {\n          dest[i] = src[i] * 0x10101 | 0xff000000;\n        }\n      } else {\n        for (let i = 0, ii = src.length; i < ii; i++) {\n          dest[i] = src[i] * 0x1010100 | 0x000000ff;\n        }\n      }\n    }\n    ; // CONCATENATED MODULE: ./src/display/canvas.js\n\n    const MIN_FONT_SIZE = 16;\n    const MAX_FONT_SIZE = 100;\n    const MAX_GROUP_SIZE = 4096;\n    const EXECUTION_TIME = 15;\n    const EXECUTION_STEPS = 10;\n    const MAX_SIZE_TO_COMPILE = 1000;\n    const FULL_CHUNK_HEIGHT = 16;\n    function mirrorContextOperations(ctx, destCtx) {\n      if (ctx._removeMirroring) {\n        throw new Error(\"Context is already forwarding operations.\");\n      }\n      ctx.__originalSave = ctx.save;\n      ctx.__originalRestore = ctx.restore;\n      ctx.__originalRotate = ctx.rotate;\n      ctx.__originalScale = ctx.scale;\n      ctx.__originalTranslate = ctx.translate;\n      ctx.__originalTransform = ctx.transform;\n      ctx.__originalSetTransform = ctx.setTransform;\n      ctx.__originalResetTransform = ctx.resetTransform;\n      ctx.__originalClip = ctx.clip;\n      ctx.__originalMoveTo = ctx.moveTo;\n      ctx.__originalLineTo = ctx.lineTo;\n      ctx.__originalBezierCurveTo = ctx.bezierCurveTo;\n      ctx.__originalRect = ctx.rect;\n      ctx.__originalClosePath = ctx.closePath;\n      ctx.__originalBeginPath = ctx.beginPath;\n      ctx._removeMirroring = () => {\n        ctx.save = ctx.__originalSave;\n        ctx.restore = ctx.__originalRestore;\n        ctx.rotate = ctx.__originalRotate;\n        ctx.scale = ctx.__originalScale;\n        ctx.translate = ctx.__originalTranslate;\n        ctx.transform = ctx.__originalTransform;\n        ctx.setTransform = ctx.__originalSetTransform;\n        ctx.resetTransform = ctx.__originalResetTransform;\n        ctx.clip = ctx.__originalClip;\n        ctx.moveTo = ctx.__originalMoveTo;\n        ctx.lineTo = ctx.__originalLineTo;\n        ctx.bezierCurveTo = ctx.__originalBezierCurveTo;\n        ctx.rect = ctx.__originalRect;\n        ctx.closePath = ctx.__originalClosePath;\n        ctx.beginPath = ctx.__originalBeginPath;\n        delete ctx._removeMirroring;\n      };\n      ctx.save = function ctxSave() {\n        destCtx.save();\n        this.__originalSave();\n      };\n      ctx.restore = function ctxRestore() {\n        destCtx.restore();\n        this.__originalRestore();\n      };\n      ctx.translate = function ctxTranslate(x, y) {\n        destCtx.translate(x, y);\n        this.__originalTranslate(x, y);\n      };\n      ctx.scale = function ctxScale(x, y) {\n        destCtx.scale(x, y);\n        this.__originalScale(x, y);\n      };\n      ctx.transform = function ctxTransform(a, b, c, d, e, f) {\n        destCtx.transform(a, b, c, d, e, f);\n        this.__originalTransform(a, b, c, d, e, f);\n      };\n      ctx.setTransform = function ctxSetTransform(a, b, c, d, e, f) {\n        destCtx.setTransform(a, b, c, d, e, f);\n        this.__originalSetTransform(a, b, c, d, e, f);\n      };\n      ctx.resetTransform = function ctxResetTransform() {\n        destCtx.resetTransform();\n        this.__originalResetTransform();\n      };\n      ctx.rotate = function ctxRotate(angle) {\n        destCtx.rotate(angle);\n        this.__originalRotate(angle);\n      };\n      ctx.clip = function ctxRotate(rule) {\n        destCtx.clip(rule);\n        this.__originalClip(rule);\n      };\n      ctx.moveTo = function (x, y) {\n        destCtx.moveTo(x, y);\n        this.__originalMoveTo(x, y);\n      };\n      ctx.lineTo = function (x, y) {\n        destCtx.lineTo(x, y);\n        this.__originalLineTo(x, y);\n      };\n      ctx.bezierCurveTo = function (cp1x, cp1y, cp2x, cp2y, x, y) {\n        destCtx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\n        this.__originalBezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\n      };\n      ctx.rect = function (x, y, width, height) {\n        destCtx.rect(x, y, width, height);\n        this.__originalRect(x, y, width, height);\n      };\n      ctx.closePath = function () {\n        destCtx.closePath();\n        this.__originalClosePath();\n      };\n      ctx.beginPath = function () {\n        destCtx.beginPath();\n        this.__originalBeginPath();\n      };\n    }\n    class CachedCanvases {\n      constructor(canvasFactory) {\n        this.canvasFactory = canvasFactory;\n        this.cache = Object.create(null);\n      }\n      getCanvas(id, width, height) {\n        let canvasEntry;\n        if (this.cache[id] !== undefined) {\n          canvasEntry = this.cache[id];\n          this.canvasFactory.reset(canvasEntry, width, height);\n        } else {\n          canvasEntry = this.canvasFactory.create(width, height);\n          this.cache[id] = canvasEntry;\n        }\n        return canvasEntry;\n      }\n      delete(id) {\n        delete this.cache[id];\n      }\n      clear() {\n        for (const id in this.cache) {\n          const canvasEntry = this.cache[id];\n          this.canvasFactory.destroy(canvasEntry);\n          delete this.cache[id];\n        }\n      }\n    }\n    function drawImageAtIntegerCoords(ctx, srcImg, srcX, srcY, srcW, srcH, destX, destY, destW, destH) {\n      const [a, b, c, d, tx, ty] = (0, display_utils.getCurrentTransform)(ctx);\n      if (b === 0 && c === 0) {\n        const tlX = destX * a + tx;\n        const rTlX = Math.round(tlX);\n        const tlY = destY * d + ty;\n        const rTlY = Math.round(tlY);\n        const brX = (destX + destW) * a + tx;\n        const rWidth = Math.abs(Math.round(brX) - rTlX) || 1;\n        const brY = (destY + destH) * d + ty;\n        const rHeight = Math.abs(Math.round(brY) - rTlY) || 1;\n        ctx.setTransform(Math.sign(a), 0, 0, Math.sign(d), rTlX, rTlY);\n        ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, 0, 0, rWidth, rHeight);\n        ctx.setTransform(a, b, c, d, tx, ty);\n        return [rWidth, rHeight];\n      }\n      if (a === 0 && d === 0) {\n        const tlX = destY * c + tx;\n        const rTlX = Math.round(tlX);\n        const tlY = destX * b + ty;\n        const rTlY = Math.round(tlY);\n        const brX = (destY + destH) * c + tx;\n        const rWidth = Math.abs(Math.round(brX) - rTlX) || 1;\n        const brY = (destX + destW) * b + ty;\n        const rHeight = Math.abs(Math.round(brY) - rTlY) || 1;\n        ctx.setTransform(0, Math.sign(b), Math.sign(c), 0, rTlX, rTlY);\n        ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, 0, 0, rHeight, rWidth);\n        ctx.setTransform(a, b, c, d, tx, ty);\n        return [rHeight, rWidth];\n      }\n      ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, destX, destY, destW, destH);\n      const scaleX = Math.hypot(a, b);\n      const scaleY = Math.hypot(c, d);\n      return [scaleX * destW, scaleY * destH];\n    }\n    function compileType3Glyph(imgData) {\n      const {\n        width,\n        height\n      } = imgData;\n      if (width > MAX_SIZE_TO_COMPILE || height > MAX_SIZE_TO_COMPILE) {\n        return null;\n      }\n      const POINT_TO_PROCESS_LIMIT = 1000;\n      const POINT_TYPES = new Uint8Array([0, 2, 4, 0, 1, 0, 5, 4, 8, 10, 0, 8, 0, 2, 1, 0]);\n      const width1 = width + 1;\n      let points = new Uint8Array(width1 * (height + 1));\n      let i, j, j0;\n      const lineSize = width + 7 & ~7;\n      let data = new Uint8Array(lineSize * height),\n        pos = 0;\n      for (const elem of imgData.data) {\n        let mask = 128;\n        while (mask > 0) {\n          data[pos++] = elem & mask ? 0 : 255;\n          mask >>= 1;\n        }\n      }\n      let count = 0;\n      pos = 0;\n      if (data[pos] !== 0) {\n        points[0] = 1;\n        ++count;\n      }\n      for (j = 1; j < width; j++) {\n        if (data[pos] !== data[pos + 1]) {\n          points[j] = data[pos] ? 2 : 1;\n          ++count;\n        }\n        pos++;\n      }\n      if (data[pos] !== 0) {\n        points[j] = 2;\n        ++count;\n      }\n      for (i = 1; i < height; i++) {\n        pos = i * lineSize;\n        j0 = i * width1;\n        if (data[pos - lineSize] !== data[pos]) {\n          points[j0] = data[pos] ? 1 : 8;\n          ++count;\n        }\n        let sum = (data[pos] ? 4 : 0) + (data[pos - lineSize] ? 8 : 0);\n        for (j = 1; j < width; j++) {\n          sum = (sum >> 2) + (data[pos + 1] ? 4 : 0) + (data[pos - lineSize + 1] ? 8 : 0);\n          if (POINT_TYPES[sum]) {\n            points[j0 + j] = POINT_TYPES[sum];\n            ++count;\n          }\n          pos++;\n        }\n        if (data[pos - lineSize] !== data[pos]) {\n          points[j0 + j] = data[pos] ? 2 : 4;\n          ++count;\n        }\n        if (count > POINT_TO_PROCESS_LIMIT) {\n          return null;\n        }\n      }\n      pos = lineSize * (height - 1);\n      j0 = i * width1;\n      if (data[pos] !== 0) {\n        points[j0] = 8;\n        ++count;\n      }\n      for (j = 1; j < width; j++) {\n        if (data[pos] !== data[pos + 1]) {\n          points[j0 + j] = data[pos] ? 4 : 8;\n          ++count;\n        }\n        pos++;\n      }\n      if (data[pos] !== 0) {\n        points[j0 + j] = 4;\n        ++count;\n      }\n      if (count > POINT_TO_PROCESS_LIMIT) {\n        return null;\n      }\n      const steps = new Int32Array([0, width1, -1, 0, -width1, 0, 0, 0, 1]);\n      const path = new Path2D();\n      for (i = 0; count && i <= height; i++) {\n        let p = i * width1;\n        const end = p + width;\n        while (p < end && !points[p]) {\n          p++;\n        }\n        if (p === end) {\n          continue;\n        }\n        path.moveTo(p % width1, i);\n        const p0 = p;\n        let type = points[p];\n        do {\n          const step = steps[type];\n          do {\n            p += step;\n          } while (!points[p]);\n          const pp = points[p];\n          if (pp !== 5 && pp !== 10) {\n            type = pp;\n            points[p] = 0;\n          } else {\n            type = pp & 0x33 * type >> 4;\n            points[p] &= type >> 2 | type << 2;\n          }\n          path.lineTo(p % width1, p / width1 | 0);\n          if (!points[p]) {\n            --count;\n          }\n        } while (p0 !== p);\n        --i;\n      }\n      data = null;\n      points = null;\n      const drawOutline = function (c) {\n        c.save();\n        c.scale(1 / width, -1 / height);\n        c.translate(0, -height);\n        c.fill(path);\n        c.beginPath();\n        c.restore();\n      };\n      return drawOutline;\n    }\n    class CanvasExtraState {\n      constructor(width, height) {\n        this.alphaIsShape = false;\n        this.fontSize = 0;\n        this.fontSizeScale = 1;\n        this.textMatrix = util.IDENTITY_MATRIX;\n        this.textMatrixScale = 1;\n        this.fontMatrix = util.FONT_IDENTITY_MATRIX;\n        this.leading = 0;\n        this.x = 0;\n        this.y = 0;\n        this.lineX = 0;\n        this.lineY = 0;\n        this.charSpacing = 0;\n        this.wordSpacing = 0;\n        this.textHScale = 1;\n        this.textRenderingMode = util.TextRenderingMode.FILL;\n        this.textRise = 0;\n        this.fillColor = \"#000000\";\n        this.strokeColor = \"#000000\";\n        this.patternFill = false;\n        this.fillAlpha = 1;\n        this.strokeAlpha = 1;\n        this.lineWidth = 1;\n        this.activeSMask = null;\n        this.transferMaps = \"none\";\n        this.startNewPathAndClipBox([0, 0, width, height]);\n      }\n      clone() {\n        const clone = Object.create(this);\n        clone.clipBox = this.clipBox.slice();\n        return clone;\n      }\n      setCurrentPoint(x, y) {\n        this.x = x;\n        this.y = y;\n      }\n      updatePathMinMax(transform, x, y) {\n        [x, y] = util.Util.applyTransform([x, y], transform);\n        this.minX = Math.min(this.minX, x);\n        this.minY = Math.min(this.minY, y);\n        this.maxX = Math.max(this.maxX, x);\n        this.maxY = Math.max(this.maxY, y);\n      }\n      updateRectMinMax(transform, rect) {\n        const p1 = util.Util.applyTransform(rect, transform);\n        const p2 = util.Util.applyTransform(rect.slice(2), transform);\n        const p3 = util.Util.applyTransform([rect[0], rect[3]], transform);\n        const p4 = util.Util.applyTransform([rect[2], rect[1]], transform);\n        this.minX = Math.min(this.minX, p1[0], p2[0], p3[0], p4[0]);\n        this.minY = Math.min(this.minY, p1[1], p2[1], p3[1], p4[1]);\n        this.maxX = Math.max(this.maxX, p1[0], p2[0], p3[0], p4[0]);\n        this.maxY = Math.max(this.maxY, p1[1], p2[1], p3[1], p4[1]);\n      }\n      updateScalingPathMinMax(transform, minMax) {\n        util.Util.scaleMinMax(transform, minMax);\n        this.minX = Math.min(this.minX, minMax[0]);\n        this.maxX = Math.max(this.maxX, minMax[1]);\n        this.minY = Math.min(this.minY, minMax[2]);\n        this.maxY = Math.max(this.maxY, minMax[3]);\n      }\n      updateCurvePathMinMax(transform, x0, y0, x1, y1, x2, y2, x3, y3, minMax) {\n        const box = util.Util.bezierBoundingBox(x0, y0, x1, y1, x2, y2, x3, y3);\n        if (minMax) {\n          minMax[0] = Math.min(minMax[0], box[0], box[2]);\n          minMax[1] = Math.max(minMax[1], box[0], box[2]);\n          minMax[2] = Math.min(minMax[2], box[1], box[3]);\n          minMax[3] = Math.max(minMax[3], box[1], box[3]);\n          return;\n        }\n        this.updateRectMinMax(transform, box);\n      }\n      getPathBoundingBox(pathType = PathType.FILL, transform = null) {\n        const box = [this.minX, this.minY, this.maxX, this.maxY];\n        if (pathType === PathType.STROKE) {\n          if (!transform) {\n            (0, util.unreachable)(\"Stroke bounding box must include transform.\");\n          }\n          const scale = util.Util.singularValueDecompose2dScale(transform);\n          const xStrokePad = scale[0] * this.lineWidth / 2;\n          const yStrokePad = scale[1] * this.lineWidth / 2;\n          box[0] -= xStrokePad;\n          box[1] -= yStrokePad;\n          box[2] += xStrokePad;\n          box[3] += yStrokePad;\n        }\n        return box;\n      }\n      updateClipFromPath() {\n        const intersect = util.Util.intersect(this.clipBox, this.getPathBoundingBox());\n        this.startNewPathAndClipBox(intersect || [0, 0, 0, 0]);\n      }\n      isEmptyClip() {\n        return this.minX === Infinity;\n      }\n      startNewPathAndClipBox(box) {\n        this.clipBox = box;\n        this.minX = Infinity;\n        this.minY = Infinity;\n        this.maxX = 0;\n        this.maxY = 0;\n      }\n      getClippedPathBoundingBox(pathType = PathType.FILL, transform = null) {\n        return util.Util.intersect(this.clipBox, this.getPathBoundingBox(pathType, transform));\n      }\n    }\n    function putBinaryImageData(ctx, imgData) {\n      if (typeof ImageData !== \"undefined\" && imgData instanceof ImageData) {\n        ctx.putImageData(imgData, 0, 0);\n        return;\n      }\n      const height = imgData.height,\n        width = imgData.width;\n      const partialChunkHeight = height % FULL_CHUNK_HEIGHT;\n      const fullChunks = (height - partialChunkHeight) / FULL_CHUNK_HEIGHT;\n      const totalChunks = partialChunkHeight === 0 ? fullChunks : fullChunks + 1;\n      const chunkImgData = ctx.createImageData(width, FULL_CHUNK_HEIGHT);\n      let srcPos = 0,\n        destPos;\n      const src = imgData.data;\n      const dest = chunkImgData.data;\n      let i, j, thisChunkHeight, elemsInThisChunk;\n      if (imgData.kind === util.ImageKind.GRAYSCALE_1BPP) {\n        const srcLength = src.byteLength;\n        const dest32 = new Uint32Array(dest.buffer, 0, dest.byteLength >> 2);\n        const dest32DataLength = dest32.length;\n        const fullSrcDiff = width + 7 >> 3;\n        const white = 0xffffffff;\n        const black = util.FeatureTest.isLittleEndian ? 0xff000000 : 0x000000ff;\n        for (i = 0; i < totalChunks; i++) {\n          thisChunkHeight = i < fullChunks ? FULL_CHUNK_HEIGHT : partialChunkHeight;\n          destPos = 0;\n          for (j = 0; j < thisChunkHeight; j++) {\n            const srcDiff = srcLength - srcPos;\n            let k = 0;\n            const kEnd = srcDiff > fullSrcDiff ? width : srcDiff * 8 - 7;\n            const kEndUnrolled = kEnd & ~7;\n            let mask = 0;\n            let srcByte = 0;\n            for (; k < kEndUnrolled; k += 8) {\n              srcByte = src[srcPos++];\n              dest32[destPos++] = srcByte & 128 ? white : black;\n              dest32[destPos++] = srcByte & 64 ? white : black;\n              dest32[destPos++] = srcByte & 32 ? white : black;\n              dest32[destPos++] = srcByte & 16 ? white : black;\n              dest32[destPos++] = srcByte & 8 ? white : black;\n              dest32[destPos++] = srcByte & 4 ? white : black;\n              dest32[destPos++] = srcByte & 2 ? white : black;\n              dest32[destPos++] = srcByte & 1 ? white : black;\n            }\n            for (; k < kEnd; k++) {\n              if (mask === 0) {\n                srcByte = src[srcPos++];\n                mask = 128;\n              }\n              dest32[destPos++] = srcByte & mask ? white : black;\n              mask >>= 1;\n            }\n          }\n          while (destPos < dest32DataLength) {\n            dest32[destPos++] = 0;\n          }\n          ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n        }\n      } else if (imgData.kind === util.ImageKind.RGBA_32BPP) {\n        j = 0;\n        elemsInThisChunk = width * FULL_CHUNK_HEIGHT * 4;\n        for (i = 0; i < fullChunks; i++) {\n          dest.set(src.subarray(srcPos, srcPos + elemsInThisChunk));\n          srcPos += elemsInThisChunk;\n          ctx.putImageData(chunkImgData, 0, j);\n          j += FULL_CHUNK_HEIGHT;\n        }\n        if (i < totalChunks) {\n          elemsInThisChunk = width * partialChunkHeight * 4;\n          dest.set(src.subarray(srcPos, srcPos + elemsInThisChunk));\n          ctx.putImageData(chunkImgData, 0, j);\n        }\n      } else if (imgData.kind === util.ImageKind.RGB_24BPP) {\n        thisChunkHeight = FULL_CHUNK_HEIGHT;\n        elemsInThisChunk = width * thisChunkHeight;\n        for (i = 0; i < totalChunks; i++) {\n          if (i >= fullChunks) {\n            thisChunkHeight = partialChunkHeight;\n            elemsInThisChunk = width * thisChunkHeight;\n          }\n          destPos = 0;\n          for (j = elemsInThisChunk; j--;) {\n            dest[destPos++] = src[srcPos++];\n            dest[destPos++] = src[srcPos++];\n            dest[destPos++] = src[srcPos++];\n            dest[destPos++] = 255;\n          }\n          ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n        }\n      } else {\n        throw new Error(`bad image kind: ${imgData.kind}`);\n      }\n    }\n    function putBinaryImageMask(ctx, imgData) {\n      if (imgData.bitmap) {\n        ctx.drawImage(imgData.bitmap, 0, 0);\n        return;\n      }\n      const height = imgData.height,\n        width = imgData.width;\n      const partialChunkHeight = height % FULL_CHUNK_HEIGHT;\n      const fullChunks = (height - partialChunkHeight) / FULL_CHUNK_HEIGHT;\n      const totalChunks = partialChunkHeight === 0 ? fullChunks : fullChunks + 1;\n      const chunkImgData = ctx.createImageData(width, FULL_CHUNK_HEIGHT);\n      let srcPos = 0;\n      const src = imgData.data;\n      const dest = chunkImgData.data;\n      for (let i = 0; i < totalChunks; i++) {\n        const thisChunkHeight = i < fullChunks ? FULL_CHUNK_HEIGHT : partialChunkHeight;\n        ({\n          srcPos\n        } = convertBlackAndWhiteToRGBA({\n          src,\n          srcPos,\n          dest,\n          width,\n          height: thisChunkHeight,\n          nonBlackColor: 0\n        }));\n        ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n      }\n    }\n    function copyCtxState(sourceCtx, destCtx) {\n      const properties = [\"strokeStyle\", \"fillStyle\", \"fillRule\", \"globalAlpha\", \"lineWidth\", \"lineCap\", \"lineJoin\", \"miterLimit\", \"globalCompositeOperation\", \"font\", \"filter\"];\n      for (const property of properties) {\n        if (sourceCtx[property] !== undefined) {\n          destCtx[property] = sourceCtx[property];\n        }\n      }\n      if (sourceCtx.setLineDash !== undefined) {\n        destCtx.setLineDash(sourceCtx.getLineDash());\n        destCtx.lineDashOffset = sourceCtx.lineDashOffset;\n      }\n    }\n    function resetCtxToDefault(ctx) {\n      ctx.strokeStyle = ctx.fillStyle = \"#000000\";\n      ctx.fillRule = \"nonzero\";\n      ctx.globalAlpha = 1;\n      ctx.lineWidth = 1;\n      ctx.lineCap = \"butt\";\n      ctx.lineJoin = \"miter\";\n      ctx.miterLimit = 10;\n      ctx.globalCompositeOperation = \"source-over\";\n      ctx.font = \"10px sans-serif\";\n      if (ctx.setLineDash !== undefined) {\n        ctx.setLineDash([]);\n        ctx.lineDashOffset = 0;\n      }\n      if (!util.isNodeJS) {\n        const {\n          filter\n        } = ctx;\n        if (filter !== \"none\" && filter !== \"\") {\n          ctx.filter = \"none\";\n        }\n      }\n    }\n    function composeSMaskBackdrop(bytes, r0, g0, b0) {\n      const length = bytes.length;\n      for (let i = 3; i < length; i += 4) {\n        const alpha = bytes[i];\n        if (alpha === 0) {\n          bytes[i - 3] = r0;\n          bytes[i - 2] = g0;\n          bytes[i - 1] = b0;\n        } else if (alpha < 255) {\n          const alpha_ = 255 - alpha;\n          bytes[i - 3] = bytes[i - 3] * alpha + r0 * alpha_ >> 8;\n          bytes[i - 2] = bytes[i - 2] * alpha + g0 * alpha_ >> 8;\n          bytes[i - 1] = bytes[i - 1] * alpha + b0 * alpha_ >> 8;\n        }\n      }\n    }\n    function composeSMaskAlpha(maskData, layerData, transferMap) {\n      const length = maskData.length;\n      const scale = 1 / 255;\n      for (let i = 3; i < length; i += 4) {\n        const alpha = transferMap ? transferMap[maskData[i]] : maskData[i];\n        layerData[i] = layerData[i] * alpha * scale | 0;\n      }\n    }\n    function composeSMaskLuminosity(maskData, layerData, transferMap) {\n      const length = maskData.length;\n      for (let i = 3; i < length; i += 4) {\n        const y = maskData[i - 3] * 77 + maskData[i - 2] * 152 + maskData[i - 1] * 28;\n        layerData[i] = transferMap ? layerData[i] * transferMap[y >> 8] >> 8 : layerData[i] * y >> 16;\n      }\n    }\n    function genericComposeSMask(maskCtx, layerCtx, width, height, subtype, backdrop, transferMap, layerOffsetX, layerOffsetY, maskOffsetX, maskOffsetY) {\n      const hasBackdrop = !!backdrop;\n      const r0 = hasBackdrop ? backdrop[0] : 0;\n      const g0 = hasBackdrop ? backdrop[1] : 0;\n      const b0 = hasBackdrop ? backdrop[2] : 0;\n      const composeFn = subtype === \"Luminosity\" ? composeSMaskLuminosity : composeSMaskAlpha;\n      const PIXELS_TO_PROCESS = 1048576;\n      const chunkSize = Math.min(height, Math.ceil(PIXELS_TO_PROCESS / width));\n      for (let row = 0; row < height; row += chunkSize) {\n        const chunkHeight = Math.min(chunkSize, height - row);\n        const maskData = maskCtx.getImageData(layerOffsetX - maskOffsetX, row + (layerOffsetY - maskOffsetY), width, chunkHeight);\n        const layerData = layerCtx.getImageData(layerOffsetX, row + layerOffsetY, width, chunkHeight);\n        if (hasBackdrop) {\n          composeSMaskBackdrop(maskData.data, r0, g0, b0);\n        }\n        composeFn(maskData.data, layerData.data, transferMap);\n        layerCtx.putImageData(layerData, layerOffsetX, row + layerOffsetY);\n      }\n    }\n    function composeSMask(ctx, smask, layerCtx, layerBox) {\n      const layerOffsetX = layerBox[0];\n      const layerOffsetY = layerBox[1];\n      const layerWidth = layerBox[2] - layerOffsetX;\n      const layerHeight = layerBox[3] - layerOffsetY;\n      if (layerWidth === 0 || layerHeight === 0) {\n        return;\n      }\n      genericComposeSMask(smask.context, layerCtx, layerWidth, layerHeight, smask.subtype, smask.backdrop, smask.transferMap, layerOffsetX, layerOffsetY, smask.offsetX, smask.offsetY);\n      ctx.save();\n      ctx.globalAlpha = 1;\n      ctx.globalCompositeOperation = \"source-over\";\n      ctx.setTransform(1, 0, 0, 1, 0, 0);\n      ctx.drawImage(layerCtx.canvas, 0, 0);\n      ctx.restore();\n    }\n    function getImageSmoothingEnabled(transform, interpolate) {\n      const scale = util.Util.singularValueDecompose2dScale(transform);\n      scale[0] = Math.fround(scale[0]);\n      scale[1] = Math.fround(scale[1]);\n      const actualScale = Math.fround((globalThis.devicePixelRatio || 1) * display_utils.PixelsPerInch.PDF_TO_CSS_UNITS);\n      if (interpolate !== undefined) {\n        return interpolate;\n      } else if (scale[0] <= actualScale || scale[1] <= actualScale) {\n        return true;\n      }\n      return false;\n    }\n    const LINE_CAP_STYLES = [\"butt\", \"round\", \"square\"];\n    const LINE_JOIN_STYLES = [\"miter\", \"round\", \"bevel\"];\n    const NORMAL_CLIP = {};\n    const EO_CLIP = {};\n    class CanvasGraphics {\n      constructor(canvasCtx, commonObjs, objs, canvasFactory, filterFactory, {\n        optionalContentConfig,\n        markedContentStack = null\n      }, annotationCanvasMap, pageColors) {\n        this.ctx = canvasCtx;\n        this.current = new CanvasExtraState(this.ctx.canvas.width, this.ctx.canvas.height);\n        this.stateStack = [];\n        this.pendingClip = null;\n        this.pendingEOFill = false;\n        this.res = null;\n        this.xobjs = null;\n        this.commonObjs = commonObjs;\n        this.objs = objs;\n        this.canvasFactory = canvasFactory;\n        this.filterFactory = filterFactory;\n        this.groupStack = [];\n        this.processingType3 = null;\n        this.baseTransform = null;\n        this.baseTransformStack = [];\n        this.groupLevel = 0;\n        this.smaskStack = [];\n        this.smaskCounter = 0;\n        this.tempSMask = null;\n        this.suspendedCtx = null;\n        this.contentVisible = true;\n        this.markedContentStack = markedContentStack || [];\n        this.optionalContentConfig = optionalContentConfig;\n        this.cachedCanvases = new CachedCanvases(this.canvasFactory);\n        this.cachedPatterns = new Map();\n        this.annotationCanvasMap = annotationCanvasMap;\n        this.viewportScale = 1;\n        this.outputScaleX = 1;\n        this.outputScaleY = 1;\n        this.pageColors = pageColors;\n        this._cachedScaleForStroking = [-1, 0];\n        this._cachedGetSinglePixelWidth = null;\n        this._cachedBitmapsMap = new Map();\n      }\n      getObject(data, fallback = null) {\n        if (typeof data === \"string\") {\n          return data.startsWith(\"g_\") ? this.commonObjs.get(data) : this.objs.get(data);\n        }\n        return fallback;\n      }\n      beginDrawing({\n        transform,\n        viewport,\n        transparency = false,\n        background = null\n      }) {\n        const width = this.ctx.canvas.width;\n        const height = this.ctx.canvas.height;\n        const savedFillStyle = this.ctx.fillStyle;\n        this.ctx.fillStyle = background || \"#ffffff\";\n        this.ctx.fillRect(0, 0, width, height);\n        this.ctx.fillStyle = savedFillStyle;\n        if (transparency) {\n          const transparentCanvas = this.cachedCanvases.getCanvas(\"transparent\", width, height);\n          this.compositeCtx = this.ctx;\n          this.transparentCanvas = transparentCanvas.canvas;\n          this.ctx = transparentCanvas.context;\n          this.ctx.save();\n          this.ctx.transform(...(0, display_utils.getCurrentTransform)(this.compositeCtx));\n        }\n        this.ctx.save();\n        resetCtxToDefault(this.ctx);\n        if (transform) {\n          this.ctx.transform(...transform);\n          this.outputScaleX = transform[0];\n          this.outputScaleY = transform[0];\n        }\n        this.ctx.transform(...viewport.transform);\n        this.viewportScale = viewport.scale;\n        this.baseTransform = (0, display_utils.getCurrentTransform)(this.ctx);\n      }\n      executeOperatorList(operatorList, executionStartIdx, continueCallback, stepper) {\n        const argsArray = operatorList.argsArray;\n        const fnArray = operatorList.fnArray;\n        let i = executionStartIdx || 0;\n        const argsArrayLen = argsArray.length;\n        if (argsArrayLen === i) {\n          return i;\n        }\n        const chunkOperations = argsArrayLen - i > EXECUTION_STEPS && typeof continueCallback === \"function\";\n        const endTime = chunkOperations ? Date.now() + EXECUTION_TIME : 0;\n        let steps = 0;\n        const commonObjs = this.commonObjs;\n        const objs = this.objs;\n        let fnId;\n        while (true) {\n          if (stepper !== undefined && i === stepper.nextBreakPoint) {\n            stepper.breakIt(i, continueCallback);\n            return i;\n          }\n          fnId = fnArray[i];\n          if (fnId !== util.OPS.dependency) {\n            this[fnId].apply(this, argsArray[i]);\n          } else {\n            for (const depObjId of argsArray[i]) {\n              const objsPool = depObjId.startsWith(\"g_\") ? commonObjs : objs;\n              if (!objsPool.has(depObjId)) {\n                objsPool.get(depObjId, continueCallback);\n                return i;\n              }\n            }\n          }\n          i++;\n          if (i === argsArrayLen) {\n            return i;\n          }\n          if (chunkOperations && ++steps > EXECUTION_STEPS) {\n            if (Date.now() > endTime) {\n              continueCallback();\n              return i;\n            }\n            steps = 0;\n          }\n        }\n      }\n      #restoreInitialState() {\n        while (this.stateStack.length || this.inSMaskMode) {\n          this.restore();\n        }\n        this.ctx.restore();\n        if (this.transparentCanvas) {\n          this.ctx = this.compositeCtx;\n          this.ctx.save();\n          this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n          this.ctx.drawImage(this.transparentCanvas, 0, 0);\n          this.ctx.restore();\n          this.transparentCanvas = null;\n        }\n      }\n      endDrawing() {\n        this.#restoreInitialState();\n        this.cachedCanvases.clear();\n        this.cachedPatterns.clear();\n        for (const cache of this._cachedBitmapsMap.values()) {\n          for (const canvas of cache.values()) {\n            if (typeof HTMLCanvasElement !== \"undefined\" && canvas instanceof HTMLCanvasElement) {\n              canvas.width = canvas.height = 0;\n            }\n          }\n          cache.clear();\n        }\n        this._cachedBitmapsMap.clear();\n        this.#drawFilter();\n      }\n      #drawFilter() {\n        if (this.pageColors) {\n          const hcmFilterId = this.filterFactory.addHCMFilter(this.pageColors.foreground, this.pageColors.background);\n          if (hcmFilterId !== \"none\") {\n            const savedFilter = this.ctx.filter;\n            this.ctx.filter = hcmFilterId;\n            this.ctx.drawImage(this.ctx.canvas, 0, 0);\n            this.ctx.filter = savedFilter;\n          }\n        }\n      }\n      _scaleImage(img, inverseTransform) {\n        const width = img.width;\n        const height = img.height;\n        let widthScale = Math.max(Math.hypot(inverseTransform[0], inverseTransform[1]), 1);\n        let heightScale = Math.max(Math.hypot(inverseTransform[2], inverseTransform[3]), 1);\n        let paintWidth = width,\n          paintHeight = height;\n        let tmpCanvasId = \"prescale1\";\n        let tmpCanvas, tmpCtx;\n        while (widthScale > 2 && paintWidth > 1 || heightScale > 2 && paintHeight > 1) {\n          let newWidth = paintWidth,\n            newHeight = paintHeight;\n          if (widthScale > 2 && paintWidth > 1) {\n            newWidth = paintWidth >= 16384 ? Math.floor(paintWidth / 2) - 1 || 1 : Math.ceil(paintWidth / 2);\n            widthScale /= paintWidth / newWidth;\n          }\n          if (heightScale > 2 && paintHeight > 1) {\n            newHeight = paintHeight >= 16384 ? Math.floor(paintHeight / 2) - 1 || 1 : Math.ceil(paintHeight) / 2;\n            heightScale /= paintHeight / newHeight;\n          }\n          tmpCanvas = this.cachedCanvases.getCanvas(tmpCanvasId, newWidth, newHeight);\n          tmpCtx = tmpCanvas.context;\n          tmpCtx.clearRect(0, 0, newWidth, newHeight);\n          tmpCtx.drawImage(img, 0, 0, paintWidth, paintHeight, 0, 0, newWidth, newHeight);\n          img = tmpCanvas.canvas;\n          paintWidth = newWidth;\n          paintHeight = newHeight;\n          tmpCanvasId = tmpCanvasId === \"prescale1\" ? \"prescale2\" : \"prescale1\";\n        }\n        return {\n          img,\n          paintWidth,\n          paintHeight\n        };\n      }\n      _createMaskCanvas(img) {\n        const ctx = this.ctx;\n        const {\n          width,\n          height\n        } = img;\n        const fillColor = this.current.fillColor;\n        const isPatternFill = this.current.patternFill;\n        const currentTransform = (0, display_utils.getCurrentTransform)(ctx);\n        let cache, cacheKey, scaled, maskCanvas;\n        if ((img.bitmap || img.data) && img.count > 1) {\n          const mainKey = img.bitmap || img.data.buffer;\n          cacheKey = JSON.stringify(isPatternFill ? currentTransform : [currentTransform.slice(0, 4), fillColor]);\n          cache = this._cachedBitmapsMap.get(mainKey);\n          if (!cache) {\n            cache = new Map();\n            this._cachedBitmapsMap.set(mainKey, cache);\n          }\n          const cachedImage = cache.get(cacheKey);\n          if (cachedImage && !isPatternFill) {\n            const offsetX = Math.round(Math.min(currentTransform[0], currentTransform[2]) + currentTransform[4]);\n            const offsetY = Math.round(Math.min(currentTransform[1], currentTransform[3]) + currentTransform[5]);\n            return {\n              canvas: cachedImage,\n              offsetX,\n              offsetY\n            };\n          }\n          scaled = cachedImage;\n        }\n        if (!scaled) {\n          maskCanvas = this.cachedCanvases.getCanvas(\"maskCanvas\", width, height);\n          putBinaryImageMask(maskCanvas.context, img);\n        }\n        let maskToCanvas = util.Util.transform(currentTransform, [1 / width, 0, 0, -1 / height, 0, 0]);\n        maskToCanvas = util.Util.transform(maskToCanvas, [1, 0, 0, 1, 0, -height]);\n        const [minX, minY, maxX, maxY] = util.Util.getAxialAlignedBoundingBox([0, 0, width, height], maskToCanvas);\n        const drawnWidth = Math.round(maxX - minX) || 1;\n        const drawnHeight = Math.round(maxY - minY) || 1;\n        const fillCanvas = this.cachedCanvases.getCanvas(\"fillCanvas\", drawnWidth, drawnHeight);\n        const fillCtx = fillCanvas.context;\n        const offsetX = minX;\n        const offsetY = minY;\n        fillCtx.translate(-offsetX, -offsetY);\n        fillCtx.transform(...maskToCanvas);\n        if (!scaled) {\n          scaled = this._scaleImage(maskCanvas.canvas, (0, display_utils.getCurrentTransformInverse)(fillCtx));\n          scaled = scaled.img;\n          if (cache && isPatternFill) {\n            cache.set(cacheKey, scaled);\n          }\n        }\n        fillCtx.imageSmoothingEnabled = getImageSmoothingEnabled((0, display_utils.getCurrentTransform)(fillCtx), img.interpolate);\n        drawImageAtIntegerCoords(fillCtx, scaled, 0, 0, scaled.width, scaled.height, 0, 0, width, height);\n        fillCtx.globalCompositeOperation = \"source-in\";\n        const inverse = util.Util.transform((0, display_utils.getCurrentTransformInverse)(fillCtx), [1, 0, 0, 1, -offsetX, -offsetY]);\n        fillCtx.fillStyle = isPatternFill ? fillColor.getPattern(ctx, this, inverse, PathType.FILL) : fillColor;\n        fillCtx.fillRect(0, 0, width, height);\n        if (cache && !isPatternFill) {\n          this.cachedCanvases.delete(\"fillCanvas\");\n          cache.set(cacheKey, fillCanvas.canvas);\n        }\n        return {\n          canvas: fillCanvas.canvas,\n          offsetX: Math.round(offsetX),\n          offsetY: Math.round(offsetY)\n        };\n      }\n      setLineWidth(width) {\n        if (width !== this.current.lineWidth) {\n          this._cachedScaleForStroking[0] = -1;\n        }\n        this.current.lineWidth = width;\n        this.ctx.lineWidth = width;\n      }\n      setLineCap(style) {\n        this.ctx.lineCap = LINE_CAP_STYLES[style];\n      }\n      setLineJoin(style) {\n        this.ctx.lineJoin = LINE_JOIN_STYLES[style];\n      }\n      setMiterLimit(limit) {\n        this.ctx.miterLimit = limit;\n      }\n      setDash(dashArray, dashPhase) {\n        const ctx = this.ctx;\n        if (ctx.setLineDash !== undefined) {\n          ctx.setLineDash(dashArray);\n          ctx.lineDashOffset = dashPhase;\n        }\n      }\n      setRenderingIntent(intent) {}\n      setFlatness(flatness) {}\n      setGState(states) {\n        for (const [key, value] of states) {\n          switch (key) {\n            case \"LW\":\n              this.setLineWidth(value);\n              break;\n            case \"LC\":\n              this.setLineCap(value);\n              break;\n            case \"LJ\":\n              this.setLineJoin(value);\n              break;\n            case \"ML\":\n              this.setMiterLimit(value);\n              break;\n            case \"D\":\n              this.setDash(value[0], value[1]);\n              break;\n            case \"RI\":\n              this.setRenderingIntent(value);\n              break;\n            case \"FL\":\n              this.setFlatness(value);\n              break;\n            case \"Font\":\n              this.setFont(value[0], value[1]);\n              break;\n            case \"CA\":\n              this.current.strokeAlpha = value;\n              break;\n            case \"ca\":\n              this.current.fillAlpha = value;\n              this.ctx.globalAlpha = value;\n              break;\n            case \"BM\":\n              this.ctx.globalCompositeOperation = value;\n              break;\n            case \"SMask\":\n              this.current.activeSMask = value ? this.tempSMask : null;\n              this.tempSMask = null;\n              this.checkSMaskState();\n              break;\n            case \"TR\":\n              this.ctx.filter = this.current.transferMaps = this.filterFactory.addFilter(value);\n              break;\n          }\n        }\n      }\n      get inSMaskMode() {\n        return !!this.suspendedCtx;\n      }\n      checkSMaskState() {\n        const inSMaskMode = this.inSMaskMode;\n        if (this.current.activeSMask && !inSMaskMode) {\n          this.beginSMaskMode();\n        } else if (!this.current.activeSMask && inSMaskMode) {\n          this.endSMaskMode();\n        }\n      }\n      beginSMaskMode() {\n        if (this.inSMaskMode) {\n          throw new Error(\"beginSMaskMode called while already in smask mode\");\n        }\n        const drawnWidth = this.ctx.canvas.width;\n        const drawnHeight = this.ctx.canvas.height;\n        const cacheId = \"smaskGroupAt\" + this.groupLevel;\n        const scratchCanvas = this.cachedCanvases.getCanvas(cacheId, drawnWidth, drawnHeight);\n        this.suspendedCtx = this.ctx;\n        this.ctx = scratchCanvas.context;\n        const ctx = this.ctx;\n        ctx.setTransform(...(0, display_utils.getCurrentTransform)(this.suspendedCtx));\n        copyCtxState(this.suspendedCtx, ctx);\n        mirrorContextOperations(ctx, this.suspendedCtx);\n        this.setGState([[\"BM\", \"source-over\"], [\"ca\", 1], [\"CA\", 1]]);\n      }\n      endSMaskMode() {\n        if (!this.inSMaskMode) {\n          throw new Error(\"endSMaskMode called while not in smask mode\");\n        }\n        this.ctx._removeMirroring();\n        copyCtxState(this.ctx, this.suspendedCtx);\n        this.ctx = this.suspendedCtx;\n        this.suspendedCtx = null;\n      }\n      compose(dirtyBox) {\n        if (!this.current.activeSMask) {\n          return;\n        }\n        if (!dirtyBox) {\n          dirtyBox = [0, 0, this.ctx.canvas.width, this.ctx.canvas.height];\n        } else {\n          dirtyBox[0] = Math.floor(dirtyBox[0]);\n          dirtyBox[1] = Math.floor(dirtyBox[1]);\n          dirtyBox[2] = Math.ceil(dirtyBox[2]);\n          dirtyBox[3] = Math.ceil(dirtyBox[3]);\n        }\n        const smask = this.current.activeSMask;\n        const suspendedCtx = this.suspendedCtx;\n        composeSMask(suspendedCtx, smask, this.ctx, dirtyBox);\n        this.ctx.save();\n        this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n        this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\n        this.ctx.restore();\n      }\n      save() {\n        if (this.inSMaskMode) {\n          copyCtxState(this.ctx, this.suspendedCtx);\n          this.suspendedCtx.save();\n        } else {\n          this.ctx.save();\n        }\n        const old = this.current;\n        this.stateStack.push(old);\n        this.current = old.clone();\n      }\n      restore() {\n        if (this.stateStack.length === 0 && this.inSMaskMode) {\n          this.endSMaskMode();\n        }\n        if (this.stateStack.length !== 0) {\n          this.current = this.stateStack.pop();\n          if (this.inSMaskMode) {\n            this.suspendedCtx.restore();\n            copyCtxState(this.suspendedCtx, this.ctx);\n          } else {\n            this.ctx.restore();\n          }\n          this.checkSMaskState();\n          this.pendingClip = null;\n          this._cachedScaleForStroking[0] = -1;\n          this._cachedGetSinglePixelWidth = null;\n        }\n      }\n      transform(a, b, c, d, e, f) {\n        this.ctx.transform(a, b, c, d, e, f);\n        this._cachedScaleForStroking[0] = -1;\n        this._cachedGetSinglePixelWidth = null;\n      }\n      constructPath(ops, args, minMax) {\n        const ctx = this.ctx;\n        const current = this.current;\n        let x = current.x,\n          y = current.y;\n        let startX, startY;\n        const currentTransform = (0, display_utils.getCurrentTransform)(ctx);\n        const isScalingMatrix = currentTransform[0] === 0 && currentTransform[3] === 0 || currentTransform[1] === 0 && currentTransform[2] === 0;\n        const minMaxForBezier = isScalingMatrix ? minMax.slice(0) : null;\n        for (let i = 0, j = 0, ii = ops.length; i < ii; i++) {\n          switch (ops[i] | 0) {\n            case util.OPS.rectangle:\n              x = args[j++];\n              y = args[j++];\n              const width = args[j++];\n              const height = args[j++];\n              const xw = x + width;\n              const yh = y + height;\n              ctx.moveTo(x, y);\n              if (width === 0 || height === 0) {\n                ctx.lineTo(xw, yh);\n              } else {\n                ctx.lineTo(xw, y);\n                ctx.lineTo(xw, yh);\n                ctx.lineTo(x, yh);\n              }\n              if (!isScalingMatrix) {\n                current.updateRectMinMax(currentTransform, [x, y, xw, yh]);\n              }\n              ctx.closePath();\n              break;\n            case util.OPS.moveTo:\n              x = args[j++];\n              y = args[j++];\n              ctx.moveTo(x, y);\n              if (!isScalingMatrix) {\n                current.updatePathMinMax(currentTransform, x, y);\n              }\n              break;\n            case util.OPS.lineTo:\n              x = args[j++];\n              y = args[j++];\n              ctx.lineTo(x, y);\n              if (!isScalingMatrix) {\n                current.updatePathMinMax(currentTransform, x, y);\n              }\n              break;\n            case util.OPS.curveTo:\n              startX = x;\n              startY = y;\n              x = args[j + 4];\n              y = args[j + 5];\n              ctx.bezierCurveTo(args[j], args[j + 1], args[j + 2], args[j + 3], x, y);\n              current.updateCurvePathMinMax(currentTransform, startX, startY, args[j], args[j + 1], args[j + 2], args[j + 3], x, y, minMaxForBezier);\n              j += 6;\n              break;\n            case util.OPS.curveTo2:\n              startX = x;\n              startY = y;\n              ctx.bezierCurveTo(x, y, args[j], args[j + 1], args[j + 2], args[j + 3]);\n              current.updateCurvePathMinMax(currentTransform, startX, startY, x, y, args[j], args[j + 1], args[j + 2], args[j + 3], minMaxForBezier);\n              x = args[j + 2];\n              y = args[j + 3];\n              j += 4;\n              break;\n            case util.OPS.curveTo3:\n              startX = x;\n              startY = y;\n              x = args[j + 2];\n              y = args[j + 3];\n              ctx.bezierCurveTo(args[j], args[j + 1], x, y, x, y);\n              current.updateCurvePathMinMax(currentTransform, startX, startY, args[j], args[j + 1], x, y, x, y, minMaxForBezier);\n              j += 4;\n              break;\n            case util.OPS.closePath:\n              ctx.closePath();\n              break;\n          }\n        }\n        if (isScalingMatrix) {\n          current.updateScalingPathMinMax(currentTransform, minMaxForBezier);\n        }\n        current.setCurrentPoint(x, y);\n      }\n      closePath() {\n        this.ctx.closePath();\n      }\n      stroke(consumePath = true) {\n        const ctx = this.ctx;\n        const strokeColor = this.current.strokeColor;\n        ctx.globalAlpha = this.current.strokeAlpha;\n        if (this.contentVisible) {\n          if (typeof strokeColor === \"object\" && strokeColor?.getPattern) {\n            ctx.save();\n            ctx.strokeStyle = strokeColor.getPattern(ctx, this, (0, display_utils.getCurrentTransformInverse)(ctx), PathType.STROKE);\n            this.rescaleAndStroke(false);\n            ctx.restore();\n          } else {\n            this.rescaleAndStroke(true);\n          }\n        }\n        if (consumePath) {\n          this.consumePath(this.current.getClippedPathBoundingBox());\n        }\n        ctx.globalAlpha = this.current.fillAlpha;\n      }\n      closeStroke() {\n        this.closePath();\n        this.stroke();\n      }\n      fill(consumePath = true) {\n        const ctx = this.ctx;\n        const fillColor = this.current.fillColor;\n        const isPatternFill = this.current.patternFill;\n        let needRestore = false;\n        if (isPatternFill) {\n          ctx.save();\n          ctx.fillStyle = fillColor.getPattern(ctx, this, (0, display_utils.getCurrentTransformInverse)(ctx), PathType.FILL);\n          needRestore = true;\n        }\n        const intersect = this.current.getClippedPathBoundingBox();\n        if (this.contentVisible && intersect !== null) {\n          if (this.pendingEOFill) {\n            ctx.fill(\"evenodd\");\n            this.pendingEOFill = false;\n          } else {\n            ctx.fill();\n          }\n        }\n        if (needRestore) {\n          ctx.restore();\n        }\n        if (consumePath) {\n          this.consumePath(intersect);\n        }\n      }\n      eoFill() {\n        this.pendingEOFill = true;\n        this.fill();\n      }\n      fillStroke() {\n        this.fill(false);\n        this.stroke(false);\n        this.consumePath();\n      }\n      eoFillStroke() {\n        this.pendingEOFill = true;\n        this.fillStroke();\n      }\n      closeFillStroke() {\n        this.closePath();\n        this.fillStroke();\n      }\n      closeEOFillStroke() {\n        this.pendingEOFill = true;\n        this.closePath();\n        this.fillStroke();\n      }\n      endPath() {\n        this.consumePath();\n      }\n      clip() {\n        this.pendingClip = NORMAL_CLIP;\n      }\n      eoClip() {\n        this.pendingClip = EO_CLIP;\n      }\n      beginText() {\n        this.current.textMatrix = util.IDENTITY_MATRIX;\n        this.current.textMatrixScale = 1;\n        this.current.x = this.current.lineX = 0;\n        this.current.y = this.current.lineY = 0;\n      }\n      endText() {\n        const paths = this.pendingTextPaths;\n        const ctx = this.ctx;\n        if (paths === undefined) {\n          ctx.beginPath();\n          return;\n        }\n        ctx.save();\n        ctx.beginPath();\n        for (const path of paths) {\n          ctx.setTransform(...path.transform);\n          ctx.translate(path.x, path.y);\n          path.addToPath(ctx, path.fontSize);\n        }\n        ctx.restore();\n        ctx.clip();\n        ctx.beginPath();\n        delete this.pendingTextPaths;\n      }\n      setCharSpacing(spacing) {\n        this.current.charSpacing = spacing;\n      }\n      setWordSpacing(spacing) {\n        this.current.wordSpacing = spacing;\n      }\n      setHScale(scale) {\n        this.current.textHScale = scale / 100;\n      }\n      setLeading(leading) {\n        this.current.leading = -leading;\n      }\n      setFont(fontRefName, size) {\n        const fontObj = this.commonObjs.get(fontRefName);\n        const current = this.current;\n        if (!fontObj) {\n          throw new Error(`Can't find font for ${fontRefName}`);\n        }\n        current.fontMatrix = fontObj.fontMatrix || util.FONT_IDENTITY_MATRIX;\n        if (current.fontMatrix[0] === 0 || current.fontMatrix[3] === 0) {\n          (0, util.warn)(\"Invalid font matrix for font \" + fontRefName);\n        }\n        if (size < 0) {\n          size = -size;\n          current.fontDirection = -1;\n        } else {\n          current.fontDirection = 1;\n        }\n        this.current.font = fontObj;\n        this.current.fontSize = size;\n        if (fontObj.isType3Font) {\n          return;\n        }\n        const name = fontObj.loadedName || \"sans-serif\";\n        const typeface = fontObj.systemFontInfo?.css || `\"${name}\", ${fontObj.fallbackName}`;\n        let bold = \"normal\";\n        if (fontObj.black) {\n          bold = \"900\";\n        } else if (fontObj.bold) {\n          bold = \"bold\";\n        }\n        const italic = fontObj.italic ? \"italic\" : \"normal\";\n        let browserFontSize = size;\n        if (size < MIN_FONT_SIZE) {\n          browserFontSize = MIN_FONT_SIZE;\n        } else if (size > MAX_FONT_SIZE) {\n          browserFontSize = MAX_FONT_SIZE;\n        }\n        this.current.fontSizeScale = size / browserFontSize;\n        this.ctx.font = `${italic} ${bold} ${browserFontSize}px ${typeface}`;\n      }\n      setTextRenderingMode(mode) {\n        this.current.textRenderingMode = mode;\n      }\n      setTextRise(rise) {\n        this.current.textRise = rise;\n      }\n      moveText(x, y) {\n        this.current.x = this.current.lineX += x;\n        this.current.y = this.current.lineY += y;\n      }\n      setLeadingMoveText(x, y) {\n        this.setLeading(-y);\n        this.moveText(x, y);\n      }\n      setTextMatrix(a, b, c, d, e, f) {\n        this.current.textMatrix = [a, b, c, d, e, f];\n        this.current.textMatrixScale = Math.hypot(a, b);\n        this.current.x = this.current.lineX = 0;\n        this.current.y = this.current.lineY = 0;\n      }\n      nextLine() {\n        this.moveText(0, this.current.leading);\n      }\n      paintChar(character, x, y, patternTransform) {\n        const ctx = this.ctx;\n        const current = this.current;\n        const font = current.font;\n        const textRenderingMode = current.textRenderingMode;\n        const fontSize = current.fontSize / current.fontSizeScale;\n        const fillStrokeMode = textRenderingMode & util.TextRenderingMode.FILL_STROKE_MASK;\n        const isAddToPathSet = !!(textRenderingMode & util.TextRenderingMode.ADD_TO_PATH_FLAG);\n        const patternFill = current.patternFill && !font.missingFile;\n        let addToPath;\n        if (font.disableFontFace || isAddToPathSet || patternFill) {\n          addToPath = font.getPathGenerator(this.commonObjs, character);\n        }\n        if (font.disableFontFace || patternFill) {\n          ctx.save();\n          ctx.translate(x, y);\n          ctx.beginPath();\n          addToPath(ctx, fontSize);\n          if (patternTransform) {\n            ctx.setTransform(...patternTransform);\n          }\n          if (fillStrokeMode === util.TextRenderingMode.FILL || fillStrokeMode === util.TextRenderingMode.FILL_STROKE) {\n            ctx.fill();\n          }\n          if (fillStrokeMode === util.TextRenderingMode.STROKE || fillStrokeMode === util.TextRenderingMode.FILL_STROKE) {\n            ctx.stroke();\n          }\n          ctx.restore();\n        } else {\n          if (fillStrokeMode === util.TextRenderingMode.FILL || fillStrokeMode === util.TextRenderingMode.FILL_STROKE) {\n            ctx.fillText(character, x, y);\n          }\n          if (fillStrokeMode === util.TextRenderingMode.STROKE || fillStrokeMode === util.TextRenderingMode.FILL_STROKE) {\n            ctx.strokeText(character, x, y);\n          }\n        }\n        if (isAddToPathSet) {\n          const paths = this.pendingTextPaths ||= [];\n          paths.push({\n            transform: (0, display_utils.getCurrentTransform)(ctx),\n            x,\n            y,\n            fontSize,\n            addToPath\n          });\n        }\n      }\n      get isFontSubpixelAAEnabled() {\n        const {\n          context: ctx\n        } = this.cachedCanvases.getCanvas(\"isFontSubpixelAAEnabled\", 10, 10);\n        ctx.scale(1.5, 1);\n        ctx.fillText(\"I\", 0, 10);\n        const data = ctx.getImageData(0, 0, 10, 10).data;\n        let enabled = false;\n        for (let i = 3; i < data.length; i += 4) {\n          if (data[i] > 0 && data[i] < 255) {\n            enabled = true;\n            break;\n          }\n        }\n        return (0, util.shadow)(this, \"isFontSubpixelAAEnabled\", enabled);\n      }\n      showText(glyphs) {\n        const current = this.current;\n        const font = current.font;\n        if (font.isType3Font) {\n          return this.showType3Text(glyphs);\n        }\n        const fontSize = current.fontSize;\n        if (fontSize === 0) {\n          return undefined;\n        }\n        const ctx = this.ctx;\n        const fontSizeScale = current.fontSizeScale;\n        const charSpacing = current.charSpacing;\n        const wordSpacing = current.wordSpacing;\n        const fontDirection = current.fontDirection;\n        const textHScale = current.textHScale * fontDirection;\n        const glyphsLength = glyphs.length;\n        const vertical = font.vertical;\n        const spacingDir = vertical ? 1 : -1;\n        const defaultVMetrics = font.defaultVMetrics;\n        const widthAdvanceScale = fontSize * current.fontMatrix[0];\n        const simpleFillText = current.textRenderingMode === util.TextRenderingMode.FILL && !font.disableFontFace && !current.patternFill;\n        ctx.save();\n        ctx.transform(...current.textMatrix);\n        ctx.translate(current.x, current.y + current.textRise);\n        if (fontDirection > 0) {\n          ctx.scale(textHScale, -1);\n        } else {\n          ctx.scale(textHScale, 1);\n        }\n        let patternTransform;\n        if (current.patternFill) {\n          ctx.save();\n          const pattern = current.fillColor.getPattern(ctx, this, (0, display_utils.getCurrentTransformInverse)(ctx), PathType.FILL);\n          patternTransform = (0, display_utils.getCurrentTransform)(ctx);\n          ctx.restore();\n          ctx.fillStyle = pattern;\n        }\n        let lineWidth = current.lineWidth;\n        const scale = current.textMatrixScale;\n        if (scale === 0 || lineWidth === 0) {\n          const fillStrokeMode = current.textRenderingMode & util.TextRenderingMode.FILL_STROKE_MASK;\n          if (fillStrokeMode === util.TextRenderingMode.STROKE || fillStrokeMode === util.TextRenderingMode.FILL_STROKE) {\n            lineWidth = this.getSinglePixelWidth();\n          }\n        } else {\n          lineWidth /= scale;\n        }\n        if (fontSizeScale !== 1.0) {\n          ctx.scale(fontSizeScale, fontSizeScale);\n          lineWidth /= fontSizeScale;\n        }\n        ctx.lineWidth = lineWidth;\n        if (font.isInvalidPDFjsFont) {\n          const chars = [];\n          let width = 0;\n          for (const glyph of glyphs) {\n            chars.push(glyph.unicode);\n            width += glyph.width;\n          }\n          ctx.fillText(chars.join(\"\"), 0, 0);\n          current.x += width * widthAdvanceScale * textHScale;\n          ctx.restore();\n          this.compose();\n          return undefined;\n        }\n        let x = 0,\n          i;\n        for (i = 0; i < glyphsLength; ++i) {\n          const glyph = glyphs[i];\n          if (typeof glyph === \"number\") {\n            x += spacingDir * glyph * fontSize / 1000;\n            continue;\n          }\n          let restoreNeeded = false;\n          const spacing = (glyph.isSpace ? wordSpacing : 0) + charSpacing;\n          const character = glyph.fontChar;\n          const accent = glyph.accent;\n          let scaledX, scaledY;\n          let width = glyph.width;\n          if (vertical) {\n            const vmetric = glyph.vmetric || defaultVMetrics;\n            const vx = -(glyph.vmetric ? vmetric[1] : width * 0.5) * widthAdvanceScale;\n            const vy = vmetric[2] * widthAdvanceScale;\n            width = vmetric ? -vmetric[0] : width;\n            scaledX = vx / fontSizeScale;\n            scaledY = (x + vy) / fontSizeScale;\n          } else {\n            scaledX = x / fontSizeScale;\n            scaledY = 0;\n          }\n          if (font.remeasure && width > 0) {\n            const measuredWidth = ctx.measureText(character).width * 1000 / fontSize * fontSizeScale;\n            if (width < measuredWidth && this.isFontSubpixelAAEnabled) {\n              const characterScaleX = width / measuredWidth;\n              restoreNeeded = true;\n              ctx.save();\n              ctx.scale(characterScaleX, 1);\n              scaledX /= characterScaleX;\n            } else if (width !== measuredWidth) {\n              scaledX += (width - measuredWidth) / 2000 * fontSize / fontSizeScale;\n            }\n          }\n          if (this.contentVisible && (glyph.isInFont || font.missingFile)) {\n            if (simpleFillText && !accent) {\n              ctx.fillText(character, scaledX, scaledY);\n            } else {\n              this.paintChar(character, scaledX, scaledY, patternTransform);\n              if (accent) {\n                const scaledAccentX = scaledX + fontSize * accent.offset.x / fontSizeScale;\n                const scaledAccentY = scaledY - fontSize * accent.offset.y / fontSizeScale;\n                this.paintChar(accent.fontChar, scaledAccentX, scaledAccentY, patternTransform);\n              }\n            }\n          }\n          const charWidth = vertical ? width * widthAdvanceScale - spacing * fontDirection : width * widthAdvanceScale + spacing * fontDirection;\n          x += charWidth;\n          if (restoreNeeded) {\n            ctx.restore();\n          }\n        }\n        if (vertical) {\n          current.y -= x;\n        } else {\n          current.x += x * textHScale;\n        }\n        ctx.restore();\n        this.compose();\n        return undefined;\n      }\n      showType3Text(glyphs) {\n        const ctx = this.ctx;\n        const current = this.current;\n        const font = current.font;\n        const fontSize = current.fontSize;\n        const fontDirection = current.fontDirection;\n        const spacingDir = font.vertical ? 1 : -1;\n        const charSpacing = current.charSpacing;\n        const wordSpacing = current.wordSpacing;\n        const textHScale = current.textHScale * fontDirection;\n        const fontMatrix = current.fontMatrix || util.FONT_IDENTITY_MATRIX;\n        const glyphsLength = glyphs.length;\n        const isTextInvisible = current.textRenderingMode === util.TextRenderingMode.INVISIBLE;\n        let i, glyph, width, spacingLength;\n        if (isTextInvisible || fontSize === 0) {\n          return;\n        }\n        this._cachedScaleForStroking[0] = -1;\n        this._cachedGetSinglePixelWidth = null;\n        ctx.save();\n        ctx.transform(...current.textMatrix);\n        ctx.translate(current.x, current.y);\n        ctx.scale(textHScale, fontDirection);\n        for (i = 0; i < glyphsLength; ++i) {\n          glyph = glyphs[i];\n          if (typeof glyph === \"number\") {\n            spacingLength = spacingDir * glyph * fontSize / 1000;\n            this.ctx.translate(spacingLength, 0);\n            current.x += spacingLength * textHScale;\n            continue;\n          }\n          const spacing = (glyph.isSpace ? wordSpacing : 0) + charSpacing;\n          const operatorList = font.charProcOperatorList[glyph.operatorListId];\n          if (!operatorList) {\n            (0, util.warn)(`Type3 character \"${glyph.operatorListId}\" is not available.`);\n            continue;\n          }\n          if (this.contentVisible) {\n            this.processingType3 = glyph;\n            this.save();\n            ctx.scale(fontSize, fontSize);\n            ctx.transform(...fontMatrix);\n            this.executeOperatorList(operatorList);\n            this.restore();\n          }\n          const transformed = util.Util.applyTransform([glyph.width, 0], fontMatrix);\n          width = transformed[0] * fontSize + spacing;\n          ctx.translate(width, 0);\n          current.x += width * textHScale;\n        }\n        ctx.restore();\n        this.processingType3 = null;\n      }\n      setCharWidth(xWidth, yWidth) {}\n      setCharWidthAndBounds(xWidth, yWidth, llx, lly, urx, ury) {\n        this.ctx.rect(llx, lly, urx - llx, ury - lly);\n        this.ctx.clip();\n        this.endPath();\n      }\n      getColorN_Pattern(IR) {\n        let pattern;\n        if (IR[0] === \"TilingPattern\") {\n          const color = IR[1];\n          const baseTransform = this.baseTransform || (0, display_utils.getCurrentTransform)(this.ctx);\n          const canvasGraphicsFactory = {\n            createCanvasGraphics: ctx => {\n              return new CanvasGraphics(ctx, this.commonObjs, this.objs, this.canvasFactory, this.filterFactory, {\n                optionalContentConfig: this.optionalContentConfig,\n                markedContentStack: this.markedContentStack\n              });\n            }\n          };\n          pattern = new TilingPattern(IR, color, this.ctx, canvasGraphicsFactory, baseTransform);\n        } else {\n          pattern = this._getPattern(IR[1], IR[2]);\n        }\n        return pattern;\n      }\n      setStrokeColorN() {\n        this.current.strokeColor = this.getColorN_Pattern(arguments);\n      }\n      setFillColorN() {\n        this.current.fillColor = this.getColorN_Pattern(arguments);\n        this.current.patternFill = true;\n      }\n      setStrokeRGBColor(r, g, b) {\n        const color = util.Util.makeHexColor(r, g, b);\n        this.ctx.strokeStyle = color;\n        this.current.strokeColor = color;\n      }\n      setFillRGBColor(r, g, b) {\n        const color = util.Util.makeHexColor(r, g, b);\n        this.ctx.fillStyle = color;\n        this.current.fillColor = color;\n        this.current.patternFill = false;\n      }\n      _getPattern(objId, matrix = null) {\n        let pattern;\n        if (this.cachedPatterns.has(objId)) {\n          pattern = this.cachedPatterns.get(objId);\n        } else {\n          pattern = getShadingPattern(this.getObject(objId));\n          this.cachedPatterns.set(objId, pattern);\n        }\n        if (matrix) {\n          pattern.matrix = matrix;\n        }\n        return pattern;\n      }\n      shadingFill(objId) {\n        if (!this.contentVisible) {\n          return;\n        }\n        const ctx = this.ctx;\n        this.save();\n        const pattern = this._getPattern(objId);\n        ctx.fillStyle = pattern.getPattern(ctx, this, (0, display_utils.getCurrentTransformInverse)(ctx), PathType.SHADING);\n        const inv = (0, display_utils.getCurrentTransformInverse)(ctx);\n        if (inv) {\n          const {\n            width,\n            height\n          } = ctx.canvas;\n          const [x0, y0, x1, y1] = util.Util.getAxialAlignedBoundingBox([0, 0, width, height], inv);\n          this.ctx.fillRect(x0, y0, x1 - x0, y1 - y0);\n        } else {\n          this.ctx.fillRect(-1e10, -1e10, 2e10, 2e10);\n        }\n        this.compose(this.current.getClippedPathBoundingBox());\n        this.restore();\n      }\n      beginInlineImage() {\n        (0, util.unreachable)(\"Should not call beginInlineImage\");\n      }\n      beginImageData() {\n        (0, util.unreachable)(\"Should not call beginImageData\");\n      }\n      paintFormXObjectBegin(matrix, bbox) {\n        if (!this.contentVisible) {\n          return;\n        }\n        this.save();\n        this.baseTransformStack.push(this.baseTransform);\n        if (Array.isArray(matrix) && matrix.length === 6) {\n          this.transform(...matrix);\n        }\n        this.baseTransform = (0, display_utils.getCurrentTransform)(this.ctx);\n        if (bbox) {\n          const width = bbox[2] - bbox[0];\n          const height = bbox[3] - bbox[1];\n          this.ctx.rect(bbox[0], bbox[1], width, height);\n          this.current.updateRectMinMax((0, display_utils.getCurrentTransform)(this.ctx), bbox);\n          this.clip();\n          this.endPath();\n        }\n      }\n      paintFormXObjectEnd() {\n        if (!this.contentVisible) {\n          return;\n        }\n        this.restore();\n        this.baseTransform = this.baseTransformStack.pop();\n      }\n      beginGroup(group) {\n        if (!this.contentVisible) {\n          return;\n        }\n        this.save();\n        if (this.inSMaskMode) {\n          this.endSMaskMode();\n          this.current.activeSMask = null;\n        }\n        const currentCtx = this.ctx;\n        if (!group.isolated) {\n          (0, util.info)(\"TODO: Support non-isolated groups.\");\n        }\n        if (group.knockout) {\n          (0, util.warn)(\"Knockout groups not supported.\");\n        }\n        const currentTransform = (0, display_utils.getCurrentTransform)(currentCtx);\n        if (group.matrix) {\n          currentCtx.transform(...group.matrix);\n        }\n        if (!group.bbox) {\n          throw new Error(\"Bounding box is required.\");\n        }\n        let bounds = util.Util.getAxialAlignedBoundingBox(group.bbox, (0, display_utils.getCurrentTransform)(currentCtx));\n        const canvasBounds = [0, 0, currentCtx.canvas.width, currentCtx.canvas.height];\n        bounds = util.Util.intersect(bounds, canvasBounds) || [0, 0, 0, 0];\n        const offsetX = Math.floor(bounds[0]);\n        const offsetY = Math.floor(bounds[1]);\n        let drawnWidth = Math.max(Math.ceil(bounds[2]) - offsetX, 1);\n        let drawnHeight = Math.max(Math.ceil(bounds[3]) - offsetY, 1);\n        let scaleX = 1,\n          scaleY = 1;\n        if (drawnWidth > MAX_GROUP_SIZE) {\n          scaleX = drawnWidth / MAX_GROUP_SIZE;\n          drawnWidth = MAX_GROUP_SIZE;\n        }\n        if (drawnHeight > MAX_GROUP_SIZE) {\n          scaleY = drawnHeight / MAX_GROUP_SIZE;\n          drawnHeight = MAX_GROUP_SIZE;\n        }\n        this.current.startNewPathAndClipBox([0, 0, drawnWidth, drawnHeight]);\n        let cacheId = \"groupAt\" + this.groupLevel;\n        if (group.smask) {\n          cacheId += \"_smask_\" + this.smaskCounter++ % 2;\n        }\n        const scratchCanvas = this.cachedCanvases.getCanvas(cacheId, drawnWidth, drawnHeight);\n        const groupCtx = scratchCanvas.context;\n        groupCtx.scale(1 / scaleX, 1 / scaleY);\n        groupCtx.translate(-offsetX, -offsetY);\n        groupCtx.transform(...currentTransform);\n        if (group.smask) {\n          this.smaskStack.push({\n            canvas: scratchCanvas.canvas,\n            context: groupCtx,\n            offsetX,\n            offsetY,\n            scaleX,\n            scaleY,\n            subtype: group.smask.subtype,\n            backdrop: group.smask.backdrop,\n            transferMap: group.smask.transferMap || null,\n            startTransformInverse: null\n          });\n        } else {\n          currentCtx.setTransform(1, 0, 0, 1, 0, 0);\n          currentCtx.translate(offsetX, offsetY);\n          currentCtx.scale(scaleX, scaleY);\n          currentCtx.save();\n        }\n        copyCtxState(currentCtx, groupCtx);\n        this.ctx = groupCtx;\n        this.setGState([[\"BM\", \"source-over\"], [\"ca\", 1], [\"CA\", 1]]);\n        this.groupStack.push(currentCtx);\n        this.groupLevel++;\n      }\n      endGroup(group) {\n        if (!this.contentVisible) {\n          return;\n        }\n        this.groupLevel--;\n        const groupCtx = this.ctx;\n        const ctx = this.groupStack.pop();\n        this.ctx = ctx;\n        this.ctx.imageSmoothingEnabled = false;\n        if (group.smask) {\n          this.tempSMask = this.smaskStack.pop();\n          this.restore();\n        } else {\n          this.ctx.restore();\n          const currentMtx = (0, display_utils.getCurrentTransform)(this.ctx);\n          this.restore();\n          this.ctx.save();\n          this.ctx.setTransform(...currentMtx);\n          const dirtyBox = util.Util.getAxialAlignedBoundingBox([0, 0, groupCtx.canvas.width, groupCtx.canvas.height], currentMtx);\n          this.ctx.drawImage(groupCtx.canvas, 0, 0);\n          this.ctx.restore();\n          this.compose(dirtyBox);\n        }\n      }\n      beginAnnotation(id, rect, transform, matrix, hasOwnCanvas) {\n        this.#restoreInitialState();\n        resetCtxToDefault(this.ctx);\n        this.ctx.save();\n        this.save();\n        if (this.baseTransform) {\n          this.ctx.setTransform(...this.baseTransform);\n        }\n        if (Array.isArray(rect) && rect.length === 4) {\n          const width = rect[2] - rect[0];\n          const height = rect[3] - rect[1];\n          if (hasOwnCanvas && this.annotationCanvasMap) {\n            transform = transform.slice();\n            transform[4] -= rect[0];\n            transform[5] -= rect[1];\n            rect = rect.slice();\n            rect[0] = rect[1] = 0;\n            rect[2] = width;\n            rect[3] = height;\n            const [scaleX, scaleY] = util.Util.singularValueDecompose2dScale((0, display_utils.getCurrentTransform)(this.ctx));\n            const {\n              viewportScale\n            } = this;\n            const canvasWidth = Math.ceil(width * this.outputScaleX * viewportScale);\n            const canvasHeight = Math.ceil(height * this.outputScaleY * viewportScale);\n            this.annotationCanvas = this.canvasFactory.create(canvasWidth, canvasHeight);\n            const {\n              canvas,\n              context\n            } = this.annotationCanvas;\n            this.annotationCanvasMap.set(id, canvas);\n            this.annotationCanvas.savedCtx = this.ctx;\n            this.ctx = context;\n            this.ctx.save();\n            this.ctx.setTransform(scaleX, 0, 0, -scaleY, 0, height * scaleY);\n            resetCtxToDefault(this.ctx);\n          } else {\n            resetCtxToDefault(this.ctx);\n            this.ctx.rect(rect[0], rect[1], width, height);\n            this.ctx.clip();\n            this.endPath();\n          }\n        }\n        this.current = new CanvasExtraState(this.ctx.canvas.width, this.ctx.canvas.height);\n        this.transform(...transform);\n        this.transform(...matrix);\n      }\n      endAnnotation() {\n        if (this.annotationCanvas) {\n          this.ctx.restore();\n          this.#drawFilter();\n          this.ctx = this.annotationCanvas.savedCtx;\n          delete this.annotationCanvas.savedCtx;\n          delete this.annotationCanvas;\n        }\n      }\n      paintImageMaskXObject(img) {\n        if (!this.contentVisible) {\n          return;\n        }\n        const count = img.count;\n        img = this.getObject(img.data, img);\n        img.count = count;\n        const ctx = this.ctx;\n        const glyph = this.processingType3;\n        if (glyph) {\n          if (glyph.compiled === undefined) {\n            glyph.compiled = compileType3Glyph(img);\n          }\n          if (glyph.compiled) {\n            glyph.compiled(ctx);\n            return;\n          }\n        }\n        const mask = this._createMaskCanvas(img);\n        const maskCanvas = mask.canvas;\n        ctx.save();\n        ctx.setTransform(1, 0, 0, 1, 0, 0);\n        ctx.drawImage(maskCanvas, mask.offsetX, mask.offsetY);\n        ctx.restore();\n        this.compose();\n      }\n      paintImageMaskXObjectRepeat(img, scaleX, skewX = 0, skewY = 0, scaleY, positions) {\n        if (!this.contentVisible) {\n          return;\n        }\n        img = this.getObject(img.data, img);\n        const ctx = this.ctx;\n        ctx.save();\n        const currentTransform = (0, display_utils.getCurrentTransform)(ctx);\n        ctx.transform(scaleX, skewX, skewY, scaleY, 0, 0);\n        const mask = this._createMaskCanvas(img);\n        ctx.setTransform(1, 0, 0, 1, mask.offsetX - currentTransform[4], mask.offsetY - currentTransform[5]);\n        for (let i = 0, ii = positions.length; i < ii; i += 2) {\n          const trans = util.Util.transform(currentTransform, [scaleX, skewX, skewY, scaleY, positions[i], positions[i + 1]]);\n          const [x, y] = util.Util.applyTransform([0, 0], trans);\n          ctx.drawImage(mask.canvas, x, y);\n        }\n        ctx.restore();\n        this.compose();\n      }\n      paintImageMaskXObjectGroup(images) {\n        if (!this.contentVisible) {\n          return;\n        }\n        const ctx = this.ctx;\n        const fillColor = this.current.fillColor;\n        const isPatternFill = this.current.patternFill;\n        for (const image of images) {\n          const {\n            data,\n            width,\n            height,\n            transform\n          } = image;\n          const maskCanvas = this.cachedCanvases.getCanvas(\"maskCanvas\", width, height);\n          const maskCtx = maskCanvas.context;\n          maskCtx.save();\n          const img = this.getObject(data, image);\n          putBinaryImageMask(maskCtx, img);\n          maskCtx.globalCompositeOperation = \"source-in\";\n          maskCtx.fillStyle = isPatternFill ? fillColor.getPattern(maskCtx, this, (0, display_utils.getCurrentTransformInverse)(ctx), PathType.FILL) : fillColor;\n          maskCtx.fillRect(0, 0, width, height);\n          maskCtx.restore();\n          ctx.save();\n          ctx.transform(...transform);\n          ctx.scale(1, -1);\n          drawImageAtIntegerCoords(ctx, maskCanvas.canvas, 0, 0, width, height, 0, -1, 1, 1);\n          ctx.restore();\n        }\n        this.compose();\n      }\n      paintImageXObject(objId) {\n        if (!this.contentVisible) {\n          return;\n        }\n        const imgData = this.getObject(objId);\n        if (!imgData) {\n          (0, util.warn)(\"Dependent image isn't ready yet\");\n          return;\n        }\n        this.paintInlineImageXObject(imgData);\n      }\n      paintImageXObjectRepeat(objId, scaleX, scaleY, positions) {\n        if (!this.contentVisible) {\n          return;\n        }\n        const imgData = this.getObject(objId);\n        if (!imgData) {\n          (0, util.warn)(\"Dependent image isn't ready yet\");\n          return;\n        }\n        const width = imgData.width;\n        const height = imgData.height;\n        const map = [];\n        for (let i = 0, ii = positions.length; i < ii; i += 2) {\n          map.push({\n            transform: [scaleX, 0, 0, scaleY, positions[i], positions[i + 1]],\n            x: 0,\n            y: 0,\n            w: width,\n            h: height\n          });\n        }\n        this.paintInlineImageXObjectGroup(imgData, map);\n      }\n      applyTransferMapsToCanvas(ctx) {\n        if (this.current.transferMaps !== \"none\") {\n          ctx.filter = this.current.transferMaps;\n          ctx.drawImage(ctx.canvas, 0, 0);\n          ctx.filter = \"none\";\n        }\n        return ctx.canvas;\n      }\n      applyTransferMapsToBitmap(imgData) {\n        if (this.current.transferMaps === \"none\") {\n          return imgData.bitmap;\n        }\n        const {\n          bitmap,\n          width,\n          height\n        } = imgData;\n        const tmpCanvas = this.cachedCanvases.getCanvas(\"inlineImage\", width, height);\n        const tmpCtx = tmpCanvas.context;\n        tmpCtx.filter = this.current.transferMaps;\n        tmpCtx.drawImage(bitmap, 0, 0);\n        tmpCtx.filter = \"none\";\n        return tmpCanvas.canvas;\n      }\n      paintInlineImageXObject(imgData) {\n        if (!this.contentVisible) {\n          return;\n        }\n        const width = imgData.width;\n        const height = imgData.height;\n        const ctx = this.ctx;\n        this.save();\n        if (!util.isNodeJS) {\n          const {\n            filter\n          } = ctx;\n          if (filter !== \"none\" && filter !== \"\") {\n            ctx.filter = \"none\";\n          }\n        }\n        ctx.scale(1 / width, -1 / height);\n        let imgToPaint;\n        if (imgData.bitmap) {\n          imgToPaint = this.applyTransferMapsToBitmap(imgData);\n        } else if (typeof HTMLElement === \"function\" && imgData instanceof HTMLElement || !imgData.data) {\n          imgToPaint = imgData;\n        } else {\n          const tmpCanvas = this.cachedCanvases.getCanvas(\"inlineImage\", width, height);\n          const tmpCtx = tmpCanvas.context;\n          putBinaryImageData(tmpCtx, imgData);\n          imgToPaint = this.applyTransferMapsToCanvas(tmpCtx);\n        }\n        const scaled = this._scaleImage(imgToPaint, (0, display_utils.getCurrentTransformInverse)(ctx));\n        ctx.imageSmoothingEnabled = getImageSmoothingEnabled((0, display_utils.getCurrentTransform)(ctx), imgData.interpolate);\n        drawImageAtIntegerCoords(ctx, scaled.img, 0, 0, scaled.paintWidth, scaled.paintHeight, 0, -height, width, height);\n        this.compose();\n        this.restore();\n      }\n      paintInlineImageXObjectGroup(imgData, map) {\n        if (!this.contentVisible) {\n          return;\n        }\n        const ctx = this.ctx;\n        let imgToPaint;\n        if (imgData.bitmap) {\n          imgToPaint = imgData.bitmap;\n        } else {\n          const w = imgData.width;\n          const h = imgData.height;\n          const tmpCanvas = this.cachedCanvases.getCanvas(\"inlineImage\", w, h);\n          const tmpCtx = tmpCanvas.context;\n          putBinaryImageData(tmpCtx, imgData);\n          imgToPaint = this.applyTransferMapsToCanvas(tmpCtx);\n        }\n        for (const entry of map) {\n          ctx.save();\n          ctx.transform(...entry.transform);\n          ctx.scale(1, -1);\n          drawImageAtIntegerCoords(ctx, imgToPaint, entry.x, entry.y, entry.w, entry.h, 0, -1, 1, 1);\n          ctx.restore();\n        }\n        this.compose();\n      }\n      paintSolidColorImageMask() {\n        if (!this.contentVisible) {\n          return;\n        }\n        this.ctx.fillRect(0, 0, 1, 1);\n        this.compose();\n      }\n      markPoint(tag) {}\n      markPointProps(tag, properties) {}\n      beginMarkedContent(tag) {\n        this.markedContentStack.push({\n          visible: true\n        });\n      }\n      beginMarkedContentProps(tag, properties) {\n        if (tag === \"OC\") {\n          this.markedContentStack.push({\n            visible: this.optionalContentConfig.isVisible(properties)\n          });\n        } else {\n          this.markedContentStack.push({\n            visible: true\n          });\n        }\n        this.contentVisible = this.isContentVisible();\n      }\n      endMarkedContent() {\n        this.markedContentStack.pop();\n        this.contentVisible = this.isContentVisible();\n      }\n      beginCompat() {}\n      endCompat() {}\n      consumePath(clipBox) {\n        const isEmpty = this.current.isEmptyClip();\n        if (this.pendingClip) {\n          this.current.updateClipFromPath();\n        }\n        if (!this.pendingClip) {\n          this.compose(clipBox);\n        }\n        const ctx = this.ctx;\n        if (this.pendingClip) {\n          if (!isEmpty) {\n            if (this.pendingClip === EO_CLIP) {\n              ctx.clip(\"evenodd\");\n            } else {\n              ctx.clip();\n            }\n          }\n          this.pendingClip = null;\n        }\n        this.current.startNewPathAndClipBox(this.current.clipBox);\n        ctx.beginPath();\n      }\n      getSinglePixelWidth() {\n        if (!this._cachedGetSinglePixelWidth) {\n          const m = (0, display_utils.getCurrentTransform)(this.ctx);\n          if (m[1] === 0 && m[2] === 0) {\n            this._cachedGetSinglePixelWidth = 1 / Math.min(Math.abs(m[0]), Math.abs(m[3]));\n          } else {\n            const absDet = Math.abs(m[0] * m[3] - m[2] * m[1]);\n            const normX = Math.hypot(m[0], m[2]);\n            const normY = Math.hypot(m[1], m[3]);\n            this._cachedGetSinglePixelWidth = Math.max(normX, normY) / absDet;\n          }\n        }\n        return this._cachedGetSinglePixelWidth;\n      }\n      getScaleForStroking() {\n        if (this._cachedScaleForStroking[0] === -1) {\n          const {\n            lineWidth\n          } = this.current;\n          const {\n            a,\n            b,\n            c,\n            d\n          } = this.ctx.getTransform();\n          let scaleX, scaleY;\n          if (b === 0 && c === 0) {\n            const normX = Math.abs(a);\n            const normY = Math.abs(d);\n            if (normX === normY) {\n              if (lineWidth === 0) {\n                scaleX = scaleY = 1 / normX;\n              } else {\n                const scaledLineWidth = normX * lineWidth;\n                scaleX = scaleY = scaledLineWidth < 1 ? 1 / scaledLineWidth : 1;\n              }\n            } else if (lineWidth === 0) {\n              scaleX = 1 / normX;\n              scaleY = 1 / normY;\n            } else {\n              const scaledXLineWidth = normX * lineWidth;\n              const scaledYLineWidth = normY * lineWidth;\n              scaleX = scaledXLineWidth < 1 ? 1 / scaledXLineWidth : 1;\n              scaleY = scaledYLineWidth < 1 ? 1 / scaledYLineWidth : 1;\n            }\n          } else {\n            const absDet = Math.abs(a * d - b * c);\n            const normX = Math.hypot(a, b);\n            const normY = Math.hypot(c, d);\n            if (lineWidth === 0) {\n              scaleX = normY / absDet;\n              scaleY = normX / absDet;\n            } else {\n              const baseArea = lineWidth * absDet;\n              scaleX = normY > baseArea ? normY / baseArea : 1;\n              scaleY = normX > baseArea ? normX / baseArea : 1;\n            }\n          }\n          this._cachedScaleForStroking[0] = scaleX;\n          this._cachedScaleForStroking[1] = scaleY;\n        }\n        return this._cachedScaleForStroking;\n      }\n      rescaleAndStroke(saveRestore) {\n        const {\n          ctx\n        } = this;\n        const {\n          lineWidth\n        } = this.current;\n        const [scaleX, scaleY] = this.getScaleForStroking();\n        ctx.lineWidth = lineWidth || 1;\n        if (scaleX === 1 && scaleY === 1) {\n          ctx.stroke();\n          return;\n        }\n        const dashes = ctx.getLineDash();\n        if (saveRestore) {\n          ctx.save();\n        }\n        ctx.scale(scaleX, scaleY);\n        if (dashes.length > 0) {\n          const scale = Math.max(scaleX, scaleY);\n          ctx.setLineDash(dashes.map(x => x / scale));\n          ctx.lineDashOffset /= scale;\n        }\n        ctx.stroke();\n        if (saveRestore) {\n          ctx.restore();\n        }\n      }\n      isContentVisible() {\n        for (let i = this.markedContentStack.length - 1; i >= 0; i--) {\n          if (!this.markedContentStack[i].visible) {\n            return false;\n          }\n        }\n        return true;\n      }\n    }\n    for (const op in util.OPS) {\n      if (CanvasGraphics.prototype[op] !== undefined) {\n        CanvasGraphics.prototype[util.OPS[op]] = CanvasGraphics.prototype[op];\n      }\n    }\n\n    /***/\n  },\n\n  /***/473: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */DOMCMapReaderFactory: () => /* binding */DOMCMapReaderFactory,\n      /* harmony export */DOMCanvasFactory: () => /* binding */DOMCanvasFactory,\n      /* harmony export */DOMFilterFactory: () => /* binding */DOMFilterFactory,\n      /* harmony export */DOMSVGFactory: () => /* binding */DOMSVGFactory,\n      /* harmony export */DOMStandardFontDataFactory: () => /* binding */DOMStandardFontDataFactory,\n      /* harmony export */PDFDateString: () => /* binding */PDFDateString,\n      /* harmony export */PageViewport: () => /* binding */PageViewport,\n      /* harmony export */PixelsPerInch: () => /* binding */PixelsPerInch,\n      /* harmony export */RenderingCancelledException: () => /* binding */RenderingCancelledException,\n      /* harmony export */StatTimer: () => /* binding */StatTimer,\n      /* harmony export */fetchData: () => /* binding */fetchData,\n      /* harmony export */getColorValues: () => /* binding */getColorValues,\n      /* harmony export */getCurrentTransform: () => /* binding */getCurrentTransform,\n      /* harmony export */getCurrentTransformInverse: () => /* binding */getCurrentTransformInverse,\n      /* harmony export */getFilenameFromUrl: () => /* binding */getFilenameFromUrl,\n      /* harmony export */getPdfFilenameFromUrl: () => /* binding */getPdfFilenameFromUrl,\n      /* harmony export */getRGB: () => /* binding */getRGB,\n      /* harmony export */getXfaPageViewport: () => /* binding */getXfaPageViewport,\n      /* harmony export */isDataScheme: () => /* binding */isDataScheme,\n      /* harmony export */isPdfFile: () => /* binding */isPdfFile,\n      /* harmony export */isValidFetchUrl: () => /* binding */isValidFetchUrl,\n      /* harmony export */noContextMenu: () => /* binding */noContextMenu,\n      /* harmony export */setLayerDimensions: () => /* binding */setLayerDimensions\n      /* harmony export */\n    });\n    /* unused harmony export deprecated */\n    /* harmony import */\n    var _base_factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(822);\n    /* harmony import */\n    var _shared_util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(266);\n    const SVG_NS = \"http://www.w3.org/2000/svg\";\n    class PixelsPerInch {\n      static CSS = 96.0;\n      static PDF = 72.0;\n      static PDF_TO_CSS_UNITS = this.CSS / this.PDF;\n    }\n    class DOMFilterFactory extends _base_factory_js__WEBPACK_IMPORTED_MODULE_0__.BaseFilterFactory {\n      #_cache;\n      #_defs;\n      #docId;\n      #document;\n      #hcmFilter;\n      #hcmKey;\n      #hcmUrl;\n      #hcmHighlightFilter;\n      #hcmHighlightKey;\n      #hcmHighlightUrl;\n      #id = 0;\n      constructor({\n        docId,\n        ownerDocument = globalThis.document\n      } = {}) {\n        super();\n        this.#docId = docId;\n        this.#document = ownerDocument;\n      }\n      get #cache() {\n        return this.#_cache ||= new Map();\n      }\n      get #defs() {\n        if (!this.#_defs) {\n          const div = this.#document.createElement(\"div\");\n          const {\n            style\n          } = div;\n          style.visibility = \"hidden\";\n          style.contain = \"strict\";\n          style.width = style.height = 0;\n          style.position = \"absolute\";\n          style.top = style.left = 0;\n          style.zIndex = -1;\n          const svg = this.#document.createElementNS(SVG_NS, \"svg\");\n          svg.setAttribute(\"width\", 0);\n          svg.setAttribute(\"height\", 0);\n          this.#_defs = this.#document.createElementNS(SVG_NS, \"defs\");\n          div.append(svg);\n          svg.append(this.#_defs);\n          this.#document.body.append(div);\n        }\n        return this.#_defs;\n      }\n      addFilter(maps) {\n        if (!maps) {\n          return \"none\";\n        }\n        let value = this.#cache.get(maps);\n        if (value) {\n          return value;\n        }\n        let tableR, tableG, tableB, key;\n        if (maps.length === 1) {\n          const mapR = maps[0];\n          const buffer = new Array(256);\n          for (let i = 0; i < 256; i++) {\n            buffer[i] = mapR[i] / 255;\n          }\n          key = tableR = tableG = tableB = buffer.join(\",\");\n        } else {\n          const [mapR, mapG, mapB] = maps;\n          const bufferR = new Array(256);\n          const bufferG = new Array(256);\n          const bufferB = new Array(256);\n          for (let i = 0; i < 256; i++) {\n            bufferR[i] = mapR[i] / 255;\n            bufferG[i] = mapG[i] / 255;\n            bufferB[i] = mapB[i] / 255;\n          }\n          tableR = bufferR.join(\",\");\n          tableG = bufferG.join(\",\");\n          tableB = bufferB.join(\",\");\n          key = `${tableR}${tableG}${tableB}`;\n        }\n        value = this.#cache.get(key);\n        if (value) {\n          this.#cache.set(maps, value);\n          return value;\n        }\n        const id = `g_${this.#docId}_transfer_map_${this.#id++}`;\n        const url = `url(#${id})`;\n        this.#cache.set(maps, url);\n        this.#cache.set(key, url);\n        const filter = this.#createFilter(id);\n        this.#addTransferMapConversion(tableR, tableG, tableB, filter);\n        return url;\n      }\n      addHCMFilter(fgColor, bgColor) {\n        const key = `${fgColor}-${bgColor}`;\n        if (this.#hcmKey === key) {\n          return this.#hcmUrl;\n        }\n        this.#hcmKey = key;\n        this.#hcmUrl = \"none\";\n        this.#hcmFilter?.remove();\n        if (!fgColor || !bgColor) {\n          return this.#hcmUrl;\n        }\n        const fgRGB = this.#getRGB(fgColor);\n        fgColor = _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.Util.makeHexColor(...fgRGB);\n        const bgRGB = this.#getRGB(bgColor);\n        bgColor = _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.Util.makeHexColor(...bgRGB);\n        this.#defs.style.color = \"\";\n        if (fgColor === \"#000000\" && bgColor === \"#ffffff\" || fgColor === bgColor) {\n          return this.#hcmUrl;\n        }\n        const map = new Array(256);\n        for (let i = 0; i <= 255; i++) {\n          const x = i / 255;\n          map[i] = x <= 0.03928 ? x / 12.92 : ((x + 0.055) / 1.055) ** 2.4;\n        }\n        const table = map.join(\",\");\n        const id = `g_${this.#docId}_hcm_filter`;\n        const filter = this.#hcmHighlightFilter = this.#createFilter(id);\n        this.#addTransferMapConversion(table, table, table, filter);\n        this.#addGrayConversion(filter);\n        const getSteps = (c, n) => {\n          const start = fgRGB[c] / 255;\n          const end = bgRGB[c] / 255;\n          const arr = new Array(n + 1);\n          for (let i = 0; i <= n; i++) {\n            arr[i] = start + i / n * (end - start);\n          }\n          return arr.join(\",\");\n        };\n        this.#addTransferMapConversion(getSteps(0, 5), getSteps(1, 5), getSteps(2, 5), filter);\n        this.#hcmUrl = `url(#${id})`;\n        return this.#hcmUrl;\n      }\n      addHighlightHCMFilter(fgColor, bgColor, newFgColor, newBgColor) {\n        const key = `${fgColor}-${bgColor}-${newFgColor}-${newBgColor}`;\n        if (this.#hcmHighlightKey === key) {\n          return this.#hcmHighlightUrl;\n        }\n        this.#hcmHighlightKey = key;\n        this.#hcmHighlightUrl = \"none\";\n        this.#hcmHighlightFilter?.remove();\n        if (!fgColor || !bgColor) {\n          return this.#hcmHighlightUrl;\n        }\n        const [fgRGB, bgRGB] = [fgColor, bgColor].map(this.#getRGB.bind(this));\n        let fgGray = Math.round(0.2126 * fgRGB[0] + 0.7152 * fgRGB[1] + 0.0722 * fgRGB[2]);\n        let bgGray = Math.round(0.2126 * bgRGB[0] + 0.7152 * bgRGB[1] + 0.0722 * bgRGB[2]);\n        let [newFgRGB, newBgRGB] = [newFgColor, newBgColor].map(this.#getRGB.bind(this));\n        if (bgGray < fgGray) {\n          [fgGray, bgGray, newFgRGB, newBgRGB] = [bgGray, fgGray, newBgRGB, newFgRGB];\n        }\n        this.#defs.style.color = \"\";\n        const getSteps = (fg, bg, n) => {\n          const arr = new Array(256);\n          const step = (bgGray - fgGray) / n;\n          const newStart = fg / 255;\n          const newStep = (bg - fg) / (255 * n);\n          let prev = 0;\n          for (let i = 0; i <= n; i++) {\n            const k = Math.round(fgGray + i * step);\n            const value = newStart + i * newStep;\n            for (let j = prev; j <= k; j++) {\n              arr[j] = value;\n            }\n            prev = k + 1;\n          }\n          for (let i = prev; i < 256; i++) {\n            arr[i] = arr[prev - 1];\n          }\n          return arr.join(\",\");\n        };\n        const id = `g_${this.#docId}_hcm_highlight_filter`;\n        const filter = this.#hcmHighlightFilter = this.#createFilter(id);\n        this.#addGrayConversion(filter);\n        this.#addTransferMapConversion(getSteps(newFgRGB[0], newBgRGB[0], 5), getSteps(newFgRGB[1], newBgRGB[1], 5), getSteps(newFgRGB[2], newBgRGB[2], 5), filter);\n        this.#hcmHighlightUrl = `url(#${id})`;\n        return this.#hcmHighlightUrl;\n      }\n      destroy(keepHCM = false) {\n        if (keepHCM && (this.#hcmUrl || this.#hcmHighlightUrl)) {\n          return;\n        }\n        if (this.#_defs) {\n          this.#_defs.parentNode.parentNode.remove();\n          this.#_defs = null;\n        }\n        if (this.#_cache) {\n          this.#_cache.clear();\n          this.#_cache = null;\n        }\n        this.#id = 0;\n      }\n      #addGrayConversion(filter) {\n        const feColorMatrix = this.#document.createElementNS(SVG_NS, \"feColorMatrix\");\n        feColorMatrix.setAttribute(\"type\", \"matrix\");\n        feColorMatrix.setAttribute(\"values\", \"0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0\");\n        filter.append(feColorMatrix);\n      }\n      #createFilter(id) {\n        const filter = this.#document.createElementNS(SVG_NS, \"filter\");\n        filter.setAttribute(\"color-interpolation-filters\", \"sRGB\");\n        filter.setAttribute(\"id\", id);\n        this.#defs.append(filter);\n        return filter;\n      }\n      #appendFeFunc(feComponentTransfer, func, table) {\n        const feFunc = this.#document.createElementNS(SVG_NS, func);\n        feFunc.setAttribute(\"type\", \"discrete\");\n        feFunc.setAttribute(\"tableValues\", table);\n        feComponentTransfer.append(feFunc);\n      }\n      #addTransferMapConversion(rTable, gTable, bTable, filter) {\n        const feComponentTransfer = this.#document.createElementNS(SVG_NS, \"feComponentTransfer\");\n        filter.append(feComponentTransfer);\n        this.#appendFeFunc(feComponentTransfer, \"feFuncR\", rTable);\n        this.#appendFeFunc(feComponentTransfer, \"feFuncG\", gTable);\n        this.#appendFeFunc(feComponentTransfer, \"feFuncB\", bTable);\n      }\n      #getRGB(color) {\n        this.#defs.style.color = color;\n        return getRGB(getComputedStyle(this.#defs).getPropertyValue(\"color\"));\n      }\n    }\n    class DOMCanvasFactory extends _base_factory_js__WEBPACK_IMPORTED_MODULE_0__.BaseCanvasFactory {\n      constructor({\n        ownerDocument = globalThis.document\n      } = {}) {\n        super();\n        this._document = ownerDocument;\n      }\n      _createCanvas(width, height) {\n        const canvas = this._document.createElement(\"canvas\");\n        canvas.width = width;\n        canvas.height = height;\n        return canvas;\n      }\n    }\n    async function fetchData(url, type = \"text\") {\n      if (isValidFetchUrl(url, document.baseURI)) {\n        const response = await fetch(url);\n        if (!response.ok) {\n          throw new Error(response.statusText);\n        }\n        switch (type) {\n          case \"arraybuffer\":\n            return response.arrayBuffer();\n          case \"blob\":\n            return response.blob();\n          case \"json\":\n            return response.json();\n        }\n        return response.text();\n      }\n      return new Promise((resolve, reject) => {\n        const request = new XMLHttpRequest();\n        request.open(\"GET\", url, true);\n        request.responseType = type;\n        request.onreadystatechange = () => {\n          if (request.readyState !== XMLHttpRequest.DONE) {\n            return;\n          }\n          if (request.status === 200 || request.status === 0) {\n            let data;\n            switch (type) {\n              case \"arraybuffer\":\n              case \"blob\":\n              case \"json\":\n                data = request.response;\n                break;\n              default:\n                data = request.responseText;\n                break;\n            }\n            if (data) {\n              resolve(data);\n              return;\n            }\n          }\n          reject(new Error(request.statusText));\n        };\n        request.send(null);\n      });\n    }\n    class DOMCMapReaderFactory extends _base_factory_js__WEBPACK_IMPORTED_MODULE_0__.BaseCMapReaderFactory {\n      _fetchData(url, compressionType) {\n        return fetchData(url, this.isCompressed ? \"arraybuffer\" : \"text\").then(data => {\n          return {\n            cMapData: data instanceof ArrayBuffer ? new Uint8Array(data) : (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.stringToBytes)(data),\n            compressionType\n          };\n        });\n      }\n    }\n    class DOMStandardFontDataFactory extends _base_factory_js__WEBPACK_IMPORTED_MODULE_0__.BaseStandardFontDataFactory {\n      _fetchData(url) {\n        return fetchData(url, \"arraybuffer\").then(data => {\n          return new Uint8Array(data);\n        });\n      }\n    }\n    class DOMSVGFactory extends _base_factory_js__WEBPACK_IMPORTED_MODULE_0__.BaseSVGFactory {\n      _createSVG(type) {\n        return document.createElementNS(SVG_NS, type);\n      }\n    }\n    class PageViewport {\n      constructor({\n        viewBox,\n        scale,\n        rotation,\n        offsetX = 0,\n        offsetY = 0,\n        dontFlip = false\n      }) {\n        this.viewBox = viewBox;\n        this.scale = scale;\n        this.rotation = rotation;\n        this.offsetX = offsetX;\n        this.offsetY = offsetY;\n        const centerX = (viewBox[2] + viewBox[0]) / 2;\n        const centerY = (viewBox[3] + viewBox[1]) / 2;\n        let rotateA, rotateB, rotateC, rotateD;\n        rotation %= 360;\n        if (rotation < 0) {\n          rotation += 360;\n        }\n        switch (rotation) {\n          case 180:\n            rotateA = -1;\n            rotateB = 0;\n            rotateC = 0;\n            rotateD = 1;\n            break;\n          case 90:\n            rotateA = 0;\n            rotateB = 1;\n            rotateC = 1;\n            rotateD = 0;\n            break;\n          case 270:\n            rotateA = 0;\n            rotateB = -1;\n            rotateC = -1;\n            rotateD = 0;\n            break;\n          case 0:\n            rotateA = 1;\n            rotateB = 0;\n            rotateC = 0;\n            rotateD = -1;\n            break;\n          default:\n            throw new Error(\"PageViewport: Invalid rotation, must be a multiple of 90 degrees.\");\n        }\n        if (dontFlip) {\n          rotateC = -rotateC;\n          rotateD = -rotateD;\n        }\n        let offsetCanvasX, offsetCanvasY;\n        let width, height;\n        if (rotateA === 0) {\n          offsetCanvasX = Math.abs(centerY - viewBox[1]) * scale + offsetX;\n          offsetCanvasY = Math.abs(centerX - viewBox[0]) * scale + offsetY;\n          width = (viewBox[3] - viewBox[1]) * scale;\n          height = (viewBox[2] - viewBox[0]) * scale;\n        } else {\n          offsetCanvasX = Math.abs(centerX - viewBox[0]) * scale + offsetX;\n          offsetCanvasY = Math.abs(centerY - viewBox[1]) * scale + offsetY;\n          width = (viewBox[2] - viewBox[0]) * scale;\n          height = (viewBox[3] - viewBox[1]) * scale;\n        }\n        this.transform = [rotateA * scale, rotateB * scale, rotateC * scale, rotateD * scale, offsetCanvasX - rotateA * scale * centerX - rotateC * scale * centerY, offsetCanvasY - rotateB * scale * centerX - rotateD * scale * centerY];\n        this.width = width;\n        this.height = height;\n      }\n      get rawDims() {\n        const {\n          viewBox\n        } = this;\n        return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.shadow)(this, \"rawDims\", {\n          pageWidth: viewBox[2] - viewBox[0],\n          pageHeight: viewBox[3] - viewBox[1],\n          pageX: viewBox[0],\n          pageY: viewBox[1]\n        });\n      }\n      clone({\n        scale = this.scale,\n        rotation = this.rotation,\n        offsetX = this.offsetX,\n        offsetY = this.offsetY,\n        dontFlip = false\n      } = {}) {\n        return new PageViewport({\n          viewBox: this.viewBox.slice(),\n          scale,\n          rotation,\n          offsetX,\n          offsetY,\n          dontFlip\n        });\n      }\n      convertToViewportPoint(x, y) {\n        return _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.Util.applyTransform([x, y], this.transform);\n      }\n      convertToViewportRectangle(rect) {\n        const topLeft = _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.Util.applyTransform([rect[0], rect[1]], this.transform);\n        const bottomRight = _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.Util.applyTransform([rect[2], rect[3]], this.transform);\n        return [topLeft[0], topLeft[1], bottomRight[0], bottomRight[1]];\n      }\n      convertToPdfPoint(x, y) {\n        return _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.Util.applyInverseTransform([x, y], this.transform);\n      }\n    }\n    class RenderingCancelledException extends _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.BaseException {\n      constructor(msg, extraDelay = 0) {\n        super(msg, \"RenderingCancelledException\");\n        this.extraDelay = extraDelay;\n      }\n    }\n    function isDataScheme(url) {\n      const ii = url.length;\n      let i = 0;\n      while (i < ii && url[i].trim() === \"\") {\n        i++;\n      }\n      return url.substring(i, i + 5).toLowerCase() === \"data:\";\n    }\n    function isPdfFile(filename) {\n      return typeof filename === \"string\" && /\\.pdf$/i.test(filename);\n    }\n    function getFilenameFromUrl(url, onlyStripPath = false) {\n      if (!onlyStripPath) {\n        [url] = url.split(/[#?]/, 1);\n      }\n      return url.substring(url.lastIndexOf(\"/\") + 1);\n    }\n    function getPdfFilenameFromUrl(url, defaultFilename = \"document.pdf\") {\n      if (typeof url !== \"string\") {\n        return defaultFilename;\n      }\n      if (isDataScheme(url)) {\n        (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.warn)('getPdfFilenameFromUrl: ignore \"data:\"-URL for performance reasons.');\n        return defaultFilename;\n      }\n      const reURI = /^(?:(?:[^:]+:)?\\/\\/[^/]+)?([^?#]*)(\\?[^#]*)?(#.*)?$/;\n      const reFilename = /[^/?#=]+\\.pdf\\b(?!.*\\.pdf\\b)/i;\n      const splitURI = reURI.exec(url);\n      let suggestedFilename = reFilename.exec(splitURI[1]) || reFilename.exec(splitURI[2]) || reFilename.exec(splitURI[3]);\n      if (suggestedFilename) {\n        suggestedFilename = suggestedFilename[0];\n        if (suggestedFilename.includes(\"%\")) {\n          try {\n            suggestedFilename = reFilename.exec(decodeURIComponent(suggestedFilename))[0];\n          } catch {}\n        }\n      }\n      return suggestedFilename || defaultFilename;\n    }\n    class StatTimer {\n      started = Object.create(null);\n      times = [];\n      time(name) {\n        if (name in this.started) {\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.warn)(`Timer is already running for ${name}`);\n        }\n        this.started[name] = Date.now();\n      }\n      timeEnd(name) {\n        if (!(name in this.started)) {\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.warn)(`Timer has not been started for ${name}`);\n        }\n        this.times.push({\n          name,\n          start: this.started[name],\n          end: Date.now()\n        });\n        delete this.started[name];\n      }\n      toString() {\n        const outBuf = [];\n        let longest = 0;\n        for (const {\n          name\n        } of this.times) {\n          longest = Math.max(name.length, longest);\n        }\n        for (const {\n          name,\n          start,\n          end\n        } of this.times) {\n          outBuf.push(`${name.padEnd(longest)} ${end - start}ms\\n`);\n        }\n        return outBuf.join(\"\");\n      }\n    }\n    function isValidFetchUrl(url, baseUrl) {\n      try {\n        const {\n          protocol\n        } = baseUrl ? new URL(url, baseUrl) : new URL(url);\n        return protocol === \"http:\" || protocol === \"https:\";\n      } catch {\n        return false;\n      }\n    }\n    function noContextMenu(e) {\n      e.preventDefault();\n    }\n    function deprecated(details) {\n      console.log(\"Deprecated API usage: \" + details);\n    }\n    let pdfDateStringRegex;\n    class PDFDateString {\n      static toDateObject(input) {\n        if (!input || typeof input !== \"string\") {\n          return null;\n        }\n        pdfDateStringRegex ||= new RegExp(\"^D:\" + \"(\\\\d{4})\" + \"(\\\\d{2})?\" + \"(\\\\d{2})?\" + \"(\\\\d{2})?\" + \"(\\\\d{2})?\" + \"(\\\\d{2})?\" + \"([Z|+|-])?\" + \"(\\\\d{2})?\" + \"'?\" + \"(\\\\d{2})?\" + \"'?\");\n        const matches = pdfDateStringRegex.exec(input);\n        if (!matches) {\n          return null;\n        }\n        const year = parseInt(matches[1], 10);\n        let month = parseInt(matches[2], 10);\n        month = month >= 1 && month <= 12 ? month - 1 : 0;\n        let day = parseInt(matches[3], 10);\n        day = day >= 1 && day <= 31 ? day : 1;\n        let hour = parseInt(matches[4], 10);\n        hour = hour >= 0 && hour <= 23 ? hour : 0;\n        let minute = parseInt(matches[5], 10);\n        minute = minute >= 0 && minute <= 59 ? minute : 0;\n        let second = parseInt(matches[6], 10);\n        second = second >= 0 && second <= 59 ? second : 0;\n        const universalTimeRelation = matches[7] || \"Z\";\n        let offsetHour = parseInt(matches[8], 10);\n        offsetHour = offsetHour >= 0 && offsetHour <= 23 ? offsetHour : 0;\n        let offsetMinute = parseInt(matches[9], 10) || 0;\n        offsetMinute = offsetMinute >= 0 && offsetMinute <= 59 ? offsetMinute : 0;\n        if (universalTimeRelation === \"-\") {\n          hour += offsetHour;\n          minute += offsetMinute;\n        } else if (universalTimeRelation === \"+\") {\n          hour -= offsetHour;\n          minute -= offsetMinute;\n        }\n        return new Date(Date.UTC(year, month, day, hour, minute, second));\n      }\n    }\n    function getXfaPageViewport(xfaPage, {\n      scale = 1,\n      rotation = 0\n    }) {\n      const {\n        width,\n        height\n      } = xfaPage.attributes.style;\n      const viewBox = [0, 0, parseInt(width), parseInt(height)];\n      return new PageViewport({\n        viewBox,\n        scale,\n        rotation\n      });\n    }\n    function getRGB(color) {\n      if (color.startsWith(\"#\")) {\n        const colorRGB = parseInt(color.slice(1), 16);\n        return [(colorRGB & 0xff0000) >> 16, (colorRGB & 0x00ff00) >> 8, colorRGB & 0x0000ff];\n      }\n      if (color.startsWith(\"rgb(\")) {\n        return color.slice(4, -1).split(\",\").map(x => parseInt(x));\n      }\n      if (color.startsWith(\"rgba(\")) {\n        return color.slice(5, -1).split(\",\").map(x => parseInt(x)).slice(0, 3);\n      }\n      (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.warn)(`Not a valid color format: \"${color}\"`);\n      return [0, 0, 0];\n    }\n    function getColorValues(colors) {\n      const span = document.createElement(\"span\");\n      span.style.visibility = \"hidden\";\n      document.body.append(span);\n      for (const name of colors.keys()) {\n        span.style.color = name;\n        const computedColor = window.getComputedStyle(span).color;\n        colors.set(name, getRGB(computedColor));\n      }\n      span.remove();\n    }\n    function getCurrentTransform(ctx) {\n      const {\n        a,\n        b,\n        c,\n        d,\n        e,\n        f\n      } = ctx.getTransform();\n      return [a, b, c, d, e, f];\n    }\n    function getCurrentTransformInverse(ctx) {\n      const {\n        a,\n        b,\n        c,\n        d,\n        e,\n        f\n      } = ctx.getTransform().invertSelf();\n      return [a, b, c, d, e, f];\n    }\n    function setLayerDimensions(div, viewport, mustFlip = false, mustRotate = true) {\n      if (viewport instanceof PageViewport) {\n        const {\n          pageWidth,\n          pageHeight\n        } = viewport.rawDims;\n        const {\n          style\n        } = div;\n        const useRound = _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.FeatureTest.isCSSRoundSupported;\n        const w = `var(--scale-factor) * ${pageWidth}px`,\n          h = `var(--scale-factor) * ${pageHeight}px`;\n        const widthStr = useRound ? `round(${w}, 1px)` : `calc(${w})`,\n          heightStr = useRound ? `round(${h}, 1px)` : `calc(${h})`;\n        if (!mustFlip || viewport.rotation % 180 === 0) {\n          style.width = widthStr;\n          style.height = heightStr;\n        } else {\n          style.width = heightStr;\n          style.height = widthStr;\n        }\n      }\n      if (mustRotate) {\n        div.setAttribute(\"data-main-rotation\", viewport.rotation);\n      }\n    }\n\n    /***/\n  },\n\n  /***/423: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */DrawLayer: () => /* binding */DrawLayer\n      /* harmony export */\n    });\n    /* harmony import */\n    var _display_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(473);\n    /* harmony import */\n    var _shared_util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(266);\n    class DrawLayer {\n      #parent = null;\n      #id = 0;\n      #mapping = new Map();\n      constructor({\n        pageIndex\n      }) {\n        this.pageIndex = pageIndex;\n      }\n      setParent(parent) {\n        if (!this.#parent) {\n          this.#parent = parent;\n          return;\n        }\n        if (this.#parent !== parent) {\n          if (this.#mapping.size > 0) {\n            for (const root of this.#mapping.values()) {\n              root.remove();\n              parent.append(root);\n            }\n          }\n          this.#parent = parent;\n        }\n      }\n      static get _svgFactory() {\n        return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_1__.shadow)(this, \"_svgFactory\", new _display_utils_js__WEBPACK_IMPORTED_MODULE_0__.DOMSVGFactory());\n      }\n      static #setBox(element, {\n        x,\n        y,\n        width,\n        height\n      }) {\n        const {\n          style\n        } = element;\n        style.top = `${100 * y}%`;\n        style.left = `${100 * x}%`;\n        style.width = `${100 * width}%`;\n        style.height = `${100 * height}%`;\n      }\n      #createSVG(box) {\n        const svg = DrawLayer._svgFactory.create(1, 1, true);\n        this.#parent.append(svg);\n        DrawLayer.#setBox(svg, box);\n        return svg;\n      }\n      highlight({\n        outlines,\n        box\n      }, color, opacity) {\n        const id = this.#id++;\n        const root = this.#createSVG(box);\n        root.classList.add(\"highlight\");\n        const defs = DrawLayer._svgFactory.createElement(\"defs\");\n        root.append(defs);\n        const path = DrawLayer._svgFactory.createElement(\"path\");\n        defs.append(path);\n        const pathId = `path_p${this.pageIndex}_${id}`;\n        path.setAttribute(\"id\", pathId);\n        path.setAttribute(\"d\", DrawLayer.#extractPathFromHighlightOutlines(outlines));\n        const clipPath = DrawLayer._svgFactory.createElement(\"clipPath\");\n        defs.append(clipPath);\n        const clipPathId = `clip_${pathId}`;\n        clipPath.setAttribute(\"id\", clipPathId);\n        clipPath.setAttribute(\"clipPathUnits\", \"objectBoundingBox\");\n        const clipPathUse = DrawLayer._svgFactory.createElement(\"use\");\n        clipPath.append(clipPathUse);\n        clipPathUse.setAttribute(\"href\", `#${pathId}`);\n        clipPathUse.classList.add(\"clip\");\n        const use = DrawLayer._svgFactory.createElement(\"use\");\n        root.append(use);\n        root.setAttribute(\"fill\", color);\n        root.setAttribute(\"fill-opacity\", opacity);\n        use.setAttribute(\"href\", `#${pathId}`);\n        this.#mapping.set(id, root);\n        return {\n          id,\n          clipPathId: `url(#${clipPathId})`\n        };\n      }\n      highlightOutline({\n        outlines,\n        box\n      }) {\n        const id = this.#id++;\n        const root = this.#createSVG(box);\n        root.classList.add(\"highlightOutline\");\n        const defs = DrawLayer._svgFactory.createElement(\"defs\");\n        root.append(defs);\n        const path = DrawLayer._svgFactory.createElement(\"path\");\n        defs.append(path);\n        const pathId = `path_p${this.pageIndex}_${id}`;\n        path.setAttribute(\"id\", pathId);\n        path.setAttribute(\"d\", DrawLayer.#extractPathFromHighlightOutlines(outlines));\n        path.setAttribute(\"vector-effect\", \"non-scaling-stroke\");\n        const use1 = DrawLayer._svgFactory.createElement(\"use\");\n        root.append(use1);\n        use1.setAttribute(\"href\", `#${pathId}`);\n        const use2 = use1.cloneNode();\n        root.append(use2);\n        use1.classList.add(\"mainOutline\");\n        use2.classList.add(\"secondaryOutline\");\n        this.#mapping.set(id, root);\n        return id;\n      }\n      static #extractPathFromHighlightOutlines(polygons) {\n        const buffer = [];\n        for (const polygon of polygons) {\n          let [prevX, prevY] = polygon;\n          buffer.push(`M${prevX} ${prevY}`);\n          for (let i = 2; i < polygon.length; i += 2) {\n            const x = polygon[i];\n            const y = polygon[i + 1];\n            if (x === prevX) {\n              buffer.push(`V${y}`);\n              prevY = y;\n            } else if (y === prevY) {\n              buffer.push(`H${x}`);\n              prevX = x;\n            }\n          }\n          buffer.push(\"Z\");\n        }\n        return buffer.join(\" \");\n      }\n      updateBox(id, box) {\n        DrawLayer.#setBox(this.#mapping.get(id), box);\n      }\n      rotate(id, angle) {\n        this.#mapping.get(id).setAttribute(\"data-main-rotation\", angle);\n      }\n      changeColor(id, color) {\n        this.#mapping.get(id).setAttribute(\"fill\", color);\n      }\n      changeOpacity(id, opacity) {\n        this.#mapping.get(id).setAttribute(\"fill-opacity\", opacity);\n      }\n      addClass(id, className) {\n        this.#mapping.get(id).classList.add(className);\n      }\n      removeClass(id, className) {\n        this.#mapping.get(id).classList.remove(className);\n      }\n      remove(id) {\n        this.#mapping.get(id).remove();\n        this.#mapping.delete(id);\n      }\n      destroy() {\n        this.#parent = null;\n        for (const root of this.#mapping.values()) {\n          root.remove();\n        }\n        this.#mapping.clear();\n      }\n    }\n\n    /***/\n  },\n\n  /***/331: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    // EXPORTS\n    __webpack_require__.d(__webpack_exports__, {\n      AnnotationEditorLayer: () => /* binding */AnnotationEditorLayer\n    });\n\n    // EXTERNAL MODULE: ./src/shared/util.js\n    var util = __webpack_require__(266);\n    // EXTERNAL MODULE: ./src/display/editor/editor.js + 1 modules\n    var editor_editor = __webpack_require__(796);\n    // EXTERNAL MODULE: ./src/display/editor/tools.js\n    var tools = __webpack_require__(812);\n    // EXTERNAL MODULE: ./src/display/annotation_layer.js + 1 modules\n    var annotation_layer = __webpack_require__(640);\n    ; // CONCATENATED MODULE: ./src/display/editor/freetext.js\n\n    class FreeTextEditor extends editor_editor.AnnotationEditor {\n      #boundEditorDivBlur = this.editorDivBlur.bind(this);\n      #boundEditorDivFocus = this.editorDivFocus.bind(this);\n      #boundEditorDivInput = this.editorDivInput.bind(this);\n      #boundEditorDivKeydown = this.editorDivKeydown.bind(this);\n      #color;\n      #content = \"\";\n      #editorDivId = `${this.id}-editor`;\n      #fontSize;\n      #initialData = null;\n      static _freeTextDefaultContent = \"\";\n      static _internalPadding = 0;\n      static _defaultColor = null;\n      static _defaultFontSize = 10;\n      static get _keyboardManager() {\n        const proto = FreeTextEditor.prototype;\n        const arrowChecker = self => self.isEmpty();\n        const small = tools.AnnotationEditorUIManager.TRANSLATE_SMALL;\n        const big = tools.AnnotationEditorUIManager.TRANSLATE_BIG;\n        return (0, util.shadow)(this, \"_keyboardManager\", new tools.KeyboardManager([[[\"ctrl+s\", \"mac+meta+s\", \"ctrl+p\", \"mac+meta+p\"], proto.commitOrRemove, {\n          bubbles: true\n        }], [[\"ctrl+Enter\", \"mac+meta+Enter\", \"Escape\", \"mac+Escape\"], proto.commitOrRemove], [[\"ArrowLeft\", \"mac+ArrowLeft\"], proto._translateEmpty, {\n          args: [-small, 0],\n          checker: arrowChecker\n        }], [[\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"], proto._translateEmpty, {\n          args: [-big, 0],\n          checker: arrowChecker\n        }], [[\"ArrowRight\", \"mac+ArrowRight\"], proto._translateEmpty, {\n          args: [small, 0],\n          checker: arrowChecker\n        }], [[\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"], proto._translateEmpty, {\n          args: [big, 0],\n          checker: arrowChecker\n        }], [[\"ArrowUp\", \"mac+ArrowUp\"], proto._translateEmpty, {\n          args: [0, -small],\n          checker: arrowChecker\n        }], [[\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"], proto._translateEmpty, {\n          args: [0, -big],\n          checker: arrowChecker\n        }], [[\"ArrowDown\", \"mac+ArrowDown\"], proto._translateEmpty, {\n          args: [0, small],\n          checker: arrowChecker\n        }], [[\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"], proto._translateEmpty, {\n          args: [0, big],\n          checker: arrowChecker\n        }]]));\n      }\n      static _type = \"freetext\";\n      static _editorType = util.AnnotationEditorType.FREETEXT;\n      constructor(params) {\n        super({\n          ...params,\n          name: \"freeTextEditor\"\n        });\n        this.#color = params.color || FreeTextEditor._defaultColor || editor_editor.AnnotationEditor._defaultLineColor;\n        this.#fontSize = params.fontSize || FreeTextEditor._defaultFontSize;\n      }\n      static initialize(l10n) {\n        editor_editor.AnnotationEditor.initialize(l10n, {\n          strings: [\"pdfjs-free-text-default-content\"]\n        });\n        const style = getComputedStyle(document.documentElement);\n        this._internalPadding = parseFloat(style.getPropertyValue(\"--freetext-padding\"));\n      }\n      static updateDefaultParams(type, value) {\n        switch (type) {\n          case util.AnnotationEditorParamsType.FREETEXT_SIZE:\n            FreeTextEditor._defaultFontSize = value;\n            break;\n          case util.AnnotationEditorParamsType.FREETEXT_COLOR:\n            FreeTextEditor._defaultColor = value;\n            break;\n        }\n      }\n      updateParams(type, value) {\n        switch (type) {\n          case util.AnnotationEditorParamsType.FREETEXT_SIZE:\n            this.#updateFontSize(value);\n            break;\n          case util.AnnotationEditorParamsType.FREETEXT_COLOR:\n            this.#updateColor(value);\n            break;\n        }\n      }\n      static get defaultPropertiesToUpdate() {\n        return [[util.AnnotationEditorParamsType.FREETEXT_SIZE, FreeTextEditor._defaultFontSize], [util.AnnotationEditorParamsType.FREETEXT_COLOR, FreeTextEditor._defaultColor || editor_editor.AnnotationEditor._defaultLineColor]];\n      }\n      get propertiesToUpdate() {\n        return [[util.AnnotationEditorParamsType.FREETEXT_SIZE, this.#fontSize], [util.AnnotationEditorParamsType.FREETEXT_COLOR, this.#color]];\n      }\n      #updateFontSize(fontSize) {\n        const setFontsize = size => {\n          this.editorDiv.style.fontSize = `calc(${size}px * var(--scale-factor))`;\n          this.translate(0, -(size - this.#fontSize) * this.parentScale);\n          this.#fontSize = size;\n          this.#setEditorDimensions();\n        };\n        const savedFontsize = this.#fontSize;\n        this.addCommands({\n          cmd: () => {\n            setFontsize(fontSize);\n          },\n          undo: () => {\n            setFontsize(savedFontsize);\n          },\n          mustExec: true,\n          type: util.AnnotationEditorParamsType.FREETEXT_SIZE,\n          overwriteIfSameType: true,\n          keepUndo: true\n        });\n      }\n      #updateColor(color) {\n        const savedColor = this.#color;\n        this.addCommands({\n          cmd: () => {\n            this.#color = this.editorDiv.style.color = color;\n          },\n          undo: () => {\n            this.#color = this.editorDiv.style.color = savedColor;\n          },\n          mustExec: true,\n          type: util.AnnotationEditorParamsType.FREETEXT_COLOR,\n          overwriteIfSameType: true,\n          keepUndo: true\n        });\n      }\n      _translateEmpty(x, y) {\n        this._uiManager.translateSelectedEditors(x, y, true);\n      }\n      getInitialTranslation() {\n        const scale = this.parentScale;\n        return [-FreeTextEditor._internalPadding * scale, -(FreeTextEditor._internalPadding + this.#fontSize) * scale];\n      }\n      rebuild() {\n        if (!this.parent) {\n          return;\n        }\n        super.rebuild();\n        if (this.div === null) {\n          return;\n        }\n        if (!this.isAttachedToDOM) {\n          this.parent.add(this);\n        }\n      }\n      enableEditMode() {\n        if (this.isInEditMode()) {\n          return;\n        }\n        this.parent.setEditingState(false);\n        this.parent.updateToolbar(util.AnnotationEditorType.FREETEXT);\n        super.enableEditMode();\n        this.overlayDiv.classList.remove(\"enabled\");\n        this.editorDiv.contentEditable = true;\n        this._isDraggable = false;\n        this.div.removeAttribute(\"aria-activedescendant\");\n        this.editorDiv.addEventListener(\"keydown\", this.#boundEditorDivKeydown);\n        this.editorDiv.addEventListener(\"focus\", this.#boundEditorDivFocus);\n        this.editorDiv.addEventListener(\"blur\", this.#boundEditorDivBlur);\n        this.editorDiv.addEventListener(\"input\", this.#boundEditorDivInput);\n      }\n      disableEditMode() {\n        if (!this.isInEditMode()) {\n          return;\n        }\n        this.parent.setEditingState(true);\n        super.disableEditMode();\n        this.overlayDiv.classList.add(\"enabled\");\n        this.editorDiv.contentEditable = false;\n        this.div.setAttribute(\"aria-activedescendant\", this.#editorDivId);\n        this._isDraggable = true;\n        this.editorDiv.removeEventListener(\"keydown\", this.#boundEditorDivKeydown);\n        this.editorDiv.removeEventListener(\"focus\", this.#boundEditorDivFocus);\n        this.editorDiv.removeEventListener(\"blur\", this.#boundEditorDivBlur);\n        this.editorDiv.removeEventListener(\"input\", this.#boundEditorDivInput);\n        this.div.focus({\n          preventScroll: true\n        });\n        this.isEditing = false;\n        this.parent.div.classList.add(\"freetextEditing\");\n      }\n      focusin(event) {\n        if (!this._focusEventsAllowed) {\n          return;\n        }\n        super.focusin(event);\n        if (event.target !== this.editorDiv) {\n          this.editorDiv.focus();\n        }\n      }\n      onceAdded() {\n        if (this.width) {\n          this.#cheatInitialRect();\n          return;\n        }\n        this.enableEditMode();\n        this.editorDiv.focus();\n        if (this._initialOptions?.isCentered) {\n          this.center();\n        }\n        this._initialOptions = null;\n      }\n      isEmpty() {\n        return !this.editorDiv || this.editorDiv.innerText.trim() === \"\";\n      }\n      remove() {\n        this.isEditing = false;\n        if (this.parent) {\n          this.parent.setEditingState(true);\n          this.parent.div.classList.add(\"freetextEditing\");\n        }\n        super.remove();\n      }\n      #extractText() {\n        const divs = this.editorDiv.getElementsByTagName(\"div\");\n        if (divs.length === 0) {\n          return this.editorDiv.innerText;\n        }\n        const buffer = [];\n        for (const div of divs) {\n          buffer.push(div.innerText.replace(/\\r\\n?|\\n/, \"\"));\n        }\n        return buffer.join(\"\\n\");\n      }\n      #setEditorDimensions() {\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        let rect;\n        if (this.isAttachedToDOM) {\n          rect = this.div.getBoundingClientRect();\n        } else {\n          const {\n            currentLayer,\n            div\n          } = this;\n          const savedDisplay = div.style.display;\n          div.style.display = \"hidden\";\n          currentLayer.div.append(this.div);\n          rect = div.getBoundingClientRect();\n          div.remove();\n          div.style.display = savedDisplay;\n        }\n        if (this.rotation % 180 === this.parentRotation % 180) {\n          this.width = rect.width / parentWidth;\n          this.height = rect.height / parentHeight;\n        } else {\n          this.width = rect.height / parentWidth;\n          this.height = rect.width / parentHeight;\n        }\n        this.fixAndSetPosition();\n      }\n      commit() {\n        if (!this.isInEditMode()) {\n          return;\n        }\n        super.commit();\n        this.disableEditMode();\n        const savedText = this.#content;\n        const newText = this.#content = this.#extractText().trimEnd();\n        if (savedText === newText) {\n          return;\n        }\n        const setText = text => {\n          this.#content = text;\n          if (!text) {\n            this.remove();\n            return;\n          }\n          this.#setContent();\n          this._uiManager.rebuild(this);\n          this.#setEditorDimensions();\n        };\n        this.addCommands({\n          cmd: () => {\n            setText(newText);\n          },\n          undo: () => {\n            setText(savedText);\n          },\n          mustExec: false\n        });\n        this.#setEditorDimensions();\n      }\n      shouldGetKeyboardEvents() {\n        return this.isInEditMode();\n      }\n      enterInEditMode() {\n        this.enableEditMode();\n        this.editorDiv.focus();\n      }\n      dblclick(event) {\n        this.enterInEditMode();\n      }\n      keydown(event) {\n        if (event.target === this.div && event.key === \"Enter\") {\n          this.enterInEditMode();\n          event.preventDefault();\n        }\n      }\n      editorDivKeydown(event) {\n        FreeTextEditor._keyboardManager.exec(this, event);\n      }\n      editorDivFocus(event) {\n        this.isEditing = true;\n      }\n      editorDivBlur(event) {\n        this.isEditing = false;\n      }\n      editorDivInput(event) {\n        this.parent.div.classList.toggle(\"freetextEditing\", this.isEmpty());\n      }\n      disableEditing() {\n        this.editorDiv.setAttribute(\"role\", \"comment\");\n        this.editorDiv.removeAttribute(\"aria-multiline\");\n      }\n      enableEditing() {\n        this.editorDiv.setAttribute(\"role\", \"textbox\");\n        this.editorDiv.setAttribute(\"aria-multiline\", true);\n      }\n      render() {\n        if (this.div) {\n          return this.div;\n        }\n        let baseX, baseY;\n        if (this.width) {\n          baseX = this.x;\n          baseY = this.y;\n        }\n        super.render();\n        this.editorDiv = document.createElement(\"div\");\n        this.editorDiv.className = \"internal\";\n        this.editorDiv.setAttribute(\"id\", this.#editorDivId);\n        this.editorDiv.setAttribute(\"data-l10n-id\", \"pdfjs-free-text\");\n        this.enableEditing();\n        editor_editor.AnnotationEditor._l10nPromise.get(\"pdfjs-free-text-default-content\").then(msg => this.editorDiv?.setAttribute(\"default-content\", msg));\n        this.editorDiv.contentEditable = true;\n        const {\n          style\n        } = this.editorDiv;\n        style.fontSize = `calc(${this.#fontSize}px * var(--scale-factor))`;\n        style.color = this.#color;\n        this.div.append(this.editorDiv);\n        this.overlayDiv = document.createElement(\"div\");\n        this.overlayDiv.classList.add(\"overlay\", \"enabled\");\n        this.div.append(this.overlayDiv);\n        (0, tools.bindEvents)(this, this.div, [\"dblclick\", \"keydown\"]);\n        if (this.width) {\n          const [parentWidth, parentHeight] = this.parentDimensions;\n          if (this.annotationElementId) {\n            const {\n              position\n            } = this.#initialData;\n            let [tx, ty] = this.getInitialTranslation();\n            [tx, ty] = this.pageTranslationToScreen(tx, ty);\n            const [pageWidth, pageHeight] = this.pageDimensions;\n            const [pageX, pageY] = this.pageTranslation;\n            let posX, posY;\n            switch (this.rotation) {\n              case 0:\n                posX = baseX + (position[0] - pageX) / pageWidth;\n                posY = baseY + this.height - (position[1] - pageY) / pageHeight;\n                break;\n              case 90:\n                posX = baseX + (position[0] - pageX) / pageWidth;\n                posY = baseY - (position[1] - pageY) / pageHeight;\n                [tx, ty] = [ty, -tx];\n                break;\n              case 180:\n                posX = baseX - this.width + (position[0] - pageX) / pageWidth;\n                posY = baseY - (position[1] - pageY) / pageHeight;\n                [tx, ty] = [-tx, -ty];\n                break;\n              case 270:\n                posX = baseX + (position[0] - pageX - this.height * pageHeight) / pageWidth;\n                posY = baseY + (position[1] - pageY - this.width * pageWidth) / pageHeight;\n                [tx, ty] = [-ty, tx];\n                break;\n            }\n            this.setAt(posX * parentWidth, posY * parentHeight, tx, ty);\n          } else {\n            this.setAt(baseX * parentWidth, baseY * parentHeight, this.width * parentWidth, this.height * parentHeight);\n          }\n          this.#setContent();\n          this._isDraggable = true;\n          this.editorDiv.contentEditable = false;\n        } else {\n          this._isDraggable = false;\n          this.editorDiv.contentEditable = true;\n        }\n        return this.div;\n      }\n      #setContent() {\n        this.editorDiv.replaceChildren();\n        if (!this.#content) {\n          return;\n        }\n        for (const line of this.#content.split(\"\\n\")) {\n          const div = document.createElement(\"div\");\n          div.append(line ? document.createTextNode(line) : document.createElement(\"br\"));\n          this.editorDiv.append(div);\n        }\n      }\n      get contentDiv() {\n        return this.editorDiv;\n      }\n      static deserialize(data, parent, uiManager) {\n        let initialData = null;\n        if (data instanceof annotation_layer.FreeTextAnnotationElement) {\n          const {\n            data: {\n              defaultAppearanceData: {\n                fontSize,\n                fontColor\n              },\n              rect,\n              rotation,\n              id\n            },\n            textContent,\n            textPosition,\n            parent: {\n              page: {\n                pageNumber\n              }\n            }\n          } = data;\n          if (!textContent || textContent.length === 0) {\n            return null;\n          }\n          initialData = data = {\n            annotationType: util.AnnotationEditorType.FREETEXT,\n            color: Array.from(fontColor),\n            fontSize,\n            value: textContent.join(\"\\n\"),\n            position: textPosition,\n            pageIndex: pageNumber - 1,\n            rect,\n            rotation,\n            id,\n            deleted: false\n          };\n        }\n        const editor = super.deserialize(data, parent, uiManager);\n        editor.#fontSize = data.fontSize;\n        editor.#color = util.Util.makeHexColor(...data.color);\n        editor.#content = data.value;\n        editor.annotationElementId = data.id || null;\n        editor.#initialData = initialData;\n        return editor;\n      }\n      serialize(isForCopying = false) {\n        if (this.isEmpty()) {\n          return null;\n        }\n        if (this.deleted) {\n          return {\n            pageIndex: this.pageIndex,\n            id: this.annotationElementId,\n            deleted: true\n          };\n        }\n        const padding = FreeTextEditor._internalPadding * this.parentScale;\n        const rect = this.getRect(padding, padding);\n        const color = editor_editor.AnnotationEditor._colorManager.convert(this.isAttachedToDOM ? getComputedStyle(this.editorDiv).color : this.#color);\n        const serialized = {\n          annotationType: util.AnnotationEditorType.FREETEXT,\n          color,\n          fontSize: this.#fontSize,\n          value: this.#content,\n          pageIndex: this.pageIndex,\n          rect,\n          rotation: this.rotation,\n          structTreeParentId: this._structTreeParentId\n        };\n        if (isForCopying) {\n          return serialized;\n        }\n        if (this.annotationElementId && !this.#hasElementChanged(serialized)) {\n          return null;\n        }\n        serialized.id = this.annotationElementId;\n        return serialized;\n      }\n      #hasElementChanged(serialized) {\n        const {\n          value,\n          fontSize,\n          color,\n          rect,\n          pageIndex\n        } = this.#initialData;\n        return serialized.value !== value || serialized.fontSize !== fontSize || serialized.rect.some((x, i) => Math.abs(x - rect[i]) >= 1) || serialized.color.some((c, i) => c !== color[i]) || serialized.pageIndex !== pageIndex;\n      }\n      #cheatInitialRect(delayed = false) {\n        if (!this.annotationElementId) {\n          return;\n        }\n        this.#setEditorDimensions();\n        if (!delayed && (this.width === 0 || this.height === 0)) {\n          setTimeout(() => this.#cheatInitialRect(true), 0);\n          return;\n        }\n        const padding = FreeTextEditor._internalPadding * this.parentScale;\n        this.#initialData.rect = this.getRect(padding, padding);\n      }\n    }\n\n    // EXTERNAL MODULE: ./src/display/display_utils.js\n    var display_utils = __webpack_require__(473);\n    ; // CONCATENATED MODULE: ./src/display/editor/ink.js\n\n    class InkEditor extends editor_editor.AnnotationEditor {\n      #baseHeight = 0;\n      #baseWidth = 0;\n      #boundCanvasPointermove = this.canvasPointermove.bind(this);\n      #boundCanvasPointerleave = this.canvasPointerleave.bind(this);\n      #boundCanvasPointerup = this.canvasPointerup.bind(this);\n      #boundCanvasPointerdown = this.canvasPointerdown.bind(this);\n      #canvasContextMenuTimeoutId = null;\n      #currentPath2D = new Path2D();\n      #disableEditing = false;\n      #hasSomethingToDraw = false;\n      #isCanvasInitialized = false;\n      #observer = null;\n      #realWidth = 0;\n      #realHeight = 0;\n      #requestFrameCallback = null;\n      static _defaultColor = null;\n      static _defaultOpacity = 1;\n      static _defaultThickness = 1;\n      static _type = \"ink\";\n      static _editorType = util.AnnotationEditorType.INK;\n      constructor(params) {\n        super({\n          ...params,\n          name: \"inkEditor\"\n        });\n        this.color = params.color || null;\n        this.thickness = params.thickness || null;\n        this.opacity = params.opacity || null;\n        this.paths = [];\n        this.bezierPath2D = [];\n        this.allRawPaths = [];\n        this.currentPath = [];\n        this.scaleFactor = 1;\n        this.translationX = this.translationY = 0;\n        this.x = 0;\n        this.y = 0;\n        this._willKeepAspectRatio = true;\n      }\n      static initialize(l10n) {\n        editor_editor.AnnotationEditor.initialize(l10n);\n      }\n      static updateDefaultParams(type, value) {\n        switch (type) {\n          case util.AnnotationEditorParamsType.INK_THICKNESS:\n            InkEditor._defaultThickness = value;\n            break;\n          case util.AnnotationEditorParamsType.INK_COLOR:\n            InkEditor._defaultColor = value;\n            break;\n          case util.AnnotationEditorParamsType.INK_OPACITY:\n            InkEditor._defaultOpacity = value / 100;\n            break;\n        }\n      }\n      updateParams(type, value) {\n        switch (type) {\n          case util.AnnotationEditorParamsType.INK_THICKNESS:\n            this.#updateThickness(value);\n            break;\n          case util.AnnotationEditorParamsType.INK_COLOR:\n            this.#updateColor(value);\n            break;\n          case util.AnnotationEditorParamsType.INK_OPACITY:\n            this.#updateOpacity(value);\n            break;\n        }\n      }\n      static get defaultPropertiesToUpdate() {\n        return [[util.AnnotationEditorParamsType.INK_THICKNESS, InkEditor._defaultThickness], [util.AnnotationEditorParamsType.INK_COLOR, InkEditor._defaultColor || editor_editor.AnnotationEditor._defaultLineColor], [util.AnnotationEditorParamsType.INK_OPACITY, Math.round(InkEditor._defaultOpacity * 100)]];\n      }\n      get propertiesToUpdate() {\n        return [[util.AnnotationEditorParamsType.INK_THICKNESS, this.thickness || InkEditor._defaultThickness], [util.AnnotationEditorParamsType.INK_COLOR, this.color || InkEditor._defaultColor || editor_editor.AnnotationEditor._defaultLineColor], [util.AnnotationEditorParamsType.INK_OPACITY, Math.round(100 * (this.opacity ?? InkEditor._defaultOpacity))]];\n      }\n      #updateThickness(thickness) {\n        const savedThickness = this.thickness;\n        this.addCommands({\n          cmd: () => {\n            this.thickness = thickness;\n            this.#fitToContent();\n          },\n          undo: () => {\n            this.thickness = savedThickness;\n            this.#fitToContent();\n          },\n          mustExec: true,\n          type: util.AnnotationEditorParamsType.INK_THICKNESS,\n          overwriteIfSameType: true,\n          keepUndo: true\n        });\n      }\n      #updateColor(color) {\n        const savedColor = this.color;\n        this.addCommands({\n          cmd: () => {\n            this.color = color;\n            this.#redraw();\n          },\n          undo: () => {\n            this.color = savedColor;\n            this.#redraw();\n          },\n          mustExec: true,\n          type: util.AnnotationEditorParamsType.INK_COLOR,\n          overwriteIfSameType: true,\n          keepUndo: true\n        });\n      }\n      #updateOpacity(opacity) {\n        opacity /= 100;\n        const savedOpacity = this.opacity;\n        this.addCommands({\n          cmd: () => {\n            this.opacity = opacity;\n            this.#redraw();\n          },\n          undo: () => {\n            this.opacity = savedOpacity;\n            this.#redraw();\n          },\n          mustExec: true,\n          type: util.AnnotationEditorParamsType.INK_OPACITY,\n          overwriteIfSameType: true,\n          keepUndo: true\n        });\n      }\n      rebuild() {\n        if (!this.parent) {\n          return;\n        }\n        super.rebuild();\n        if (this.div === null) {\n          return;\n        }\n        if (!this.canvas) {\n          this.#createCanvas();\n          this.#createObserver();\n        }\n        if (!this.isAttachedToDOM) {\n          this.parent.add(this);\n          this.#setCanvasDims();\n        }\n        this.#fitToContent();\n      }\n      remove() {\n        if (this.canvas === null) {\n          return;\n        }\n        if (!this.isEmpty()) {\n          this.commit();\n        }\n        this.canvas.width = this.canvas.height = 0;\n        this.canvas.remove();\n        this.canvas = null;\n        if (this.#canvasContextMenuTimeoutId) {\n          clearTimeout(this.#canvasContextMenuTimeoutId);\n          this.#canvasContextMenuTimeoutId = null;\n        }\n        this.#observer.disconnect();\n        this.#observer = null;\n        super.remove();\n      }\n      setParent(parent) {\n        if (!this.parent && parent) {\n          this._uiManager.removeShouldRescale(this);\n        } else if (this.parent && parent === null) {\n          this._uiManager.addShouldRescale(this);\n        }\n        super.setParent(parent);\n      }\n      onScaleChanging() {\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        const width = this.width * parentWidth;\n        const height = this.height * parentHeight;\n        this.setDimensions(width, height);\n      }\n      enableEditMode() {\n        if (this.#disableEditing || this.canvas === null) {\n          return;\n        }\n        super.enableEditMode();\n        this._isDraggable = false;\n        this.canvas.addEventListener(\"pointerdown\", this.#boundCanvasPointerdown);\n      }\n      disableEditMode() {\n        if (!this.isInEditMode() || this.canvas === null) {\n          return;\n        }\n        super.disableEditMode();\n        this._isDraggable = !this.isEmpty();\n        this.div.classList.remove(\"editing\");\n        this.canvas.removeEventListener(\"pointerdown\", this.#boundCanvasPointerdown);\n      }\n      onceAdded() {\n        this._isDraggable = !this.isEmpty();\n      }\n      isEmpty() {\n        return this.paths.length === 0 || this.paths.length === 1 && this.paths[0].length === 0;\n      }\n      #getInitialBBox() {\n        const {\n          parentRotation,\n          parentDimensions: [width, height]\n        } = this;\n        switch (parentRotation) {\n          case 90:\n            return [0, height, height, width];\n          case 180:\n            return [width, height, width, height];\n          case 270:\n            return [width, 0, height, width];\n          default:\n            return [0, 0, width, height];\n        }\n      }\n      #setStroke() {\n        const {\n          ctx,\n          color,\n          opacity,\n          thickness,\n          parentScale,\n          scaleFactor\n        } = this;\n        ctx.lineWidth = thickness * parentScale / scaleFactor;\n        ctx.lineCap = \"round\";\n        ctx.lineJoin = \"round\";\n        ctx.miterLimit = 10;\n        ctx.strokeStyle = `${color}${(0, tools.opacityToHex)(opacity)}`;\n      }\n      #startDrawing(x, y) {\n        this.canvas.addEventListener(\"contextmenu\", display_utils.noContextMenu);\n        this.canvas.addEventListener(\"pointerleave\", this.#boundCanvasPointerleave);\n        this.canvas.addEventListener(\"pointermove\", this.#boundCanvasPointermove);\n        this.canvas.addEventListener(\"pointerup\", this.#boundCanvasPointerup);\n        this.canvas.removeEventListener(\"pointerdown\", this.#boundCanvasPointerdown);\n        this.isEditing = true;\n        if (!this.#isCanvasInitialized) {\n          this.#isCanvasInitialized = true;\n          this.#setCanvasDims();\n          this.thickness ||= InkEditor._defaultThickness;\n          this.color ||= InkEditor._defaultColor || editor_editor.AnnotationEditor._defaultLineColor;\n          this.opacity ??= InkEditor._defaultOpacity;\n        }\n        this.currentPath.push([x, y]);\n        this.#hasSomethingToDraw = false;\n        this.#setStroke();\n        this.#requestFrameCallback = () => {\n          this.#drawPoints();\n          if (this.#requestFrameCallback) {\n            window.requestAnimationFrame(this.#requestFrameCallback);\n          }\n        };\n        window.requestAnimationFrame(this.#requestFrameCallback);\n      }\n      #draw(x, y) {\n        const [lastX, lastY] = this.currentPath.at(-1);\n        if (this.currentPath.length > 1 && x === lastX && y === lastY) {\n          return;\n        }\n        const currentPath = this.currentPath;\n        let path2D = this.#currentPath2D;\n        currentPath.push([x, y]);\n        this.#hasSomethingToDraw = true;\n        if (currentPath.length <= 2) {\n          path2D.moveTo(...currentPath[0]);\n          path2D.lineTo(x, y);\n          return;\n        }\n        if (currentPath.length === 3) {\n          this.#currentPath2D = path2D = new Path2D();\n          path2D.moveTo(...currentPath[0]);\n        }\n        this.#makeBezierCurve(path2D, ...currentPath.at(-3), ...currentPath.at(-2), x, y);\n      }\n      #endPath() {\n        if (this.currentPath.length === 0) {\n          return;\n        }\n        const lastPoint = this.currentPath.at(-1);\n        this.#currentPath2D.lineTo(...lastPoint);\n      }\n      #stopDrawing(x, y) {\n        this.#requestFrameCallback = null;\n        x = Math.min(Math.max(x, 0), this.canvas.width);\n        y = Math.min(Math.max(y, 0), this.canvas.height);\n        this.#draw(x, y);\n        this.#endPath();\n        let bezier;\n        if (this.currentPath.length !== 1) {\n          bezier = this.#generateBezierPoints();\n        } else {\n          const xy = [x, y];\n          bezier = [[xy, xy.slice(), xy.slice(), xy]];\n        }\n        const path2D = this.#currentPath2D;\n        const currentPath = this.currentPath;\n        this.currentPath = [];\n        this.#currentPath2D = new Path2D();\n        const cmd = () => {\n          this.allRawPaths.push(currentPath);\n          this.paths.push(bezier);\n          this.bezierPath2D.push(path2D);\n          this.rebuild();\n        };\n        const undo = () => {\n          this.allRawPaths.pop();\n          this.paths.pop();\n          this.bezierPath2D.pop();\n          if (this.paths.length === 0) {\n            this.remove();\n          } else {\n            if (!this.canvas) {\n              this.#createCanvas();\n              this.#createObserver();\n            }\n            this.#fitToContent();\n          }\n        };\n        this.addCommands({\n          cmd,\n          undo,\n          mustExec: true\n        });\n      }\n      #drawPoints() {\n        if (!this.#hasSomethingToDraw) {\n          return;\n        }\n        this.#hasSomethingToDraw = false;\n        const thickness = Math.ceil(this.thickness * this.parentScale);\n        const lastPoints = this.currentPath.slice(-3);\n        const x = lastPoints.map(xy => xy[0]);\n        const y = lastPoints.map(xy => xy[1]);\n        const xMin = Math.min(...x) - thickness;\n        const xMax = Math.max(...x) + thickness;\n        const yMin = Math.min(...y) - thickness;\n        const yMax = Math.max(...y) + thickness;\n        const {\n          ctx\n        } = this;\n        ctx.save();\n        ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        for (const path of this.bezierPath2D) {\n          ctx.stroke(path);\n        }\n        ctx.stroke(this.#currentPath2D);\n        ctx.restore();\n      }\n      #makeBezierCurve(path2D, x0, y0, x1, y1, x2, y2) {\n        const prevX = (x0 + x1) / 2;\n        const prevY = (y0 + y1) / 2;\n        const x3 = (x1 + x2) / 2;\n        const y3 = (y1 + y2) / 2;\n        path2D.bezierCurveTo(prevX + 2 * (x1 - prevX) / 3, prevY + 2 * (y1 - prevY) / 3, x3 + 2 * (x1 - x3) / 3, y3 + 2 * (y1 - y3) / 3, x3, y3);\n      }\n      #generateBezierPoints() {\n        const path = this.currentPath;\n        if (path.length <= 2) {\n          return [[path[0], path[0], path.at(-1), path.at(-1)]];\n        }\n        const bezierPoints = [];\n        let i;\n        let [x0, y0] = path[0];\n        for (i = 1; i < path.length - 2; i++) {\n          const [x1, y1] = path[i];\n          const [x2, y2] = path[i + 1];\n          const x3 = (x1 + x2) / 2;\n          const y3 = (y1 + y2) / 2;\n          const control1 = [x0 + 2 * (x1 - x0) / 3, y0 + 2 * (y1 - y0) / 3];\n          const control2 = [x3 + 2 * (x1 - x3) / 3, y3 + 2 * (y1 - y3) / 3];\n          bezierPoints.push([[x0, y0], control1, control2, [x3, y3]]);\n          [x0, y0] = [x3, y3];\n        }\n        const [x1, y1] = path[i];\n        const [x2, y2] = path[i + 1];\n        const control1 = [x0 + 2 * (x1 - x0) / 3, y0 + 2 * (y1 - y0) / 3];\n        const control2 = [x2 + 2 * (x1 - x2) / 3, y2 + 2 * (y1 - y2) / 3];\n        bezierPoints.push([[x0, y0], control1, control2, [x2, y2]]);\n        return bezierPoints;\n      }\n      #redraw() {\n        if (this.isEmpty()) {\n          this.#updateTransform();\n          return;\n        }\n        this.#setStroke();\n        const {\n          canvas,\n          ctx\n        } = this;\n        ctx.setTransform(1, 0, 0, 1, 0, 0);\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        this.#updateTransform();\n        for (const path of this.bezierPath2D) {\n          ctx.stroke(path);\n        }\n      }\n      commit() {\n        if (this.#disableEditing) {\n          return;\n        }\n        super.commit();\n        this.isEditing = false;\n        this.disableEditMode();\n        this.setInForeground();\n        this.#disableEditing = true;\n        this.div.classList.add(\"disabled\");\n        this.#fitToContent(true);\n        this.select();\n        this.parent.addInkEditorIfNeeded(true);\n        this.moveInDOM();\n        this.div.focus({\n          preventScroll: true\n        });\n      }\n      focusin(event) {\n        if (!this._focusEventsAllowed) {\n          return;\n        }\n        super.focusin(event);\n        this.enableEditMode();\n      }\n      canvasPointerdown(event) {\n        if (event.button !== 0 || !this.isInEditMode() || this.#disableEditing) {\n          return;\n        }\n        this.setInForeground();\n        event.preventDefault();\n        if (event.pointerType !== \"mouse\" && !this.div.contains(document.activeElement)) {\n          this.div.focus({\n            preventScroll: true\n          });\n        }\n        this.#startDrawing(event.offsetX, event.offsetY);\n      }\n      canvasPointermove(event) {\n        event.preventDefault();\n        this.#draw(event.offsetX, event.offsetY);\n      }\n      canvasPointerup(event) {\n        event.preventDefault();\n        this.#endDrawing(event);\n      }\n      canvasPointerleave(event) {\n        this.#endDrawing(event);\n      }\n      #endDrawing(event) {\n        this.canvas.removeEventListener(\"pointerleave\", this.#boundCanvasPointerleave);\n        this.canvas.removeEventListener(\"pointermove\", this.#boundCanvasPointermove);\n        this.canvas.removeEventListener(\"pointerup\", this.#boundCanvasPointerup);\n        this.canvas.addEventListener(\"pointerdown\", this.#boundCanvasPointerdown);\n        if (this.#canvasContextMenuTimeoutId) {\n          clearTimeout(this.#canvasContextMenuTimeoutId);\n        }\n        this.#canvasContextMenuTimeoutId = setTimeout(() => {\n          this.#canvasContextMenuTimeoutId = null;\n          this.canvas.removeEventListener(\"contextmenu\", display_utils.noContextMenu);\n        }, 10);\n        this.#stopDrawing(event.offsetX, event.offsetY);\n        this.addToAnnotationStorage();\n        this.setInBackground();\n      }\n      #createCanvas() {\n        this.canvas = document.createElement(\"canvas\");\n        this.canvas.width = this.canvas.height = 0;\n        this.canvas.className = \"inkEditorCanvas\";\n        this.canvas.setAttribute(\"data-l10n-id\", \"pdfjs-ink-canvas\");\n        this.div.append(this.canvas);\n        this.ctx = this.canvas.getContext(\"2d\");\n      }\n      #createObserver() {\n        this.#observer = new ResizeObserver(entries => {\n          const rect = entries[0].contentRect;\n          if (rect.width && rect.height) {\n            this.setDimensions(rect.width, rect.height);\n          }\n        });\n        this.#observer.observe(this.div);\n      }\n      get isResizable() {\n        return !this.isEmpty() && this.#disableEditing;\n      }\n      render() {\n        if (this.div) {\n          return this.div;\n        }\n        let baseX, baseY;\n        if (this.width) {\n          baseX = this.x;\n          baseY = this.y;\n        }\n        super.render();\n        this.div.setAttribute(\"data-l10n-id\", \"pdfjs-ink\");\n        const [x, y, w, h] = this.#getInitialBBox();\n        this.setAt(x, y, 0, 0);\n        this.setDims(w, h);\n        this.#createCanvas();\n        if (this.width) {\n          const [parentWidth, parentHeight] = this.parentDimensions;\n          this.setAspectRatio(this.width * parentWidth, this.height * parentHeight);\n          this.setAt(baseX * parentWidth, baseY * parentHeight, this.width * parentWidth, this.height * parentHeight);\n          this.#isCanvasInitialized = true;\n          this.#setCanvasDims();\n          this.setDims(this.width * parentWidth, this.height * parentHeight);\n          this.#redraw();\n          this.div.classList.add(\"disabled\");\n        } else {\n          this.div.classList.add(\"editing\");\n          this.enableEditMode();\n        }\n        this.#createObserver();\n        return this.div;\n      }\n      #setCanvasDims() {\n        if (!this.#isCanvasInitialized) {\n          return;\n        }\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        this.canvas.width = Math.ceil(this.width * parentWidth);\n        this.canvas.height = Math.ceil(this.height * parentHeight);\n        this.#updateTransform();\n      }\n      setDimensions(width, height) {\n        const roundedWidth = Math.round(width);\n        const roundedHeight = Math.round(height);\n        if (this.#realWidth === roundedWidth && this.#realHeight === roundedHeight) {\n          return;\n        }\n        this.#realWidth = roundedWidth;\n        this.#realHeight = roundedHeight;\n        this.canvas.style.visibility = \"hidden\";\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        this.width = width / parentWidth;\n        this.height = height / parentHeight;\n        this.fixAndSetPosition();\n        if (this.#disableEditing) {\n          this.#setScaleFactor(width, height);\n        }\n        this.#setCanvasDims();\n        this.#redraw();\n        this.canvas.style.visibility = \"visible\";\n        this.fixDims();\n      }\n      #setScaleFactor(width, height) {\n        const padding = this.#getPadding();\n        const scaleFactorW = (width - padding) / this.#baseWidth;\n        const scaleFactorH = (height - padding) / this.#baseHeight;\n        this.scaleFactor = Math.min(scaleFactorW, scaleFactorH);\n      }\n      #updateTransform() {\n        const padding = this.#getPadding() / 2;\n        this.ctx.setTransform(this.scaleFactor, 0, 0, this.scaleFactor, this.translationX * this.scaleFactor + padding, this.translationY * this.scaleFactor + padding);\n      }\n      static #buildPath2D(bezier) {\n        const path2D = new Path2D();\n        for (let i = 0, ii = bezier.length; i < ii; i++) {\n          const [first, control1, control2, second] = bezier[i];\n          if (i === 0) {\n            path2D.moveTo(...first);\n          }\n          path2D.bezierCurveTo(control1[0], control1[1], control2[0], control2[1], second[0], second[1]);\n        }\n        return path2D;\n      }\n      static #toPDFCoordinates(points, rect, rotation) {\n        const [blX, blY, trX, trY] = rect;\n        switch (rotation) {\n          case 0:\n            for (let i = 0, ii = points.length; i < ii; i += 2) {\n              points[i] += blX;\n              points[i + 1] = trY - points[i + 1];\n            }\n            break;\n          case 90:\n            for (let i = 0, ii = points.length; i < ii; i += 2) {\n              const x = points[i];\n              points[i] = points[i + 1] + blX;\n              points[i + 1] = x + blY;\n            }\n            break;\n          case 180:\n            for (let i = 0, ii = points.length; i < ii; i += 2) {\n              points[i] = trX - points[i];\n              points[i + 1] += blY;\n            }\n            break;\n          case 270:\n            for (let i = 0, ii = points.length; i < ii; i += 2) {\n              const x = points[i];\n              points[i] = trX - points[i + 1];\n              points[i + 1] = trY - x;\n            }\n            break;\n          default:\n            throw new Error(\"Invalid rotation\");\n        }\n        return points;\n      }\n      static #fromPDFCoordinates(points, rect, rotation) {\n        const [blX, blY, trX, trY] = rect;\n        switch (rotation) {\n          case 0:\n            for (let i = 0, ii = points.length; i < ii; i += 2) {\n              points[i] -= blX;\n              points[i + 1] = trY - points[i + 1];\n            }\n            break;\n          case 90:\n            for (let i = 0, ii = points.length; i < ii; i += 2) {\n              const x = points[i];\n              points[i] = points[i + 1] - blY;\n              points[i + 1] = x - blX;\n            }\n            break;\n          case 180:\n            for (let i = 0, ii = points.length; i < ii; i += 2) {\n              points[i] = trX - points[i];\n              points[i + 1] -= blY;\n            }\n            break;\n          case 270:\n            for (let i = 0, ii = points.length; i < ii; i += 2) {\n              const x = points[i];\n              points[i] = trY - points[i + 1];\n              points[i + 1] = trX - x;\n            }\n            break;\n          default:\n            throw new Error(\"Invalid rotation\");\n        }\n        return points;\n      }\n      #serializePaths(s, tx, ty, rect) {\n        const paths = [];\n        const padding = this.thickness / 2;\n        const shiftX = s * tx + padding;\n        const shiftY = s * ty + padding;\n        for (const bezier of this.paths) {\n          const buffer = [];\n          const points = [];\n          for (let j = 0, jj = bezier.length; j < jj; j++) {\n            const [first, control1, control2, second] = bezier[j];\n            const p10 = s * first[0] + shiftX;\n            const p11 = s * first[1] + shiftY;\n            const p20 = s * control1[0] + shiftX;\n            const p21 = s * control1[1] + shiftY;\n            const p30 = s * control2[0] + shiftX;\n            const p31 = s * control2[1] + shiftY;\n            const p40 = s * second[0] + shiftX;\n            const p41 = s * second[1] + shiftY;\n            if (j === 0) {\n              buffer.push(p10, p11);\n              points.push(p10, p11);\n            }\n            buffer.push(p20, p21, p30, p31, p40, p41);\n            points.push(p20, p21);\n            if (j === jj - 1) {\n              points.push(p40, p41);\n            }\n          }\n          paths.push({\n            bezier: InkEditor.#toPDFCoordinates(buffer, rect, this.rotation),\n            points: InkEditor.#toPDFCoordinates(points, rect, this.rotation)\n          });\n        }\n        return paths;\n      }\n      #getBbox() {\n        let xMin = Infinity;\n        let xMax = -Infinity;\n        let yMin = Infinity;\n        let yMax = -Infinity;\n        for (const path of this.paths) {\n          for (const [first, control1, control2, second] of path) {\n            const bbox = util.Util.bezierBoundingBox(...first, ...control1, ...control2, ...second);\n            xMin = Math.min(xMin, bbox[0]);\n            yMin = Math.min(yMin, bbox[1]);\n            xMax = Math.max(xMax, bbox[2]);\n            yMax = Math.max(yMax, bbox[3]);\n          }\n        }\n        return [xMin, yMin, xMax, yMax];\n      }\n      #getPadding() {\n        return this.#disableEditing ? Math.ceil(this.thickness * this.parentScale) : 0;\n      }\n      #fitToContent(firstTime = false) {\n        if (this.isEmpty()) {\n          return;\n        }\n        if (!this.#disableEditing) {\n          this.#redraw();\n          return;\n        }\n        const bbox = this.#getBbox();\n        const padding = this.#getPadding();\n        this.#baseWidth = Math.max(editor_editor.AnnotationEditor.MIN_SIZE, bbox[2] - bbox[0]);\n        this.#baseHeight = Math.max(editor_editor.AnnotationEditor.MIN_SIZE, bbox[3] - bbox[1]);\n        const width = Math.ceil(padding + this.#baseWidth * this.scaleFactor);\n        const height = Math.ceil(padding + this.#baseHeight * this.scaleFactor);\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        this.width = width / parentWidth;\n        this.height = height / parentHeight;\n        this.setAspectRatio(width, height);\n        const prevTranslationX = this.translationX;\n        const prevTranslationY = this.translationY;\n        this.translationX = -bbox[0];\n        this.translationY = -bbox[1];\n        this.#setCanvasDims();\n        this.#redraw();\n        this.#realWidth = width;\n        this.#realHeight = height;\n        this.setDims(width, height);\n        const unscaledPadding = firstTime ? padding / this.scaleFactor / 2 : 0;\n        this.translate(prevTranslationX - this.translationX - unscaledPadding, prevTranslationY - this.translationY - unscaledPadding);\n      }\n      static deserialize(data, parent, uiManager) {\n        if (data instanceof annotation_layer.InkAnnotationElement) {\n          return null;\n        }\n        const editor = super.deserialize(data, parent, uiManager);\n        editor.thickness = data.thickness;\n        editor.color = util.Util.makeHexColor(...data.color);\n        editor.opacity = data.opacity;\n        const [pageWidth, pageHeight] = editor.pageDimensions;\n        const width = editor.width * pageWidth;\n        const height = editor.height * pageHeight;\n        const scaleFactor = editor.parentScale;\n        const padding = data.thickness / 2;\n        editor.#disableEditing = true;\n        editor.#realWidth = Math.round(width);\n        editor.#realHeight = Math.round(height);\n        const {\n          paths,\n          rect,\n          rotation\n        } = data;\n        for (let {\n          bezier\n        } of paths) {\n          bezier = InkEditor.#fromPDFCoordinates(bezier, rect, rotation);\n          const path = [];\n          editor.paths.push(path);\n          let p0 = scaleFactor * (bezier[0] - padding);\n          let p1 = scaleFactor * (bezier[1] - padding);\n          for (let i = 2, ii = bezier.length; i < ii; i += 6) {\n            const p10 = scaleFactor * (bezier[i] - padding);\n            const p11 = scaleFactor * (bezier[i + 1] - padding);\n            const p20 = scaleFactor * (bezier[i + 2] - padding);\n            const p21 = scaleFactor * (bezier[i + 3] - padding);\n            const p30 = scaleFactor * (bezier[i + 4] - padding);\n            const p31 = scaleFactor * (bezier[i + 5] - padding);\n            path.push([[p0, p1], [p10, p11], [p20, p21], [p30, p31]]);\n            p0 = p30;\n            p1 = p31;\n          }\n          const path2D = this.#buildPath2D(path);\n          editor.bezierPath2D.push(path2D);\n        }\n        const bbox = editor.#getBbox();\n        editor.#baseWidth = Math.max(editor_editor.AnnotationEditor.MIN_SIZE, bbox[2] - bbox[0]);\n        editor.#baseHeight = Math.max(editor_editor.AnnotationEditor.MIN_SIZE, bbox[3] - bbox[1]);\n        editor.#setScaleFactor(width, height);\n        return editor;\n      }\n      serialize() {\n        if (this.isEmpty()) {\n          return null;\n        }\n        const rect = this.getRect(0, 0);\n        const color = editor_editor.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);\n        return {\n          annotationType: util.AnnotationEditorType.INK,\n          color,\n          thickness: this.thickness,\n          opacity: this.opacity,\n          paths: this.#serializePaths(this.scaleFactor / this.parentScale, this.translationX, this.translationY, rect),\n          pageIndex: this.pageIndex,\n          rect,\n          rotation: this.rotation,\n          structTreeParentId: this._structTreeParentId\n        };\n      }\n    }\n    ; // CONCATENATED MODULE: ./src/display/editor/stamp.js\n\n    class StampEditor extends editor_editor.AnnotationEditor {\n      #bitmap = null;\n      #bitmapId = null;\n      #bitmapPromise = null;\n      #bitmapUrl = null;\n      #bitmapFile = null;\n      #bitmapFileName = \"\";\n      #canvas = null;\n      #observer = null;\n      #resizeTimeoutId = null;\n      #isSvg = false;\n      #hasBeenAddedInUndoStack = false;\n      static _type = \"stamp\";\n      static _editorType = util.AnnotationEditorType.STAMP;\n      constructor(params) {\n        super({\n          ...params,\n          name: \"stampEditor\"\n        });\n        this.#bitmapUrl = params.bitmapUrl;\n        this.#bitmapFile = params.bitmapFile;\n      }\n      static initialize(l10n) {\n        editor_editor.AnnotationEditor.initialize(l10n);\n      }\n      static get supportedTypes() {\n        const types = [\"apng\", \"avif\", \"bmp\", \"gif\", \"jpeg\", \"png\", \"svg+xml\", \"webp\", \"x-icon\"];\n        return (0, util.shadow)(this, \"supportedTypes\", types.map(type => `image/${type}`));\n      }\n      static get supportedTypesStr() {\n        return (0, util.shadow)(this, \"supportedTypesStr\", this.supportedTypes.join(\",\"));\n      }\n      static isHandlingMimeForPasting(mime) {\n        return this.supportedTypes.includes(mime);\n      }\n      static paste(item, parent) {\n        parent.pasteEditor(util.AnnotationEditorType.STAMP, {\n          bitmapFile: item.getAsFile()\n        });\n      }\n      #getBitmapFetched(data, fromId = false) {\n        if (!data) {\n          this.remove();\n          return;\n        }\n        this.#bitmap = data.bitmap;\n        if (!fromId) {\n          this.#bitmapId = data.id;\n          this.#isSvg = data.isSvg;\n        }\n        if (data.file) {\n          this.#bitmapFileName = data.file.name;\n        }\n        this.#createCanvas();\n      }\n      #getBitmapDone() {\n        this.#bitmapPromise = null;\n        this._uiManager.enableWaiting(false);\n        if (this.#canvas) {\n          this.div.focus();\n        }\n      }\n      #getBitmap() {\n        if (this.#bitmapId) {\n          this._uiManager.enableWaiting(true);\n          this._uiManager.imageManager.getFromId(this.#bitmapId).then(data => this.#getBitmapFetched(data, true)).finally(() => this.#getBitmapDone());\n          return;\n        }\n        if (this.#bitmapUrl) {\n          const url = this.#bitmapUrl;\n          this.#bitmapUrl = null;\n          this._uiManager.enableWaiting(true);\n          this.#bitmapPromise = this._uiManager.imageManager.getFromUrl(url).then(data => this.#getBitmapFetched(data)).finally(() => this.#getBitmapDone());\n          return;\n        }\n        if (this.#bitmapFile) {\n          const file = this.#bitmapFile;\n          this.#bitmapFile = null;\n          this._uiManager.enableWaiting(true);\n          this.#bitmapPromise = this._uiManager.imageManager.getFromFile(file).then(data => this.#getBitmapFetched(data)).finally(() => this.#getBitmapDone());\n          return;\n        }\n        const input = document.createElement(\"input\");\n        input.type = \"file\";\n        input.accept = StampEditor.supportedTypesStr;\n        this.#bitmapPromise = new Promise(resolve => {\n          input.addEventListener(\"change\", async () => {\n            if (!input.files || input.files.length === 0) {\n              this.remove();\n            } else {\n              this._uiManager.enableWaiting(true);\n              const data = await this._uiManager.imageManager.getFromFile(input.files[0]);\n              this.#getBitmapFetched(data);\n            }\n            resolve();\n          });\n          input.addEventListener(\"cancel\", () => {\n            this.remove();\n            resolve();\n          });\n        }).finally(() => this.#getBitmapDone());\n        input.click();\n      }\n      remove() {\n        if (this.#bitmapId) {\n          this.#bitmap = null;\n          this._uiManager.imageManager.deleteId(this.#bitmapId);\n          this.#canvas?.remove();\n          this.#canvas = null;\n          this.#observer?.disconnect();\n          this.#observer = null;\n          if (this.#resizeTimeoutId) {\n            clearTimeout(this.#resizeTimeoutId);\n            this.#resizeTimeoutId = null;\n          }\n        }\n        super.remove();\n      }\n      rebuild() {\n        if (!this.parent) {\n          if (this.#bitmapId) {\n            this.#getBitmap();\n          }\n          return;\n        }\n        super.rebuild();\n        if (this.div === null) {\n          return;\n        }\n        if (this.#bitmapId) {\n          this.#getBitmap();\n        }\n        if (!this.isAttachedToDOM) {\n          this.parent.add(this);\n        }\n      }\n      onceAdded() {\n        this._isDraggable = true;\n        this.div.focus();\n      }\n      isEmpty() {\n        return !(this.#bitmapPromise || this.#bitmap || this.#bitmapUrl || this.#bitmapFile);\n      }\n      get isResizable() {\n        return true;\n      }\n      render() {\n        if (this.div) {\n          return this.div;\n        }\n        let baseX, baseY;\n        if (this.width) {\n          baseX = this.x;\n          baseY = this.y;\n        }\n        super.render();\n        this.div.hidden = true;\n        if (this.#bitmap) {\n          this.#createCanvas();\n        } else {\n          this.#getBitmap();\n        }\n        if (this.width) {\n          const [parentWidth, parentHeight] = this.parentDimensions;\n          this.setAt(baseX * parentWidth, baseY * parentHeight, this.width * parentWidth, this.height * parentHeight);\n        }\n        return this.div;\n      }\n      #createCanvas() {\n        const {\n          div\n        } = this;\n        let {\n          width,\n          height\n        } = this.#bitmap;\n        const [pageWidth, pageHeight] = this.pageDimensions;\n        const MAX_RATIO = 0.75;\n        if (this.width) {\n          width = this.width * pageWidth;\n          height = this.height * pageHeight;\n        } else if (width > MAX_RATIO * pageWidth || height > MAX_RATIO * pageHeight) {\n          const factor = Math.min(MAX_RATIO * pageWidth / width, MAX_RATIO * pageHeight / height);\n          width *= factor;\n          height *= factor;\n        }\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        this.setDims(width * parentWidth / pageWidth, height * parentHeight / pageHeight);\n        this._uiManager.enableWaiting(false);\n        const canvas = this.#canvas = document.createElement(\"canvas\");\n        div.append(canvas);\n        div.hidden = false;\n        this.#drawBitmap(width, height);\n        this.#createObserver();\n        if (!this.#hasBeenAddedInUndoStack) {\n          this.parent.addUndoableEditor(this);\n          this.#hasBeenAddedInUndoStack = true;\n        }\n        this._uiManager._eventBus.dispatch(\"reporttelemetry\", {\n          source: this,\n          details: {\n            type: \"editing\",\n            subtype: this.editorType,\n            data: {\n              action: \"inserted_image\"\n            }\n          }\n        });\n        this.addAltTextButton();\n        if (this.#bitmapFileName) {\n          canvas.setAttribute(\"aria-label\", this.#bitmapFileName);\n        }\n      }\n      #setDimensions(width, height) {\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        this.width = width / parentWidth;\n        this.height = height / parentHeight;\n        this.setDims(width, height);\n        if (this._initialOptions?.isCentered) {\n          this.center();\n        } else {\n          this.fixAndSetPosition();\n        }\n        this._initialOptions = null;\n        if (this.#resizeTimeoutId !== null) {\n          clearTimeout(this.#resizeTimeoutId);\n        }\n        const TIME_TO_WAIT = 200;\n        this.#resizeTimeoutId = setTimeout(() => {\n          this.#resizeTimeoutId = null;\n          this.#drawBitmap(width, height);\n        }, TIME_TO_WAIT);\n      }\n      #scaleBitmap(width, height) {\n        const {\n          width: bitmapWidth,\n          height: bitmapHeight\n        } = this.#bitmap;\n        let newWidth = bitmapWidth;\n        let newHeight = bitmapHeight;\n        let bitmap = this.#bitmap;\n        while (newWidth > 2 * width || newHeight > 2 * height) {\n          const prevWidth = newWidth;\n          const prevHeight = newHeight;\n          if (newWidth > 2 * width) {\n            newWidth = newWidth >= 16384 ? Math.floor(newWidth / 2) - 1 : Math.ceil(newWidth / 2);\n          }\n          if (newHeight > 2 * height) {\n            newHeight = newHeight >= 16384 ? Math.floor(newHeight / 2) - 1 : Math.ceil(newHeight / 2);\n          }\n          const offscreen = new OffscreenCanvas(newWidth, newHeight);\n          const ctx = offscreen.getContext(\"2d\");\n          ctx.drawImage(bitmap, 0, 0, prevWidth, prevHeight, 0, 0, newWidth, newHeight);\n          bitmap = offscreen.transferToImageBitmap();\n        }\n        return bitmap;\n      }\n      #drawBitmap(width, height) {\n        width = Math.ceil(width);\n        height = Math.ceil(height);\n        const canvas = this.#canvas;\n        if (!canvas || canvas.width === width && canvas.height === height) {\n          return;\n        }\n        canvas.width = width;\n        canvas.height = height;\n        const bitmap = this.#isSvg ? this.#bitmap : this.#scaleBitmap(width, height);\n        const ctx = canvas.getContext(\"2d\");\n        ctx.filter = this._uiManager.hcmFilter;\n        ctx.drawImage(bitmap, 0, 0, bitmap.width, bitmap.height, 0, 0, width, height);\n      }\n      getImageForAltText() {\n        return this.#canvas;\n      }\n      #serializeBitmap(toUrl) {\n        if (toUrl) {\n          if (this.#isSvg) {\n            const url = this._uiManager.imageManager.getSvgUrl(this.#bitmapId);\n            if (url) {\n              return url;\n            }\n          }\n          const canvas = document.createElement(\"canvas\");\n          ({\n            width: canvas.width,\n            height: canvas.height\n          } = this.#bitmap);\n          const ctx = canvas.getContext(\"2d\");\n          ctx.drawImage(this.#bitmap, 0, 0);\n          return canvas.toDataURL();\n        }\n        if (this.#isSvg) {\n          const [pageWidth, pageHeight] = this.pageDimensions;\n          const width = Math.round(this.width * pageWidth * display_utils.PixelsPerInch.PDF_TO_CSS_UNITS);\n          const height = Math.round(this.height * pageHeight * display_utils.PixelsPerInch.PDF_TO_CSS_UNITS);\n          const offscreen = new OffscreenCanvas(width, height);\n          const ctx = offscreen.getContext(\"2d\");\n          ctx.drawImage(this.#bitmap, 0, 0, this.#bitmap.width, this.#bitmap.height, 0, 0, width, height);\n          return offscreen.transferToImageBitmap();\n        }\n        return structuredClone(this.#bitmap);\n      }\n      #createObserver() {\n        this.#observer = new ResizeObserver(entries => {\n          const rect = entries[0].contentRect;\n          if (rect.width && rect.height) {\n            this.#setDimensions(rect.width, rect.height);\n          }\n        });\n        this.#observer.observe(this.div);\n      }\n      static deserialize(data, parent, uiManager) {\n        if (data instanceof annotation_layer.StampAnnotationElement) {\n          return null;\n        }\n        const editor = super.deserialize(data, parent, uiManager);\n        const {\n          rect,\n          bitmapUrl,\n          bitmapId,\n          isSvg,\n          accessibilityData\n        } = data;\n        if (bitmapId && uiManager.imageManager.isValidId(bitmapId)) {\n          editor.#bitmapId = bitmapId;\n        } else {\n          editor.#bitmapUrl = bitmapUrl;\n        }\n        editor.#isSvg = isSvg;\n        const [parentWidth, parentHeight] = editor.pageDimensions;\n        editor.width = (rect[2] - rect[0]) / parentWidth;\n        editor.height = (rect[3] - rect[1]) / parentHeight;\n        if (accessibilityData) {\n          editor.altTextData = accessibilityData;\n        }\n        return editor;\n      }\n      serialize(isForCopying = false, context = null) {\n        if (this.isEmpty()) {\n          return null;\n        }\n        const serialized = {\n          annotationType: util.AnnotationEditorType.STAMP,\n          bitmapId: this.#bitmapId,\n          pageIndex: this.pageIndex,\n          rect: this.getRect(0, 0),\n          rotation: this.rotation,\n          isSvg: this.#isSvg,\n          structTreeParentId: this._structTreeParentId\n        };\n        if (isForCopying) {\n          serialized.bitmapUrl = this.#serializeBitmap(true);\n          serialized.accessibilityData = this.altTextData;\n          return serialized;\n        }\n        const {\n          decorative,\n          altText\n        } = this.altTextData;\n        if (!decorative && altText) {\n          serialized.accessibilityData = {\n            type: \"Figure\",\n            alt: altText\n          };\n        }\n        if (context === null) {\n          return serialized;\n        }\n        context.stamps ||= new Map();\n        const area = this.#isSvg ? (serialized.rect[2] - serialized.rect[0]) * (serialized.rect[3] - serialized.rect[1]) : null;\n        if (!context.stamps.has(this.#bitmapId)) {\n          context.stamps.set(this.#bitmapId, {\n            area,\n            serialized\n          });\n          serialized.bitmap = this.#serializeBitmap(false);\n        } else if (this.#isSvg) {\n          const prevData = context.stamps.get(this.#bitmapId);\n          if (area > prevData.area) {\n            prevData.area = area;\n            prevData.serialized.bitmap.close();\n            prevData.serialized.bitmap = this.#serializeBitmap(false);\n          }\n        }\n        return serialized;\n      }\n    }\n    ; // CONCATENATED MODULE: ./src/display/editor/annotation_editor_layer.js\n\n    class AnnotationEditorLayer {\n      #accessibilityManager;\n      #allowClick = false;\n      #annotationLayer = null;\n      #boundPointerup = this.pointerup.bind(this);\n      #boundPointerdown = this.pointerdown.bind(this);\n      #editorFocusTimeoutId = null;\n      #editors = new Map();\n      #hadPointerDown = false;\n      #isCleaningUp = false;\n      #isDisabling = false;\n      #uiManager;\n      static _initialized = false;\n      static #editorTypes = new Map([FreeTextEditor, InkEditor, StampEditor].map(type => [type._editorType, type]));\n      constructor({\n        uiManager,\n        pageIndex,\n        div,\n        accessibilityManager,\n        annotationLayer,\n        viewport,\n        l10n\n      }) {\n        const editorTypes = [...AnnotationEditorLayer.#editorTypes.values()];\n        if (!AnnotationEditorLayer._initialized) {\n          AnnotationEditorLayer._initialized = true;\n          for (const editorType of editorTypes) {\n            editorType.initialize(l10n);\n          }\n        }\n        uiManager.registerEditorTypes(editorTypes);\n        this.#uiManager = uiManager;\n        this.pageIndex = pageIndex;\n        this.div = div;\n        this.#accessibilityManager = accessibilityManager;\n        this.#annotationLayer = annotationLayer;\n        this.viewport = viewport;\n        this.#uiManager.addLayer(this);\n      }\n      get isEmpty() {\n        return this.#editors.size === 0;\n      }\n      updateToolbar(mode) {\n        this.#uiManager.updateToolbar(mode);\n      }\n      updateMode(mode = this.#uiManager.getMode()) {\n        this.#cleanup();\n        if (mode === util.AnnotationEditorType.INK) {\n          this.addInkEditorIfNeeded(false);\n          this.disableClick();\n        } else {\n          this.enableClick();\n        }\n        if (mode !== util.AnnotationEditorType.NONE) {\n          const {\n            classList\n          } = this.div;\n          for (const editorType of AnnotationEditorLayer.#editorTypes.values()) {\n            classList.toggle(`${editorType._type}Editing`, mode === editorType._editorType);\n          }\n          this.div.hidden = false;\n        }\n      }\n      addInkEditorIfNeeded(isCommitting) {\n        if (!isCommitting && this.#uiManager.getMode() !== util.AnnotationEditorType.INK) {\n          return;\n        }\n        if (!isCommitting) {\n          for (const editor of this.#editors.values()) {\n            if (editor.isEmpty()) {\n              editor.setInBackground();\n              return;\n            }\n          }\n        }\n        const editor = this.#createAndAddNewEditor({\n          offsetX: 0,\n          offsetY: 0\n        }, false);\n        editor.setInBackground();\n      }\n      setEditingState(isEditing) {\n        this.#uiManager.setEditingState(isEditing);\n      }\n      addCommands(params) {\n        this.#uiManager.addCommands(params);\n      }\n      togglePointerEvents(enabled = false) {\n        this.div.classList.toggle(\"disabled\", !enabled);\n      }\n      enable() {\n        this.togglePointerEvents(true);\n        const annotationElementIds = new Set();\n        for (const editor of this.#editors.values()) {\n          editor.enableEditing();\n          if (editor.annotationElementId) {\n            annotationElementIds.add(editor.annotationElementId);\n          }\n        }\n        if (!this.#annotationLayer) {\n          return;\n        }\n        const editables = this.#annotationLayer.getEditableAnnotations();\n        for (const editable of editables) {\n          editable.hide();\n          if (this.#uiManager.isDeletedAnnotationElement(editable.data.id)) {\n            continue;\n          }\n          if (annotationElementIds.has(editable.data.id)) {\n            continue;\n          }\n          const editor = this.deserialize(editable);\n          if (!editor) {\n            continue;\n          }\n          this.addOrRebuild(editor);\n          editor.enableEditing();\n        }\n      }\n      disable() {\n        this.#isDisabling = true;\n        this.togglePointerEvents(false);\n        const hiddenAnnotationIds = new Set();\n        for (const editor of this.#editors.values()) {\n          editor.disableEditing();\n          if (!editor.annotationElementId || editor.serialize() !== null) {\n            hiddenAnnotationIds.add(editor.annotationElementId);\n            continue;\n          }\n          this.getEditableAnnotation(editor.annotationElementId)?.show();\n          editor.remove();\n        }\n        if (this.#annotationLayer) {\n          const editables = this.#annotationLayer.getEditableAnnotations();\n          for (const editable of editables) {\n            const {\n              id\n            } = editable.data;\n            if (hiddenAnnotationIds.has(id) || this.#uiManager.isDeletedAnnotationElement(id)) {\n              continue;\n            }\n            editable.show();\n          }\n        }\n        this.#cleanup();\n        if (this.isEmpty) {\n          this.div.hidden = true;\n        }\n        const {\n          classList\n        } = this.div;\n        for (const editorType of AnnotationEditorLayer.#editorTypes.values()) {\n          classList.remove(`${editorType._type}Editing`);\n        }\n        this.#isDisabling = false;\n      }\n      getEditableAnnotation(id) {\n        return this.#annotationLayer?.getEditableAnnotation(id) || null;\n      }\n      setActiveEditor(editor) {\n        const currentActive = this.#uiManager.getActive();\n        if (currentActive === editor) {\n          return;\n        }\n        this.#uiManager.setActiveEditor(editor);\n      }\n      enableClick() {\n        this.div.addEventListener(\"pointerdown\", this.#boundPointerdown);\n        this.div.addEventListener(\"pointerup\", this.#boundPointerup);\n      }\n      disableClick() {\n        this.div.removeEventListener(\"pointerdown\", this.#boundPointerdown);\n        this.div.removeEventListener(\"pointerup\", this.#boundPointerup);\n      }\n      attach(editor) {\n        this.#editors.set(editor.id, editor);\n        const {\n          annotationElementId\n        } = editor;\n        if (annotationElementId && this.#uiManager.isDeletedAnnotationElement(annotationElementId)) {\n          this.#uiManager.removeDeletedAnnotationElement(editor);\n        }\n      }\n      detach(editor) {\n        this.#editors.delete(editor.id);\n        this.#accessibilityManager?.removePointerInTextLayer(editor.contentDiv);\n        if (!this.#isDisabling && editor.annotationElementId) {\n          this.#uiManager.addDeletedAnnotationElement(editor);\n        }\n      }\n      remove(editor) {\n        this.detach(editor);\n        this.#uiManager.removeEditor(editor);\n        editor.div.remove();\n        editor.isAttachedToDOM = false;\n        if (!this.#isCleaningUp) {\n          this.addInkEditorIfNeeded(false);\n        }\n      }\n      changeParent(editor) {\n        if (editor.parent === this) {\n          return;\n        }\n        if (editor.annotationElementId) {\n          this.#uiManager.addDeletedAnnotationElement(editor.annotationElementId);\n          editor_editor.AnnotationEditor.deleteAnnotationElement(editor);\n          editor.annotationElementId = null;\n        }\n        this.attach(editor);\n        editor.parent?.detach(editor);\n        editor.setParent(this);\n        if (editor.div && editor.isAttachedToDOM) {\n          editor.div.remove();\n          this.div.append(editor.div);\n        }\n      }\n      add(editor) {\n        this.changeParent(editor);\n        this.#uiManager.addEditor(editor);\n        this.attach(editor);\n        if (!editor.isAttachedToDOM) {\n          const div = editor.render();\n          this.div.append(div);\n          editor.isAttachedToDOM = true;\n        }\n        editor.fixAndSetPosition();\n        editor.onceAdded();\n        this.#uiManager.addToAnnotationStorage(editor);\n      }\n      moveEditorInDOM(editor) {\n        if (!editor.isAttachedToDOM) {\n          return;\n        }\n        const {\n          activeElement\n        } = document;\n        if (editor.div.contains(activeElement) && !this.#editorFocusTimeoutId) {\n          editor._focusEventsAllowed = false;\n          this.#editorFocusTimeoutId = setTimeout(() => {\n            this.#editorFocusTimeoutId = null;\n            if (!editor.div.contains(document.activeElement)) {\n              editor.div.addEventListener(\"focusin\", () => {\n                editor._focusEventsAllowed = true;\n              }, {\n                once: true\n              });\n              activeElement.focus();\n            } else {\n              editor._focusEventsAllowed = true;\n            }\n          }, 0);\n        }\n        editor._structTreeParentId = this.#accessibilityManager?.moveElementInDOM(this.div, editor.div, editor.contentDiv, true);\n      }\n      addOrRebuild(editor) {\n        if (editor.needsToBeRebuilt()) {\n          editor.parent ||= this;\n          editor.rebuild();\n        } else {\n          this.add(editor);\n        }\n      }\n      addUndoableEditor(editor) {\n        const cmd = () => editor._uiManager.rebuild(editor);\n        const undo = () => {\n          editor.remove();\n        };\n        this.addCommands({\n          cmd,\n          undo,\n          mustExec: false\n        });\n      }\n      getNextId() {\n        return this.#uiManager.getId();\n      }\n      #createNewEditor(params) {\n        const editorType = AnnotationEditorLayer.#editorTypes.get(this.#uiManager.getMode());\n        return editorType ? new editorType.prototype.constructor(params) : null;\n      }\n      pasteEditor(mode, params) {\n        this.#uiManager.updateToolbar(mode);\n        this.#uiManager.updateMode(mode);\n        const {\n          offsetX,\n          offsetY\n        } = this.#getCenterPoint();\n        const id = this.getNextId();\n        const editor = this.#createNewEditor({\n          parent: this,\n          id,\n          x: offsetX,\n          y: offsetY,\n          uiManager: this.#uiManager,\n          isCentered: true,\n          ...params\n        });\n        if (editor) {\n          this.add(editor);\n        }\n      }\n      deserialize(data) {\n        return AnnotationEditorLayer.#editorTypes.get(data.annotationType ?? data.annotationEditorType)?.deserialize(data, this, this.#uiManager) || null;\n      }\n      #createAndAddNewEditor(event, isCentered) {\n        const id = this.getNextId();\n        const editor = this.#createNewEditor({\n          parent: this,\n          id,\n          x: event.offsetX,\n          y: event.offsetY,\n          uiManager: this.#uiManager,\n          isCentered\n        });\n        if (editor) {\n          this.add(editor);\n        }\n        return editor;\n      }\n      #getCenterPoint() {\n        const {\n          x,\n          y,\n          width,\n          height\n        } = this.div.getBoundingClientRect();\n        const tlX = Math.max(0, x);\n        const tlY = Math.max(0, y);\n        const brX = Math.min(window.innerWidth, x + width);\n        const brY = Math.min(window.innerHeight, y + height);\n        const centerX = (tlX + brX) / 2 - x;\n        const centerY = (tlY + brY) / 2 - y;\n        const [offsetX, offsetY] = this.viewport.rotation % 180 === 0 ? [centerX, centerY] : [centerY, centerX];\n        return {\n          offsetX,\n          offsetY\n        };\n      }\n      addNewEditor() {\n        this.#createAndAddNewEditor(this.#getCenterPoint(), true);\n      }\n      setSelected(editor) {\n        this.#uiManager.setSelected(editor);\n      }\n      toggleSelected(editor) {\n        this.#uiManager.toggleSelected(editor);\n      }\n      isSelected(editor) {\n        return this.#uiManager.isSelected(editor);\n      }\n      unselect(editor) {\n        this.#uiManager.unselect(editor);\n      }\n      pointerup(event) {\n        const {\n          isMac\n        } = util.FeatureTest.platform;\n        if (event.button !== 0 || event.ctrlKey && isMac) {\n          return;\n        }\n        if (event.target !== this.div) {\n          return;\n        }\n        if (!this.#hadPointerDown) {\n          return;\n        }\n        this.#hadPointerDown = false;\n        if (!this.#allowClick) {\n          this.#allowClick = true;\n          return;\n        }\n        if (this.#uiManager.getMode() === util.AnnotationEditorType.STAMP) {\n          this.#uiManager.unselectAll();\n          return;\n        }\n        this.#createAndAddNewEditor(event, false);\n      }\n      pointerdown(event) {\n        if (this.#hadPointerDown) {\n          this.#hadPointerDown = false;\n          return;\n        }\n        const {\n          isMac\n        } = util.FeatureTest.platform;\n        if (event.button !== 0 || event.ctrlKey && isMac) {\n          return;\n        }\n        if (event.target !== this.div) {\n          return;\n        }\n        this.#hadPointerDown = true;\n        const editor = this.#uiManager.getActive();\n        this.#allowClick = !editor || editor.isEmpty();\n      }\n      findNewParent(editor, x, y) {\n        const layer = this.#uiManager.findParent(x, y);\n        if (layer === null || layer === this) {\n          return false;\n        }\n        layer.changeParent(editor);\n        return true;\n      }\n      destroy() {\n        if (this.#uiManager.getActive()?.parent === this) {\n          this.#uiManager.commitOrRemove();\n          this.#uiManager.setActiveEditor(null);\n        }\n        if (this.#editorFocusTimeoutId) {\n          clearTimeout(this.#editorFocusTimeoutId);\n          this.#editorFocusTimeoutId = null;\n        }\n        for (const editor of this.#editors.values()) {\n          this.#accessibilityManager?.removePointerInTextLayer(editor.contentDiv);\n          editor.setParent(null);\n          editor.isAttachedToDOM = false;\n          editor.div.remove();\n        }\n        this.div = null;\n        this.#editors.clear();\n        this.#uiManager.removeLayer(this);\n      }\n      #cleanup() {\n        this.#isCleaningUp = true;\n        for (const editor of this.#editors.values()) {\n          if (editor.isEmpty()) {\n            editor.remove();\n          }\n        }\n        this.#isCleaningUp = false;\n      }\n      render({\n        viewport\n      }) {\n        this.viewport = viewport;\n        (0, display_utils.setLayerDimensions)(this.div, viewport);\n        for (const editor of this.#uiManager.getEditors(this.pageIndex)) {\n          this.add(editor);\n        }\n        this.updateMode();\n      }\n      update({\n        viewport\n      }) {\n        this.#uiManager.commitOrRemove();\n        this.viewport = viewport;\n        (0, display_utils.setLayerDimensions)(this.div, {\n          rotation: viewport.rotation\n        });\n        this.updateMode();\n      }\n      get pageDimensions() {\n        const {\n          pageWidth,\n          pageHeight\n        } = this.viewport.rawDims;\n        return [pageWidth, pageHeight];\n      }\n    }\n\n    /***/\n  },\n\n  /***/796: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    // EXPORTS\n    __webpack_require__.d(__webpack_exports__, {\n      AnnotationEditor: () => /* binding */AnnotationEditor\n    });\n\n    // EXTERNAL MODULE: ./src/display/editor/tools.js\n    var tools = __webpack_require__(812);\n    // EXTERNAL MODULE: ./src/shared/util.js\n    var util = __webpack_require__(266);\n    // EXTERNAL MODULE: ./src/display/display_utils.js\n    var display_utils = __webpack_require__(473);\n    ; // CONCATENATED MODULE: ./src/display/editor/toolbar.js\n\n    class EditorToolbar {\n      #toolbar = null;\n      #editor;\n      #buttons = null;\n      constructor(editor) {\n        this.#editor = editor;\n      }\n      render() {\n        const editToolbar = this.#toolbar = document.createElement(\"div\");\n        editToolbar.className = \"editToolbar\";\n        editToolbar.addEventListener(\"contextmenu\", display_utils.noContextMenu);\n        editToolbar.addEventListener(\"pointerdown\", EditorToolbar.#pointerDown);\n        const buttons = this.#buttons = document.createElement(\"div\");\n        buttons.className = \"buttons\";\n        editToolbar.append(buttons);\n        this.#addDeleteButton();\n        return editToolbar;\n      }\n      static #pointerDown(e) {\n        e.stopPropagation();\n      }\n      #focusIn(e) {\n        this.#editor._focusEventsAllowed = false;\n        e.preventDefault();\n        e.stopPropagation();\n      }\n      #focusOut(e) {\n        this.#editor._focusEventsAllowed = true;\n        e.preventDefault();\n        e.stopPropagation();\n      }\n      #addListenersToElement(element) {\n        element.addEventListener(\"focusin\", this.#focusIn.bind(this), {\n          capture: true\n        });\n        element.addEventListener(\"focusout\", this.#focusOut.bind(this), {\n          capture: true\n        });\n        element.addEventListener(\"contextmenu\", display_utils.noContextMenu);\n      }\n      hide() {\n        this.#toolbar.classList.add(\"hidden\");\n      }\n      show() {\n        this.#toolbar.classList.remove(\"hidden\");\n      }\n      #addDeleteButton() {\n        const button = document.createElement(\"button\");\n        button.className = \"delete\";\n        button.tabIndex = 0;\n        button.setAttribute(\"data-l10n-id\", \"pdfjs-editor-remove-button\");\n        this.#addListenersToElement(button);\n        button.addEventListener(\"click\", e => {\n          this.#editor._uiManager.delete();\n        });\n        this.#buttons.append(button);\n      }\n      remove() {\n        this.#toolbar.remove();\n      }\n    }\n    ; // CONCATENATED MODULE: ./src/display/editor/editor.js\n\n    class AnnotationEditor {\n      #allResizerDivs = null;\n      #altText = \"\";\n      #altTextDecorative = false;\n      #altTextButton = null;\n      #altTextTooltip = null;\n      #altTextTooltipTimeout = null;\n      #altTextWasFromKeyBoard = false;\n      #keepAspectRatio = false;\n      #resizersDiv = null;\n      #savedDimensions = null;\n      #boundFocusin = this.focusin.bind(this);\n      #boundFocusout = this.focusout.bind(this);\n      #editToolbar = null;\n      #focusedResizerName = \"\";\n      #hasBeenClicked = false;\n      #isEditing = false;\n      #isInEditMode = false;\n      #isResizerEnabledForKeyboard = false;\n      #moveInDOMTimeout = null;\n      _initialOptions = Object.create(null);\n      _uiManager = null;\n      _focusEventsAllowed = true;\n      _l10nPromise = null;\n      #isDraggable = false;\n      #zIndex = AnnotationEditor._zIndex++;\n      static _borderLineWidth = -1;\n      static _colorManager = new tools.ColorManager();\n      static _zIndex = 1;\n      static SMALL_EDITOR_SIZE = 0;\n      static get _resizerKeyboardManager() {\n        const resize = AnnotationEditor.prototype._resizeWithKeyboard;\n        const small = tools.AnnotationEditorUIManager.TRANSLATE_SMALL;\n        const big = tools.AnnotationEditorUIManager.TRANSLATE_BIG;\n        return (0, util.shadow)(this, \"_resizerKeyboardManager\", new tools.KeyboardManager([[[\"ArrowLeft\", \"mac+ArrowLeft\"], resize, {\n          args: [-small, 0]\n        }], [[\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"], resize, {\n          args: [-big, 0]\n        }], [[\"ArrowRight\", \"mac+ArrowRight\"], resize, {\n          args: [small, 0]\n        }], [[\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"], resize, {\n          args: [big, 0]\n        }], [[\"ArrowUp\", \"mac+ArrowUp\"], resize, {\n          args: [0, -small]\n        }], [[\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"], resize, {\n          args: [0, -big]\n        }], [[\"ArrowDown\", \"mac+ArrowDown\"], resize, {\n          args: [0, small]\n        }], [[\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"], resize, {\n          args: [0, big]\n        }], [[\"Escape\", \"mac+Escape\"], AnnotationEditor.prototype._stopResizingWithKeyboard]]));\n      }\n      constructor(parameters) {\n        if (this.constructor === AnnotationEditor) {\n          (0, util.unreachable)(\"Cannot initialize AnnotationEditor.\");\n        }\n        this.parent = parameters.parent;\n        this.id = parameters.id;\n        this.width = this.height = null;\n        this.pageIndex = parameters.parent.pageIndex;\n        this.name = parameters.name;\n        this.div = null;\n        this._uiManager = parameters.uiManager;\n        this.annotationElementId = null;\n        this._willKeepAspectRatio = false;\n        this._initialOptions.isCentered = parameters.isCentered;\n        this._structTreeParentId = null;\n        const {\n          rotation,\n          rawDims: {\n            pageWidth,\n            pageHeight,\n            pageX,\n            pageY\n          }\n        } = this.parent.viewport;\n        this.rotation = rotation;\n        this.pageRotation = (360 + rotation - this._uiManager.viewParameters.rotation) % 360;\n        this.pageDimensions = [pageWidth, pageHeight];\n        this.pageTranslation = [pageX, pageY];\n        const [width, height] = this.parentDimensions;\n        this.x = parameters.x / width;\n        this.y = parameters.y / height;\n        this.isAttachedToDOM = false;\n        this.deleted = false;\n      }\n      get editorType() {\n        return Object.getPrototypeOf(this).constructor._type;\n      }\n      static get _defaultLineColor() {\n        return (0, util.shadow)(this, \"_defaultLineColor\", this._colorManager.getHexCode(\"CanvasText\"));\n      }\n      static deleteAnnotationElement(editor) {\n        const fakeEditor = new FakeEditor({\n          id: editor.parent.getNextId(),\n          parent: editor.parent,\n          uiManager: editor._uiManager\n        });\n        fakeEditor.annotationElementId = editor.annotationElementId;\n        fakeEditor.deleted = true;\n        fakeEditor._uiManager.addToAnnotationStorage(fakeEditor);\n      }\n      static initialize(l10n, options = null) {\n        AnnotationEditor._l10nPromise ||= new Map([\"pdfjs-editor-alt-text-button-label\", \"pdfjs-editor-alt-text-edit-button-label\", \"pdfjs-editor-alt-text-decorative-tooltip\", \"pdfjs-editor-resizer-label-topLeft\", \"pdfjs-editor-resizer-label-topMiddle\", \"pdfjs-editor-resizer-label-topRight\", \"pdfjs-editor-resizer-label-middleRight\", \"pdfjs-editor-resizer-label-bottomRight\", \"pdfjs-editor-resizer-label-bottomMiddle\", \"pdfjs-editor-resizer-label-bottomLeft\", \"pdfjs-editor-resizer-label-middleLeft\"].map(str => [str, l10n.get(str.replaceAll(/([A-Z])/g, c => `-${c.toLowerCase()}`))]));\n        if (options?.strings) {\n          for (const str of options.strings) {\n            AnnotationEditor._l10nPromise.set(str, l10n.get(str));\n          }\n        }\n        if (AnnotationEditor._borderLineWidth !== -1) {\n          return;\n        }\n        const style = getComputedStyle(document.documentElement);\n        AnnotationEditor._borderLineWidth = parseFloat(style.getPropertyValue(\"--outline-width\")) || 0;\n      }\n      static updateDefaultParams(_type, _value) {}\n      static get defaultPropertiesToUpdate() {\n        return [];\n      }\n      static isHandlingMimeForPasting(mime) {\n        return false;\n      }\n      static paste(item, parent) {\n        (0, util.unreachable)(\"Not implemented\");\n      }\n      get propertiesToUpdate() {\n        return [];\n      }\n      get _isDraggable() {\n        return this.#isDraggable;\n      }\n      set _isDraggable(value) {\n        this.#isDraggable = value;\n        this.div?.classList.toggle(\"draggable\", value);\n      }\n      get isEnterHandled() {\n        return true;\n      }\n      center() {\n        const [pageWidth, pageHeight] = this.pageDimensions;\n        switch (this.parentRotation) {\n          case 90:\n            this.x -= this.height * pageHeight / (pageWidth * 2);\n            this.y += this.width * pageWidth / (pageHeight * 2);\n            break;\n          case 180:\n            this.x += this.width / 2;\n            this.y += this.height / 2;\n            break;\n          case 270:\n            this.x += this.height * pageHeight / (pageWidth * 2);\n            this.y -= this.width * pageWidth / (pageHeight * 2);\n            break;\n          default:\n            this.x -= this.width / 2;\n            this.y -= this.height / 2;\n            break;\n        }\n        this.fixAndSetPosition();\n      }\n      addCommands(params) {\n        this._uiManager.addCommands(params);\n      }\n      get currentLayer() {\n        return this._uiManager.currentLayer;\n      }\n      setInBackground() {\n        this.div.style.zIndex = 0;\n      }\n      setInForeground() {\n        this.div.style.zIndex = this.#zIndex;\n      }\n      setParent(parent) {\n        if (parent !== null) {\n          this.pageIndex = parent.pageIndex;\n          this.pageDimensions = parent.pageDimensions;\n        } else {\n          this.#stopResizing();\n        }\n        this.parent = parent;\n      }\n      focusin(event) {\n        if (!this._focusEventsAllowed) {\n          return;\n        }\n        if (!this.#hasBeenClicked) {\n          this.parent.setSelected(this);\n        } else {\n          this.#hasBeenClicked = false;\n        }\n      }\n      focusout(event) {\n        if (!this._focusEventsAllowed) {\n          return;\n        }\n        if (!this.isAttachedToDOM) {\n          return;\n        }\n        const target = event.relatedTarget;\n        if (target?.closest(`#${this.id}`)) {\n          return;\n        }\n        event.preventDefault();\n        if (!this.parent?.isMultipleSelection) {\n          this.commitOrRemove();\n        }\n      }\n      commitOrRemove() {\n        if (this.isEmpty()) {\n          this.remove();\n        } else {\n          this.commit();\n        }\n      }\n      commit() {\n        this.addToAnnotationStorage();\n      }\n      addToAnnotationStorage() {\n        this._uiManager.addToAnnotationStorage(this);\n      }\n      setAt(x, y, tx, ty) {\n        const [width, height] = this.parentDimensions;\n        [tx, ty] = this.screenToPageTranslation(tx, ty);\n        this.x = (x + tx) / width;\n        this.y = (y + ty) / height;\n        this.fixAndSetPosition();\n      }\n      #translate([width, height], x, y) {\n        [x, y] = this.screenToPageTranslation(x, y);\n        this.x += x / width;\n        this.y += y / height;\n        this.fixAndSetPosition();\n      }\n      translate(x, y) {\n        this.#translate(this.parentDimensions, x, y);\n      }\n      translateInPage(x, y) {\n        this.#translate(this.pageDimensions, x, y);\n        this.div.scrollIntoView({\n          block: \"nearest\"\n        });\n      }\n      drag(tx, ty) {\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        this.x += tx / parentWidth;\n        this.y += ty / parentHeight;\n        if (this.parent && (this.x < 0 || this.x > 1 || this.y < 0 || this.y > 1)) {\n          const {\n            x,\n            y\n          } = this.div.getBoundingClientRect();\n          if (this.parent.findNewParent(this, x, y)) {\n            this.x -= Math.floor(this.x);\n            this.y -= Math.floor(this.y);\n          }\n        }\n        let {\n          x,\n          y\n        } = this;\n        const [bx, by] = this.#getBaseTranslation();\n        x += bx;\n        y += by;\n        this.div.style.left = `${(100 * x).toFixed(2)}%`;\n        this.div.style.top = `${(100 * y).toFixed(2)}%`;\n        this.div.scrollIntoView({\n          block: \"nearest\"\n        });\n      }\n      #getBaseTranslation() {\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        const {\n          _borderLineWidth\n        } = AnnotationEditor;\n        const x = _borderLineWidth / parentWidth;\n        const y = _borderLineWidth / parentHeight;\n        switch (this.rotation) {\n          case 90:\n            return [-x, y];\n          case 180:\n            return [x, y];\n          case 270:\n            return [x, -y];\n          default:\n            return [-x, -y];\n        }\n      }\n      fixAndSetPosition() {\n        const [pageWidth, pageHeight] = this.pageDimensions;\n        let {\n          x,\n          y,\n          width,\n          height\n        } = this;\n        width *= pageWidth;\n        height *= pageHeight;\n        x *= pageWidth;\n        y *= pageHeight;\n        switch (this.rotation) {\n          case 0:\n            x = Math.max(0, Math.min(pageWidth - width, x));\n            y = Math.max(0, Math.min(pageHeight - height, y));\n            break;\n          case 90:\n            x = Math.max(0, Math.min(pageWidth - height, x));\n            y = Math.min(pageHeight, Math.max(width, y));\n            break;\n          case 180:\n            x = Math.min(pageWidth, Math.max(width, x));\n            y = Math.min(pageHeight, Math.max(height, y));\n            break;\n          case 270:\n            x = Math.min(pageWidth, Math.max(height, x));\n            y = Math.max(0, Math.min(pageHeight - width, y));\n            break;\n        }\n        this.x = x /= pageWidth;\n        this.y = y /= pageHeight;\n        const [bx, by] = this.#getBaseTranslation();\n        x += bx;\n        y += by;\n        const {\n          style\n        } = this.div;\n        style.left = `${(100 * x).toFixed(2)}%`;\n        style.top = `${(100 * y).toFixed(2)}%`;\n        this.moveInDOM();\n      }\n      static #rotatePoint(x, y, angle) {\n        switch (angle) {\n          case 90:\n            return [y, -x];\n          case 180:\n            return [-x, -y];\n          case 270:\n            return [-y, x];\n          default:\n            return [x, y];\n        }\n      }\n      screenToPageTranslation(x, y) {\n        return AnnotationEditor.#rotatePoint(x, y, this.parentRotation);\n      }\n      pageTranslationToScreen(x, y) {\n        return AnnotationEditor.#rotatePoint(x, y, 360 - this.parentRotation);\n      }\n      #getRotationMatrix(rotation) {\n        switch (rotation) {\n          case 90:\n            {\n              const [pageWidth, pageHeight] = this.pageDimensions;\n              return [0, -pageWidth / pageHeight, pageHeight / pageWidth, 0];\n            }\n          case 180:\n            return [-1, 0, 0, -1];\n          case 270:\n            {\n              const [pageWidth, pageHeight] = this.pageDimensions;\n              return [0, pageWidth / pageHeight, -pageHeight / pageWidth, 0];\n            }\n          default:\n            return [1, 0, 0, 1];\n        }\n      }\n      get parentScale() {\n        return this._uiManager.viewParameters.realScale;\n      }\n      get parentRotation() {\n        return (this._uiManager.viewParameters.rotation + this.pageRotation) % 360;\n      }\n      get parentDimensions() {\n        const {\n          parentScale,\n          pageDimensions: [pageWidth, pageHeight]\n        } = this;\n        const scaledWidth = pageWidth * parentScale;\n        const scaledHeight = pageHeight * parentScale;\n        return util.FeatureTest.isCSSRoundSupported ? [Math.round(scaledWidth), Math.round(scaledHeight)] : [scaledWidth, scaledHeight];\n      }\n      setDims(width, height) {\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        this.div.style.width = `${(100 * width / parentWidth).toFixed(2)}%`;\n        if (!this.#keepAspectRatio) {\n          this.div.style.height = `${(100 * height / parentHeight).toFixed(2)}%`;\n        }\n        this.#altTextButton?.classList.toggle(\"small\", width < AnnotationEditor.SMALL_EDITOR_SIZE || height < AnnotationEditor.SMALL_EDITOR_SIZE);\n      }\n      fixDims() {\n        const {\n          style\n        } = this.div;\n        const {\n          height,\n          width\n        } = style;\n        const widthPercent = width.endsWith(\"%\");\n        const heightPercent = !this.#keepAspectRatio && height.endsWith(\"%\");\n        if (widthPercent && heightPercent) {\n          return;\n        }\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        if (!widthPercent) {\n          style.width = `${(100 * parseFloat(width) / parentWidth).toFixed(2)}%`;\n        }\n        if (!this.#keepAspectRatio && !heightPercent) {\n          style.height = `${(100 * parseFloat(height) / parentHeight).toFixed(2)}%`;\n        }\n      }\n      getInitialTranslation() {\n        return [0, 0];\n      }\n      #createResizers() {\n        if (this.#resizersDiv) {\n          return;\n        }\n        this.#resizersDiv = document.createElement(\"div\");\n        this.#resizersDiv.classList.add(\"resizers\");\n        const classes = this._willKeepAspectRatio ? [\"topLeft\", \"topRight\", \"bottomRight\", \"bottomLeft\"] : [\"topLeft\", \"topMiddle\", \"topRight\", \"middleRight\", \"bottomRight\", \"bottomMiddle\", \"bottomLeft\", \"middleLeft\"];\n        for (const name of classes) {\n          const div = document.createElement(\"div\");\n          this.#resizersDiv.append(div);\n          div.classList.add(\"resizer\", name);\n          div.setAttribute(\"data-resizer-name\", name);\n          div.addEventListener(\"pointerdown\", this.#resizerPointerdown.bind(this, name));\n          div.addEventListener(\"contextmenu\", display_utils.noContextMenu);\n          div.tabIndex = -1;\n        }\n        this.div.prepend(this.#resizersDiv);\n      }\n      #resizerPointerdown(name, event) {\n        event.preventDefault();\n        const {\n          isMac\n        } = util.FeatureTest.platform;\n        if (event.button !== 0 || event.ctrlKey && isMac) {\n          return;\n        }\n        this.#toggleAltTextButton(false);\n        const boundResizerPointermove = this.#resizerPointermove.bind(this, name);\n        const savedDraggable = this._isDraggable;\n        this._isDraggable = false;\n        const pointerMoveOptions = {\n          passive: true,\n          capture: true\n        };\n        this.parent.togglePointerEvents(false);\n        window.addEventListener(\"pointermove\", boundResizerPointermove, pointerMoveOptions);\n        const savedX = this.x;\n        const savedY = this.y;\n        const savedWidth = this.width;\n        const savedHeight = this.height;\n        const savedParentCursor = this.parent.div.style.cursor;\n        const savedCursor = this.div.style.cursor;\n        this.div.style.cursor = this.parent.div.style.cursor = window.getComputedStyle(event.target).cursor;\n        const pointerUpCallback = () => {\n          this.parent.togglePointerEvents(true);\n          this.#toggleAltTextButton(true);\n          this._isDraggable = savedDraggable;\n          window.removeEventListener(\"pointerup\", pointerUpCallback);\n          window.removeEventListener(\"blur\", pointerUpCallback);\n          window.removeEventListener(\"pointermove\", boundResizerPointermove, pointerMoveOptions);\n          this.parent.div.style.cursor = savedParentCursor;\n          this.div.style.cursor = savedCursor;\n          this.#addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight);\n        };\n        window.addEventListener(\"pointerup\", pointerUpCallback);\n        window.addEventListener(\"blur\", pointerUpCallback);\n      }\n      #addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight) {\n        const newX = this.x;\n        const newY = this.y;\n        const newWidth = this.width;\n        const newHeight = this.height;\n        if (newX === savedX && newY === savedY && newWidth === savedWidth && newHeight === savedHeight) {\n          return;\n        }\n        this.addCommands({\n          cmd: () => {\n            this.width = newWidth;\n            this.height = newHeight;\n            this.x = newX;\n            this.y = newY;\n            const [parentWidth, parentHeight] = this.parentDimensions;\n            this.setDims(parentWidth * newWidth, parentHeight * newHeight);\n            this.fixAndSetPosition();\n          },\n          undo: () => {\n            this.width = savedWidth;\n            this.height = savedHeight;\n            this.x = savedX;\n            this.y = savedY;\n            const [parentWidth, parentHeight] = this.parentDimensions;\n            this.setDims(parentWidth * savedWidth, parentHeight * savedHeight);\n            this.fixAndSetPosition();\n          },\n          mustExec: true\n        });\n      }\n      #resizerPointermove(name, event) {\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        const savedX = this.x;\n        const savedY = this.y;\n        const savedWidth = this.width;\n        const savedHeight = this.height;\n        const minWidth = AnnotationEditor.MIN_SIZE / parentWidth;\n        const minHeight = AnnotationEditor.MIN_SIZE / parentHeight;\n        const round = x => Math.round(x * 10000) / 10000;\n        const rotationMatrix = this.#getRotationMatrix(this.rotation);\n        const transf = (x, y) => [rotationMatrix[0] * x + rotationMatrix[2] * y, rotationMatrix[1] * x + rotationMatrix[3] * y];\n        const invRotationMatrix = this.#getRotationMatrix(360 - this.rotation);\n        const invTransf = (x, y) => [invRotationMatrix[0] * x + invRotationMatrix[2] * y, invRotationMatrix[1] * x + invRotationMatrix[3] * y];\n        let getPoint;\n        let getOpposite;\n        let isDiagonal = false;\n        let isHorizontal = false;\n        switch (name) {\n          case \"topLeft\":\n            isDiagonal = true;\n            getPoint = (w, h) => [0, 0];\n            getOpposite = (w, h) => [w, h];\n            break;\n          case \"topMiddle\":\n            getPoint = (w, h) => [w / 2, 0];\n            getOpposite = (w, h) => [w / 2, h];\n            break;\n          case \"topRight\":\n            isDiagonal = true;\n            getPoint = (w, h) => [w, 0];\n            getOpposite = (w, h) => [0, h];\n            break;\n          case \"middleRight\":\n            isHorizontal = true;\n            getPoint = (w, h) => [w, h / 2];\n            getOpposite = (w, h) => [0, h / 2];\n            break;\n          case \"bottomRight\":\n            isDiagonal = true;\n            getPoint = (w, h) => [w, h];\n            getOpposite = (w, h) => [0, 0];\n            break;\n          case \"bottomMiddle\":\n            getPoint = (w, h) => [w / 2, h];\n            getOpposite = (w, h) => [w / 2, 0];\n            break;\n          case \"bottomLeft\":\n            isDiagonal = true;\n            getPoint = (w, h) => [0, h];\n            getOpposite = (w, h) => [w, 0];\n            break;\n          case \"middleLeft\":\n            isHorizontal = true;\n            getPoint = (w, h) => [0, h / 2];\n            getOpposite = (w, h) => [w, h / 2];\n            break;\n        }\n        const point = getPoint(savedWidth, savedHeight);\n        const oppositePoint = getOpposite(savedWidth, savedHeight);\n        let transfOppositePoint = transf(...oppositePoint);\n        const oppositeX = round(savedX + transfOppositePoint[0]);\n        const oppositeY = round(savedY + transfOppositePoint[1]);\n        let ratioX = 1;\n        let ratioY = 1;\n        let [deltaX, deltaY] = this.screenToPageTranslation(event.movementX, event.movementY);\n        [deltaX, deltaY] = invTransf(deltaX / parentWidth, deltaY / parentHeight);\n        if (isDiagonal) {\n          const oldDiag = Math.hypot(savedWidth, savedHeight);\n          ratioX = ratioY = Math.max(Math.min(Math.hypot(oppositePoint[0] - point[0] - deltaX, oppositePoint[1] - point[1] - deltaY) / oldDiag, 1 / savedWidth, 1 / savedHeight), minWidth / savedWidth, minHeight / savedHeight);\n        } else if (isHorizontal) {\n          ratioX = Math.max(minWidth, Math.min(1, Math.abs(oppositePoint[0] - point[0] - deltaX))) / savedWidth;\n        } else {\n          ratioY = Math.max(minHeight, Math.min(1, Math.abs(oppositePoint[1] - point[1] - deltaY))) / savedHeight;\n        }\n        const newWidth = round(savedWidth * ratioX);\n        const newHeight = round(savedHeight * ratioY);\n        transfOppositePoint = transf(...getOpposite(newWidth, newHeight));\n        const newX = oppositeX - transfOppositePoint[0];\n        const newY = oppositeY - transfOppositePoint[1];\n        this.width = newWidth;\n        this.height = newHeight;\n        this.x = newX;\n        this.y = newY;\n        this.setDims(parentWidth * newWidth, parentHeight * newHeight);\n        this.fixAndSetPosition();\n      }\n      async addAltTextButton() {\n        if (this.#altTextButton) {\n          return;\n        }\n        const altText = this.#altTextButton = document.createElement(\"button\");\n        altText.className = \"altText\";\n        const msg = await AnnotationEditor._l10nPromise.get(\"pdfjs-editor-alt-text-button-label\");\n        altText.textContent = msg;\n        altText.setAttribute(\"aria-label\", msg);\n        altText.tabIndex = \"0\";\n        altText.addEventListener(\"contextmenu\", display_utils.noContextMenu);\n        altText.addEventListener(\"pointerdown\", event => event.stopPropagation());\n        const onClick = event => {\n          this.#altTextButton.hidden = true;\n          event.preventDefault();\n          this._uiManager.editAltText(this);\n        };\n        altText.addEventListener(\"click\", onClick, {\n          capture: true\n        });\n        altText.addEventListener(\"keydown\", event => {\n          if (event.target === altText && event.key === \"Enter\") {\n            this.#altTextWasFromKeyBoard = true;\n            onClick(event);\n          }\n        });\n        this.#setAltTextButtonState();\n        this.div.append(altText);\n        if (!AnnotationEditor.SMALL_EDITOR_SIZE) {\n          const PERCENT = 40;\n          AnnotationEditor.SMALL_EDITOR_SIZE = Math.min(128, Math.round(altText.getBoundingClientRect().width * (1 + PERCENT / 100)));\n        }\n      }\n      async #setAltTextButtonState() {\n        const button = this.#altTextButton;\n        if (!button) {\n          return;\n        }\n        if (!this.#altText && !this.#altTextDecorative) {\n          button.classList.remove(\"done\");\n          this.#altTextTooltip?.remove();\n          return;\n        }\n        button.classList.add(\"done\");\n        AnnotationEditor._l10nPromise.get(\"pdfjs-editor-alt-text-edit-button-label\").then(msg => {\n          button.setAttribute(\"aria-label\", msg);\n        });\n        let tooltip = this.#altTextTooltip;\n        if (!tooltip) {\n          this.#altTextTooltip = tooltip = document.createElement(\"span\");\n          tooltip.className = \"tooltip\";\n          tooltip.setAttribute(\"role\", \"tooltip\");\n          const id = tooltip.id = `alt-text-tooltip-${this.id}`;\n          button.setAttribute(\"aria-describedby\", id);\n          const DELAY_TO_SHOW_TOOLTIP = 100;\n          button.addEventListener(\"mouseenter\", () => {\n            this.#altTextTooltipTimeout = setTimeout(() => {\n              this.#altTextTooltipTimeout = null;\n              this.#altTextTooltip.classList.add(\"show\");\n              this._uiManager._eventBus.dispatch(\"reporttelemetry\", {\n                source: this,\n                details: {\n                  type: \"editing\",\n                  subtype: this.editorType,\n                  data: {\n                    action: \"alt_text_tooltip\"\n                  }\n                }\n              });\n            }, DELAY_TO_SHOW_TOOLTIP);\n          });\n          button.addEventListener(\"mouseleave\", () => {\n            if (this.#altTextTooltipTimeout) {\n              clearTimeout(this.#altTextTooltipTimeout);\n              this.#altTextTooltipTimeout = null;\n            }\n            this.#altTextTooltip?.classList.remove(\"show\");\n          });\n        }\n        tooltip.innerText = this.#altTextDecorative ? await AnnotationEditor._l10nPromise.get(\"pdfjs-editor-alt-text-decorative-tooltip\") : this.#altText;\n        if (!tooltip.parentNode) {\n          button.append(tooltip);\n        }\n        const element = this.getImageForAltText();\n        element?.setAttribute(\"aria-describedby\", tooltip.id);\n      }\n      #toggleAltTextButton(enabled = false) {\n        if (!this.#altTextButton) {\n          return;\n        }\n        if (!enabled && this.#altTextTooltipTimeout) {\n          clearTimeout(this.#altTextTooltipTimeout);\n          this.#altTextTooltipTimeout = null;\n        }\n        this.#altTextButton.disabled = !enabled;\n      }\n      altTextFinish() {\n        if (!this.#altTextButton) {\n          return;\n        }\n        this.#altTextButton.hidden = false;\n        this.#altTextButton.focus({\n          focusVisible: this.#altTextWasFromKeyBoard\n        });\n        this.#altTextWasFromKeyBoard = false;\n      }\n      addEditToolbar() {\n        if (this.#editToolbar || this.#isInEditMode) {\n          return;\n        }\n        this.#editToolbar = new EditorToolbar(this);\n        this.div.append(this.#editToolbar.render());\n      }\n      removeEditToolbar() {\n        if (!this.#editToolbar) {\n          return;\n        }\n        this.#editToolbar.remove();\n        this.#editToolbar = null;\n      }\n      getClientDimensions() {\n        return this.div.getBoundingClientRect();\n      }\n      get altTextData() {\n        return {\n          altText: this.#altText,\n          decorative: this.#altTextDecorative\n        };\n      }\n      set altTextData({\n        altText,\n        decorative\n      }) {\n        if (this.#altText === altText && this.#altTextDecorative === decorative) {\n          return;\n        }\n        this.#altText = altText;\n        this.#altTextDecorative = decorative;\n        this.#setAltTextButtonState();\n      }\n      render() {\n        this.div = document.createElement(\"div\");\n        this.div.setAttribute(\"data-editor-rotation\", (360 - this.rotation) % 360);\n        this.div.className = this.name;\n        this.div.setAttribute(\"id\", this.id);\n        this.div.setAttribute(\"tabIndex\", 0);\n        this.setInForeground();\n        this.div.addEventListener(\"focusin\", this.#boundFocusin);\n        this.div.addEventListener(\"focusout\", this.#boundFocusout);\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        if (this.parentRotation % 180 !== 0) {\n          this.div.style.maxWidth = `${(100 * parentHeight / parentWidth).toFixed(2)}%`;\n          this.div.style.maxHeight = `${(100 * parentWidth / parentHeight).toFixed(2)}%`;\n        }\n        const [tx, ty] = this.getInitialTranslation();\n        this.translate(tx, ty);\n        (0, tools.bindEvents)(this, this.div, [\"pointerdown\"]);\n        return this.div;\n      }\n      pointerdown(event) {\n        const {\n          isMac\n        } = util.FeatureTest.platform;\n        if (event.button !== 0 || event.ctrlKey && isMac) {\n          event.preventDefault();\n          return;\n        }\n        this.#hasBeenClicked = true;\n        this.#setUpDragSession(event);\n      }\n      #setUpDragSession(event) {\n        if (!this._isDraggable) {\n          return;\n        }\n        const isSelected = this._uiManager.isSelected(this);\n        this._uiManager.setUpDragSession();\n        let pointerMoveOptions, pointerMoveCallback;\n        if (isSelected) {\n          pointerMoveOptions = {\n            passive: true,\n            capture: true\n          };\n          pointerMoveCallback = e => {\n            const [tx, ty] = this.screenToPageTranslation(e.movementX, e.movementY);\n            this._uiManager.dragSelectedEditors(tx, ty);\n          };\n          window.addEventListener(\"pointermove\", pointerMoveCallback, pointerMoveOptions);\n        }\n        const pointerUpCallback = () => {\n          window.removeEventListener(\"pointerup\", pointerUpCallback);\n          window.removeEventListener(\"blur\", pointerUpCallback);\n          if (isSelected) {\n            window.removeEventListener(\"pointermove\", pointerMoveCallback, pointerMoveOptions);\n          }\n          this.#hasBeenClicked = false;\n          if (!this._uiManager.endDragSession()) {\n            const {\n              isMac\n            } = util.FeatureTest.platform;\n            if (event.ctrlKey && !isMac || event.shiftKey || event.metaKey && isMac) {\n              this.parent.toggleSelected(this);\n            } else {\n              this.parent.setSelected(this);\n            }\n          }\n        };\n        window.addEventListener(\"pointerup\", pointerUpCallback);\n        window.addEventListener(\"blur\", pointerUpCallback);\n      }\n      moveInDOM() {\n        if (this.#moveInDOMTimeout) {\n          clearTimeout(this.#moveInDOMTimeout);\n        }\n        this.#moveInDOMTimeout = setTimeout(() => {\n          this.#moveInDOMTimeout = null;\n          this.parent?.moveEditorInDOM(this);\n        }, 0);\n      }\n      _setParentAndPosition(parent, x, y) {\n        parent.changeParent(this);\n        this.x = x;\n        this.y = y;\n        this.fixAndSetPosition();\n      }\n      getRect(tx, ty) {\n        const scale = this.parentScale;\n        const [pageWidth, pageHeight] = this.pageDimensions;\n        const [pageX, pageY] = this.pageTranslation;\n        const shiftX = tx / scale;\n        const shiftY = ty / scale;\n        const x = this.x * pageWidth;\n        const y = this.y * pageHeight;\n        const width = this.width * pageWidth;\n        const height = this.height * pageHeight;\n        switch (this.rotation) {\n          case 0:\n            return [x + shiftX + pageX, pageHeight - y - shiftY - height + pageY, x + shiftX + width + pageX, pageHeight - y - shiftY + pageY];\n          case 90:\n            return [x + shiftY + pageX, pageHeight - y + shiftX + pageY, x + shiftY + height + pageX, pageHeight - y + shiftX + width + pageY];\n          case 180:\n            return [x - shiftX - width + pageX, pageHeight - y + shiftY + pageY, x - shiftX + pageX, pageHeight - y + shiftY + height + pageY];\n          case 270:\n            return [x - shiftY - height + pageX, pageHeight - y - shiftX - width + pageY, x - shiftY + pageX, pageHeight - y - shiftX + pageY];\n          default:\n            throw new Error(\"Invalid rotation\");\n        }\n      }\n      getRectInCurrentCoords(rect, pageHeight) {\n        const [x1, y1, x2, y2] = rect;\n        const width = x2 - x1;\n        const height = y2 - y1;\n        switch (this.rotation) {\n          case 0:\n            return [x1, pageHeight - y2, width, height];\n          case 90:\n            return [x1, pageHeight - y1, height, width];\n          case 180:\n            return [x2, pageHeight - y1, width, height];\n          case 270:\n            return [x2, pageHeight - y2, height, width];\n          default:\n            throw new Error(\"Invalid rotation\");\n        }\n      }\n      onceAdded() {}\n      isEmpty() {\n        return false;\n      }\n      enableEditMode() {\n        this.#isInEditMode = true;\n      }\n      disableEditMode() {\n        this.#isInEditMode = false;\n      }\n      isInEditMode() {\n        return this.#isInEditMode;\n      }\n      shouldGetKeyboardEvents() {\n        return this.#isResizerEnabledForKeyboard;\n      }\n      needsToBeRebuilt() {\n        return this.div && !this.isAttachedToDOM;\n      }\n      rebuild() {\n        this.div?.addEventListener(\"focusin\", this.#boundFocusin);\n        this.div?.addEventListener(\"focusout\", this.#boundFocusout);\n      }\n      serialize(isForCopying = false, context = null) {\n        (0, util.unreachable)(\"An editor must be serializable\");\n      }\n      static deserialize(data, parent, uiManager) {\n        const editor = new this.prototype.constructor({\n          parent,\n          id: parent.getNextId(),\n          uiManager\n        });\n        editor.rotation = data.rotation;\n        const [pageWidth, pageHeight] = editor.pageDimensions;\n        const [x, y, width, height] = editor.getRectInCurrentCoords(data.rect, pageHeight);\n        editor.x = x / pageWidth;\n        editor.y = y / pageHeight;\n        editor.width = width / pageWidth;\n        editor.height = height / pageHeight;\n        return editor;\n      }\n      remove() {\n        this.div.removeEventListener(\"focusin\", this.#boundFocusin);\n        this.div.removeEventListener(\"focusout\", this.#boundFocusout);\n        if (!this.isEmpty()) {\n          this.commit();\n        }\n        if (this.parent) {\n          this.parent.remove(this);\n        } else {\n          this._uiManager.removeEditor(this);\n        }\n        this.#altTextButton?.remove();\n        this.#altTextButton = null;\n        this.#altTextTooltip = null;\n        if (this.#moveInDOMTimeout) {\n          clearTimeout(this.#moveInDOMTimeout);\n          this.#moveInDOMTimeout = null;\n        }\n        this.#stopResizing();\n        this.removeEditToolbar();\n      }\n      get isResizable() {\n        return false;\n      }\n      makeResizable() {\n        if (this.isResizable) {\n          this.#createResizers();\n          this.#resizersDiv.classList.remove(\"hidden\");\n          (0, tools.bindEvents)(this, this.div, [\"keydown\"]);\n        }\n      }\n      keydown(event) {\n        if (!this.isResizable || event.target !== this.div || event.key !== \"Enter\") {\n          return;\n        }\n        this._uiManager.setSelected(this);\n        this.#savedDimensions = {\n          savedX: this.x,\n          savedY: this.y,\n          savedWidth: this.width,\n          savedHeight: this.height\n        };\n        const children = this.#resizersDiv.children;\n        if (!this.#allResizerDivs) {\n          this.#allResizerDivs = Array.from(children);\n          const boundResizerKeydown = this.#resizerKeydown.bind(this);\n          const boundResizerBlur = this.#resizerBlur.bind(this);\n          for (const div of this.#allResizerDivs) {\n            const name = div.getAttribute(\"data-resizer-name\");\n            div.setAttribute(\"role\", \"spinbutton\");\n            div.addEventListener(\"keydown\", boundResizerKeydown);\n            div.addEventListener(\"blur\", boundResizerBlur);\n            div.addEventListener(\"focus\", this.#resizerFocus.bind(this, name));\n            AnnotationEditor._l10nPromise.get(`pdfjs-editor-resizer-label-${name}`).then(msg => div.setAttribute(\"aria-label\", msg));\n          }\n        }\n        const first = this.#allResizerDivs[0];\n        let firstPosition = 0;\n        for (const div of children) {\n          if (div === first) {\n            break;\n          }\n          firstPosition++;\n        }\n        const nextFirstPosition = (360 - this.rotation + this.parentRotation) % 360 / 90 * (this.#allResizerDivs.length / 4);\n        if (nextFirstPosition !== firstPosition) {\n          if (nextFirstPosition < firstPosition) {\n            for (let i = 0; i < firstPosition - nextFirstPosition; i++) {\n              this.#resizersDiv.append(this.#resizersDiv.firstChild);\n            }\n          } else if (nextFirstPosition > firstPosition) {\n            for (let i = 0; i < nextFirstPosition - firstPosition; i++) {\n              this.#resizersDiv.firstChild.before(this.#resizersDiv.lastChild);\n            }\n          }\n          let i = 0;\n          for (const child of children) {\n            const div = this.#allResizerDivs[i++];\n            const name = div.getAttribute(\"data-resizer-name\");\n            AnnotationEditor._l10nPromise.get(`pdfjs-editor-resizer-label-${name}`).then(msg => child.setAttribute(\"aria-label\", msg));\n          }\n        }\n        this.#setResizerTabIndex(0);\n        this.#isResizerEnabledForKeyboard = true;\n        this.#resizersDiv.firstChild.focus({\n          focusVisible: true\n        });\n        event.preventDefault();\n        event.stopImmediatePropagation();\n      }\n      #resizerKeydown(event) {\n        AnnotationEditor._resizerKeyboardManager.exec(this, event);\n      }\n      #resizerBlur(event) {\n        if (this.#isResizerEnabledForKeyboard && event.relatedTarget?.parentNode !== this.#resizersDiv) {\n          this.#stopResizing();\n        }\n      }\n      #resizerFocus(name) {\n        this.#focusedResizerName = this.#isResizerEnabledForKeyboard ? name : \"\";\n      }\n      #setResizerTabIndex(value) {\n        if (!this.#allResizerDivs) {\n          return;\n        }\n        for (const div of this.#allResizerDivs) {\n          div.tabIndex = value;\n        }\n      }\n      _resizeWithKeyboard(x, y) {\n        if (!this.#isResizerEnabledForKeyboard) {\n          return;\n        }\n        this.#resizerPointermove(this.#focusedResizerName, {\n          movementX: x,\n          movementY: y\n        });\n      }\n      #stopResizing() {\n        this.#isResizerEnabledForKeyboard = false;\n        this.#setResizerTabIndex(-1);\n        if (this.#savedDimensions) {\n          const {\n            savedX,\n            savedY,\n            savedWidth,\n            savedHeight\n          } = this.#savedDimensions;\n          this.#addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight);\n          this.#savedDimensions = null;\n        }\n      }\n      _stopResizingWithKeyboard() {\n        this.#stopResizing();\n        this.div.focus();\n      }\n      select() {\n        this.makeResizable();\n        this.div?.classList.add(\"selectedEditor\");\n        this.addEditToolbar();\n        this.#editToolbar?.show();\n      }\n      unselect() {\n        this.#resizersDiv?.classList.add(\"hidden\");\n        this.div?.classList.remove(\"selectedEditor\");\n        if (this.div?.contains(document.activeElement)) {\n          this._uiManager.currentLayer.div.focus();\n        }\n        this.#editToolbar?.hide();\n      }\n      updateParams(type, value) {}\n      disableEditing() {\n        if (this.#altTextButton) {\n          this.#altTextButton.hidden = true;\n        }\n      }\n      enableEditing() {\n        if (this.#altTextButton) {\n          this.#altTextButton.hidden = false;\n        }\n      }\n      enterInEditMode() {}\n      getImageForAltText() {\n        return null;\n      }\n      get contentDiv() {\n        return this.div;\n      }\n      get isEditing() {\n        return this.#isEditing;\n      }\n      set isEditing(value) {\n        this.#isEditing = value;\n        if (!this.parent) {\n          return;\n        }\n        if (value) {\n          this.parent.setSelected(this);\n          this.parent.setActiveEditor(this);\n        } else {\n          this.parent.setActiveEditor(null);\n        }\n      }\n      setAspectRatio(width, height) {\n        this.#keepAspectRatio = true;\n        const aspectRatio = width / height;\n        const {\n          style\n        } = this.div;\n        style.aspectRatio = aspectRatio;\n        style.height = \"auto\";\n      }\n      static get MIN_SIZE() {\n        return 16;\n      }\n    }\n    class FakeEditor extends AnnotationEditor {\n      constructor(params) {\n        super(params);\n        this.annotationElementId = params.annotationElementId;\n        this.deleted = true;\n      }\n      serialize() {\n        return {\n          id: this.annotationElementId,\n          deleted: true,\n          pageIndex: this.pageIndex\n        };\n      }\n    }\n\n    /***/\n  },\n\n  /***/405: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */Outliner: () => /* binding */Outliner\n      /* harmony export */\n    });\n    class Outliner {\n      #box;\n      #verticalEdges = [];\n      #intervals = [];\n      constructor(boxes, borderWidth = 0, innerMargin = 0, isLTR = true) {\n        let minX = Infinity;\n        let maxX = -Infinity;\n        let minY = Infinity;\n        let maxY = -Infinity;\n        const NUMBER_OF_DIGITS = 4;\n        const EPSILON = 10 ** -NUMBER_OF_DIGITS;\n        for (const {\n          x,\n          y,\n          width,\n          height\n        } of boxes) {\n          const x1 = Math.floor((x - borderWidth) / EPSILON) * EPSILON;\n          const x2 = Math.ceil((x + width + borderWidth) / EPSILON) * EPSILON;\n          const y1 = Math.floor((y - borderWidth) / EPSILON) * EPSILON;\n          const y2 = Math.ceil((y + height + borderWidth) / EPSILON) * EPSILON;\n          const left = [x1, y1, y2, true];\n          const right = [x2, y1, y2, false];\n          this.#verticalEdges.push(left, right);\n          minX = Math.min(minX, x1);\n          maxX = Math.max(maxX, x2);\n          minY = Math.min(minY, y1);\n          maxY = Math.max(maxY, y2);\n        }\n        const bboxWidth = maxX - minX + 2 * innerMargin;\n        const bboxHeight = maxY - minY + 2 * innerMargin;\n        const shiftedMinX = minX - innerMargin;\n        const shiftedMinY = minY - innerMargin;\n        const lastEdge = this.#verticalEdges.at(isLTR ? -1 : -2);\n        const lastPoint = [lastEdge[0], lastEdge[2]];\n        for (const edge of this.#verticalEdges) {\n          const [x, y1, y2] = edge;\n          edge[0] = (x - shiftedMinX) / bboxWidth;\n          edge[1] = (y1 - shiftedMinY) / bboxHeight;\n          edge[2] = (y2 - shiftedMinY) / bboxHeight;\n        }\n        this.#box = {\n          x: shiftedMinX,\n          y: shiftedMinY,\n          width: bboxWidth,\n          height: bboxHeight,\n          lastPoint\n        };\n      }\n      getOutlines() {\n        this.#verticalEdges.sort((a, b) => a[0] - b[0] || a[1] - b[1] || a[2] - b[2]);\n        const outlineVerticalEdges = [];\n        for (const edge of this.#verticalEdges) {\n          if (edge[3]) {\n            outlineVerticalEdges.push(...this.#breakEdge(edge));\n            this.#insert(edge);\n          } else {\n            this.#remove(edge);\n            outlineVerticalEdges.push(...this.#breakEdge(edge));\n          }\n        }\n        return this.#getOutlines(outlineVerticalEdges);\n      }\n      #getOutlines(outlineVerticalEdges) {\n        const edges = [];\n        const allEdges = new Set();\n        for (const edge of outlineVerticalEdges) {\n          const [x, y1, y2] = edge;\n          edges.push([x, y1, edge], [x, y2, edge]);\n        }\n        edges.sort((a, b) => a[1] - b[1] || a[0] - b[0]);\n        for (let i = 0, ii = edges.length; i < ii; i += 2) {\n          const edge1 = edges[i][2];\n          const edge2 = edges[i + 1][2];\n          edge1.push(edge2);\n          edge2.push(edge1);\n          allEdges.add(edge1);\n          allEdges.add(edge2);\n        }\n        const outlines = [];\n        let outline;\n        while (allEdges.size > 0) {\n          const edge = allEdges.values().next().value;\n          let [x, y1, y2, edge1, edge2] = edge;\n          allEdges.delete(edge);\n          let lastPointX = x;\n          let lastPointY = y1;\n          outline = [x, y2];\n          outlines.push(outline);\n          while (true) {\n            let e;\n            if (allEdges.has(edge1)) {\n              e = edge1;\n            } else if (allEdges.has(edge2)) {\n              e = edge2;\n            } else {\n              break;\n            }\n            allEdges.delete(e);\n            [x, y1, y2, edge1, edge2] = e;\n            if (lastPointX !== x) {\n              outline.push(lastPointX, lastPointY, x, lastPointY === y1 ? y1 : y2);\n              lastPointX = x;\n            }\n            lastPointY = lastPointY === y1 ? y2 : y1;\n          }\n          outline.push(lastPointX, lastPointY);\n        }\n        return {\n          outlines,\n          box: this.#box\n        };\n      }\n      #binarySearch(y) {\n        const array = this.#intervals;\n        let start = 0;\n        let end = array.length - 1;\n        while (start <= end) {\n          const middle = start + end >> 1;\n          const y1 = array[middle][0];\n          if (y1 === y) {\n            return middle;\n          }\n          if (y1 < y) {\n            start = middle + 1;\n          } else {\n            end = middle - 1;\n          }\n        }\n        return end + 1;\n      }\n      #insert([, y1, y2]) {\n        const index = this.#binarySearch(y1);\n        this.#intervals.splice(index, 0, [y1, y2]);\n      }\n      #remove([, y1, y2]) {\n        const index = this.#binarySearch(y1);\n        for (let i = index; i < this.#intervals.length; i++) {\n          const [start, end] = this.#intervals[i];\n          if (start !== y1) {\n            break;\n          }\n          if (start === y1 && end === y2) {\n            this.#intervals.splice(i, 1);\n            return;\n          }\n        }\n        for (let i = index - 1; i >= 0; i--) {\n          const [start, end] = this.#intervals[i];\n          if (start !== y1) {\n            break;\n          }\n          if (start === y1 && end === y2) {\n            this.#intervals.splice(i, 1);\n            return;\n          }\n        }\n      }\n      #breakEdge(edge) {\n        const [x, y1, y2] = edge;\n        const results = [[x, y1, y2]];\n        const index = this.#binarySearch(y2);\n        for (let i = 0; i < index; i++) {\n          const [start, end] = this.#intervals[i];\n          for (let j = 0, jj = results.length; j < jj; j++) {\n            const [, y3, y4] = results[j];\n            if (end <= y3 || y4 <= start) {\n              continue;\n            }\n            if (y3 >= start) {\n              if (y4 > end) {\n                results[j][1] = end;\n              } else {\n                if (jj === 1) {\n                  return [];\n                }\n                results.splice(j, 1);\n                j--;\n                jj--;\n              }\n              continue;\n            }\n            results[j][2] = start;\n            if (y4 > end) {\n              results.push([x, end, y4]);\n            }\n          }\n        }\n        return results;\n      }\n    }\n\n    /***/\n  },\n\n  /***/812: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */AnnotationEditorUIManager: () => /* binding */AnnotationEditorUIManager,\n      /* harmony export */ColorManager: () => /* binding */ColorManager,\n      /* harmony export */KeyboardManager: () => /* binding */KeyboardManager,\n      /* harmony export */bindEvents: () => /* binding */bindEvents,\n      /* harmony export */opacityToHex: () => /* binding */opacityToHex\n      /* harmony export */\n    });\n    /* unused harmony export CommandManager */\n    /* harmony import */\n    var _shared_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n    /* harmony import */\n    var _display_utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(473);\n    function bindEvents(obj, element, names) {\n      for (const name of names) {\n        element.addEventListener(name, obj[name].bind(obj));\n      }\n    }\n    function opacityToHex(opacity) {\n      return Math.round(Math.min(255, Math.max(1, 255 * opacity))).toString(16).padStart(2, \"0\");\n    }\n    class IdManager {\n      #id = 0;\n      getId() {\n        return `${_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationEditorPrefix}${this.#id++}`;\n      }\n    }\n    class ImageManager {\n      #baseId = (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.getUuid)();\n      #id = 0;\n      #cache = null;\n      static get _isSVGFittingCanvas() {\n        const svg = `data:image/svg+xml;charset=UTF-8,<svg viewBox=\"0 0 1 1\" width=\"1\" height=\"1\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"1\" height=\"1\" style=\"fill:red;\"/></svg>`;\n        const canvas = new OffscreenCanvas(1, 3);\n        const ctx = canvas.getContext(\"2d\");\n        const image = new Image();\n        image.src = svg;\n        const promise = image.decode().then(() => {\n          ctx.drawImage(image, 0, 0, 1, 1, 0, 0, 1, 3);\n          return new Uint32Array(ctx.getImageData(0, 0, 1, 1).data.buffer)[0] === 0;\n        });\n        return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"_isSVGFittingCanvas\", promise);\n      }\n      async #get(key, rawData) {\n        this.#cache ||= new Map();\n        let data = this.#cache.get(key);\n        if (data === null) {\n          return null;\n        }\n        if (data?.bitmap) {\n          data.refCounter += 1;\n          return data;\n        }\n        try {\n          data ||= {\n            bitmap: null,\n            id: `image_${this.#baseId}_${this.#id++}`,\n            refCounter: 0,\n            isSvg: false\n          };\n          let image;\n          if (typeof rawData === \"string\") {\n            data.url = rawData;\n            image = await (0, _display_utils_js__WEBPACK_IMPORTED_MODULE_1__.fetchData)(rawData, \"blob\");\n          } else {\n            image = data.file = rawData;\n          }\n          if (image.type === \"image/svg+xml\") {\n            const mustRemoveAspectRatioPromise = ImageManager._isSVGFittingCanvas;\n            const fileReader = new FileReader();\n            const imageElement = new Image();\n            const imagePromise = new Promise((resolve, reject) => {\n              imageElement.onload = () => {\n                data.bitmap = imageElement;\n                data.isSvg = true;\n                resolve();\n              };\n              fileReader.onload = async () => {\n                const url = data.svgUrl = fileReader.result;\n                imageElement.src = (await mustRemoveAspectRatioPromise) ? `${url}#svgView(preserveAspectRatio(none))` : url;\n              };\n              imageElement.onerror = fileReader.onerror = reject;\n            });\n            fileReader.readAsDataURL(image);\n            await imagePromise;\n          } else {\n            data.bitmap = await createImageBitmap(image);\n          }\n          data.refCounter = 1;\n        } catch (e) {\n          console.error(e);\n          data = null;\n        }\n        this.#cache.set(key, data);\n        if (data) {\n          this.#cache.set(data.id, data);\n        }\n        return data;\n      }\n      async getFromFile(file) {\n        const {\n          lastModified,\n          name,\n          size,\n          type\n        } = file;\n        return this.#get(`${lastModified}_${name}_${size}_${type}`, file);\n      }\n      async getFromUrl(url) {\n        return this.#get(url, url);\n      }\n      async getFromId(id) {\n        this.#cache ||= new Map();\n        const data = this.#cache.get(id);\n        if (!data) {\n          return null;\n        }\n        if (data.bitmap) {\n          data.refCounter += 1;\n          return data;\n        }\n        if (data.file) {\n          return this.getFromFile(data.file);\n        }\n        return this.getFromUrl(data.url);\n      }\n      getSvgUrl(id) {\n        const data = this.#cache.get(id);\n        if (!data?.isSvg) {\n          return null;\n        }\n        return data.svgUrl;\n      }\n      deleteId(id) {\n        this.#cache ||= new Map();\n        const data = this.#cache.get(id);\n        if (!data) {\n          return;\n        }\n        data.refCounter -= 1;\n        if (data.refCounter !== 0) {\n          return;\n        }\n        data.bitmap = null;\n      }\n      isValidId(id) {\n        return id.startsWith(`image_${this.#baseId}_`);\n      }\n    }\n    class CommandManager {\n      #commands = [];\n      #locked = false;\n      #maxSize;\n      #position = -1;\n      constructor(maxSize = 128) {\n        this.#maxSize = maxSize;\n      }\n      add({\n        cmd,\n        undo,\n        mustExec,\n        type = NaN,\n        overwriteIfSameType = false,\n        keepUndo = false\n      }) {\n        if (mustExec) {\n          cmd();\n        }\n        if (this.#locked) {\n          return;\n        }\n        const save = {\n          cmd,\n          undo,\n          type\n        };\n        if (this.#position === -1) {\n          if (this.#commands.length > 0) {\n            this.#commands.length = 0;\n          }\n          this.#position = 0;\n          this.#commands.push(save);\n          return;\n        }\n        if (overwriteIfSameType && this.#commands[this.#position].type === type) {\n          if (keepUndo) {\n            save.undo = this.#commands[this.#position].undo;\n          }\n          this.#commands[this.#position] = save;\n          return;\n        }\n        const next = this.#position + 1;\n        if (next === this.#maxSize) {\n          this.#commands.splice(0, 1);\n        } else {\n          this.#position = next;\n          if (next < this.#commands.length) {\n            this.#commands.splice(next);\n          }\n        }\n        this.#commands.push(save);\n      }\n      undo() {\n        if (this.#position === -1) {\n          return;\n        }\n        this.#locked = true;\n        this.#commands[this.#position].undo();\n        this.#locked = false;\n        this.#position -= 1;\n      }\n      redo() {\n        if (this.#position < this.#commands.length - 1) {\n          this.#position += 1;\n          this.#locked = true;\n          this.#commands[this.#position].cmd();\n          this.#locked = false;\n        }\n      }\n      hasSomethingToUndo() {\n        return this.#position !== -1;\n      }\n      hasSomethingToRedo() {\n        return this.#position < this.#commands.length - 1;\n      }\n      destroy() {\n        this.#commands = null;\n      }\n    }\n    class KeyboardManager {\n      constructor(callbacks) {\n        this.buffer = [];\n        this.callbacks = new Map();\n        this.allKeys = new Set();\n        const {\n          isMac\n        } = _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.FeatureTest.platform;\n        for (const [keys, callback, options = {}] of callbacks) {\n          for (const key of keys) {\n            const isMacKey = key.startsWith(\"mac+\");\n            if (isMac && isMacKey) {\n              this.callbacks.set(key.slice(4), {\n                callback,\n                options\n              });\n              this.allKeys.add(key.split(\"+\").at(-1));\n            } else if (!isMac && !isMacKey) {\n              this.callbacks.set(key, {\n                callback,\n                options\n              });\n              this.allKeys.add(key.split(\"+\").at(-1));\n            }\n          }\n        }\n      }\n      #serialize(event) {\n        if (event.altKey) {\n          this.buffer.push(\"alt\");\n        }\n        if (event.ctrlKey) {\n          this.buffer.push(\"ctrl\");\n        }\n        if (event.metaKey) {\n          this.buffer.push(\"meta\");\n        }\n        if (event.shiftKey) {\n          this.buffer.push(\"shift\");\n        }\n        this.buffer.push(event.key);\n        const str = this.buffer.join(\"+\");\n        this.buffer.length = 0;\n        return str;\n      }\n      exec(self, event) {\n        if (!this.allKeys.has(event.key)) {\n          return;\n        }\n        const info = this.callbacks.get(this.#serialize(event));\n        if (!info) {\n          return;\n        }\n        const {\n          callback,\n          options: {\n            bubbles = false,\n            args = [],\n            checker = null\n          }\n        } = info;\n        if (checker && !checker(self, event)) {\n          return;\n        }\n        callback.bind(self, ...args)();\n        if (!bubbles) {\n          event.stopPropagation();\n          event.preventDefault();\n        }\n      }\n    }\n    class ColorManager {\n      static _colorsMapping = new Map([[\"CanvasText\", [0, 0, 0]], [\"Canvas\", [255, 255, 255]]]);\n      get _colors() {\n        const colors = new Map([[\"CanvasText\", null], [\"Canvas\", null]]);\n        (0, _display_utils_js__WEBPACK_IMPORTED_MODULE_1__.getColorValues)(colors);\n        return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"_colors\", colors);\n      }\n      convert(color) {\n        const rgb = (0, _display_utils_js__WEBPACK_IMPORTED_MODULE_1__.getRGB)(color);\n        if (!window.matchMedia(\"(forced-colors: active)\").matches) {\n          return rgb;\n        }\n        for (const [name, RGB] of this._colors) {\n          if (RGB.every((x, i) => x === rgb[i])) {\n            return ColorManager._colorsMapping.get(name);\n          }\n        }\n        return rgb;\n      }\n      getHexCode(name) {\n        const rgb = this._colors.get(name);\n        if (!rgb) {\n          return name;\n        }\n        return _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.Util.makeHexColor(...rgb);\n      }\n    }\n    class AnnotationEditorUIManager {\n      #activeEditor = null;\n      #allEditors = new Map();\n      #allLayers = new Map();\n      #altTextManager = null;\n      #annotationStorage = null;\n      #commandManager = new CommandManager();\n      #currentPageIndex = 0;\n      #deletedAnnotationsElementIds = new Set();\n      #draggingEditors = null;\n      #editorTypes = null;\n      #editorsToRescale = new Set();\n      #filterFactory = null;\n      #focusMainContainerTimeoutId = null;\n      #idManager = new IdManager();\n      #isEnabled = false;\n      #isWaiting = false;\n      #lastActiveElement = null;\n      #mode = _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationEditorType.NONE;\n      #selectedEditors = new Set();\n      #pageColors = null;\n      #boundBlur = this.blur.bind(this);\n      #boundFocus = this.focus.bind(this);\n      #boundCopy = this.copy.bind(this);\n      #boundCut = this.cut.bind(this);\n      #boundPaste = this.paste.bind(this);\n      #boundKeydown = this.keydown.bind(this);\n      #boundOnEditingAction = this.onEditingAction.bind(this);\n      #boundOnPageChanging = this.onPageChanging.bind(this);\n      #boundOnScaleChanging = this.onScaleChanging.bind(this);\n      #boundOnRotationChanging = this.onRotationChanging.bind(this);\n      #previousStates = {\n        isEditing: false,\n        isEmpty: true,\n        hasSomethingToUndo: false,\n        hasSomethingToRedo: false,\n        hasSelectedEditor: false\n      };\n      #translation = [0, 0];\n      #translationTimeoutId = null;\n      #container = null;\n      #viewer = null;\n      static TRANSLATE_SMALL = 1;\n      static TRANSLATE_BIG = 10;\n      static get _keyboardManager() {\n        const proto = AnnotationEditorUIManager.prototype;\n        const arrowChecker = self => {\n          return self.#container.contains(document.activeElement) && self.hasSomethingToControl();\n        };\n        const textInputChecker = (_self, {\n          target: el\n        }) => {\n          if (el instanceof HTMLInputElement) {\n            const {\n              type\n            } = el;\n            return type !== \"text\" && type !== \"number\";\n          }\n          return true;\n        };\n        const small = this.TRANSLATE_SMALL;\n        const big = this.TRANSLATE_BIG;\n        return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"_keyboardManager\", new KeyboardManager([[[\"ctrl+a\", \"mac+meta+a\"], proto.selectAll, {\n          checker: textInputChecker\n        }], [[\"ctrl+z\", \"mac+meta+z\"], proto.undo, {\n          checker: textInputChecker\n        }], [[\"ctrl+y\", \"ctrl+shift+z\", \"mac+meta+shift+z\", \"ctrl+shift+Z\", \"mac+meta+shift+Z\"], proto.redo, {\n          checker: textInputChecker\n        }], [[\"Backspace\", \"alt+Backspace\", \"ctrl+Backspace\", \"shift+Backspace\", \"mac+Backspace\", \"mac+alt+Backspace\", \"mac+ctrl+Backspace\", \"Delete\", \"ctrl+Delete\", \"shift+Delete\", \"mac+Delete\"], proto.delete, {\n          checker: textInputChecker\n        }], [[\"Enter\", \"mac+Enter\"], proto.addNewEditorFromKeyboard, {\n          checker: (self, {\n            target: el\n          }) => !(el instanceof HTMLButtonElement) && self.#container.contains(el) && !self.isEnterHandled\n        }], [[\" \", \"mac+ \"], proto.addNewEditorFromKeyboard, {\n          checker: self => self.#container.contains(document.activeElement)\n        }], [[\"Escape\", \"mac+Escape\"], proto.unselectAll], [[\"ArrowLeft\", \"mac+ArrowLeft\"], proto.translateSelectedEditors, {\n          args: [-small, 0],\n          checker: arrowChecker\n        }], [[\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"], proto.translateSelectedEditors, {\n          args: [-big, 0],\n          checker: arrowChecker\n        }], [[\"ArrowRight\", \"mac+ArrowRight\"], proto.translateSelectedEditors, {\n          args: [small, 0],\n          checker: arrowChecker\n        }], [[\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"], proto.translateSelectedEditors, {\n          args: [big, 0],\n          checker: arrowChecker\n        }], [[\"ArrowUp\", \"mac+ArrowUp\"], proto.translateSelectedEditors, {\n          args: [0, -small],\n          checker: arrowChecker\n        }], [[\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"], proto.translateSelectedEditors, {\n          args: [0, -big],\n          checker: arrowChecker\n        }], [[\"ArrowDown\", \"mac+ArrowDown\"], proto.translateSelectedEditors, {\n          args: [0, small],\n          checker: arrowChecker\n        }], [[\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"], proto.translateSelectedEditors, {\n          args: [0, big],\n          checker: arrowChecker\n        }]]));\n      }\n      constructor(container, viewer, altTextManager, eventBus, pdfDocument, pageColors) {\n        this.#container = container;\n        this.#viewer = viewer;\n        this.#altTextManager = altTextManager;\n        this._eventBus = eventBus;\n        this._eventBus._on(\"editingaction\", this.#boundOnEditingAction);\n        this._eventBus._on(\"pagechanging\", this.#boundOnPageChanging);\n        this._eventBus._on(\"scalechanging\", this.#boundOnScaleChanging);\n        this._eventBus._on(\"rotationchanging\", this.#boundOnRotationChanging);\n        this.#annotationStorage = pdfDocument.annotationStorage;\n        this.#filterFactory = pdfDocument.filterFactory;\n        this.#pageColors = pageColors;\n        this.viewParameters = {\n          realScale: _display_utils_js__WEBPACK_IMPORTED_MODULE_1__.PixelsPerInch.PDF_TO_CSS_UNITS,\n          rotation: 0\n        };\n      }\n      destroy() {\n        this.#removeKeyboardManager();\n        this.#removeFocusManager();\n        this._eventBus._off(\"editingaction\", this.#boundOnEditingAction);\n        this._eventBus._off(\"pagechanging\", this.#boundOnPageChanging);\n        this._eventBus._off(\"scalechanging\", this.#boundOnScaleChanging);\n        this._eventBus._off(\"rotationchanging\", this.#boundOnRotationChanging);\n        for (const layer of this.#allLayers.values()) {\n          layer.destroy();\n        }\n        this.#allLayers.clear();\n        this.#allEditors.clear();\n        this.#editorsToRescale.clear();\n        this.#activeEditor = null;\n        this.#selectedEditors.clear();\n        this.#commandManager.destroy();\n        this.#altTextManager.destroy();\n        if (this.#focusMainContainerTimeoutId) {\n          clearTimeout(this.#focusMainContainerTimeoutId);\n          this.#focusMainContainerTimeoutId = null;\n        }\n        if (this.#translationTimeoutId) {\n          clearTimeout(this.#translationTimeoutId);\n          this.#translationTimeoutId = null;\n        }\n      }\n      get hcmFilter() {\n        return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"hcmFilter\", this.#pageColors ? this.#filterFactory.addHCMFilter(this.#pageColors.foreground, this.#pageColors.background) : \"none\");\n      }\n      get direction() {\n        return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"direction\", getComputedStyle(this.#container).direction);\n      }\n      editAltText(editor) {\n        this.#altTextManager?.editAltText(this, editor);\n      }\n      onPageChanging({\n        pageNumber\n      }) {\n        this.#currentPageIndex = pageNumber - 1;\n      }\n      focusMainContainer() {\n        this.#container.focus();\n      }\n      findParent(x, y) {\n        for (const layer of this.#allLayers.values()) {\n          const {\n            x: layerX,\n            y: layerY,\n            width,\n            height\n          } = layer.div.getBoundingClientRect();\n          if (x >= layerX && x <= layerX + width && y >= layerY && y <= layerY + height) {\n            return layer;\n          }\n        }\n        return null;\n      }\n      disableUserSelect(value = false) {\n        this.#viewer.classList.toggle(\"noUserSelect\", value);\n      }\n      addShouldRescale(editor) {\n        this.#editorsToRescale.add(editor);\n      }\n      removeShouldRescale(editor) {\n        this.#editorsToRescale.delete(editor);\n      }\n      onScaleChanging({\n        scale\n      }) {\n        this.commitOrRemove();\n        this.viewParameters.realScale = scale * _display_utils_js__WEBPACK_IMPORTED_MODULE_1__.PixelsPerInch.PDF_TO_CSS_UNITS;\n        for (const editor of this.#editorsToRescale) {\n          editor.onScaleChanging();\n        }\n      }\n      onRotationChanging({\n        pagesRotation\n      }) {\n        this.commitOrRemove();\n        this.viewParameters.rotation = pagesRotation;\n      }\n      addToAnnotationStorage(editor) {\n        if (!editor.isEmpty() && this.#annotationStorage && !this.#annotationStorage.has(editor.id)) {\n          this.#annotationStorage.setValue(editor.id, editor);\n        }\n      }\n      #addFocusManager() {\n        window.addEventListener(\"focus\", this.#boundFocus);\n        window.addEventListener(\"blur\", this.#boundBlur);\n      }\n      #removeFocusManager() {\n        window.removeEventListener(\"focus\", this.#boundFocus);\n        window.removeEventListener(\"blur\", this.#boundBlur);\n      }\n      blur() {\n        if (!this.hasSelection) {\n          return;\n        }\n        const {\n          activeElement\n        } = document;\n        for (const editor of this.#selectedEditors) {\n          if (editor.div.contains(activeElement)) {\n            this.#lastActiveElement = [editor, activeElement];\n            editor._focusEventsAllowed = false;\n            break;\n          }\n        }\n      }\n      focus() {\n        if (!this.#lastActiveElement) {\n          return;\n        }\n        const [lastEditor, lastActiveElement] = this.#lastActiveElement;\n        this.#lastActiveElement = null;\n        lastActiveElement.addEventListener(\"focusin\", () => {\n          lastEditor._focusEventsAllowed = true;\n        }, {\n          once: true\n        });\n        lastActiveElement.focus();\n      }\n      #addKeyboardManager() {\n        window.addEventListener(\"keydown\", this.#boundKeydown);\n      }\n      #removeKeyboardManager() {\n        window.removeEventListener(\"keydown\", this.#boundKeydown);\n      }\n      #addCopyPasteListeners() {\n        document.addEventListener(\"copy\", this.#boundCopy);\n        document.addEventListener(\"cut\", this.#boundCut);\n        document.addEventListener(\"paste\", this.#boundPaste);\n      }\n      #removeCopyPasteListeners() {\n        document.removeEventListener(\"copy\", this.#boundCopy);\n        document.removeEventListener(\"cut\", this.#boundCut);\n        document.removeEventListener(\"paste\", this.#boundPaste);\n      }\n      addEditListeners() {\n        this.#addKeyboardManager();\n        this.#addCopyPasteListeners();\n      }\n      removeEditListeners() {\n        this.#removeKeyboardManager();\n        this.#removeCopyPasteListeners();\n      }\n      copy(event) {\n        event.preventDefault();\n        this.#activeEditor?.commitOrRemove();\n        if (!this.hasSelection) {\n          return;\n        }\n        const editors = [];\n        for (const editor of this.#selectedEditors) {\n          const serialized = editor.serialize(true);\n          if (serialized) {\n            editors.push(serialized);\n          }\n        }\n        if (editors.length === 0) {\n          return;\n        }\n        event.clipboardData.setData(\"application/pdfjs\", JSON.stringify(editors));\n      }\n      cut(event) {\n        this.copy(event);\n        this.delete();\n      }\n      paste(event) {\n        event.preventDefault();\n        const {\n          clipboardData\n        } = event;\n        for (const item of clipboardData.items) {\n          for (const editorType of this.#editorTypes) {\n            if (editorType.isHandlingMimeForPasting(item.type)) {\n              editorType.paste(item, this.currentLayer);\n              return;\n            }\n          }\n        }\n        let data = clipboardData.getData(\"application/pdfjs\");\n        if (!data) {\n          return;\n        }\n        try {\n          data = JSON.parse(data);\n        } catch (ex) {\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`paste: \"${ex.message}\".`);\n          return;\n        }\n        if (!Array.isArray(data)) {\n          return;\n        }\n        this.unselectAll();\n        const layer = this.currentLayer;\n        try {\n          const newEditors = [];\n          for (const editor of data) {\n            const deserializedEditor = layer.deserialize(editor);\n            if (!deserializedEditor) {\n              return;\n            }\n            newEditors.push(deserializedEditor);\n          }\n          const cmd = () => {\n            for (const editor of newEditors) {\n              this.#addEditorToLayer(editor);\n            }\n            this.#selectEditors(newEditors);\n          };\n          const undo = () => {\n            for (const editor of newEditors) {\n              editor.remove();\n            }\n          };\n          this.addCommands({\n            cmd,\n            undo,\n            mustExec: true\n          });\n        } catch (ex) {\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`paste: \"${ex.message}\".`);\n        }\n      }\n      keydown(event) {\n        if (!this.isEditorHandlingKeyboard) {\n          AnnotationEditorUIManager._keyboardManager.exec(this, event);\n        }\n      }\n      onEditingAction(details) {\n        if ([\"undo\", \"redo\", \"delete\", \"selectAll\"].includes(details.name)) {\n          this[details.name]();\n        }\n      }\n      #dispatchUpdateStates(details) {\n        const hasChanged = Object.entries(details).some(([key, value]) => this.#previousStates[key] !== value);\n        if (hasChanged) {\n          this._eventBus.dispatch(\"annotationeditorstateschanged\", {\n            source: this,\n            details: Object.assign(this.#previousStates, details)\n          });\n        }\n      }\n      #dispatchUpdateUI(details) {\n        this._eventBus.dispatch(\"annotationeditorparamschanged\", {\n          source: this,\n          details\n        });\n      }\n      setEditingState(isEditing) {\n        if (isEditing) {\n          this.#addFocusManager();\n          this.#addKeyboardManager();\n          this.#addCopyPasteListeners();\n          this.#dispatchUpdateStates({\n            isEditing: this.#mode !== _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationEditorType.NONE,\n            isEmpty: this.#isEmpty(),\n            hasSomethingToUndo: this.#commandManager.hasSomethingToUndo(),\n            hasSomethingToRedo: this.#commandManager.hasSomethingToRedo(),\n            hasSelectedEditor: false\n          });\n        } else {\n          this.#removeFocusManager();\n          this.#removeKeyboardManager();\n          this.#removeCopyPasteListeners();\n          this.#dispatchUpdateStates({\n            isEditing: false\n          });\n          this.disableUserSelect(false);\n        }\n      }\n      registerEditorTypes(types) {\n        if (this.#editorTypes) {\n          return;\n        }\n        this.#editorTypes = types;\n        for (const editorType of this.#editorTypes) {\n          this.#dispatchUpdateUI(editorType.defaultPropertiesToUpdate);\n        }\n      }\n      getId() {\n        return this.#idManager.getId();\n      }\n      get currentLayer() {\n        return this.#allLayers.get(this.#currentPageIndex);\n      }\n      getLayer(pageIndex) {\n        return this.#allLayers.get(pageIndex);\n      }\n      get currentPageIndex() {\n        return this.#currentPageIndex;\n      }\n      addLayer(layer) {\n        this.#allLayers.set(layer.pageIndex, layer);\n        if (this.#isEnabled) {\n          layer.enable();\n        } else {\n          layer.disable();\n        }\n      }\n      removeLayer(layer) {\n        this.#allLayers.delete(layer.pageIndex);\n      }\n      updateMode(mode, editId = null, isFromKeyboard = false) {\n        if (this.#mode === mode) {\n          return;\n        }\n        this.#mode = mode;\n        if (mode === _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationEditorType.NONE) {\n          this.setEditingState(false);\n          this.#disableAll();\n          return;\n        }\n        this.setEditingState(true);\n        this.#enableAll();\n        this.unselectAll();\n        for (const layer of this.#allLayers.values()) {\n          layer.updateMode(mode);\n        }\n        if (!editId && isFromKeyboard) {\n          this.addNewEditorFromKeyboard();\n          return;\n        }\n        if (!editId) {\n          return;\n        }\n        for (const editor of this.#allEditors.values()) {\n          if (editor.annotationElementId === editId) {\n            this.setSelected(editor);\n            editor.enterInEditMode();\n            break;\n          }\n        }\n      }\n      addNewEditorFromKeyboard() {\n        this.currentLayer.addNewEditor();\n      }\n      updateToolbar(mode) {\n        if (mode === this.#mode) {\n          return;\n        }\n        this._eventBus.dispatch(\"switchannotationeditormode\", {\n          source: this,\n          mode\n        });\n      }\n      updateParams(type, value) {\n        if (!this.#editorTypes) {\n          return;\n        }\n        if (type === _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationEditorParamsType.CREATE) {\n          this.currentLayer.addNewEditor();\n          return;\n        }\n        for (const editor of this.#selectedEditors) {\n          editor.updateParams(type, value);\n        }\n        for (const editorType of this.#editorTypes) {\n          editorType.updateDefaultParams(type, value);\n        }\n      }\n      enableWaiting(mustWait = false) {\n        if (this.#isWaiting === mustWait) {\n          return;\n        }\n        this.#isWaiting = mustWait;\n        for (const layer of this.#allLayers.values()) {\n          if (mustWait) {\n            layer.disableClick();\n          } else {\n            layer.enableClick();\n          }\n          layer.div.classList.toggle(\"waiting\", mustWait);\n        }\n      }\n      #enableAll() {\n        if (!this.#isEnabled) {\n          this.#isEnabled = true;\n          for (const layer of this.#allLayers.values()) {\n            layer.enable();\n          }\n        }\n      }\n      #disableAll() {\n        this.unselectAll();\n        if (this.#isEnabled) {\n          this.#isEnabled = false;\n          for (const layer of this.#allLayers.values()) {\n            layer.disable();\n          }\n        }\n      }\n      getEditors(pageIndex) {\n        const editors = [];\n        for (const editor of this.#allEditors.values()) {\n          if (editor.pageIndex === pageIndex) {\n            editors.push(editor);\n          }\n        }\n        return editors;\n      }\n      getEditor(id) {\n        return this.#allEditors.get(id);\n      }\n      addEditor(editor) {\n        this.#allEditors.set(editor.id, editor);\n      }\n      removeEditor(editor) {\n        if (editor.div.contains(document.activeElement)) {\n          if (this.#focusMainContainerTimeoutId) {\n            clearTimeout(this.#focusMainContainerTimeoutId);\n          }\n          this.#focusMainContainerTimeoutId = setTimeout(() => {\n            this.focusMainContainer();\n            this.#focusMainContainerTimeoutId = null;\n          }, 0);\n        }\n        this.#allEditors.delete(editor.id);\n        this.unselect(editor);\n        if (!editor.annotationElementId || !this.#deletedAnnotationsElementIds.has(editor.annotationElementId)) {\n          this.#annotationStorage?.remove(editor.id);\n        }\n      }\n      addDeletedAnnotationElement(editor) {\n        this.#deletedAnnotationsElementIds.add(editor.annotationElementId);\n        editor.deleted = true;\n      }\n      isDeletedAnnotationElement(annotationElementId) {\n        return this.#deletedAnnotationsElementIds.has(annotationElementId);\n      }\n      removeDeletedAnnotationElement(editor) {\n        this.#deletedAnnotationsElementIds.delete(editor.annotationElementId);\n        editor.deleted = false;\n      }\n      #addEditorToLayer(editor) {\n        const layer = this.#allLayers.get(editor.pageIndex);\n        if (layer) {\n          layer.addOrRebuild(editor);\n        } else {\n          this.addEditor(editor);\n        }\n      }\n      setActiveEditor(editor) {\n        if (this.#activeEditor === editor) {\n          return;\n        }\n        this.#activeEditor = editor;\n        if (editor) {\n          this.#dispatchUpdateUI(editor.propertiesToUpdate);\n        }\n      }\n      toggleSelected(editor) {\n        if (this.#selectedEditors.has(editor)) {\n          this.#selectedEditors.delete(editor);\n          editor.unselect();\n          this.#dispatchUpdateStates({\n            hasSelectedEditor: this.hasSelection\n          });\n          return;\n        }\n        this.#selectedEditors.add(editor);\n        editor.select();\n        this.#dispatchUpdateUI(editor.propertiesToUpdate);\n        this.#dispatchUpdateStates({\n          hasSelectedEditor: true\n        });\n      }\n      setSelected(editor) {\n        for (const ed of this.#selectedEditors) {\n          if (ed !== editor) {\n            ed.unselect();\n          }\n        }\n        this.#selectedEditors.clear();\n        this.#selectedEditors.add(editor);\n        editor.select();\n        this.#dispatchUpdateUI(editor.propertiesToUpdate);\n        this.#dispatchUpdateStates({\n          hasSelectedEditor: true\n        });\n      }\n      isSelected(editor) {\n        return this.#selectedEditors.has(editor);\n      }\n      get firstSelectedEditor() {\n        return this.#selectedEditors.values().next().value;\n      }\n      unselect(editor) {\n        editor.unselect();\n        this.#selectedEditors.delete(editor);\n        this.#dispatchUpdateStates({\n          hasSelectedEditor: this.hasSelection\n        });\n      }\n      get hasSelection() {\n        return this.#selectedEditors.size !== 0;\n      }\n      get isEnterHandled() {\n        return this.#selectedEditors.size === 1 && this.firstSelectedEditor.isEnterHandled;\n      }\n      undo() {\n        this.#commandManager.undo();\n        this.#dispatchUpdateStates({\n          hasSomethingToUndo: this.#commandManager.hasSomethingToUndo(),\n          hasSomethingToRedo: true,\n          isEmpty: this.#isEmpty()\n        });\n      }\n      redo() {\n        this.#commandManager.redo();\n        this.#dispatchUpdateStates({\n          hasSomethingToUndo: true,\n          hasSomethingToRedo: this.#commandManager.hasSomethingToRedo(),\n          isEmpty: this.#isEmpty()\n        });\n      }\n      addCommands(params) {\n        this.#commandManager.add(params);\n        this.#dispatchUpdateStates({\n          hasSomethingToUndo: true,\n          hasSomethingToRedo: false,\n          isEmpty: this.#isEmpty()\n        });\n      }\n      #isEmpty() {\n        if (this.#allEditors.size === 0) {\n          return true;\n        }\n        if (this.#allEditors.size === 1) {\n          for (const editor of this.#allEditors.values()) {\n            return editor.isEmpty();\n          }\n        }\n        return false;\n      }\n      delete() {\n        this.commitOrRemove();\n        if (!this.hasSelection) {\n          return;\n        }\n        const editors = [...this.#selectedEditors];\n        const cmd = () => {\n          for (const editor of editors) {\n            editor.remove();\n          }\n        };\n        const undo = () => {\n          for (const editor of editors) {\n            this.#addEditorToLayer(editor);\n          }\n        };\n        this.addCommands({\n          cmd,\n          undo,\n          mustExec: true\n        });\n      }\n      commitOrRemove() {\n        this.#activeEditor?.commitOrRemove();\n      }\n      hasSomethingToControl() {\n        return this.#activeEditor || this.hasSelection;\n      }\n      #selectEditors(editors) {\n        this.#selectedEditors.clear();\n        for (const editor of editors) {\n          if (editor.isEmpty()) {\n            continue;\n          }\n          this.#selectedEditors.add(editor);\n          editor.select();\n        }\n        this.#dispatchUpdateStates({\n          hasSelectedEditor: true\n        });\n      }\n      selectAll() {\n        for (const editor of this.#selectedEditors) {\n          editor.commit();\n        }\n        this.#selectEditors(this.#allEditors.values());\n      }\n      unselectAll() {\n        if (this.#activeEditor) {\n          this.#activeEditor.commitOrRemove();\n          return;\n        }\n        if (!this.hasSelection) {\n          return;\n        }\n        for (const editor of this.#selectedEditors) {\n          editor.unselect();\n        }\n        this.#selectedEditors.clear();\n        this.#dispatchUpdateStates({\n          hasSelectedEditor: false\n        });\n      }\n      translateSelectedEditors(x, y, noCommit = false) {\n        if (!noCommit) {\n          this.commitOrRemove();\n        }\n        if (!this.hasSelection) {\n          return;\n        }\n        this.#translation[0] += x;\n        this.#translation[1] += y;\n        const [totalX, totalY] = this.#translation;\n        const editors = [...this.#selectedEditors];\n        const TIME_TO_WAIT = 1000;\n        if (this.#translationTimeoutId) {\n          clearTimeout(this.#translationTimeoutId);\n        }\n        this.#translationTimeoutId = setTimeout(() => {\n          this.#translationTimeoutId = null;\n          this.#translation[0] = this.#translation[1] = 0;\n          this.addCommands({\n            cmd: () => {\n              for (const editor of editors) {\n                if (this.#allEditors.has(editor.id)) {\n                  editor.translateInPage(totalX, totalY);\n                }\n              }\n            },\n            undo: () => {\n              for (const editor of editors) {\n                if (this.#allEditors.has(editor.id)) {\n                  editor.translateInPage(-totalX, -totalY);\n                }\n              }\n            },\n            mustExec: false\n          });\n        }, TIME_TO_WAIT);\n        for (const editor of editors) {\n          editor.translateInPage(x, y);\n        }\n      }\n      setUpDragSession() {\n        if (!this.hasSelection) {\n          return;\n        }\n        this.disableUserSelect(true);\n        this.#draggingEditors = new Map();\n        for (const editor of this.#selectedEditors) {\n          this.#draggingEditors.set(editor, {\n            savedX: editor.x,\n            savedY: editor.y,\n            savedPageIndex: editor.pageIndex,\n            newX: 0,\n            newY: 0,\n            newPageIndex: -1\n          });\n        }\n      }\n      endDragSession() {\n        if (!this.#draggingEditors) {\n          return false;\n        }\n        this.disableUserSelect(false);\n        const map = this.#draggingEditors;\n        this.#draggingEditors = null;\n        let mustBeAddedInUndoStack = false;\n        for (const [{\n          x,\n          y,\n          pageIndex\n        }, value] of map) {\n          value.newX = x;\n          value.newY = y;\n          value.newPageIndex = pageIndex;\n          mustBeAddedInUndoStack ||= x !== value.savedX || y !== value.savedY || pageIndex !== value.savedPageIndex;\n        }\n        if (!mustBeAddedInUndoStack) {\n          return false;\n        }\n        const move = (editor, x, y, pageIndex) => {\n          if (this.#allEditors.has(editor.id)) {\n            const parent = this.#allLayers.get(pageIndex);\n            if (parent) {\n              editor._setParentAndPosition(parent, x, y);\n            } else {\n              editor.pageIndex = pageIndex;\n              editor.x = x;\n              editor.y = y;\n            }\n          }\n        };\n        this.addCommands({\n          cmd: () => {\n            for (const [editor, {\n              newX,\n              newY,\n              newPageIndex\n            }] of map) {\n              move(editor, newX, newY, newPageIndex);\n            }\n          },\n          undo: () => {\n            for (const [editor, {\n              savedX,\n              savedY,\n              savedPageIndex\n            }] of map) {\n              move(editor, savedX, savedY, savedPageIndex);\n            }\n          },\n          mustExec: true\n        });\n        return true;\n      }\n      dragSelectedEditors(tx, ty) {\n        if (!this.#draggingEditors) {\n          return;\n        }\n        for (const editor of this.#draggingEditors.keys()) {\n          editor.drag(tx, ty);\n        }\n      }\n      rebuild(editor) {\n        if (editor.parent === null) {\n          const parent = this.getLayer(editor.pageIndex);\n          if (parent) {\n            parent.changeParent(editor);\n            parent.addOrRebuild(editor);\n          } else {\n            this.addEditor(editor);\n            this.addToAnnotationStorage(editor);\n            editor.rebuild();\n          }\n        } else {\n          editor.parent.addOrRebuild(editor);\n        }\n      }\n      get isEditorHandlingKeyboard() {\n        return this.getActive()?.shouldGetKeyboardEvents() || this.#selectedEditors.size === 1 && this.firstSelectedEditor.shouldGetKeyboardEvents();\n      }\n      isActive(editor) {\n        return this.#activeEditor === editor;\n      }\n      getActive() {\n        return this.#activeEditor;\n      }\n      getMode() {\n        return this.#mode;\n      }\n      get imageManager() {\n        return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"imageManager\", new ImageManager());\n      }\n    }\n\n    /***/\n  },\n\n  /***/171: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */PDFFetchStream: () => /* binding */PDFFetchStream\n      /* harmony export */\n    });\n    /* harmony import */\n    var _shared_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n    /* harmony import */\n    var _network_utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(253);\n    ;\n    function createFetchOptions(headers, withCredentials, abortController) {\n      return {\n        method: \"GET\",\n        headers,\n        signal: abortController.signal,\n        mode: \"cors\",\n        credentials: withCredentials ? \"include\" : \"same-origin\",\n        redirect: \"follow\"\n      };\n    }\n    function createHeaders(httpHeaders) {\n      const headers = new Headers();\n      for (const property in httpHeaders) {\n        const value = httpHeaders[property];\n        if (value === undefined) {\n          continue;\n        }\n        headers.append(property, value);\n      }\n      return headers;\n    }\n    function getArrayBuffer(val) {\n      if (val instanceof Uint8Array) {\n        return val.buffer;\n      }\n      if (val instanceof ArrayBuffer) {\n        return val;\n      }\n      (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`getArrayBuffer - unexpected data format: ${val}`);\n      return new Uint8Array(val).buffer;\n    }\n    class PDFFetchStream {\n      constructor(source) {\n        this.source = source;\n        this.isHttp = /^https?:/i.test(source.url);\n        this.httpHeaders = this.isHttp && source.httpHeaders || {};\n        this._fullRequestReader = null;\n        this._rangeRequestReaders = [];\n      }\n      get _progressiveDataLength() {\n        return this._fullRequestReader?._loaded ?? 0;\n      }\n      getFullReader() {\n        (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(!this._fullRequestReader, \"PDFFetchStream.getFullReader can only be called once.\");\n        this._fullRequestReader = new PDFFetchStreamReader(this);\n        return this._fullRequestReader;\n      }\n      getRangeReader(begin, end) {\n        if (end <= this._progressiveDataLength) {\n          return null;\n        }\n        const reader = new PDFFetchStreamRangeReader(this, begin, end);\n        this._rangeRequestReaders.push(reader);\n        return reader;\n      }\n      cancelAllRequests(reason) {\n        this._fullRequestReader?.cancel(reason);\n        for (const reader of this._rangeRequestReaders.slice(0)) {\n          reader.cancel(reason);\n        }\n      }\n    }\n    class PDFFetchStreamReader {\n      constructor(stream) {\n        this._stream = stream;\n        this._reader = null;\n        this._loaded = 0;\n        this._filename = null;\n        const source = stream.source;\n        this._withCredentials = source.withCredentials || false;\n        this._contentLength = source.length;\n        this._headersCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n        this._disableRange = source.disableRange || false;\n        this._rangeChunkSize = source.rangeChunkSize;\n        if (!this._rangeChunkSize && !this._disableRange) {\n          this._disableRange = true;\n        }\n        this._abortController = new AbortController();\n        this._isStreamingSupported = !source.disableStream;\n        this._isRangeSupported = !source.disableRange;\n        this._headers = createHeaders(this._stream.httpHeaders);\n        const url = source.url;\n        fetch(url, createFetchOptions(this._headers, this._withCredentials, this._abortController)).then(response => {\n          if (!(0, _network_utils_js__WEBPACK_IMPORTED_MODULE_1__.validateResponseStatus)(response.status)) {\n            throw (0, _network_utils_js__WEBPACK_IMPORTED_MODULE_1__.createResponseStatusError)(response.status, url);\n          }\n          this._reader = response.body.getReader();\n          this._headersCapability.resolve();\n          const getResponseHeader = name => {\n            return response.headers.get(name);\n          };\n          const {\n            allowRangeRequests,\n            suggestedLength\n          } = (0, _network_utils_js__WEBPACK_IMPORTED_MODULE_1__.validateRangeRequestCapabilities)({\n            getResponseHeader,\n            isHttp: this._stream.isHttp,\n            rangeChunkSize: this._rangeChunkSize,\n            disableRange: this._disableRange\n          });\n          this._isRangeSupported = allowRangeRequests;\n          this._contentLength = suggestedLength || this._contentLength;\n          this._filename = (0, _network_utils_js__WEBPACK_IMPORTED_MODULE_1__.extractFilenameFromHeader)(getResponseHeader);\n          if (!this._isStreamingSupported && this._isRangeSupported) {\n            this.cancel(new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AbortException(\"Streaming is disabled.\"));\n          }\n        }).catch(this._headersCapability.reject);\n        this.onProgress = null;\n      }\n      get headersReady() {\n        return this._headersCapability.promise;\n      }\n      get filename() {\n        return this._filename;\n      }\n      get contentLength() {\n        return this._contentLength;\n      }\n      get isRangeSupported() {\n        return this._isRangeSupported;\n      }\n      get isStreamingSupported() {\n        return this._isStreamingSupported;\n      }\n      async read() {\n        await this._headersCapability.promise;\n        const {\n          value,\n          done\n        } = await this._reader.read();\n        if (done) {\n          return {\n            value,\n            done\n          };\n        }\n        this._loaded += value.byteLength;\n        this.onProgress?.({\n          loaded: this._loaded,\n          total: this._contentLength\n        });\n        return {\n          value: getArrayBuffer(value),\n          done: false\n        };\n      }\n      cancel(reason) {\n        this._reader?.cancel(reason);\n        this._abortController.abort();\n      }\n    }\n    class PDFFetchStreamRangeReader {\n      constructor(stream, begin, end) {\n        this._stream = stream;\n        this._reader = null;\n        this._loaded = 0;\n        const source = stream.source;\n        this._withCredentials = source.withCredentials || false;\n        this._readCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n        this._isStreamingSupported = !source.disableStream;\n        this._abortController = new AbortController();\n        this._headers = createHeaders(this._stream.httpHeaders);\n        this._headers.append(\"Range\", `bytes=${begin}-${end - 1}`);\n        const url = source.url;\n        fetch(url, createFetchOptions(this._headers, this._withCredentials, this._abortController)).then(response => {\n          if (!(0, _network_utils_js__WEBPACK_IMPORTED_MODULE_1__.validateResponseStatus)(response.status)) {\n            throw (0, _network_utils_js__WEBPACK_IMPORTED_MODULE_1__.createResponseStatusError)(response.status, url);\n          }\n          this._readCapability.resolve();\n          this._reader = response.body.getReader();\n        }).catch(this._readCapability.reject);\n        this.onProgress = null;\n      }\n      get isStreamingSupported() {\n        return this._isStreamingSupported;\n      }\n      async read() {\n        await this._readCapability.promise;\n        const {\n          value,\n          done\n        } = await this._reader.read();\n        if (done) {\n          return {\n            value,\n            done\n          };\n        }\n        this._loaded += value.byteLength;\n        this.onProgress?.({\n          loaded: this._loaded\n        });\n        return {\n          value: getArrayBuffer(value),\n          done: false\n        };\n      }\n      cancel(reason) {\n        this._reader?.cancel(reason);\n        this._abortController.abort();\n      }\n    }\n\n    /***/\n  },\n\n  /***/742: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */FontFaceObject: () => /* binding */FontFaceObject,\n      /* harmony export */FontLoader: () => /* binding */FontLoader\n      /* harmony export */\n    });\n    /* harmony import */\n    var _shared_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n    class FontLoader {\n      #systemFonts = new Set();\n      constructor({\n        ownerDocument = globalThis.document,\n        styleElement = null\n      }) {\n        this._document = ownerDocument;\n        this.nativeFontFaces = new Set();\n        this.styleElement = null;\n        this.loadingRequests = [];\n        this.loadTestFontId = 0;\n      }\n      addNativeFontFace(nativeFontFace) {\n        this.nativeFontFaces.add(nativeFontFace);\n        this._document.fonts.add(nativeFontFace);\n      }\n      removeNativeFontFace(nativeFontFace) {\n        this.nativeFontFaces.delete(nativeFontFace);\n        this._document.fonts.delete(nativeFontFace);\n      }\n      insertRule(rule) {\n        if (!this.styleElement) {\n          this.styleElement = this._document.createElement(\"style\");\n          this._document.documentElement.getElementsByTagName(\"head\")[0].append(this.styleElement);\n        }\n        const styleSheet = this.styleElement.sheet;\n        styleSheet.insertRule(rule, styleSheet.cssRules.length);\n      }\n      clear() {\n        for (const nativeFontFace of this.nativeFontFaces) {\n          this._document.fonts.delete(nativeFontFace);\n        }\n        this.nativeFontFaces.clear();\n        this.#systemFonts.clear();\n        if (this.styleElement) {\n          this.styleElement.remove();\n          this.styleElement = null;\n        }\n      }\n      async loadSystemFont({\n        systemFontInfo: info,\n        _inspectFont\n      }) {\n        if (!info || this.#systemFonts.has(info.loadedName)) {\n          return;\n        }\n        (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(!this.disableFontFace, \"loadSystemFont shouldn't be called when `disableFontFace` is set.\");\n        if (this.isFontLoadingAPISupported) {\n          const {\n            loadedName,\n            src,\n            style\n          } = info;\n          const fontFace = new FontFace(loadedName, src, style);\n          this.addNativeFontFace(fontFace);\n          try {\n            await fontFace.load();\n            this.#systemFonts.add(loadedName);\n            _inspectFont?.(info);\n          } catch {\n            (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`Cannot load system font: ${info.baseFontName}, installing it could help to improve PDF rendering.`);\n            this.removeNativeFontFace(fontFace);\n          }\n          return;\n        }\n        (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"Not implemented: loadSystemFont without the Font Loading API.\");\n      }\n      async bind(font) {\n        if (font.attached || font.missingFile && !font.systemFontInfo) {\n          return;\n        }\n        font.attached = true;\n        if (font.systemFontInfo) {\n          await this.loadSystemFont(font);\n          return;\n        }\n        if (this.isFontLoadingAPISupported) {\n          const nativeFontFace = font.createNativeFontFace();\n          if (nativeFontFace) {\n            this.addNativeFontFace(nativeFontFace);\n            try {\n              await nativeFontFace.loaded;\n            } catch (ex) {\n              (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`Failed to load font '${nativeFontFace.family}': '${ex}'.`);\n              font.disableFontFace = true;\n              throw ex;\n            }\n          }\n          return;\n        }\n        const rule = font.createFontFaceRule();\n        if (rule) {\n          this.insertRule(rule);\n          if (this.isSyncFontLoadingSupported) {\n            return;\n          }\n          await new Promise(resolve => {\n            const request = this._queueLoadingCallback(resolve);\n            this._prepareFontLoadEvent(font, request);\n          });\n        }\n      }\n      get isFontLoadingAPISupported() {\n        const hasFonts = !!this._document?.fonts;\n        return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"isFontLoadingAPISupported\", hasFonts);\n      }\n      get isSyncFontLoadingSupported() {\n        let supported = false;\n        if (_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isNodeJS) {\n          supported = true;\n        } else if (typeof navigator !== \"undefined\" && typeof navigator?.userAgent === \"string\" && /Mozilla\\/5.0.*?rv:\\d+.*? Gecko/.test(navigator.userAgent)) {\n          supported = true;\n        }\n        return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"isSyncFontLoadingSupported\", supported);\n      }\n      _queueLoadingCallback(callback) {\n        function completeRequest() {\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(!request.done, \"completeRequest() cannot be called twice.\");\n          request.done = true;\n          while (loadingRequests.length > 0 && loadingRequests[0].done) {\n            const otherRequest = loadingRequests.shift();\n            setTimeout(otherRequest.callback, 0);\n          }\n        }\n        const {\n          loadingRequests\n        } = this;\n        const request = {\n          done: false,\n          complete: completeRequest,\n          callback\n        };\n        loadingRequests.push(request);\n        return request;\n      }\n      get _loadTestFont() {\n        const testFont = atob(\"T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQA\" + \"FQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAA\" + \"ALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgA\" + \"AAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1\" + \"AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD\" + \"6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACM\" + \"AooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4D\" + \"IP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAA\" + \"AAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUA\" + \"AQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgAB\" + \"AAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABY\" + \"AAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAA\" + \"AC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAA\" + \"AAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQAC\" + \"AQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3\" + \"Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTj\" + \"FQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==\");\n        return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow)(this, \"_loadTestFont\", testFont);\n      }\n      _prepareFontLoadEvent(font, request) {\n        function int32(data, offset) {\n          return data.charCodeAt(offset) << 24 | data.charCodeAt(offset + 1) << 16 | data.charCodeAt(offset + 2) << 8 | data.charCodeAt(offset + 3) & 0xff;\n        }\n        function spliceString(s, offset, remove, insert) {\n          const chunk1 = s.substring(0, offset);\n          const chunk2 = s.substring(offset + remove);\n          return chunk1 + insert + chunk2;\n        }\n        let i, ii;\n        const canvas = this._document.createElement(\"canvas\");\n        canvas.width = 1;\n        canvas.height = 1;\n        const ctx = canvas.getContext(\"2d\");\n        let called = 0;\n        function isFontReady(name, callback) {\n          if (++called > 30) {\n            (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(\"Load test font never loaded.\");\n            callback();\n            return;\n          }\n          ctx.font = \"30px \" + name;\n          ctx.fillText(\".\", 0, 20);\n          const imageData = ctx.getImageData(0, 0, 1, 1);\n          if (imageData.data[3] > 0) {\n            callback();\n            return;\n          }\n          setTimeout(isFontReady.bind(null, name, callback));\n        }\n        const loadTestFontId = `lt${Date.now()}${this.loadTestFontId++}`;\n        let data = this._loadTestFont;\n        const COMMENT_OFFSET = 976;\n        data = spliceString(data, COMMENT_OFFSET, loadTestFontId.length, loadTestFontId);\n        const CFF_CHECKSUM_OFFSET = 16;\n        const XXXX_VALUE = 0x58585858;\n        let checksum = int32(data, CFF_CHECKSUM_OFFSET);\n        for (i = 0, ii = loadTestFontId.length - 3; i < ii; i += 4) {\n          checksum = checksum - XXXX_VALUE + int32(loadTestFontId, i) | 0;\n        }\n        if (i < loadTestFontId.length) {\n          checksum = checksum - XXXX_VALUE + int32(loadTestFontId + \"XXX\", i) | 0;\n        }\n        data = spliceString(data, CFF_CHECKSUM_OFFSET, 4, (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.string32)(checksum));\n        const url = `url(data:font/opentype;base64,${btoa(data)});`;\n        const rule = `@font-face {font-family:\"${loadTestFontId}\";src:${url}}`;\n        this.insertRule(rule);\n        const div = this._document.createElement(\"div\");\n        div.style.visibility = \"hidden\";\n        div.style.width = div.style.height = \"10px\";\n        div.style.position = \"absolute\";\n        div.style.top = div.style.left = \"0px\";\n        for (const name of [font.loadedName, loadTestFontId]) {\n          const span = this._document.createElement(\"span\");\n          span.textContent = \"Hi\";\n          span.style.fontFamily = name;\n          div.append(span);\n        }\n        this._document.body.append(div);\n        isFontReady(loadTestFontId, () => {\n          div.remove();\n          request.complete();\n        });\n      }\n    }\n    class FontFaceObject {\n      constructor(translatedData, {\n        isEvalSupported = true,\n        disableFontFace = false,\n        ignoreErrors = false,\n        inspectFont = null\n      }) {\n        this.compiledGlyphs = Object.create(null);\n        for (const i in translatedData) {\n          this[i] = translatedData[i];\n        }\n        this.isEvalSupported = isEvalSupported !== false;\n        this.disableFontFace = disableFontFace === true;\n        this.ignoreErrors = ignoreErrors === true;\n        this._inspectFont = inspectFont;\n      }\n      createNativeFontFace() {\n        if (!this.data || this.disableFontFace) {\n          return null;\n        }\n        let nativeFontFace;\n        if (!this.cssFontInfo) {\n          nativeFontFace = new FontFace(this.loadedName, this.data, {});\n        } else {\n          const css = {\n            weight: this.cssFontInfo.fontWeight\n          };\n          if (this.cssFontInfo.italicAngle) {\n            css.style = `oblique ${this.cssFontInfo.italicAngle}deg`;\n          }\n          nativeFontFace = new FontFace(this.cssFontInfo.fontFamily, this.data, css);\n        }\n        this._inspectFont?.(this);\n        return nativeFontFace;\n      }\n      createFontFaceRule() {\n        if (!this.data || this.disableFontFace) {\n          return null;\n        }\n        const data = (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.bytesToString)(this.data);\n        const url = `url(data:${this.mimetype};base64,${btoa(data)});`;\n        let rule;\n        if (!this.cssFontInfo) {\n          rule = `@font-face {font-family:\"${this.loadedName}\";src:${url}}`;\n        } else {\n          let css = `font-weight: ${this.cssFontInfo.fontWeight};`;\n          if (this.cssFontInfo.italicAngle) {\n            css += `font-style: oblique ${this.cssFontInfo.italicAngle}deg;`;\n          }\n          rule = `@font-face {font-family:\"${this.cssFontInfo.fontFamily}\";${css}src:${url}}`;\n        }\n        this._inspectFont?.(this, url);\n        return rule;\n      }\n      getPathGenerator(objs, character) {\n        if (this.compiledGlyphs[character] !== undefined) {\n          return this.compiledGlyphs[character];\n        }\n        let cmds;\n        try {\n          cmds = objs.get(this.loadedName + \"_path_\" + character);\n        } catch (ex) {\n          if (!this.ignoreErrors) {\n            throw ex;\n          }\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`getPathGenerator - ignoring character: \"${ex}\".`);\n          return this.compiledGlyphs[character] = function (c, size) {};\n        }\n        if (this.isEvalSupported && _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.FeatureTest.isEvalSupported) {\n          const jsBuf = [];\n          for (const current of cmds) {\n            const args = current.args !== undefined ? current.args.join(\",\") : \"\";\n            jsBuf.push(\"c.\", current.cmd, \"(\", args, \");\\n\");\n          }\n          return this.compiledGlyphs[character] = new Function(\"c\", \"size\", jsBuf.join(\"\"));\n        }\n        return this.compiledGlyphs[character] = function (c, size) {\n          for (const current of cmds) {\n            if (current.cmd === \"scale\") {\n              current.args = [size, -size];\n            }\n            c[current.cmd].apply(c, current.args);\n          }\n        };\n      }\n    }\n\n    /***/\n  },\n\n  /***/472: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */Metadata: () => /* binding */Metadata\n      /* harmony export */\n    });\n    /* harmony import */\n    var _shared_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n    class Metadata {\n      #metadataMap;\n      #data;\n      constructor({\n        parsedData,\n        rawData\n      }) {\n        this.#metadataMap = parsedData;\n        this.#data = rawData;\n      }\n      getRaw() {\n        return this.#data;\n      }\n      get(name) {\n        return this.#metadataMap.get(name) ?? null;\n      }\n      getAll() {\n        return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.objectFromMap)(this.#metadataMap);\n      }\n      has(name) {\n        return this.#metadataMap.has(name);\n      }\n    }\n\n    /***/\n  },\n\n  /***/474: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */PDFNetworkStream: () => /* binding */PDFNetworkStream\n      /* harmony export */\n    });\n    /* harmony import */\n    var _shared_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n    /* harmony import */\n    var _network_utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(253);\n    ;\n    const OK_RESPONSE = 200;\n    const PARTIAL_CONTENT_RESPONSE = 206;\n    function getArrayBuffer(xhr) {\n      const data = xhr.response;\n      if (typeof data !== \"string\") {\n        return data;\n      }\n      return (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.stringToBytes)(data).buffer;\n    }\n    class NetworkManager {\n      constructor(url, args = {}) {\n        this.url = url;\n        this.isHttp = /^https?:/i.test(url);\n        this.httpHeaders = this.isHttp && args.httpHeaders || Object.create(null);\n        this.withCredentials = args.withCredentials || false;\n        this.currXhrId = 0;\n        this.pendingRequests = Object.create(null);\n      }\n      requestRange(begin, end, listeners) {\n        const args = {\n          begin,\n          end\n        };\n        for (const prop in listeners) {\n          args[prop] = listeners[prop];\n        }\n        return this.request(args);\n      }\n      requestFull(listeners) {\n        return this.request(listeners);\n      }\n      request(args) {\n        const xhr = new XMLHttpRequest();\n        const xhrId = this.currXhrId++;\n        const pendingRequest = this.pendingRequests[xhrId] = {\n          xhr\n        };\n        xhr.open(\"GET\", this.url);\n        xhr.withCredentials = this.withCredentials;\n        for (const property in this.httpHeaders) {\n          const value = this.httpHeaders[property];\n          if (value === undefined) {\n            continue;\n          }\n          xhr.setRequestHeader(property, value);\n        }\n        if (this.isHttp && \"begin\" in args && \"end\" in args) {\n          xhr.setRequestHeader(\"Range\", `bytes=${args.begin}-${args.end - 1}`);\n          pendingRequest.expectedStatus = PARTIAL_CONTENT_RESPONSE;\n        } else {\n          pendingRequest.expectedStatus = OK_RESPONSE;\n        }\n        xhr.responseType = \"arraybuffer\";\n        if (args.onError) {\n          xhr.onerror = function (evt) {\n            args.onError(xhr.status);\n          };\n        }\n        xhr.onreadystatechange = this.onStateChange.bind(this, xhrId);\n        xhr.onprogress = this.onProgress.bind(this, xhrId);\n        pendingRequest.onHeadersReceived = args.onHeadersReceived;\n        pendingRequest.onDone = args.onDone;\n        pendingRequest.onError = args.onError;\n        pendingRequest.onProgress = args.onProgress;\n        xhr.send(null);\n        return xhrId;\n      }\n      onProgress(xhrId, evt) {\n        const pendingRequest = this.pendingRequests[xhrId];\n        if (!pendingRequest) {\n          return;\n        }\n        pendingRequest.onProgress?.(evt);\n      }\n      onStateChange(xhrId, evt) {\n        const pendingRequest = this.pendingRequests[xhrId];\n        if (!pendingRequest) {\n          return;\n        }\n        const xhr = pendingRequest.xhr;\n        if (xhr.readyState >= 2 && pendingRequest.onHeadersReceived) {\n          pendingRequest.onHeadersReceived();\n          delete pendingRequest.onHeadersReceived;\n        }\n        if (xhr.readyState !== 4) {\n          return;\n        }\n        if (!(xhrId in this.pendingRequests)) {\n          return;\n        }\n        delete this.pendingRequests[xhrId];\n        if (xhr.status === 0 && this.isHttp) {\n          pendingRequest.onError?.(xhr.status);\n          return;\n        }\n        const xhrStatus = xhr.status || OK_RESPONSE;\n        const ok_response_on_range_request = xhrStatus === OK_RESPONSE && pendingRequest.expectedStatus === PARTIAL_CONTENT_RESPONSE;\n        if (!ok_response_on_range_request && xhrStatus !== pendingRequest.expectedStatus) {\n          pendingRequest.onError?.(xhr.status);\n          return;\n        }\n        const chunk = getArrayBuffer(xhr);\n        if (xhrStatus === PARTIAL_CONTENT_RESPONSE) {\n          const rangeHeader = xhr.getResponseHeader(\"Content-Range\");\n          const matches = /bytes (\\d+)-(\\d+)\\/(\\d+)/.exec(rangeHeader);\n          pendingRequest.onDone({\n            begin: parseInt(matches[1], 10),\n            chunk\n          });\n        } else if (chunk) {\n          pendingRequest.onDone({\n            begin: 0,\n            chunk\n          });\n        } else {\n          pendingRequest.onError?.(xhr.status);\n        }\n      }\n      getRequestXhr(xhrId) {\n        return this.pendingRequests[xhrId].xhr;\n      }\n      isPendingRequest(xhrId) {\n        return xhrId in this.pendingRequests;\n      }\n      abortRequest(xhrId) {\n        const xhr = this.pendingRequests[xhrId].xhr;\n        delete this.pendingRequests[xhrId];\n        xhr.abort();\n      }\n    }\n    class PDFNetworkStream {\n      constructor(source) {\n        this._source = source;\n        this._manager = new NetworkManager(source.url, {\n          httpHeaders: source.httpHeaders,\n          withCredentials: source.withCredentials\n        });\n        this._rangeChunkSize = source.rangeChunkSize;\n        this._fullRequestReader = null;\n        this._rangeRequestReaders = [];\n      }\n      _onRangeRequestReaderClosed(reader) {\n        const i = this._rangeRequestReaders.indexOf(reader);\n        if (i >= 0) {\n          this._rangeRequestReaders.splice(i, 1);\n        }\n      }\n      getFullReader() {\n        (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(!this._fullRequestReader, \"PDFNetworkStream.getFullReader can only be called once.\");\n        this._fullRequestReader = new PDFNetworkStreamFullRequestReader(this._manager, this._source);\n        return this._fullRequestReader;\n      }\n      getRangeReader(begin, end) {\n        const reader = new PDFNetworkStreamRangeRequestReader(this._manager, begin, end);\n        reader.onClosed = this._onRangeRequestReaderClosed.bind(this);\n        this._rangeRequestReaders.push(reader);\n        return reader;\n      }\n      cancelAllRequests(reason) {\n        this._fullRequestReader?.cancel(reason);\n        for (const reader of this._rangeRequestReaders.slice(0)) {\n          reader.cancel(reason);\n        }\n      }\n    }\n    class PDFNetworkStreamFullRequestReader {\n      constructor(manager, source) {\n        this._manager = manager;\n        const args = {\n          onHeadersReceived: this._onHeadersReceived.bind(this),\n          onDone: this._onDone.bind(this),\n          onError: this._onError.bind(this),\n          onProgress: this._onProgress.bind(this)\n        };\n        this._url = source.url;\n        this._fullRequestId = manager.requestFull(args);\n        this._headersReceivedCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n        this._disableRange = source.disableRange || false;\n        this._contentLength = source.length;\n        this._rangeChunkSize = source.rangeChunkSize;\n        if (!this._rangeChunkSize && !this._disableRange) {\n          this._disableRange = true;\n        }\n        this._isStreamingSupported = false;\n        this._isRangeSupported = false;\n        this._cachedChunks = [];\n        this._requests = [];\n        this._done = false;\n        this._storedError = undefined;\n        this._filename = null;\n        this.onProgress = null;\n      }\n      _onHeadersReceived() {\n        const fullRequestXhrId = this._fullRequestId;\n        const fullRequestXhr = this._manager.getRequestXhr(fullRequestXhrId);\n        const getResponseHeader = name => {\n          return fullRequestXhr.getResponseHeader(name);\n        };\n        const {\n          allowRangeRequests,\n          suggestedLength\n        } = (0, _network_utils_js__WEBPACK_IMPORTED_MODULE_1__.validateRangeRequestCapabilities)({\n          getResponseHeader,\n          isHttp: this._manager.isHttp,\n          rangeChunkSize: this._rangeChunkSize,\n          disableRange: this._disableRange\n        });\n        if (allowRangeRequests) {\n          this._isRangeSupported = true;\n        }\n        this._contentLength = suggestedLength || this._contentLength;\n        this._filename = (0, _network_utils_js__WEBPACK_IMPORTED_MODULE_1__.extractFilenameFromHeader)(getResponseHeader);\n        if (this._isRangeSupported) {\n          this._manager.abortRequest(fullRequestXhrId);\n        }\n        this._headersReceivedCapability.resolve();\n      }\n      _onDone(data) {\n        if (data) {\n          if (this._requests.length > 0) {\n            const requestCapability = this._requests.shift();\n            requestCapability.resolve({\n              value: data.chunk,\n              done: false\n            });\n          } else {\n            this._cachedChunks.push(data.chunk);\n          }\n        }\n        this._done = true;\n        if (this._cachedChunks.length > 0) {\n          return;\n        }\n        for (const requestCapability of this._requests) {\n          requestCapability.resolve({\n            value: undefined,\n            done: true\n          });\n        }\n        this._requests.length = 0;\n      }\n      _onError(status) {\n        this._storedError = (0, _network_utils_js__WEBPACK_IMPORTED_MODULE_1__.createResponseStatusError)(status, this._url);\n        this._headersReceivedCapability.reject(this._storedError);\n        for (const requestCapability of this._requests) {\n          requestCapability.reject(this._storedError);\n        }\n        this._requests.length = 0;\n        this._cachedChunks.length = 0;\n      }\n      _onProgress(evt) {\n        this.onProgress?.({\n          loaded: evt.loaded,\n          total: evt.lengthComputable ? evt.total : this._contentLength\n        });\n      }\n      get filename() {\n        return this._filename;\n      }\n      get isRangeSupported() {\n        return this._isRangeSupported;\n      }\n      get isStreamingSupported() {\n        return this._isStreamingSupported;\n      }\n      get contentLength() {\n        return this._contentLength;\n      }\n      get headersReady() {\n        return this._headersReceivedCapability.promise;\n      }\n      async read() {\n        if (this._storedError) {\n          throw this._storedError;\n        }\n        if (this._cachedChunks.length > 0) {\n          const chunk = this._cachedChunks.shift();\n          return {\n            value: chunk,\n            done: false\n          };\n        }\n        if (this._done) {\n          return {\n            value: undefined,\n            done: true\n          };\n        }\n        const requestCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n        this._requests.push(requestCapability);\n        return requestCapability.promise;\n      }\n      cancel(reason) {\n        this._done = true;\n        this._headersReceivedCapability.reject(reason);\n        for (const requestCapability of this._requests) {\n          requestCapability.resolve({\n            value: undefined,\n            done: true\n          });\n        }\n        this._requests.length = 0;\n        if (this._manager.isPendingRequest(this._fullRequestId)) {\n          this._manager.abortRequest(this._fullRequestId);\n        }\n        this._fullRequestReader = null;\n      }\n    }\n    class PDFNetworkStreamRangeRequestReader {\n      constructor(manager, begin, end) {\n        this._manager = manager;\n        const args = {\n          onDone: this._onDone.bind(this),\n          onError: this._onError.bind(this),\n          onProgress: this._onProgress.bind(this)\n        };\n        this._url = manager.url;\n        this._requestId = manager.requestRange(begin, end, args);\n        this._requests = [];\n        this._queuedChunk = null;\n        this._done = false;\n        this._storedError = undefined;\n        this.onProgress = null;\n        this.onClosed = null;\n      }\n      _close() {\n        this.onClosed?.(this);\n      }\n      _onDone(data) {\n        const chunk = data.chunk;\n        if (this._requests.length > 0) {\n          const requestCapability = this._requests.shift();\n          requestCapability.resolve({\n            value: chunk,\n            done: false\n          });\n        } else {\n          this._queuedChunk = chunk;\n        }\n        this._done = true;\n        for (const requestCapability of this._requests) {\n          requestCapability.resolve({\n            value: undefined,\n            done: true\n          });\n        }\n        this._requests.length = 0;\n        this._close();\n      }\n      _onError(status) {\n        this._storedError = (0, _network_utils_js__WEBPACK_IMPORTED_MODULE_1__.createResponseStatusError)(status, this._url);\n        for (const requestCapability of this._requests) {\n          requestCapability.reject(this._storedError);\n        }\n        this._requests.length = 0;\n        this._queuedChunk = null;\n      }\n      _onProgress(evt) {\n        if (!this.isStreamingSupported) {\n          this.onProgress?.({\n            loaded: evt.loaded\n          });\n        }\n      }\n      get isStreamingSupported() {\n        return false;\n      }\n      async read() {\n        if (this._storedError) {\n          throw this._storedError;\n        }\n        if (this._queuedChunk !== null) {\n          const chunk = this._queuedChunk;\n          this._queuedChunk = null;\n          return {\n            value: chunk,\n            done: false\n          };\n        }\n        if (this._done) {\n          return {\n            value: undefined,\n            done: true\n          };\n        }\n        const requestCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n        this._requests.push(requestCapability);\n        return requestCapability.promise;\n      }\n      cancel(reason) {\n        this._done = true;\n        for (const requestCapability of this._requests) {\n          requestCapability.resolve({\n            value: undefined,\n            done: true\n          });\n        }\n        this._requests.length = 0;\n        if (this._manager.isPendingRequest(this._requestId)) {\n          this._manager.abortRequest(this._requestId);\n        }\n        this._close();\n      }\n    }\n\n    /***/\n  },\n\n  /***/253: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    // EXPORTS\n    __webpack_require__.d(__webpack_exports__, {\n      createResponseStatusError: () => /* binding */createResponseStatusError,\n      extractFilenameFromHeader: () => /* binding */extractFilenameFromHeader,\n      validateRangeRequestCapabilities: () => /* binding */validateRangeRequestCapabilities,\n      validateResponseStatus: () => /* binding */validateResponseStatus\n    });\n\n    // EXTERNAL MODULE: ./src/shared/util.js\n    var util = __webpack_require__(266);\n    ; // CONCATENATED MODULE: ./src/display/content_disposition.js\n\n    function getFilenameFromContentDispositionHeader(contentDisposition) {\n      let needsEncodingFixup = true;\n      let tmp = toParamRegExp(\"filename\\\\*\", \"i\").exec(contentDisposition);\n      if (tmp) {\n        tmp = tmp[1];\n        let filename = rfc2616unquote(tmp);\n        filename = unescape(filename);\n        filename = rfc5987decode(filename);\n        filename = rfc2047decode(filename);\n        return fixupEncoding(filename);\n      }\n      tmp = rfc2231getparam(contentDisposition);\n      if (tmp) {\n        const filename = rfc2047decode(tmp);\n        return fixupEncoding(filename);\n      }\n      tmp = toParamRegExp(\"filename\", \"i\").exec(contentDisposition);\n      if (tmp) {\n        tmp = tmp[1];\n        let filename = rfc2616unquote(tmp);\n        filename = rfc2047decode(filename);\n        return fixupEncoding(filename);\n      }\n      function toParamRegExp(attributePattern, flags) {\n        return new RegExp(\"(?:^|;)\\\\s*\" + attributePattern + \"\\\\s*=\\\\s*\" + \"(\" + '[^\";\\\\s][^;\\\\s]*' + \"|\" + '\"(?:[^\"\\\\\\\\]|\\\\\\\\\"?)+\"?' + \")\", flags);\n      }\n      function textdecode(encoding, value) {\n        if (encoding) {\n          if (!/^[\\x00-\\xFF]+$/.test(value)) {\n            return value;\n          }\n          try {\n            const decoder = new TextDecoder(encoding, {\n              fatal: true\n            });\n            const buffer = (0, util.stringToBytes)(value);\n            value = decoder.decode(buffer);\n            needsEncodingFixup = false;\n          } catch {}\n        }\n        return value;\n      }\n      function fixupEncoding(value) {\n        if (needsEncodingFixup && /[\\x80-\\xff]/.test(value)) {\n          value = textdecode(\"utf-8\", value);\n          if (needsEncodingFixup) {\n            value = textdecode(\"iso-8859-1\", value);\n          }\n        }\n        return value;\n      }\n      function rfc2231getparam(contentDispositionStr) {\n        const matches = [];\n        let match;\n        const iter = toParamRegExp(\"filename\\\\*((?!0\\\\d)\\\\d+)(\\\\*?)\", \"ig\");\n        while ((match = iter.exec(contentDispositionStr)) !== null) {\n          let [, n, quot, part] = match;\n          n = parseInt(n, 10);\n          if (n in matches) {\n            if (n === 0) {\n              break;\n            }\n            continue;\n          }\n          matches[n] = [quot, part];\n        }\n        const parts = [];\n        for (let n = 0; n < matches.length; ++n) {\n          if (!(n in matches)) {\n            break;\n          }\n          let [quot, part] = matches[n];\n          part = rfc2616unquote(part);\n          if (quot) {\n            part = unescape(part);\n            if (n === 0) {\n              part = rfc5987decode(part);\n            }\n          }\n          parts.push(part);\n        }\n        return parts.join(\"\");\n      }\n      function rfc2616unquote(value) {\n        if (value.startsWith('\"')) {\n          const parts = value.slice(1).split('\\\\\"');\n          for (let i = 0; i < parts.length; ++i) {\n            const quotindex = parts[i].indexOf('\"');\n            if (quotindex !== -1) {\n              parts[i] = parts[i].slice(0, quotindex);\n              parts.length = i + 1;\n            }\n            parts[i] = parts[i].replaceAll(/\\\\(.)/g, \"$1\");\n          }\n          value = parts.join('\"');\n        }\n        return value;\n      }\n      function rfc5987decode(extvalue) {\n        const encodingend = extvalue.indexOf(\"'\");\n        if (encodingend === -1) {\n          return extvalue;\n        }\n        const encoding = extvalue.slice(0, encodingend);\n        const langvalue = extvalue.slice(encodingend + 1);\n        const value = langvalue.replace(/^[^']*'/, \"\");\n        return textdecode(encoding, value);\n      }\n      function rfc2047decode(value) {\n        if (!value.startsWith(\"=?\") || /[\\x00-\\x19\\x80-\\xff]/.test(value)) {\n          return value;\n        }\n        return value.replaceAll(/=\\?([\\w-]*)\\?([QqBb])\\?((?:[^?]|\\?(?!=))*)\\?=/g, function (matches, charset, encoding, text) {\n          if (encoding === \"q\" || encoding === \"Q\") {\n            text = text.replaceAll(\"_\", \" \");\n            text = text.replaceAll(/=([0-9a-fA-F]{2})/g, function (match, hex) {\n              return String.fromCharCode(parseInt(hex, 16));\n            });\n            return textdecode(charset, text);\n          }\n          try {\n            text = atob(text);\n          } catch {}\n          return textdecode(charset, text);\n        });\n      }\n      return \"\";\n    }\n\n    // EXTERNAL MODULE: ./src/display/display_utils.js\n    var display_utils = __webpack_require__(473);\n    ; // CONCATENATED MODULE: ./src/display/network_utils.js\n\n    function validateRangeRequestCapabilities({\n      getResponseHeader,\n      isHttp,\n      rangeChunkSize,\n      disableRange\n    }) {\n      const returnValues = {\n        allowRangeRequests: false,\n        suggestedLength: undefined\n      };\n      const length = parseInt(getResponseHeader(\"Content-Length\"), 10);\n      if (!Number.isInteger(length)) {\n        return returnValues;\n      }\n      returnValues.suggestedLength = length;\n      if (length <= 2 * rangeChunkSize) {\n        return returnValues;\n      }\n      if (disableRange || !isHttp) {\n        return returnValues;\n      }\n      if (getResponseHeader(\"Accept-Ranges\") !== \"bytes\") {\n        return returnValues;\n      }\n      const contentEncoding = getResponseHeader(\"Content-Encoding\") || \"identity\";\n      if (contentEncoding !== \"identity\") {\n        return returnValues;\n      }\n      returnValues.allowRangeRequests = true;\n      return returnValues;\n    }\n    function extractFilenameFromHeader(getResponseHeader) {\n      const contentDisposition = getResponseHeader(\"Content-Disposition\");\n      if (contentDisposition) {\n        let filename = getFilenameFromContentDispositionHeader(contentDisposition);\n        if (filename.includes(\"%\")) {\n          try {\n            filename = decodeURIComponent(filename);\n          } catch {}\n        }\n        if ((0, display_utils.isPdfFile)(filename)) {\n          return filename;\n        }\n      }\n      return null;\n    }\n    function createResponseStatusError(status, url) {\n      if (status === 404 || status === 0 && url.startsWith(\"file:\")) {\n        return new util.MissingPDFException('Missing PDF \"' + url + '\".');\n      }\n      return new util.UnexpectedResponseException(`Unexpected server response (${status}) while retrieving PDF \"${url}\".`, status);\n    }\n    function validateResponseStatus(status) {\n      return status === 200 || status === 206;\n    }\n\n    /***/\n  },\n\n  /***/498: /***/(__webpack_module__, __webpack_exports__, __webpack_require__) => {\n    __webpack_require__.a(__webpack_module__, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => {\n      try {\n        /* harmony export */__webpack_require__.d(__webpack_exports__, {\n          /* harmony export */PDFNodeStream: () => /* binding */PDFNodeStream\n          /* harmony export */\n        });\n        /* harmony import */\n        var _shared_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n        /* harmony import */\n        var _network_utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(253);\n        ;\n        let fs, http, https, url;\n        if (_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.isNodeJS) {\n          fs = await import( /* webpackIgnore: true */\"fs\");\n          http = await import( /* webpackIgnore: true */\"http\");\n          https = await import( /* webpackIgnore: true */\"https\");\n          url = await import( /* webpackIgnore: true */\"url\");\n        }\n        const fileUriRegex = /^file:\\/\\/\\/[a-zA-Z]:\\//;\n        function parseUrl(sourceUrl) {\n          const parsedUrl = url.parse(sourceUrl);\n          if (parsedUrl.protocol === \"file:\" || parsedUrl.host) {\n            return parsedUrl;\n          }\n          if (/^[a-z]:[/\\\\]/i.test(sourceUrl)) {\n            return url.parse(`file:///${sourceUrl}`);\n          }\n          if (!parsedUrl.host) {\n            parsedUrl.protocol = \"file:\";\n          }\n          return parsedUrl;\n        }\n        class PDFNodeStream {\n          constructor(source) {\n            this.source = source;\n            this.url = parseUrl(source.url);\n            this.isHttp = this.url.protocol === \"http:\" || this.url.protocol === \"https:\";\n            this.isFsUrl = this.url.protocol === \"file:\";\n            this.httpHeaders = this.isHttp && source.httpHeaders || {};\n            this._fullRequestReader = null;\n            this._rangeRequestReaders = [];\n          }\n          get _progressiveDataLength() {\n            return this._fullRequestReader?._loaded ?? 0;\n          }\n          getFullReader() {\n            (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(!this._fullRequestReader, \"PDFNodeStream.getFullReader can only be called once.\");\n            this._fullRequestReader = this.isFsUrl ? new PDFNodeStreamFsFullReader(this) : new PDFNodeStreamFullReader(this);\n            return this._fullRequestReader;\n          }\n          getRangeReader(start, end) {\n            if (end <= this._progressiveDataLength) {\n              return null;\n            }\n            const rangeReader = this.isFsUrl ? new PDFNodeStreamFsRangeReader(this, start, end) : new PDFNodeStreamRangeReader(this, start, end);\n            this._rangeRequestReaders.push(rangeReader);\n            return rangeReader;\n          }\n          cancelAllRequests(reason) {\n            this._fullRequestReader?.cancel(reason);\n            for (const reader of this._rangeRequestReaders.slice(0)) {\n              reader.cancel(reason);\n            }\n          }\n        }\n        class BaseFullReader {\n          constructor(stream) {\n            this._url = stream.url;\n            this._done = false;\n            this._storedError = null;\n            this.onProgress = null;\n            const source = stream.source;\n            this._contentLength = source.length;\n            this._loaded = 0;\n            this._filename = null;\n            this._disableRange = source.disableRange || false;\n            this._rangeChunkSize = source.rangeChunkSize;\n            if (!this._rangeChunkSize && !this._disableRange) {\n              this._disableRange = true;\n            }\n            this._isStreamingSupported = !source.disableStream;\n            this._isRangeSupported = !source.disableRange;\n            this._readableStream = null;\n            this._readCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n            this._headersCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n          }\n          get headersReady() {\n            return this._headersCapability.promise;\n          }\n          get filename() {\n            return this._filename;\n          }\n          get contentLength() {\n            return this._contentLength;\n          }\n          get isRangeSupported() {\n            return this._isRangeSupported;\n          }\n          get isStreamingSupported() {\n            return this._isStreamingSupported;\n          }\n          async read() {\n            await this._readCapability.promise;\n            if (this._done) {\n              return {\n                value: undefined,\n                done: true\n              };\n            }\n            if (this._storedError) {\n              throw this._storedError;\n            }\n            const chunk = this._readableStream.read();\n            if (chunk === null) {\n              this._readCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n              return this.read();\n            }\n            this._loaded += chunk.length;\n            this.onProgress?.({\n              loaded: this._loaded,\n              total: this._contentLength\n            });\n            const buffer = new Uint8Array(chunk).buffer;\n            return {\n              value: buffer,\n              done: false\n            };\n          }\n          cancel(reason) {\n            if (!this._readableStream) {\n              this._error(reason);\n              return;\n            }\n            this._readableStream.destroy(reason);\n          }\n          _error(reason) {\n            this._storedError = reason;\n            this._readCapability.resolve();\n          }\n          _setReadableStream(readableStream) {\n            this._readableStream = readableStream;\n            readableStream.on(\"readable\", () => {\n              this._readCapability.resolve();\n            });\n            readableStream.on(\"end\", () => {\n              readableStream.destroy();\n              this._done = true;\n              this._readCapability.resolve();\n            });\n            readableStream.on(\"error\", reason => {\n              this._error(reason);\n            });\n            if (!this._isStreamingSupported && this._isRangeSupported) {\n              this._error(new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AbortException(\"streaming is disabled\"));\n            }\n            if (this._storedError) {\n              this._readableStream.destroy(this._storedError);\n            }\n          }\n        }\n        class BaseRangeReader {\n          constructor(stream) {\n            this._url = stream.url;\n            this._done = false;\n            this._storedError = null;\n            this.onProgress = null;\n            this._loaded = 0;\n            this._readableStream = null;\n            this._readCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n            const source = stream.source;\n            this._isStreamingSupported = !source.disableStream;\n          }\n          get isStreamingSupported() {\n            return this._isStreamingSupported;\n          }\n          async read() {\n            await this._readCapability.promise;\n            if (this._done) {\n              return {\n                value: undefined,\n                done: true\n              };\n            }\n            if (this._storedError) {\n              throw this._storedError;\n            }\n            const chunk = this._readableStream.read();\n            if (chunk === null) {\n              this._readCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n              return this.read();\n            }\n            this._loaded += chunk.length;\n            this.onProgress?.({\n              loaded: this._loaded\n            });\n            const buffer = new Uint8Array(chunk).buffer;\n            return {\n              value: buffer,\n              done: false\n            };\n          }\n          cancel(reason) {\n            if (!this._readableStream) {\n              this._error(reason);\n              return;\n            }\n            this._readableStream.destroy(reason);\n          }\n          _error(reason) {\n            this._storedError = reason;\n            this._readCapability.resolve();\n          }\n          _setReadableStream(readableStream) {\n            this._readableStream = readableStream;\n            readableStream.on(\"readable\", () => {\n              this._readCapability.resolve();\n            });\n            readableStream.on(\"end\", () => {\n              readableStream.destroy();\n              this._done = true;\n              this._readCapability.resolve();\n            });\n            readableStream.on(\"error\", reason => {\n              this._error(reason);\n            });\n            if (this._storedError) {\n              this._readableStream.destroy(this._storedError);\n            }\n          }\n        }\n        function createRequestOptions(parsedUrl, headers) {\n          return {\n            protocol: parsedUrl.protocol,\n            auth: parsedUrl.auth,\n            host: parsedUrl.hostname,\n            port: parsedUrl.port,\n            path: parsedUrl.path,\n            method: \"GET\",\n            headers\n          };\n        }\n        class PDFNodeStreamFullReader extends BaseFullReader {\n          constructor(stream) {\n            super(stream);\n            const handleResponse = response => {\n              if (response.statusCode === 404) {\n                const error = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.MissingPDFException(`Missing PDF \"${this._url}\".`);\n                this._storedError = error;\n                this._headersCapability.reject(error);\n                return;\n              }\n              this._headersCapability.resolve();\n              this._setReadableStream(response);\n              const getResponseHeader = name => {\n                return this._readableStream.headers[name.toLowerCase()];\n              };\n              const {\n                allowRangeRequests,\n                suggestedLength\n              } = (0, _network_utils_js__WEBPACK_IMPORTED_MODULE_1__.validateRangeRequestCapabilities)({\n                getResponseHeader,\n                isHttp: stream.isHttp,\n                rangeChunkSize: this._rangeChunkSize,\n                disableRange: this._disableRange\n              });\n              this._isRangeSupported = allowRangeRequests;\n              this._contentLength = suggestedLength || this._contentLength;\n              this._filename = (0, _network_utils_js__WEBPACK_IMPORTED_MODULE_1__.extractFilenameFromHeader)(getResponseHeader);\n            };\n            this._request = null;\n            if (this._url.protocol === \"http:\") {\n              this._request = http.request(createRequestOptions(this._url, stream.httpHeaders), handleResponse);\n            } else {\n              this._request = https.request(createRequestOptions(this._url, stream.httpHeaders), handleResponse);\n            }\n            this._request.on(\"error\", reason => {\n              this._storedError = reason;\n              this._headersCapability.reject(reason);\n            });\n            this._request.end();\n          }\n        }\n        class PDFNodeStreamRangeReader extends BaseRangeReader {\n          constructor(stream, start, end) {\n            super(stream);\n            this._httpHeaders = {};\n            for (const property in stream.httpHeaders) {\n              const value = stream.httpHeaders[property];\n              if (value === undefined) {\n                continue;\n              }\n              this._httpHeaders[property] = value;\n            }\n            this._httpHeaders.Range = `bytes=${start}-${end - 1}`;\n            const handleResponse = response => {\n              if (response.statusCode === 404) {\n                const error = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.MissingPDFException(`Missing PDF \"${this._url}\".`);\n                this._storedError = error;\n                return;\n              }\n              this._setReadableStream(response);\n            };\n            this._request = null;\n            if (this._url.protocol === \"http:\") {\n              this._request = http.request(createRequestOptions(this._url, this._httpHeaders), handleResponse);\n            } else {\n              this._request = https.request(createRequestOptions(this._url, this._httpHeaders), handleResponse);\n            }\n            this._request.on(\"error\", reason => {\n              this._storedError = reason;\n            });\n            this._request.end();\n          }\n        }\n        class PDFNodeStreamFsFullReader extends BaseFullReader {\n          constructor(stream) {\n            super(stream);\n            let path = decodeURIComponent(this._url.path);\n            if (fileUriRegex.test(this._url.href)) {\n              path = path.replace(/^\\//, \"\");\n            }\n            fs.lstat(path, (error, stat) => {\n              if (error) {\n                if (error.code === \"ENOENT\") {\n                  error = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.MissingPDFException(`Missing PDF \"${path}\".`);\n                }\n                this._storedError = error;\n                this._headersCapability.reject(error);\n                return;\n              }\n              this._contentLength = stat.size;\n              this._setReadableStream(fs.createReadStream(path));\n              this._headersCapability.resolve();\n            });\n          }\n        }\n        class PDFNodeStreamFsRangeReader extends BaseRangeReader {\n          constructor(stream, start, end) {\n            super(stream);\n            let path = decodeURIComponent(this._url.path);\n            if (fileUriRegex.test(this._url.href)) {\n              path = path.replace(/^\\//, \"\");\n            }\n            this._setReadableStream(fs.createReadStream(path, {\n              start,\n              end: end - 1\n            }));\n          }\n        }\n        __webpack_async_result__();\n      } catch (e) {\n        __webpack_async_result__(e);\n      }\n    }, 1);\n\n    /***/\n  },\n\n  /***/738: /***/(__webpack_module__, __webpack_exports__, __webpack_require__) => {\n    __webpack_require__.a(__webpack_module__, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => {\n      try {\n        /* harmony export */__webpack_require__.d(__webpack_exports__, {\n          /* harmony export */NodeCMapReaderFactory: () => /* binding */NodeCMapReaderFactory,\n          /* harmony export */NodeCanvasFactory: () => /* binding */NodeCanvasFactory,\n          /* harmony export */NodeFilterFactory: () => /* binding */NodeFilterFactory,\n          /* harmony export */NodeStandardFontDataFactory: () => /* binding */NodeStandardFontDataFactory\n          /* harmony export */\n        });\n        /* harmony import */\n        var _base_factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(822);\n        /* harmony import */\n        var _shared_util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(266);\n        ;\n        let fs, canvas, path2d_polyfill;\n        if (_shared_util_js__WEBPACK_IMPORTED_MODULE_1__.isNodeJS) {\n          fs = await import( /* webpackIgnore: true */\"fs\");\n          try {\n            canvas = await import( /* webpackIgnore: true */\"canvas\");\n          } catch {}\n          try {\n            path2d_polyfill = await import( /* webpackIgnore: true */\"path2d-polyfill\");\n          } catch {}\n        }\n        ;\n        const fetchData = function (url) {\n          return new Promise((resolve, reject) => {\n            fs.readFile(url, (error, data) => {\n              if (error || !data) {\n                reject(new Error(error));\n                return;\n              }\n              resolve(new Uint8Array(data));\n            });\n          });\n        };\n        class NodeFilterFactory extends _base_factory_js__WEBPACK_IMPORTED_MODULE_0__.BaseFilterFactory {}\n        class NodeCanvasFactory extends _base_factory_js__WEBPACK_IMPORTED_MODULE_0__.BaseCanvasFactory {\n          _createCanvas(width, height) {\n            return canvas.createCanvas(width, height);\n          }\n        }\n        class NodeCMapReaderFactory extends _base_factory_js__WEBPACK_IMPORTED_MODULE_0__.BaseCMapReaderFactory {\n          _fetchData(url, compressionType) {\n            return fetchData(url).then(data => {\n              return {\n                cMapData: data,\n                compressionType\n              };\n            });\n          }\n        }\n        class NodeStandardFontDataFactory extends _base_factory_js__WEBPACK_IMPORTED_MODULE_0__.BaseStandardFontDataFactory {\n          _fetchData(url) {\n            return fetchData(url);\n          }\n        }\n        __webpack_async_result__();\n      } catch (e) {\n        __webpack_async_result__(e);\n      }\n    }, 1);\n\n    /***/\n  },\n\n  /***/890: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */OptionalContentConfig: () => /* binding */OptionalContentConfig\n      /* harmony export */\n    });\n    /* harmony import */\n    var _shared_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n    /* harmony import */\n    var _shared_murmurhash3_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(825);\n    const INTERNAL = Symbol(\"INTERNAL\");\n    class OptionalContentGroup {\n      #visible = true;\n      constructor(name, intent) {\n        this.name = name;\n        this.intent = intent;\n      }\n      get visible() {\n        return this.#visible;\n      }\n      _setVisible(internal, visible) {\n        if (internal !== INTERNAL) {\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)(\"Internal method `_setVisible` called.\");\n        }\n        this.#visible = visible;\n      }\n    }\n    class OptionalContentConfig {\n      #cachedGetHash = null;\n      #groups = new Map();\n      #initialHash = null;\n      #order = null;\n      constructor(data) {\n        this.name = null;\n        this.creator = null;\n        if (data === null) {\n          return;\n        }\n        this.name = data.name;\n        this.creator = data.creator;\n        this.#order = data.order;\n        for (const group of data.groups) {\n          this.#groups.set(group.id, new OptionalContentGroup(group.name, group.intent));\n        }\n        if (data.baseState === \"OFF\") {\n          for (const group of this.#groups.values()) {\n            group._setVisible(INTERNAL, false);\n          }\n        }\n        for (const on of data.on) {\n          this.#groups.get(on)._setVisible(INTERNAL, true);\n        }\n        for (const off of data.off) {\n          this.#groups.get(off)._setVisible(INTERNAL, false);\n        }\n        this.#initialHash = this.getHash();\n      }\n      #evaluateVisibilityExpression(array) {\n        const length = array.length;\n        if (length < 2) {\n          return true;\n        }\n        const operator = array[0];\n        for (let i = 1; i < length; i++) {\n          const element = array[i];\n          let state;\n          if (Array.isArray(element)) {\n            state = this.#evaluateVisibilityExpression(element);\n          } else if (this.#groups.has(element)) {\n            state = this.#groups.get(element).visible;\n          } else {\n            (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`Optional content group not found: ${element}`);\n            return true;\n          }\n          switch (operator) {\n            case \"And\":\n              if (!state) {\n                return false;\n              }\n              break;\n            case \"Or\":\n              if (state) {\n                return true;\n              }\n              break;\n            case \"Not\":\n              return !state;\n            default:\n              return true;\n          }\n        }\n        return operator === \"And\";\n      }\n      isVisible(group) {\n        if (this.#groups.size === 0) {\n          return true;\n        }\n        if (!group) {\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(\"Optional content group not defined.\");\n          return true;\n        }\n        if (group.type === \"OCG\") {\n          if (!this.#groups.has(group.id)) {\n            (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`Optional content group not found: ${group.id}`);\n            return true;\n          }\n          return this.#groups.get(group.id).visible;\n        } else if (group.type === \"OCMD\") {\n          if (group.expression) {\n            return this.#evaluateVisibilityExpression(group.expression);\n          }\n          if (!group.policy || group.policy === \"AnyOn\") {\n            for (const id of group.ids) {\n              if (!this.#groups.has(id)) {\n                (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`Optional content group not found: ${id}`);\n                return true;\n              }\n              if (this.#groups.get(id).visible) {\n                return true;\n              }\n            }\n            return false;\n          } else if (group.policy === \"AllOn\") {\n            for (const id of group.ids) {\n              if (!this.#groups.has(id)) {\n                (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`Optional content group not found: ${id}`);\n                return true;\n              }\n              if (!this.#groups.get(id).visible) {\n                return false;\n              }\n            }\n            return true;\n          } else if (group.policy === \"AnyOff\") {\n            for (const id of group.ids) {\n              if (!this.#groups.has(id)) {\n                (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`Optional content group not found: ${id}`);\n                return true;\n              }\n              if (!this.#groups.get(id).visible) {\n                return true;\n              }\n            }\n            return false;\n          } else if (group.policy === \"AllOff\") {\n            for (const id of group.ids) {\n              if (!this.#groups.has(id)) {\n                (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`Optional content group not found: ${id}`);\n                return true;\n              }\n              if (this.#groups.get(id).visible) {\n                return false;\n              }\n            }\n            return true;\n          }\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`Unknown optional content policy ${group.policy}.`);\n          return true;\n        }\n        (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`Unknown group type ${group.type}.`);\n        return true;\n      }\n      setVisibility(id, visible = true) {\n        if (!this.#groups.has(id)) {\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.warn)(`Optional content group not found: ${id}`);\n          return;\n        }\n        this.#groups.get(id)._setVisible(INTERNAL, !!visible);\n        this.#cachedGetHash = null;\n      }\n      get hasInitialVisibility() {\n        return this.#initialHash === null || this.getHash() === this.#initialHash;\n      }\n      getOrder() {\n        if (!this.#groups.size) {\n          return null;\n        }\n        if (this.#order) {\n          return this.#order.slice();\n        }\n        return [...this.#groups.keys()];\n      }\n      getGroups() {\n        return this.#groups.size > 0 ? (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.objectFromMap)(this.#groups) : null;\n      }\n      getGroup(id) {\n        return this.#groups.get(id) || null;\n      }\n      getHash() {\n        if (this.#cachedGetHash !== null) {\n          return this.#cachedGetHash;\n        }\n        const hash = new _shared_murmurhash3_js__WEBPACK_IMPORTED_MODULE_1__.MurmurHash3_64();\n        for (const [id, group] of this.#groups) {\n          hash.update(`${id}:${group.visible}`);\n        }\n        return this.#cachedGetHash = hash.hexdigest();\n      }\n    }\n\n    /***/\n  },\n\n  /***/739: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */renderTextLayer: () => /* binding */renderTextLayer,\n      /* harmony export */updateTextLayer: () => /* binding */updateTextLayer\n      /* harmony export */\n    });\n    /* unused harmony export TextLayerRenderTask */\n    /* harmony import */\n    var _shared_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n    /* harmony import */\n    var _display_utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(473);\n    const MAX_TEXT_DIVS_TO_RENDER = 100000;\n    const DEFAULT_FONT_SIZE = 30;\n    const DEFAULT_FONT_ASCENT = 0.8;\n    const ascentCache = new Map();\n    function getCtx(size, isOffscreenCanvasSupported) {\n      let ctx;\n      if (isOffscreenCanvasSupported && _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.FeatureTest.isOffscreenCanvasSupported) {\n        ctx = new OffscreenCanvas(size, size).getContext(\"2d\", {\n          alpha: false\n        });\n      } else {\n        const canvas = document.createElement(\"canvas\");\n        canvas.width = canvas.height = size;\n        ctx = canvas.getContext(\"2d\", {\n          alpha: false\n        });\n      }\n      return ctx;\n    }\n    function getAscent(fontFamily, isOffscreenCanvasSupported) {\n      const cachedAscent = ascentCache.get(fontFamily);\n      if (cachedAscent) {\n        return cachedAscent;\n      }\n      const ctx = getCtx(DEFAULT_FONT_SIZE, isOffscreenCanvasSupported);\n      ctx.font = `${DEFAULT_FONT_SIZE}px ${fontFamily}`;\n      const metrics = ctx.measureText(\"\");\n      let ascent = metrics.fontBoundingBoxAscent;\n      let descent = Math.abs(metrics.fontBoundingBoxDescent);\n      if (ascent) {\n        const ratio = ascent / (ascent + descent);\n        ascentCache.set(fontFamily, ratio);\n        ctx.canvas.width = ctx.canvas.height = 0;\n        return ratio;\n      }\n      ctx.strokeStyle = \"red\";\n      ctx.clearRect(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE);\n      ctx.strokeText(\"g\", 0, 0);\n      let pixels = ctx.getImageData(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE).data;\n      descent = 0;\n      for (let i = pixels.length - 1 - 3; i >= 0; i -= 4) {\n        if (pixels[i] > 0) {\n          descent = Math.ceil(i / 4 / DEFAULT_FONT_SIZE);\n          break;\n        }\n      }\n      ctx.clearRect(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE);\n      ctx.strokeText(\"A\", 0, DEFAULT_FONT_SIZE);\n      pixels = ctx.getImageData(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE).data;\n      ascent = 0;\n      for (let i = 0, ii = pixels.length; i < ii; i += 4) {\n        if (pixels[i] > 0) {\n          ascent = DEFAULT_FONT_SIZE - Math.floor(i / 4 / DEFAULT_FONT_SIZE);\n          break;\n        }\n      }\n      ctx.canvas.width = ctx.canvas.height = 0;\n      if (ascent) {\n        const ratio = ascent / (ascent + descent);\n        ascentCache.set(fontFamily, ratio);\n        return ratio;\n      }\n      ascentCache.set(fontFamily, DEFAULT_FONT_ASCENT);\n      return DEFAULT_FONT_ASCENT;\n    }\n    function appendText(task, geom, styles) {\n      const textDiv = document.createElement(\"span\");\n      const textDivProperties = {\n        angle: 0,\n        canvasWidth: 0,\n        hasText: geom.str !== \"\",\n        hasEOL: geom.hasEOL,\n        fontSize: 0\n      };\n      task._textDivs.push(textDiv);\n      const tx = _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.Util.transform(task._transform, geom.transform);\n      let angle = Math.atan2(tx[1], tx[0]);\n      const style = styles[geom.fontName];\n      if (style.vertical) {\n        angle += Math.PI / 2;\n      }\n      const fontFamily = task._fontInspectorEnabled && style.fontSubstitution || style.fontFamily;\n      const fontHeight = Math.hypot(tx[2], tx[3]);\n      const fontAscent = fontHeight * getAscent(fontFamily, task._isOffscreenCanvasSupported);\n      let left, top;\n      if (angle === 0) {\n        left = tx[4];\n        top = tx[5] - fontAscent;\n      } else {\n        left = tx[4] + fontAscent * Math.sin(angle);\n        top = tx[5] - fontAscent * Math.cos(angle);\n      }\n      const scaleFactorStr = \"calc(var(--scale-factor)*\";\n      const divStyle = textDiv.style;\n      if (task._container === task._rootContainer) {\n        divStyle.left = `${(100 * left / task._pageWidth).toFixed(2)}%`;\n        divStyle.top = `${(100 * top / task._pageHeight).toFixed(2)}%`;\n      } else {\n        divStyle.left = `${scaleFactorStr}${left.toFixed(2)}px)`;\n        divStyle.top = `${scaleFactorStr}${top.toFixed(2)}px)`;\n      }\n      divStyle.fontSize = `${scaleFactorStr}${fontHeight.toFixed(2)}px)`;\n      divStyle.fontFamily = fontFamily;\n      textDivProperties.fontSize = fontHeight;\n      textDiv.setAttribute(\"role\", \"presentation\");\n      textDiv.textContent = geom.str;\n      textDiv.dir = geom.dir;\n      if (task._fontInspectorEnabled) {\n        textDiv.dataset.fontName = style.fontSubstitutionLoadedName || geom.fontName;\n      }\n      if (angle !== 0) {\n        textDivProperties.angle = angle * (180 / Math.PI);\n      }\n      let shouldScaleText = false;\n      if (geom.str.length > 1) {\n        shouldScaleText = true;\n      } else if (geom.str !== \" \" && geom.transform[0] !== geom.transform[3]) {\n        const absScaleX = Math.abs(geom.transform[0]),\n          absScaleY = Math.abs(geom.transform[3]);\n        if (absScaleX !== absScaleY && Math.max(absScaleX, absScaleY) / Math.min(absScaleX, absScaleY) > 1.5) {\n          shouldScaleText = true;\n        }\n      }\n      if (shouldScaleText) {\n        textDivProperties.canvasWidth = style.vertical ? geom.height : geom.width;\n      }\n      task._textDivProperties.set(textDiv, textDivProperties);\n      if (task._isReadableStream) {\n        task._layoutText(textDiv);\n      }\n    }\n    function layout(params) {\n      const {\n        div,\n        scale,\n        properties,\n        ctx,\n        prevFontSize,\n        prevFontFamily\n      } = params;\n      const {\n        style\n      } = div;\n      let transform = \"\";\n      if (properties.canvasWidth !== 0 && properties.hasText) {\n        const {\n          fontFamily\n        } = style;\n        const {\n          canvasWidth,\n          fontSize\n        } = properties;\n        if (prevFontSize !== fontSize || prevFontFamily !== fontFamily) {\n          ctx.font = `${fontSize * scale}px ${fontFamily}`;\n          params.prevFontSize = fontSize;\n          params.prevFontFamily = fontFamily;\n        }\n        const {\n          width\n        } = ctx.measureText(div.textContent);\n        if (width > 0) {\n          transform = `scaleX(${canvasWidth * scale / width})`;\n        }\n      }\n      if (properties.angle !== 0) {\n        transform = `rotate(${properties.angle}deg) ${transform}`;\n      }\n      if (transform.length > 0) {\n        style.transform = transform;\n      }\n    }\n    function render(task) {\n      if (task._canceled) {\n        return;\n      }\n      const textDivs = task._textDivs;\n      const capability = task._capability;\n      const textDivsLength = textDivs.length;\n      if (textDivsLength > MAX_TEXT_DIVS_TO_RENDER) {\n        capability.resolve();\n        return;\n      }\n      if (!task._isReadableStream) {\n        for (const textDiv of textDivs) {\n          task._layoutText(textDiv);\n        }\n      }\n      capability.resolve();\n    }\n    class TextLayerRenderTask {\n      constructor({\n        textContentSource,\n        container,\n        viewport,\n        textDivs,\n        textDivProperties,\n        textContentItemsStr,\n        isOffscreenCanvasSupported\n      }) {\n        this._textContentSource = textContentSource;\n        this._isReadableStream = textContentSource instanceof ReadableStream;\n        this._container = this._rootContainer = container;\n        this._textDivs = textDivs || [];\n        this._textContentItemsStr = textContentItemsStr || [];\n        this._isOffscreenCanvasSupported = isOffscreenCanvasSupported;\n        this._fontInspectorEnabled = !!globalThis.FontInspector?.enabled;\n        this._reader = null;\n        this._textDivProperties = textDivProperties || new WeakMap();\n        this._canceled = false;\n        this._capability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n        this._layoutTextParams = {\n          prevFontSize: null,\n          prevFontFamily: null,\n          div: null,\n          scale: viewport.scale * (globalThis.devicePixelRatio || 1),\n          properties: null,\n          ctx: getCtx(0, isOffscreenCanvasSupported)\n        };\n        const {\n          pageWidth,\n          pageHeight,\n          pageX,\n          pageY\n        } = viewport.rawDims;\n        this._transform = [1, 0, 0, -1, -pageX, pageY + pageHeight];\n        this._pageWidth = pageWidth;\n        this._pageHeight = pageHeight;\n        (0, _display_utils_js__WEBPACK_IMPORTED_MODULE_1__.setLayerDimensions)(container, viewport);\n        this._capability.promise.finally(() => {\n          this._layoutTextParams = null;\n        }).catch(() => {});\n      }\n      get promise() {\n        return this._capability.promise;\n      }\n      cancel() {\n        this._canceled = true;\n        if (this._reader) {\n          this._reader.cancel(new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AbortException(\"TextLayer task cancelled.\")).catch(() => {});\n          this._reader = null;\n        }\n        this._capability.reject(new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AbortException(\"TextLayer task cancelled.\"));\n      }\n      _processItems(items, styleCache) {\n        for (const item of items) {\n          if (item.str === undefined) {\n            if (item.type === \"beginMarkedContentProps\" || item.type === \"beginMarkedContent\") {\n              const parent = this._container;\n              this._container = document.createElement(\"span\");\n              this._container.classList.add(\"markedContent\");\n              if (item.id !== null) {\n                this._container.setAttribute(\"id\", `${item.id}`);\n              }\n              parent.append(this._container);\n            } else if (item.type === \"endMarkedContent\") {\n              this._container = this._container.parentNode;\n            }\n            continue;\n          }\n          this._textContentItemsStr.push(item.str);\n          appendText(this, item, styleCache);\n        }\n      }\n      _layoutText(textDiv) {\n        const textDivProperties = this._layoutTextParams.properties = this._textDivProperties.get(textDiv);\n        this._layoutTextParams.div = textDiv;\n        layout(this._layoutTextParams);\n        if (textDivProperties.hasText) {\n          this._container.append(textDiv);\n        }\n        if (textDivProperties.hasEOL) {\n          const br = document.createElement(\"br\");\n          br.setAttribute(\"role\", \"presentation\");\n          this._container.append(br);\n        }\n      }\n      _render() {\n        const capability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n        let styleCache = Object.create(null);\n        if (this._isReadableStream) {\n          const pump = () => {\n            this._reader.read().then(({\n              value,\n              done\n            }) => {\n              if (done) {\n                capability.resolve();\n                return;\n              }\n              Object.assign(styleCache, value.styles);\n              this._processItems(value.items, styleCache);\n              pump();\n            }, capability.reject);\n          };\n          this._reader = this._textContentSource.getReader();\n          pump();\n        } else if (this._textContentSource) {\n          const {\n            items,\n            styles\n          } = this._textContentSource;\n          this._processItems(items, styles);\n          capability.resolve();\n        } else {\n          throw new Error('No \"textContentSource\" parameter specified.');\n        }\n        capability.promise.then(() => {\n          styleCache = null;\n          render(this);\n        }, this._capability.reject);\n      }\n    }\n    function renderTextLayer(params) {\n      const task = new TextLayerRenderTask(params);\n      task._render();\n      return task;\n    }\n    function updateTextLayer({\n      container,\n      viewport,\n      textDivs,\n      textDivProperties,\n      isOffscreenCanvasSupported,\n      mustRotate = true,\n      mustRescale = true\n    }) {\n      if (mustRotate) {\n        (0, _display_utils_js__WEBPACK_IMPORTED_MODULE_1__.setLayerDimensions)(container, {\n          rotation: viewport.rotation\n        });\n      }\n      if (mustRescale) {\n        const ctx = getCtx(0, isOffscreenCanvasSupported);\n        const scale = viewport.scale * (globalThis.devicePixelRatio || 1);\n        const params = {\n          prevFontSize: null,\n          prevFontFamily: null,\n          div: null,\n          scale,\n          properties: null,\n          ctx\n        };\n        for (const div of textDivs) {\n          params.properties = textDivProperties.get(div);\n          params.div = div;\n          layout(params);\n        }\n      }\n    }\n\n    /***/\n  },\n\n  /***/92: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */PDFDataTransportStream: () => /* binding */PDFDataTransportStream\n      /* harmony export */\n    });\n    /* harmony import */\n    var _shared_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n    /* harmony import */\n    var _display_utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(473);\n    class PDFDataTransportStream {\n      constructor({\n        length,\n        initialData,\n        progressiveDone = false,\n        contentDispositionFilename = null,\n        disableRange = false,\n        disableStream = false\n      }, pdfDataRangeTransport) {\n        (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(pdfDataRangeTransport, 'PDFDataTransportStream - missing required \"pdfDataRangeTransport\" argument.');\n        this._queuedChunks = [];\n        this._progressiveDone = progressiveDone;\n        this._contentDispositionFilename = contentDispositionFilename;\n        if (initialData?.length > 0) {\n          const buffer = initialData instanceof Uint8Array && initialData.byteLength === initialData.buffer.byteLength ? initialData.buffer : new Uint8Array(initialData).buffer;\n          this._queuedChunks.push(buffer);\n        }\n        this._pdfDataRangeTransport = pdfDataRangeTransport;\n        this._isStreamingSupported = !disableStream;\n        this._isRangeSupported = !disableRange;\n        this._contentLength = length;\n        this._fullRequestReader = null;\n        this._rangeReaders = [];\n        this._pdfDataRangeTransport.addRangeListener((begin, chunk) => {\n          this._onReceiveData({\n            begin,\n            chunk\n          });\n        });\n        this._pdfDataRangeTransport.addProgressListener((loaded, total) => {\n          this._onProgress({\n            loaded,\n            total\n          });\n        });\n        this._pdfDataRangeTransport.addProgressiveReadListener(chunk => {\n          this._onReceiveData({\n            chunk\n          });\n        });\n        this._pdfDataRangeTransport.addProgressiveDoneListener(() => {\n          this._onProgressiveDone();\n        });\n        this._pdfDataRangeTransport.transportReady();\n      }\n      _onReceiveData({\n        begin,\n        chunk\n      }) {\n        const buffer = chunk instanceof Uint8Array && chunk.byteLength === chunk.buffer.byteLength ? chunk.buffer : new Uint8Array(chunk).buffer;\n        if (begin === undefined) {\n          if (this._fullRequestReader) {\n            this._fullRequestReader._enqueue(buffer);\n          } else {\n            this._queuedChunks.push(buffer);\n          }\n        } else {\n          const found = this._rangeReaders.some(function (rangeReader) {\n            if (rangeReader._begin !== begin) {\n              return false;\n            }\n            rangeReader._enqueue(buffer);\n            return true;\n          });\n          (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(found, \"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.\");\n        }\n      }\n      get _progressiveDataLength() {\n        return this._fullRequestReader?._loaded ?? 0;\n      }\n      _onProgress(evt) {\n        if (evt.total === undefined) {\n          this._rangeReaders[0]?.onProgress?.({\n            loaded: evt.loaded\n          });\n        } else {\n          this._fullRequestReader?.onProgress?.({\n            loaded: evt.loaded,\n            total: evt.total\n          });\n        }\n      }\n      _onProgressiveDone() {\n        this._fullRequestReader?.progressiveDone();\n        this._progressiveDone = true;\n      }\n      _removeRangeReader(reader) {\n        const i = this._rangeReaders.indexOf(reader);\n        if (i >= 0) {\n          this._rangeReaders.splice(i, 1);\n        }\n      }\n      getFullReader() {\n        (0, _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(!this._fullRequestReader, \"PDFDataTransportStream.getFullReader can only be called once.\");\n        const queuedChunks = this._queuedChunks;\n        this._queuedChunks = null;\n        return new PDFDataTransportStreamReader(this, queuedChunks, this._progressiveDone, this._contentDispositionFilename);\n      }\n      getRangeReader(begin, end) {\n        if (end <= this._progressiveDataLength) {\n          return null;\n        }\n        const reader = new PDFDataTransportStreamRangeReader(this, begin, end);\n        this._pdfDataRangeTransport.requestDataRange(begin, end);\n        this._rangeReaders.push(reader);\n        return reader;\n      }\n      cancelAllRequests(reason) {\n        this._fullRequestReader?.cancel(reason);\n        for (const reader of this._rangeReaders.slice(0)) {\n          reader.cancel(reason);\n        }\n        this._pdfDataRangeTransport.abort();\n      }\n    }\n    class PDFDataTransportStreamReader {\n      constructor(stream, queuedChunks, progressiveDone = false, contentDispositionFilename = null) {\n        this._stream = stream;\n        this._done = progressiveDone || false;\n        this._filename = (0, _display_utils_js__WEBPACK_IMPORTED_MODULE_1__.isPdfFile)(contentDispositionFilename) ? contentDispositionFilename : null;\n        this._queuedChunks = queuedChunks || [];\n        this._loaded = 0;\n        for (const chunk of this._queuedChunks) {\n          this._loaded += chunk.byteLength;\n        }\n        this._requests = [];\n        this._headersReady = Promise.resolve();\n        stream._fullRequestReader = this;\n        this.onProgress = null;\n      }\n      _enqueue(chunk) {\n        if (this._done) {\n          return;\n        }\n        if (this._requests.length > 0) {\n          const requestCapability = this._requests.shift();\n          requestCapability.resolve({\n            value: chunk,\n            done: false\n          });\n        } else {\n          this._queuedChunks.push(chunk);\n        }\n        this._loaded += chunk.byteLength;\n      }\n      get headersReady() {\n        return this._headersReady;\n      }\n      get filename() {\n        return this._filename;\n      }\n      get isRangeSupported() {\n        return this._stream._isRangeSupported;\n      }\n      get isStreamingSupported() {\n        return this._stream._isStreamingSupported;\n      }\n      get contentLength() {\n        return this._stream._contentLength;\n      }\n      async read() {\n        if (this._queuedChunks.length > 0) {\n          const chunk = this._queuedChunks.shift();\n          return {\n            value: chunk,\n            done: false\n          };\n        }\n        if (this._done) {\n          return {\n            value: undefined,\n            done: true\n          };\n        }\n        const requestCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n        this._requests.push(requestCapability);\n        return requestCapability.promise;\n      }\n      cancel(reason) {\n        this._done = true;\n        for (const requestCapability of this._requests) {\n          requestCapability.resolve({\n            value: undefined,\n            done: true\n          });\n        }\n        this._requests.length = 0;\n      }\n      progressiveDone() {\n        if (this._done) {\n          return;\n        }\n        this._done = true;\n      }\n    }\n    class PDFDataTransportStreamRangeReader {\n      constructor(stream, begin, end) {\n        this._stream = stream;\n        this._begin = begin;\n        this._end = end;\n        this._queuedChunk = null;\n        this._requests = [];\n        this._done = false;\n        this.onProgress = null;\n      }\n      _enqueue(chunk) {\n        if (this._done) {\n          return;\n        }\n        if (this._requests.length === 0) {\n          this._queuedChunk = chunk;\n        } else {\n          const requestsCapability = this._requests.shift();\n          requestsCapability.resolve({\n            value: chunk,\n            done: false\n          });\n          for (const requestCapability of this._requests) {\n            requestCapability.resolve({\n              value: undefined,\n              done: true\n            });\n          }\n          this._requests.length = 0;\n        }\n        this._done = true;\n        this._stream._removeRangeReader(this);\n      }\n      get isStreamingSupported() {\n        return false;\n      }\n      async read() {\n        if (this._queuedChunk) {\n          const chunk = this._queuedChunk;\n          this._queuedChunk = null;\n          return {\n            value: chunk,\n            done: false\n          };\n        }\n        if (this._done) {\n          return {\n            value: undefined,\n            done: true\n          };\n        }\n        const requestCapability = new _shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n        this._requests.push(requestCapability);\n        return requestCapability.promise;\n      }\n      cancel(reason) {\n        this._done = true;\n        for (const requestCapability of this._requests) {\n          requestCapability.resolve({\n            value: undefined,\n            done: true\n          });\n        }\n        this._requests.length = 0;\n        this._stream._removeRangeReader(this);\n      }\n    }\n\n    /***/\n  },\n\n  /***/368: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */GlobalWorkerOptions: () => /* binding */GlobalWorkerOptions\n      /* harmony export */\n    });\n    const GlobalWorkerOptions = Object.create(null);\n    GlobalWorkerOptions.workerPort = null;\n    GlobalWorkerOptions.workerSrc = \"\";\n\n    /***/\n  },\n\n  /***/160: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */XfaLayer: () => /* binding */XfaLayer\n      /* harmony export */\n    });\n    /* harmony import */\n    var _xfa_text_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(521);\n    class XfaLayer {\n      static setupStorage(html, id, element, storage, intent) {\n        const storedData = storage.getValue(id, {\n          value: null\n        });\n        switch (element.name) {\n          case \"textarea\":\n            if (storedData.value !== null) {\n              html.textContent = storedData.value;\n            }\n            if (intent === \"print\") {\n              break;\n            }\n            html.addEventListener(\"input\", event => {\n              storage.setValue(id, {\n                value: event.target.value\n              });\n            });\n            break;\n          case \"input\":\n            if (element.attributes.type === \"radio\" || element.attributes.type === \"checkbox\") {\n              if (storedData.value === element.attributes.xfaOn) {\n                html.setAttribute(\"checked\", true);\n              } else if (storedData.value === element.attributes.xfaOff) {\n                html.removeAttribute(\"checked\");\n              }\n              if (intent === \"print\") {\n                break;\n              }\n              html.addEventListener(\"change\", event => {\n                storage.setValue(id, {\n                  value: event.target.checked ? event.target.getAttribute(\"xfaOn\") : event.target.getAttribute(\"xfaOff\")\n                });\n              });\n            } else {\n              if (storedData.value !== null) {\n                html.setAttribute(\"value\", storedData.value);\n              }\n              if (intent === \"print\") {\n                break;\n              }\n              html.addEventListener(\"input\", event => {\n                storage.setValue(id, {\n                  value: event.target.value\n                });\n              });\n            }\n            break;\n          case \"select\":\n            if (storedData.value !== null) {\n              html.setAttribute(\"value\", storedData.value);\n              for (const option of element.children) {\n                if (option.attributes.value === storedData.value) {\n                  option.attributes.selected = true;\n                } else if (option.attributes.hasOwnProperty(\"selected\")) {\n                  delete option.attributes.selected;\n                }\n              }\n            }\n            html.addEventListener(\"input\", event => {\n              const options = event.target.options;\n              const value = options.selectedIndex === -1 ? \"\" : options[options.selectedIndex].value;\n              storage.setValue(id, {\n                value\n              });\n            });\n            break;\n        }\n      }\n      static setAttributes({\n        html,\n        element,\n        storage = null,\n        intent,\n        linkService\n      }) {\n        const {\n          attributes\n        } = element;\n        const isHTMLAnchorElement = html instanceof HTMLAnchorElement;\n        if (attributes.type === \"radio\") {\n          attributes.name = `${attributes.name}-${intent}`;\n        }\n        for (const [key, value] of Object.entries(attributes)) {\n          if (value === null || value === undefined) {\n            continue;\n          }\n          switch (key) {\n            case \"class\":\n              if (value.length) {\n                html.setAttribute(key, value.join(\" \"));\n              }\n              break;\n            case \"dataId\":\n              break;\n            case \"id\":\n              html.setAttribute(\"data-element-id\", value);\n              break;\n            case \"style\":\n              Object.assign(html.style, value);\n              break;\n            case \"textContent\":\n              html.textContent = value;\n              break;\n            default:\n              if (!isHTMLAnchorElement || key !== \"href\" && key !== \"newWindow\") {\n                html.setAttribute(key, value);\n              }\n          }\n        }\n        if (isHTMLAnchorElement) {\n          linkService.addLinkAttributes(html, attributes.href, attributes.newWindow);\n        }\n        if (storage && attributes.dataId) {\n          this.setupStorage(html, attributes.dataId, element, storage);\n        }\n      }\n      static render(parameters) {\n        const storage = parameters.annotationStorage;\n        const linkService = parameters.linkService;\n        const root = parameters.xfaHtml;\n        const intent = parameters.intent || \"display\";\n        const rootHtml = document.createElement(root.name);\n        if (root.attributes) {\n          this.setAttributes({\n            html: rootHtml,\n            element: root,\n            intent,\n            linkService\n          });\n        }\n        const isNotForRichText = intent !== \"richText\";\n        const rootDiv = parameters.div;\n        rootDiv.append(rootHtml);\n        if (parameters.viewport) {\n          const transform = `matrix(${parameters.viewport.transform.join(\",\")})`;\n          rootDiv.style.transform = transform;\n        }\n        if (isNotForRichText) {\n          rootDiv.setAttribute(\"class\", \"xfaLayer xfaFont\");\n        }\n        const textDivs = [];\n        if (root.children.length === 0) {\n          if (root.value) {\n            const node = document.createTextNode(root.value);\n            rootHtml.append(node);\n            if (isNotForRichText && _xfa_text_js__WEBPACK_IMPORTED_MODULE_0__.XfaText.shouldBuildText(root.name)) {\n              textDivs.push(node);\n            }\n          }\n          return {\n            textDivs\n          };\n        }\n        const stack = [[root, -1, rootHtml]];\n        while (stack.length > 0) {\n          const [parent, i, html] = stack.at(-1);\n          if (i + 1 === parent.children.length) {\n            stack.pop();\n            continue;\n          }\n          const child = parent.children[++stack.at(-1)[1]];\n          if (child === null) {\n            continue;\n          }\n          const {\n            name\n          } = child;\n          if (name === \"#text\") {\n            const node = document.createTextNode(child.value);\n            textDivs.push(node);\n            html.append(node);\n            continue;\n          }\n          const childHtml = child?.attributes?.xmlns ? document.createElementNS(child.attributes.xmlns, name) : document.createElement(name);\n          html.append(childHtml);\n          if (child.attributes) {\n            this.setAttributes({\n              html: childHtml,\n              element: child,\n              storage,\n              intent,\n              linkService\n            });\n          }\n          if (child.children?.length > 0) {\n            stack.push([child, -1, childHtml]);\n          } else if (child.value) {\n            const node = document.createTextNode(child.value);\n            if (isNotForRichText && _xfa_text_js__WEBPACK_IMPORTED_MODULE_0__.XfaText.shouldBuildText(name)) {\n              textDivs.push(node);\n            }\n            childHtml.append(node);\n          }\n        }\n        for (const el of rootDiv.querySelectorAll(\".xfaNonInteractive input, .xfaNonInteractive textarea\")) {\n          el.setAttribute(\"readOnly\", true);\n        }\n        return {\n          textDivs\n        };\n      }\n      static update(parameters) {\n        const transform = `matrix(${parameters.viewport.transform.join(\",\")})`;\n        parameters.div.style.transform = transform;\n        parameters.div.hidden = false;\n      }\n    }\n\n    /***/\n  },\n\n  /***/521: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */XfaText: () => /* binding */XfaText\n      /* harmony export */\n    });\n    class XfaText {\n      static textContent(xfa) {\n        const items = [];\n        const output = {\n          items,\n          styles: Object.create(null)\n        };\n        function walk(node) {\n          if (!node) {\n            return;\n          }\n          let str = null;\n          const name = node.name;\n          if (name === \"#text\") {\n            str = node.value;\n          } else if (!XfaText.shouldBuildText(name)) {\n            return;\n          } else if (node?.attributes?.textContent) {\n            str = node.attributes.textContent;\n          } else if (node.value) {\n            str = node.value;\n          }\n          if (str !== null) {\n            items.push({\n              str\n            });\n          }\n          if (!node.children) {\n            return;\n          }\n          for (const child of node.children) {\n            walk(child);\n          }\n        }\n        walk(xfa);\n        return output;\n      }\n      static shouldBuildText(name) {\n        return !(name === \"textarea\" || name === \"input\" || name === \"option\" || name === \"select\");\n      }\n    }\n\n    /***/\n  },\n\n  /***/907: /***/(__webpack_module__, __webpack_exports__, __webpack_require__) => {\n    __webpack_require__.a(__webpack_module__, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => {\n      try {\n        /* harmony export */__webpack_require__.d(__webpack_exports__, {\n          /* harmony export */AbortException: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AbortException,\n          /* harmony export */AnnotationEditorLayer: () => /* reexport safe */_display_editor_annotation_editor_layer_js__WEBPACK_IMPORTED_MODULE_4__.AnnotationEditorLayer,\n          /* harmony export */AnnotationEditorParamsType: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationEditorParamsType,\n          /* harmony export */AnnotationEditorType: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationEditorType,\n          /* harmony export */AnnotationEditorUIManager: () => /* reexport safe */_display_editor_tools_js__WEBPACK_IMPORTED_MODULE_5__.AnnotationEditorUIManager,\n          /* harmony export */AnnotationLayer: () => /* reexport safe */_display_annotation_layer_js__WEBPACK_IMPORTED_MODULE_6__.AnnotationLayer,\n          /* harmony export */AnnotationMode: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.AnnotationMode,\n          /* harmony export */CMapCompressionType: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.CMapCompressionType,\n          /* harmony export */DOMSVGFactory: () => /* reexport safe */_display_display_utils_js__WEBPACK_IMPORTED_MODULE_2__.DOMSVGFactory,\n          /* harmony export */DrawLayer: () => /* reexport safe */_display_draw_layer_js__WEBPACK_IMPORTED_MODULE_7__.DrawLayer,\n          /* harmony export */FeatureTest: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.FeatureTest,\n          /* harmony export */GlobalWorkerOptions: () => /* reexport safe */_display_worker_options_js__WEBPACK_IMPORTED_MODULE_8__.GlobalWorkerOptions,\n          /* harmony export */ImageKind: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.ImageKind,\n          /* harmony export */InvalidPDFException: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.InvalidPDFException,\n          /* harmony export */MissingPDFException: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.MissingPDFException,\n          /* harmony export */OPS: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.OPS,\n          /* harmony export */Outliner: () => /* reexport safe */_display_editor_outliner_js__WEBPACK_IMPORTED_MODULE_9__.Outliner,\n          /* harmony export */PDFDataRangeTransport: () => /* reexport safe */_display_api_js__WEBPACK_IMPORTED_MODULE_1__.PDFDataRangeTransport,\n          /* harmony export */PDFDateString: () => /* reexport safe */_display_display_utils_js__WEBPACK_IMPORTED_MODULE_2__.PDFDateString,\n          /* harmony export */PDFWorker: () => /* reexport safe */_display_api_js__WEBPACK_IMPORTED_MODULE_1__.PDFWorker,\n          /* harmony export */PasswordResponses: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PasswordResponses,\n          /* harmony export */PermissionFlag: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PermissionFlag,\n          /* harmony export */PixelsPerInch: () => /* reexport safe */_display_display_utils_js__WEBPACK_IMPORTED_MODULE_2__.PixelsPerInch,\n          /* harmony export */PromiseCapability: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability,\n          /* harmony export */RenderingCancelledException: () => /* reexport safe */_display_display_utils_js__WEBPACK_IMPORTED_MODULE_2__.RenderingCancelledException,\n          /* harmony export */UnexpectedResponseException: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.UnexpectedResponseException,\n          /* harmony export */Util: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.Util,\n          /* harmony export */VerbosityLevel: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.VerbosityLevel,\n          /* harmony export */XfaLayer: () => /* reexport safe */_display_xfa_layer_js__WEBPACK_IMPORTED_MODULE_10__.XfaLayer,\n          /* harmony export */build: () => /* reexport safe */_display_api_js__WEBPACK_IMPORTED_MODULE_1__.build,\n          /* harmony export */createValidAbsoluteUrl: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.createValidAbsoluteUrl,\n          /* harmony export */fetchData: () => /* reexport safe */_display_display_utils_js__WEBPACK_IMPORTED_MODULE_2__.fetchData,\n          /* harmony export */getDocument: () => /* reexport safe */_display_api_js__WEBPACK_IMPORTED_MODULE_1__.getDocument,\n          /* harmony export */getFilenameFromUrl: () => /* reexport safe */_display_display_utils_js__WEBPACK_IMPORTED_MODULE_2__.getFilenameFromUrl,\n          /* harmony export */getPdfFilenameFromUrl: () => /* reexport safe */_display_display_utils_js__WEBPACK_IMPORTED_MODULE_2__.getPdfFilenameFromUrl,\n          /* harmony export */getXfaPageViewport: () => /* reexport safe */_display_display_utils_js__WEBPACK_IMPORTED_MODULE_2__.getXfaPageViewport,\n          /* harmony export */isDataScheme: () => /* reexport safe */_display_display_utils_js__WEBPACK_IMPORTED_MODULE_2__.isDataScheme,\n          /* harmony export */isPdfFile: () => /* reexport safe */_display_display_utils_js__WEBPACK_IMPORTED_MODULE_2__.isPdfFile,\n          /* harmony export */noContextMenu: () => /* reexport safe */_display_display_utils_js__WEBPACK_IMPORTED_MODULE_2__.noContextMenu,\n          /* harmony export */normalizeUnicode: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.normalizeUnicode,\n          /* harmony export */renderTextLayer: () => /* reexport safe */_display_text_layer_js__WEBPACK_IMPORTED_MODULE_3__.renderTextLayer,\n          /* harmony export */setLayerDimensions: () => /* reexport safe */_display_display_utils_js__WEBPACK_IMPORTED_MODULE_2__.setLayerDimensions,\n          /* harmony export */shadow: () => /* reexport safe */_shared_util_js__WEBPACK_IMPORTED_MODULE_0__.shadow,\n          /* harmony export */updateTextLayer: () => /* reexport safe */_display_text_layer_js__WEBPACK_IMPORTED_MODULE_3__.updateTextLayer,\n          /* harmony export */version: () => /* reexport safe */_display_api_js__WEBPACK_IMPORTED_MODULE_1__.version\n          /* harmony export */\n        });\n        /* harmony import */\n        var _shared_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n        /* harmony import */\n        var _display_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(406);\n        /* harmony import */\n        var _display_display_utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(473);\n        /* harmony import */\n        var _display_text_layer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(739);\n        /* harmony import */\n        var _display_editor_annotation_editor_layer_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(331);\n        /* harmony import */\n        var _display_editor_tools_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(812);\n        /* harmony import */\n        var _display_annotation_layer_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(640);\n        /* harmony import */\n        var _display_draw_layer_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(423);\n        /* harmony import */\n        var _display_worker_options_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(368);\n        /* harmony import */\n        var _display_editor_outliner_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(405);\n        /* harmony import */\n        var _display_xfa_layer_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(160);\n        var __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_display_api_js__WEBPACK_IMPORTED_MODULE_1__]);\n        _display_api_js__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n        const pdfjsVersion = '4.0.269';\n        const pdfjsBuild = 'f4b396f6c';\n        __webpack_async_result__();\n      } catch (e) {\n        __webpack_async_result__(e);\n      }\n    });\n\n    /***/\n  },\n\n  /***/694: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */MessageHandler: () => /* binding */MessageHandler\n      /* harmony export */\n    });\n    /* harmony import */\n    var _util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n    const CallbackKind = {\n      UNKNOWN: 0,\n      DATA: 1,\n      ERROR: 2\n    };\n    const StreamKind = {\n      UNKNOWN: 0,\n      CANCEL: 1,\n      CANCEL_COMPLETE: 2,\n      CLOSE: 3,\n      ENQUEUE: 4,\n      ERROR: 5,\n      PULL: 6,\n      PULL_COMPLETE: 7,\n      START_COMPLETE: 8\n    };\n    function wrapReason(reason) {\n      if (!(reason instanceof Error || typeof reason === \"object\" && reason !== null)) {\n        (0, _util_js__WEBPACK_IMPORTED_MODULE_0__.unreachable)('wrapReason: Expected \"reason\" to be a (possibly cloned) Error.');\n      }\n      switch (reason.name) {\n        case \"AbortException\":\n          return new _util_js__WEBPACK_IMPORTED_MODULE_0__.AbortException(reason.message);\n        case \"MissingPDFException\":\n          return new _util_js__WEBPACK_IMPORTED_MODULE_0__.MissingPDFException(reason.message);\n        case \"PasswordException\":\n          return new _util_js__WEBPACK_IMPORTED_MODULE_0__.PasswordException(reason.message, reason.code);\n        case \"UnexpectedResponseException\":\n          return new _util_js__WEBPACK_IMPORTED_MODULE_0__.UnexpectedResponseException(reason.message, reason.status);\n        case \"UnknownErrorException\":\n          return new _util_js__WEBPACK_IMPORTED_MODULE_0__.UnknownErrorException(reason.message, reason.details);\n        default:\n          return new _util_js__WEBPACK_IMPORTED_MODULE_0__.UnknownErrorException(reason.message, reason.toString());\n      }\n    }\n    class MessageHandler {\n      constructor(sourceName, targetName, comObj) {\n        this.sourceName = sourceName;\n        this.targetName = targetName;\n        this.comObj = comObj;\n        this.callbackId = 1;\n        this.streamId = 1;\n        this.streamSinks = Object.create(null);\n        this.streamControllers = Object.create(null);\n        this.callbackCapabilities = Object.create(null);\n        this.actionHandler = Object.create(null);\n        this._onComObjOnMessage = event => {\n          const data = event.data;\n          if (data.targetName !== this.sourceName) {\n            return;\n          }\n          if (data.stream) {\n            this.#processStreamMessage(data);\n            return;\n          }\n          if (data.callback) {\n            const callbackId = data.callbackId;\n            const capability = this.callbackCapabilities[callbackId];\n            if (!capability) {\n              throw new Error(`Cannot resolve callback ${callbackId}`);\n            }\n            delete this.callbackCapabilities[callbackId];\n            if (data.callback === CallbackKind.DATA) {\n              capability.resolve(data.data);\n            } else if (data.callback === CallbackKind.ERROR) {\n              capability.reject(wrapReason(data.reason));\n            } else {\n              throw new Error(\"Unexpected callback case\");\n            }\n            return;\n          }\n          const action = this.actionHandler[data.action];\n          if (!action) {\n            throw new Error(`Unknown action from worker: ${data.action}`);\n          }\n          if (data.callbackId) {\n            const cbSourceName = this.sourceName;\n            const cbTargetName = data.sourceName;\n            new Promise(function (resolve) {\n              resolve(action(data.data));\n            }).then(function (result) {\n              comObj.postMessage({\n                sourceName: cbSourceName,\n                targetName: cbTargetName,\n                callback: CallbackKind.DATA,\n                callbackId: data.callbackId,\n                data: result\n              });\n            }, function (reason) {\n              comObj.postMessage({\n                sourceName: cbSourceName,\n                targetName: cbTargetName,\n                callback: CallbackKind.ERROR,\n                callbackId: data.callbackId,\n                reason: wrapReason(reason)\n              });\n            });\n            return;\n          }\n          if (data.streamId) {\n            this.#createStreamSink(data);\n            return;\n          }\n          action(data.data);\n        };\n        comObj.addEventListener(\"message\", this._onComObjOnMessage);\n      }\n      on(actionName, handler) {\n        const ah = this.actionHandler;\n        if (ah[actionName]) {\n          throw new Error(`There is already an actionName called \"${actionName}\"`);\n        }\n        ah[actionName] = handler;\n      }\n      send(actionName, data, transfers) {\n        this.comObj.postMessage({\n          sourceName: this.sourceName,\n          targetName: this.targetName,\n          action: actionName,\n          data\n        }, transfers);\n      }\n      sendWithPromise(actionName, data, transfers) {\n        const callbackId = this.callbackId++;\n        const capability = new _util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n        this.callbackCapabilities[callbackId] = capability;\n        try {\n          this.comObj.postMessage({\n            sourceName: this.sourceName,\n            targetName: this.targetName,\n            action: actionName,\n            callbackId,\n            data\n          }, transfers);\n        } catch (ex) {\n          capability.reject(ex);\n        }\n        return capability.promise;\n      }\n      sendWithStream(actionName, data, queueingStrategy, transfers) {\n        const streamId = this.streamId++,\n          sourceName = this.sourceName,\n          targetName = this.targetName,\n          comObj = this.comObj;\n        return new ReadableStream({\n          start: controller => {\n            const startCapability = new _util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n            this.streamControllers[streamId] = {\n              controller,\n              startCall: startCapability,\n              pullCall: null,\n              cancelCall: null,\n              isClosed: false\n            };\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              action: actionName,\n              streamId,\n              data,\n              desiredSize: controller.desiredSize\n            }, transfers);\n            return startCapability.promise;\n          },\n          pull: controller => {\n            const pullCapability = new _util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n            this.streamControllers[streamId].pullCall = pullCapability;\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              stream: StreamKind.PULL,\n              streamId,\n              desiredSize: controller.desiredSize\n            });\n            return pullCapability.promise;\n          },\n          cancel: reason => {\n            (0, _util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(reason instanceof Error, \"cancel must have a valid reason\");\n            const cancelCapability = new _util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n            this.streamControllers[streamId].cancelCall = cancelCapability;\n            this.streamControllers[streamId].isClosed = true;\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              stream: StreamKind.CANCEL,\n              streamId,\n              reason: wrapReason(reason)\n            });\n            return cancelCapability.promise;\n          }\n        }, queueingStrategy);\n      }\n      #createStreamSink(data) {\n        const streamId = data.streamId,\n          sourceName = this.sourceName,\n          targetName = data.sourceName,\n          comObj = this.comObj;\n        const self = this,\n          action = this.actionHandler[data.action];\n        const streamSink = {\n          enqueue(chunk, size = 1, transfers) {\n            if (this.isCancelled) {\n              return;\n            }\n            const lastDesiredSize = this.desiredSize;\n            this.desiredSize -= size;\n            if (lastDesiredSize > 0 && this.desiredSize <= 0) {\n              this.sinkCapability = new _util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability();\n              this.ready = this.sinkCapability.promise;\n            }\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              stream: StreamKind.ENQUEUE,\n              streamId,\n              chunk\n            }, transfers);\n          },\n          close() {\n            if (this.isCancelled) {\n              return;\n            }\n            this.isCancelled = true;\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              stream: StreamKind.CLOSE,\n              streamId\n            });\n            delete self.streamSinks[streamId];\n          },\n          error(reason) {\n            (0, _util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(reason instanceof Error, \"error must have a valid reason\");\n            if (this.isCancelled) {\n              return;\n            }\n            this.isCancelled = true;\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              stream: StreamKind.ERROR,\n              streamId,\n              reason: wrapReason(reason)\n            });\n          },\n          sinkCapability: new _util_js__WEBPACK_IMPORTED_MODULE_0__.PromiseCapability(),\n          onPull: null,\n          onCancel: null,\n          isCancelled: false,\n          desiredSize: data.desiredSize,\n          ready: null\n        };\n        streamSink.sinkCapability.resolve();\n        streamSink.ready = streamSink.sinkCapability.promise;\n        this.streamSinks[streamId] = streamSink;\n        new Promise(function (resolve) {\n          resolve(action(data.data, streamSink));\n        }).then(function () {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.START_COMPLETE,\n            streamId,\n            success: true\n          });\n        }, function (reason) {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.START_COMPLETE,\n            streamId,\n            reason: wrapReason(reason)\n          });\n        });\n      }\n      #processStreamMessage(data) {\n        const streamId = data.streamId,\n          sourceName = this.sourceName,\n          targetName = data.sourceName,\n          comObj = this.comObj;\n        const streamController = this.streamControllers[streamId],\n          streamSink = this.streamSinks[streamId];\n        switch (data.stream) {\n          case StreamKind.START_COMPLETE:\n            if (data.success) {\n              streamController.startCall.resolve();\n            } else {\n              streamController.startCall.reject(wrapReason(data.reason));\n            }\n            break;\n          case StreamKind.PULL_COMPLETE:\n            if (data.success) {\n              streamController.pullCall.resolve();\n            } else {\n              streamController.pullCall.reject(wrapReason(data.reason));\n            }\n            break;\n          case StreamKind.PULL:\n            if (!streamSink) {\n              comObj.postMessage({\n                sourceName,\n                targetName,\n                stream: StreamKind.PULL_COMPLETE,\n                streamId,\n                success: true\n              });\n              break;\n            }\n            if (streamSink.desiredSize <= 0 && data.desiredSize > 0) {\n              streamSink.sinkCapability.resolve();\n            }\n            streamSink.desiredSize = data.desiredSize;\n            new Promise(function (resolve) {\n              resolve(streamSink.onPull?.());\n            }).then(function () {\n              comObj.postMessage({\n                sourceName,\n                targetName,\n                stream: StreamKind.PULL_COMPLETE,\n                streamId,\n                success: true\n              });\n            }, function (reason) {\n              comObj.postMessage({\n                sourceName,\n                targetName,\n                stream: StreamKind.PULL_COMPLETE,\n                streamId,\n                reason: wrapReason(reason)\n              });\n            });\n            break;\n          case StreamKind.ENQUEUE:\n            (0, _util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(streamController, \"enqueue should have stream controller\");\n            if (streamController.isClosed) {\n              break;\n            }\n            streamController.controller.enqueue(data.chunk);\n            break;\n          case StreamKind.CLOSE:\n            (0, _util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(streamController, \"close should have stream controller\");\n            if (streamController.isClosed) {\n              break;\n            }\n            streamController.isClosed = true;\n            streamController.controller.close();\n            this.#deleteStreamController(streamController, streamId);\n            break;\n          case StreamKind.ERROR:\n            (0, _util_js__WEBPACK_IMPORTED_MODULE_0__.assert)(streamController, \"error should have stream controller\");\n            streamController.controller.error(wrapReason(data.reason));\n            this.#deleteStreamController(streamController, streamId);\n            break;\n          case StreamKind.CANCEL_COMPLETE:\n            if (data.success) {\n              streamController.cancelCall.resolve();\n            } else {\n              streamController.cancelCall.reject(wrapReason(data.reason));\n            }\n            this.#deleteStreamController(streamController, streamId);\n            break;\n          case StreamKind.CANCEL:\n            if (!streamSink) {\n              break;\n            }\n            new Promise(function (resolve) {\n              resolve(streamSink.onCancel?.(wrapReason(data.reason)));\n            }).then(function () {\n              comObj.postMessage({\n                sourceName,\n                targetName,\n                stream: StreamKind.CANCEL_COMPLETE,\n                streamId,\n                success: true\n              });\n            }, function (reason) {\n              comObj.postMessage({\n                sourceName,\n                targetName,\n                stream: StreamKind.CANCEL_COMPLETE,\n                streamId,\n                reason: wrapReason(reason)\n              });\n            });\n            streamSink.sinkCapability.reject(wrapReason(data.reason));\n            streamSink.isCancelled = true;\n            delete this.streamSinks[streamId];\n            break;\n          default:\n            throw new Error(\"Unexpected stream case\");\n        }\n      }\n      async #deleteStreamController(streamController, streamId) {\n        await Promise.allSettled([streamController.startCall?.promise, streamController.pullCall?.promise, streamController.cancelCall?.promise]);\n        delete this.streamControllers[streamId];\n      }\n      destroy() {\n        this.comObj.removeEventListener(\"message\", this._onComObjOnMessage);\n      }\n    }\n\n    /***/\n  },\n\n  /***/825: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */MurmurHash3_64: () => /* binding */MurmurHash3_64\n      /* harmony export */\n    });\n    /* harmony import */\n    var _util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(266);\n    const SEED = 0xc3d2e1f0;\n    const MASK_HIGH = 0xffff0000;\n    const MASK_LOW = 0xffff;\n    class MurmurHash3_64 {\n      constructor(seed) {\n        this.h1 = seed ? seed & 0xffffffff : SEED;\n        this.h2 = seed ? seed & 0xffffffff : SEED;\n      }\n      update(input) {\n        let data, length;\n        if (typeof input === \"string\") {\n          data = new Uint8Array(input.length * 2);\n          length = 0;\n          for (let i = 0, ii = input.length; i < ii; i++) {\n            const code = input.charCodeAt(i);\n            if (code <= 0xff) {\n              data[length++] = code;\n            } else {\n              data[length++] = code >>> 8;\n              data[length++] = code & 0xff;\n            }\n          }\n        } else if ((0, _util_js__WEBPACK_IMPORTED_MODULE_0__.isArrayBuffer)(input)) {\n          data = input.slice();\n          length = data.byteLength;\n        } else {\n          throw new Error(\"Wrong data format in MurmurHash3_64_update. \" + \"Input must be a string or array.\");\n        }\n        const blockCounts = length >> 2;\n        const tailLength = length - blockCounts * 4;\n        const dataUint32 = new Uint32Array(data.buffer, 0, blockCounts);\n        let k1 = 0,\n          k2 = 0;\n        let h1 = this.h1,\n          h2 = this.h2;\n        const C1 = 0xcc9e2d51,\n          C2 = 0x1b873593;\n        const C1_LOW = C1 & MASK_LOW,\n          C2_LOW = C2 & MASK_LOW;\n        for (let i = 0; i < blockCounts; i++) {\n          if (i & 1) {\n            k1 = dataUint32[i];\n            k1 = k1 * C1 & MASK_HIGH | k1 * C1_LOW & MASK_LOW;\n            k1 = k1 << 15 | k1 >>> 17;\n            k1 = k1 * C2 & MASK_HIGH | k1 * C2_LOW & MASK_LOW;\n            h1 ^= k1;\n            h1 = h1 << 13 | h1 >>> 19;\n            h1 = h1 * 5 + 0xe6546b64;\n          } else {\n            k2 = dataUint32[i];\n            k2 = k2 * C1 & MASK_HIGH | k2 * C1_LOW & MASK_LOW;\n            k2 = k2 << 15 | k2 >>> 17;\n            k2 = k2 * C2 & MASK_HIGH | k2 * C2_LOW & MASK_LOW;\n            h2 ^= k2;\n            h2 = h2 << 13 | h2 >>> 19;\n            h2 = h2 * 5 + 0xe6546b64;\n          }\n        }\n        k1 = 0;\n        switch (tailLength) {\n          case 3:\n            k1 ^= data[blockCounts * 4 + 2] << 16;\n          case 2:\n            k1 ^= data[blockCounts * 4 + 1] << 8;\n          case 1:\n            k1 ^= data[blockCounts * 4];\n            k1 = k1 * C1 & MASK_HIGH | k1 * C1_LOW & MASK_LOW;\n            k1 = k1 << 15 | k1 >>> 17;\n            k1 = k1 * C2 & MASK_HIGH | k1 * C2_LOW & MASK_LOW;\n            if (blockCounts & 1) {\n              h1 ^= k1;\n            } else {\n              h2 ^= k1;\n            }\n        }\n        this.h1 = h1;\n        this.h2 = h2;\n      }\n      hexdigest() {\n        let h1 = this.h1,\n          h2 = this.h2;\n        h1 ^= h2 >>> 1;\n        h1 = h1 * 0xed558ccd & MASK_HIGH | h1 * 0x8ccd & MASK_LOW;\n        h2 = h2 * 0xff51afd7 & MASK_HIGH | ((h2 << 16 | h1 >>> 16) * 0xafd7ed55 & MASK_HIGH) >>> 16;\n        h1 ^= h2 >>> 1;\n        h1 = h1 * 0x1a85ec53 & MASK_HIGH | h1 * 0xec53 & MASK_LOW;\n        h2 = h2 * 0xc4ceb9fe & MASK_HIGH | ((h2 << 16 | h1 >>> 16) * 0xb9fe1a85 & MASK_HIGH) >>> 16;\n        h1 ^= h2 >>> 1;\n        return (h1 >>> 0).toString(16).padStart(8, \"0\") + (h2 >>> 0).toString(16).padStart(8, \"0\");\n      }\n    }\n\n    /***/\n  },\n\n  /***/266: /***/(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n    /* harmony export */__webpack_require__.d(__webpack_exports__, {\n      /* harmony export */AbortException: () => /* binding */AbortException,\n      /* harmony export */AnnotationBorderStyleType: () => /* binding */AnnotationBorderStyleType,\n      /* harmony export */AnnotationEditorParamsType: () => /* binding */AnnotationEditorParamsType,\n      /* harmony export */AnnotationEditorPrefix: () => /* binding */AnnotationEditorPrefix,\n      /* harmony export */AnnotationEditorType: () => /* binding */AnnotationEditorType,\n      /* harmony export */AnnotationMode: () => /* binding */AnnotationMode,\n      /* harmony export */AnnotationPrefix: () => /* binding */AnnotationPrefix,\n      /* harmony export */AnnotationType: () => /* binding */AnnotationType,\n      /* harmony export */BaseException: () => /* binding */BaseException,\n      /* harmony export */CMapCompressionType: () => /* binding */CMapCompressionType,\n      /* harmony export */FONT_IDENTITY_MATRIX: () => /* binding */FONT_IDENTITY_MATRIX,\n      /* harmony export */FeatureTest: () => /* binding */FeatureTest,\n      /* harmony export */FormatError: () => /* binding */FormatError,\n      /* harmony export */IDENTITY_MATRIX: () => /* binding */IDENTITY_MATRIX,\n      /* harmony export */ImageKind: () => /* binding */ImageKind,\n      /* harmony export */InvalidPDFException: () => /* binding */InvalidPDFException,\n      /* harmony export */LINE_FACTOR: () => /* binding */LINE_FACTOR,\n      /* harmony export */MAX_IMAGE_SIZE_TO_CACHE: () => /* binding */MAX_IMAGE_SIZE_TO_CACHE,\n      /* harmony export */MissingPDFException: () => /* binding */MissingPDFException,\n      /* harmony export */OPS: () => /* binding */OPS,\n      /* harmony export */PasswordException: () => /* binding */PasswordException,\n      /* harmony export */PasswordResponses: () => /* binding */PasswordResponses,\n      /* harmony export */PermissionFlag: () => /* binding */PermissionFlag,\n      /* harmony export */PromiseCapability: () => /* binding */PromiseCapability,\n      /* harmony export */RenderingIntentFlag: () => /* binding */RenderingIntentFlag,\n      /* harmony export */TextRenderingMode: () => /* binding */TextRenderingMode,\n      /* harmony export */UnexpectedResponseException: () => /* binding */UnexpectedResponseException,\n      /* harmony export */UnknownErrorException: () => /* binding */UnknownErrorException,\n      /* harmony export */Util: () => /* binding */Util,\n      /* harmony export */VerbosityLevel: () => /* binding */VerbosityLevel,\n      /* harmony export */assert: () => /* binding */assert,\n      /* harmony export */bytesToString: () => /* binding */bytesToString,\n      /* harmony export */createValidAbsoluteUrl: () => /* binding */createValidAbsoluteUrl,\n      /* harmony export */getUuid: () => /* binding */getUuid,\n      /* harmony export */getVerbosityLevel: () => /* binding */getVerbosityLevel,\n      /* harmony export */info: () => /* binding */info,\n      /* harmony export */isArrayBuffer: () => /* binding */isArrayBuffer,\n      /* harmony export */isNodeJS: () => /* binding */isNodeJS,\n      /* harmony export */normalizeUnicode: () => /* binding */normalizeUnicode,\n      /* harmony export */objectFromMap: () => /* binding */objectFromMap,\n      /* harmony export */setVerbosityLevel: () => /* binding */setVerbosityLevel,\n      /* harmony export */shadow: () => /* binding */shadow,\n      /* harmony export */string32: () => /* binding */string32,\n      /* harmony export */stringToBytes: () => /* binding */stringToBytes,\n      /* harmony export */unreachable: () => /* binding */unreachable,\n      /* harmony export */warn: () => /* binding */warn\n      /* harmony export */\n    });\n    /* unused harmony exports AnnotationActionEventType, AnnotationFieldFlag, AnnotationFlag, AnnotationReplyType, BASELINE_FACTOR, DocumentActionEventType, getModificationDate, isArrayEqual, LINE_DESCENT_FACTOR, objectSize, PageActionEventType, stringToPDFString, stringToUTF8String, utf8StringToString */\n    const isNodeJS = typeof process === \"object\" && process + \"\" === \"[object process]\" && !process.versions.nw && !(process.versions.electron && process.type && process.type !== \"browser\");\n    const IDENTITY_MATRIX = [1, 0, 0, 1, 0, 0];\n    const FONT_IDENTITY_MATRIX = [0.001, 0, 0, 0.001, 0, 0];\n    const MAX_IMAGE_SIZE_TO_CACHE = 10e6;\n    const LINE_FACTOR = 1.35;\n    const LINE_DESCENT_FACTOR = 0.35;\n    const BASELINE_FACTOR = LINE_DESCENT_FACTOR / LINE_FACTOR;\n    const RenderingIntentFlag = {\n      ANY: 0x01,\n      DISPLAY: 0x02,\n      PRINT: 0x04,\n      SAVE: 0x08,\n      ANNOTATIONS_FORMS: 0x10,\n      ANNOTATIONS_STORAGE: 0x20,\n      ANNOTATIONS_DISABLE: 0x40,\n      OPLIST: 0x100\n    };\n    const AnnotationMode = {\n      DISABLE: 0,\n      ENABLE: 1,\n      ENABLE_FORMS: 2,\n      ENABLE_STORAGE: 3\n    };\n    const AnnotationEditorPrefix = \"pdfjs_internal_editor_\";\n    const AnnotationEditorType = {\n      DISABLE: -1,\n      NONE: 0,\n      FREETEXT: 3,\n      HIGHLIGHT: 9,\n      STAMP: 13,\n      INK: 15\n    };\n    const AnnotationEditorParamsType = {\n      RESIZE: 1,\n      CREATE: 2,\n      FREETEXT_SIZE: 11,\n      FREETEXT_COLOR: 12,\n      FREETEXT_OPACITY: 13,\n      INK_COLOR: 21,\n      INK_THICKNESS: 22,\n      INK_OPACITY: 23\n    };\n    const PermissionFlag = {\n      PRINT: 0x04,\n      MODIFY_CONTENTS: 0x08,\n      COPY: 0x10,\n      MODIFY_ANNOTATIONS: 0x20,\n      FILL_INTERACTIVE_FORMS: 0x100,\n      COPY_FOR_ACCESSIBILITY: 0x200,\n      ASSEMBLE: 0x400,\n      PRINT_HIGH_QUALITY: 0x800\n    };\n    const TextRenderingMode = {\n      FILL: 0,\n      STROKE: 1,\n      FILL_STROKE: 2,\n      INVISIBLE: 3,\n      FILL_ADD_TO_PATH: 4,\n      STROKE_ADD_TO_PATH: 5,\n      FILL_STROKE_ADD_TO_PATH: 6,\n      ADD_TO_PATH: 7,\n      FILL_STROKE_MASK: 3,\n      ADD_TO_PATH_FLAG: 4\n    };\n    const ImageKind = {\n      GRAYSCALE_1BPP: 1,\n      RGB_24BPP: 2,\n      RGBA_32BPP: 3\n    };\n    const AnnotationType = {\n      TEXT: 1,\n      LINK: 2,\n      FREETEXT: 3,\n      LINE: 4,\n      SQUARE: 5,\n      CIRCLE: 6,\n      POLYGON: 7,\n      POLYLINE: 8,\n      HIGHLIGHT: 9,\n      UNDERLINE: 10,\n      SQUIGGLY: 11,\n      STRIKEOUT: 12,\n      STAMP: 13,\n      CARET: 14,\n      INK: 15,\n      POPUP: 16,\n      FILEATTACHMENT: 17,\n      SOUND: 18,\n      MOVIE: 19,\n      WIDGET: 20,\n      SCREEN: 21,\n      PRINTERMARK: 22,\n      TRAPNET: 23,\n      WATERMARK: 24,\n      THREED: 25,\n      REDACT: 26\n    };\n    const AnnotationReplyType = {\n      GROUP: \"Group\",\n      REPLY: \"R\"\n    };\n    const AnnotationFlag = {\n      INVISIBLE: 0x01,\n      HIDDEN: 0x02,\n      PRINT: 0x04,\n      NOZOOM: 0x08,\n      NOROTATE: 0x10,\n      NOVIEW: 0x20,\n      READONLY: 0x40,\n      LOCKED: 0x80,\n      TOGGLENOVIEW: 0x100,\n      LOCKEDCONTENTS: 0x200\n    };\n    const AnnotationFieldFlag = {\n      READONLY: 0x0000001,\n      REQUIRED: 0x0000002,\n      NOEXPORT: 0x0000004,\n      MULTILINE: 0x0001000,\n      PASSWORD: 0x0002000,\n      NOTOGGLETOOFF: 0x0004000,\n      RADIO: 0x0008000,\n      PUSHBUTTON: 0x0010000,\n      COMBO: 0x0020000,\n      EDIT: 0x0040000,\n      SORT: 0x0080000,\n      FILESELECT: 0x0100000,\n      MULTISELECT: 0x0200000,\n      DONOTSPELLCHECK: 0x0400000,\n      DONOTSCROLL: 0x0800000,\n      COMB: 0x1000000,\n      RICHTEXT: 0x2000000,\n      RADIOSINUNISON: 0x2000000,\n      COMMITONSELCHANGE: 0x4000000\n    };\n    const AnnotationBorderStyleType = {\n      SOLID: 1,\n      DASHED: 2,\n      BEVELED: 3,\n      INSET: 4,\n      UNDERLINE: 5\n    };\n    const AnnotationActionEventType = {\n      E: \"Mouse Enter\",\n      X: \"Mouse Exit\",\n      D: \"Mouse Down\",\n      U: \"Mouse Up\",\n      Fo: \"Focus\",\n      Bl: \"Blur\",\n      PO: \"PageOpen\",\n      PC: \"PageClose\",\n      PV: \"PageVisible\",\n      PI: \"PageInvisible\",\n      K: \"Keystroke\",\n      F: \"Format\",\n      V: \"Validate\",\n      C: \"Calculate\"\n    };\n    const DocumentActionEventType = {\n      WC: \"WillClose\",\n      WS: \"WillSave\",\n      DS: \"DidSave\",\n      WP: \"WillPrint\",\n      DP: \"DidPrint\"\n    };\n    const PageActionEventType = {\n      O: \"PageOpen\",\n      C: \"PageClose\"\n    };\n    const VerbosityLevel = {\n      ERRORS: 0,\n      WARNINGS: 1,\n      INFOS: 5\n    };\n    const CMapCompressionType = {\n      NONE: 0,\n      BINARY: 1\n    };\n    const OPS = {\n      dependency: 1,\n      setLineWidth: 2,\n      setLineCap: 3,\n      setLineJoin: 4,\n      setMiterLimit: 5,\n      setDash: 6,\n      setRenderingIntent: 7,\n      setFlatness: 8,\n      setGState: 9,\n      save: 10,\n      restore: 11,\n      transform: 12,\n      moveTo: 13,\n      lineTo: 14,\n      curveTo: 15,\n      curveTo2: 16,\n      curveTo3: 17,\n      closePath: 18,\n      rectangle: 19,\n      stroke: 20,\n      closeStroke: 21,\n      fill: 22,\n      eoFill: 23,\n      fillStroke: 24,\n      eoFillStroke: 25,\n      closeFillStroke: 26,\n      closeEOFillStroke: 27,\n      endPath: 28,\n      clip: 29,\n      eoClip: 30,\n      beginText: 31,\n      endText: 32,\n      setCharSpacing: 33,\n      setWordSpacing: 34,\n      setHScale: 35,\n      setLeading: 36,\n      setFont: 37,\n      setTextRenderingMode: 38,\n      setTextRise: 39,\n      moveText: 40,\n      setLeadingMoveText: 41,\n      setTextMatrix: 42,\n      nextLine: 43,\n      showText: 44,\n      showSpacedText: 45,\n      nextLineShowText: 46,\n      nextLineSetSpacingShowText: 47,\n      setCharWidth: 48,\n      setCharWidthAndBounds: 49,\n      setStrokeColorSpace: 50,\n      setFillColorSpace: 51,\n      setStrokeColor: 52,\n      setStrokeColorN: 53,\n      setFillColor: 54,\n      setFillColorN: 55,\n      setStrokeGray: 56,\n      setFillGray: 57,\n      setStrokeRGBColor: 58,\n      setFillRGBColor: 59,\n      setStrokeCMYKColor: 60,\n      setFillCMYKColor: 61,\n      shadingFill: 62,\n      beginInlineImage: 63,\n      beginImageData: 64,\n      endInlineImage: 65,\n      paintXObject: 66,\n      markPoint: 67,\n      markPointProps: 68,\n      beginMarkedContent: 69,\n      beginMarkedContentProps: 70,\n      endMarkedContent: 71,\n      beginCompat: 72,\n      endCompat: 73,\n      paintFormXObjectBegin: 74,\n      paintFormXObjectEnd: 75,\n      beginGroup: 76,\n      endGroup: 77,\n      beginAnnotation: 80,\n      endAnnotation: 81,\n      paintImageMaskXObject: 83,\n      paintImageMaskXObjectGroup: 84,\n      paintImageXObject: 85,\n      paintInlineImageXObject: 86,\n      paintInlineImageXObjectGroup: 87,\n      paintImageXObjectRepeat: 88,\n      paintImageMaskXObjectRepeat: 89,\n      paintSolidColorImageMask: 90,\n      constructPath: 91\n    };\n    const PasswordResponses = {\n      NEED_PASSWORD: 1,\n      INCORRECT_PASSWORD: 2\n    };\n    let verbosity = VerbosityLevel.WARNINGS;\n    function setVerbosityLevel(level) {\n      if (Number.isInteger(level)) {\n        verbosity = level;\n      }\n    }\n    function getVerbosityLevel() {\n      return verbosity;\n    }\n    function info(msg) {\n      if (verbosity >= VerbosityLevel.INFOS) {\n        console.log(`Info: ${msg}`);\n      }\n    }\n    function warn(msg) {\n      if (verbosity >= VerbosityLevel.WARNINGS) {\n        console.log(`Warning: ${msg}`);\n      }\n    }\n    function unreachable(msg) {\n      throw new Error(msg);\n    }\n    function assert(cond, msg) {\n      if (!cond) {\n        unreachable(msg);\n      }\n    }\n    function _isValidProtocol(url) {\n      switch (url?.protocol) {\n        case \"http:\":\n        case \"https:\":\n        case \"ftp:\":\n        case \"mailto:\":\n        case \"tel:\":\n          return true;\n        default:\n          return false;\n      }\n    }\n    function createValidAbsoluteUrl(url, baseUrl = null, options = null) {\n      if (!url) {\n        return null;\n      }\n      try {\n        if (options && typeof url === \"string\") {\n          if (options.addDefaultProtocol && url.startsWith(\"www.\")) {\n            const dots = url.match(/\\./g);\n            if (dots?.length >= 2) {\n              url = `http://${url}`;\n            }\n          }\n          if (options.tryConvertEncoding) {\n            try {\n              url = stringToUTF8String(url);\n            } catch {}\n          }\n        }\n        const absoluteUrl = baseUrl ? new URL(url, baseUrl) : new URL(url);\n        if (_isValidProtocol(absoluteUrl)) {\n          return absoluteUrl;\n        }\n      } catch {}\n      return null;\n    }\n    function shadow(obj, prop, value, nonSerializable = false) {\n      Object.defineProperty(obj, prop, {\n        value,\n        enumerable: !nonSerializable,\n        configurable: true,\n        writable: false\n      });\n      return value;\n    }\n    const BaseException = function BaseExceptionClosure() {\n      function BaseException(message, name) {\n        if (this.constructor === BaseException) {\n          unreachable(\"Cannot initialize BaseException.\");\n        }\n        this.message = message;\n        this.name = name;\n      }\n      BaseException.prototype = new Error();\n      BaseException.constructor = BaseException;\n      return BaseException;\n    }();\n    class PasswordException extends BaseException {\n      constructor(msg, code) {\n        super(msg, \"PasswordException\");\n        this.code = code;\n      }\n    }\n    class UnknownErrorException extends BaseException {\n      constructor(msg, details) {\n        super(msg, \"UnknownErrorException\");\n        this.details = details;\n      }\n    }\n    class InvalidPDFException extends BaseException {\n      constructor(msg) {\n        super(msg, \"InvalidPDFException\");\n      }\n    }\n    class MissingPDFException extends BaseException {\n      constructor(msg) {\n        super(msg, \"MissingPDFException\");\n      }\n    }\n    class UnexpectedResponseException extends BaseException {\n      constructor(msg, status) {\n        super(msg, \"UnexpectedResponseException\");\n        this.status = status;\n      }\n    }\n    class FormatError extends BaseException {\n      constructor(msg) {\n        super(msg, \"FormatError\");\n      }\n    }\n    class AbortException extends BaseException {\n      constructor(msg) {\n        super(msg, \"AbortException\");\n      }\n    }\n    function bytesToString(bytes) {\n      if (typeof bytes !== \"object\" || bytes?.length === undefined) {\n        unreachable(\"Invalid argument for bytesToString\");\n      }\n      const length = bytes.length;\n      const MAX_ARGUMENT_COUNT = 8192;\n      if (length < MAX_ARGUMENT_COUNT) {\n        return String.fromCharCode.apply(null, bytes);\n      }\n      const strBuf = [];\n      for (let i = 0; i < length; i += MAX_ARGUMENT_COUNT) {\n        const chunkEnd = Math.min(i + MAX_ARGUMENT_COUNT, length);\n        const chunk = bytes.subarray(i, chunkEnd);\n        strBuf.push(String.fromCharCode.apply(null, chunk));\n      }\n      return strBuf.join(\"\");\n    }\n    function stringToBytes(str) {\n      if (typeof str !== \"string\") {\n        unreachable(\"Invalid argument for stringToBytes\");\n      }\n      const length = str.length;\n      const bytes = new Uint8Array(length);\n      for (let i = 0; i < length; ++i) {\n        bytes[i] = str.charCodeAt(i) & 0xff;\n      }\n      return bytes;\n    }\n    function string32(value) {\n      return String.fromCharCode(value >> 24 & 0xff, value >> 16 & 0xff, value >> 8 & 0xff, value & 0xff);\n    }\n    function objectSize(obj) {\n      return Object.keys(obj).length;\n    }\n    function objectFromMap(map) {\n      const obj = Object.create(null);\n      for (const [key, value] of map) {\n        obj[key] = value;\n      }\n      return obj;\n    }\n    function isLittleEndian() {\n      const buffer8 = new Uint8Array(4);\n      buffer8[0] = 1;\n      const view32 = new Uint32Array(buffer8.buffer, 0, 1);\n      return view32[0] === 1;\n    }\n    function isEvalSupported() {\n      try {\n        new Function(\"\");\n        return true;\n      } catch {\n        return false;\n      }\n    }\n    class FeatureTest {\n      static get isLittleEndian() {\n        return shadow(this, \"isLittleEndian\", isLittleEndian());\n      }\n      static get isEvalSupported() {\n        return shadow(this, \"isEvalSupported\", isEvalSupported());\n      }\n      static get isOffscreenCanvasSupported() {\n        return shadow(this, \"isOffscreenCanvasSupported\", typeof OffscreenCanvas !== \"undefined\");\n      }\n      static get platform() {\n        if (typeof navigator !== \"undefined\" && typeof navigator?.platform === \"string\") {\n          return shadow(this, \"platform\", {\n            isMac: navigator.platform.includes(\"Mac\")\n          });\n        }\n        return shadow(this, \"platform\", {\n          isMac: false\n        });\n      }\n      static get isCSSRoundSupported() {\n        return shadow(this, \"isCSSRoundSupported\", globalThis.CSS?.supports?.(\"width: round(1.5px, 1px)\"));\n      }\n    }\n    const hexNumbers = [...Array(256).keys()].map(n => n.toString(16).padStart(2, \"0\"));\n    class Util {\n      static makeHexColor(r, g, b) {\n        return `#${hexNumbers[r]}${hexNumbers[g]}${hexNumbers[b]}`;\n      }\n      static scaleMinMax(transform, minMax) {\n        let temp;\n        if (transform[0]) {\n          if (transform[0] < 0) {\n            temp = minMax[0];\n            minMax[0] = minMax[1];\n            minMax[1] = temp;\n          }\n          minMax[0] *= transform[0];\n          minMax[1] *= transform[0];\n          if (transform[3] < 0) {\n            temp = minMax[2];\n            minMax[2] = minMax[3];\n            minMax[3] = temp;\n          }\n          minMax[2] *= transform[3];\n          minMax[3] *= transform[3];\n        } else {\n          temp = minMax[0];\n          minMax[0] = minMax[2];\n          minMax[2] = temp;\n          temp = minMax[1];\n          minMax[1] = minMax[3];\n          minMax[3] = temp;\n          if (transform[1] < 0) {\n            temp = minMax[2];\n            minMax[2] = minMax[3];\n            minMax[3] = temp;\n          }\n          minMax[2] *= transform[1];\n          minMax[3] *= transform[1];\n          if (transform[2] < 0) {\n            temp = minMax[0];\n            minMax[0] = minMax[1];\n            minMax[1] = temp;\n          }\n          minMax[0] *= transform[2];\n          minMax[1] *= transform[2];\n        }\n        minMax[0] += transform[4];\n        minMax[1] += transform[4];\n        minMax[2] += transform[5];\n        minMax[3] += transform[5];\n      }\n      static transform(m1, m2) {\n        return [m1[0] * m2[0] + m1[2] * m2[1], m1[1] * m2[0] + m1[3] * m2[1], m1[0] * m2[2] + m1[2] * m2[3], m1[1] * m2[2] + m1[3] * m2[3], m1[0] * m2[4] + m1[2] * m2[5] + m1[4], m1[1] * m2[4] + m1[3] * m2[5] + m1[5]];\n      }\n      static applyTransform(p, m) {\n        const xt = p[0] * m[0] + p[1] * m[2] + m[4];\n        const yt = p[0] * m[1] + p[1] * m[3] + m[5];\n        return [xt, yt];\n      }\n      static applyInverseTransform(p, m) {\n        const d = m[0] * m[3] - m[1] * m[2];\n        const xt = (p[0] * m[3] - p[1] * m[2] + m[2] * m[5] - m[4] * m[3]) / d;\n        const yt = (-p[0] * m[1] + p[1] * m[0] + m[4] * m[1] - m[5] * m[0]) / d;\n        return [xt, yt];\n      }\n      static getAxialAlignedBoundingBox(r, m) {\n        const p1 = this.applyTransform(r, m);\n        const p2 = this.applyTransform(r.slice(2, 4), m);\n        const p3 = this.applyTransform([r[0], r[3]], m);\n        const p4 = this.applyTransform([r[2], r[1]], m);\n        return [Math.min(p1[0], p2[0], p3[0], p4[0]), Math.min(p1[1], p2[1], p3[1], p4[1]), Math.max(p1[0], p2[0], p3[0], p4[0]), Math.max(p1[1], p2[1], p3[1], p4[1])];\n      }\n      static inverseTransform(m) {\n        const d = m[0] * m[3] - m[1] * m[2];\n        return [m[3] / d, -m[1] / d, -m[2] / d, m[0] / d, (m[2] * m[5] - m[4] * m[3]) / d, (m[4] * m[1] - m[5] * m[0]) / d];\n      }\n      static singularValueDecompose2dScale(m) {\n        const transpose = [m[0], m[2], m[1], m[3]];\n        const a = m[0] * transpose[0] + m[1] * transpose[2];\n        const b = m[0] * transpose[1] + m[1] * transpose[3];\n        const c = m[2] * transpose[0] + m[3] * transpose[2];\n        const d = m[2] * transpose[1] + m[3] * transpose[3];\n        const first = (a + d) / 2;\n        const second = Math.sqrt((a + d) ** 2 - 4 * (a * d - c * b)) / 2;\n        const sx = first + second || 1;\n        const sy = first - second || 1;\n        return [Math.sqrt(sx), Math.sqrt(sy)];\n      }\n      static normalizeRect(rect) {\n        const r = rect.slice(0);\n        if (rect[0] > rect[2]) {\n          r[0] = rect[2];\n          r[2] = rect[0];\n        }\n        if (rect[1] > rect[3]) {\n          r[1] = rect[3];\n          r[3] = rect[1];\n        }\n        return r;\n      }\n      static intersect(rect1, rect2) {\n        const xLow = Math.max(Math.min(rect1[0], rect1[2]), Math.min(rect2[0], rect2[2]));\n        const xHigh = Math.min(Math.max(rect1[0], rect1[2]), Math.max(rect2[0], rect2[2]));\n        if (xLow > xHigh) {\n          return null;\n        }\n        const yLow = Math.max(Math.min(rect1[1], rect1[3]), Math.min(rect2[1], rect2[3]));\n        const yHigh = Math.min(Math.max(rect1[1], rect1[3]), Math.max(rect2[1], rect2[3]));\n        if (yLow > yHigh) {\n          return null;\n        }\n        return [xLow, yLow, xHigh, yHigh];\n      }\n      static bezierBoundingBox(x0, y0, x1, y1, x2, y2, x3, y3) {\n        const tvalues = [],\n          bounds = [[], []];\n        let a, b, c, t, t1, t2, b2ac, sqrtb2ac;\n        for (let i = 0; i < 2; ++i) {\n          if (i === 0) {\n            b = 6 * x0 - 12 * x1 + 6 * x2;\n            a = -3 * x0 + 9 * x1 - 9 * x2 + 3 * x3;\n            c = 3 * x1 - 3 * x0;\n          } else {\n            b = 6 * y0 - 12 * y1 + 6 * y2;\n            a = -3 * y0 + 9 * y1 - 9 * y2 + 3 * y3;\n            c = 3 * y1 - 3 * y0;\n          }\n          if (Math.abs(a) < 1e-12) {\n            if (Math.abs(b) < 1e-12) {\n              continue;\n            }\n            t = -c / b;\n            if (0 < t && t < 1) {\n              tvalues.push(t);\n            }\n            continue;\n          }\n          b2ac = b * b - 4 * c * a;\n          sqrtb2ac = Math.sqrt(b2ac);\n          if (b2ac < 0) {\n            continue;\n          }\n          t1 = (-b + sqrtb2ac) / (2 * a);\n          if (0 < t1 && t1 < 1) {\n            tvalues.push(t1);\n          }\n          t2 = (-b - sqrtb2ac) / (2 * a);\n          if (0 < t2 && t2 < 1) {\n            tvalues.push(t2);\n          }\n        }\n        let j = tvalues.length,\n          mt;\n        const jlen = j;\n        while (j--) {\n          t = tvalues[j];\n          mt = 1 - t;\n          bounds[0][j] = mt * mt * mt * x0 + 3 * mt * mt * t * x1 + 3 * mt * t * t * x2 + t * t * t * x3;\n          bounds[1][j] = mt * mt * mt * y0 + 3 * mt * mt * t * y1 + 3 * mt * t * t * y2 + t * t * t * y3;\n        }\n        bounds[0][jlen] = x0;\n        bounds[1][jlen] = y0;\n        bounds[0][jlen + 1] = x3;\n        bounds[1][jlen + 1] = y3;\n        bounds[0].length = bounds[1].length = jlen + 2;\n        return [Math.min(...bounds[0]), Math.min(...bounds[1]), Math.max(...bounds[0]), Math.max(...bounds[1])];\n      }\n    }\n    const PDFStringTranslateTable = /* unused pure expression or super */null && [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x2d8, 0x2c7, 0x2c6, 0x2d9, 0x2dd, 0x2db, 0x2da, 0x2dc, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x2022, 0x2020, 0x2021, 0x2026, 0x2014, 0x2013, 0x192, 0x2044, 0x2039, 0x203a, 0x2212, 0x2030, 0x201e, 0x201c, 0x201d, 0x2018, 0x2019, 0x201a, 0x2122, 0xfb01, 0xfb02, 0x141, 0x152, 0x160, 0x178, 0x17d, 0x131, 0x142, 0x153, 0x161, 0x17e, 0, 0x20ac];\n    function stringToPDFString(str) {\n      if (str[0] >= \"\\xEF\") {\n        let encoding;\n        if (str[0] === \"\\xFE\" && str[1] === \"\\xFF\") {\n          encoding = \"utf-16be\";\n          if (str.length % 2 === 1) {\n            str = str.slice(0, -1);\n          }\n        } else if (str[0] === \"\\xFF\" && str[1] === \"\\xFE\") {\n          encoding = \"utf-16le\";\n          if (str.length % 2 === 1) {\n            str = str.slice(0, -1);\n          }\n        } else if (str[0] === \"\\xEF\" && str[1] === \"\\xBB\" && str[2] === \"\\xBF\") {\n          encoding = \"utf-8\";\n        }\n        if (encoding) {\n          try {\n            const decoder = new TextDecoder(encoding, {\n              fatal: true\n            });\n            const buffer = stringToBytes(str);\n            const decoded = decoder.decode(buffer);\n            if (!decoded.includes(\"\\x1b\")) {\n              return decoded;\n            }\n            return decoded.replaceAll(/\\x1b[^\\x1b]*(?:\\x1b|$)/g, \"\");\n          } catch (ex) {\n            warn(`stringToPDFString: \"${ex}\".`);\n          }\n        }\n      }\n      const strBuf = [];\n      for (let i = 0, ii = str.length; i < ii; i++) {\n        const charCode = str.charCodeAt(i);\n        if (charCode === 0x1b) {\n          while (++i < ii && str.charCodeAt(i) !== 0x1b) {}\n          continue;\n        }\n        const code = PDFStringTranslateTable[charCode];\n        strBuf.push(code ? String.fromCharCode(code) : str.charAt(i));\n      }\n      return strBuf.join(\"\");\n    }\n    function stringToUTF8String(str) {\n      return decodeURIComponent(escape(str));\n    }\n    function utf8StringToString(str) {\n      return unescape(encodeURIComponent(str));\n    }\n    function isArrayBuffer(v) {\n      return typeof v === \"object\" && v?.byteLength !== undefined;\n    }\n    function isArrayEqual(arr1, arr2) {\n      if (arr1.length !== arr2.length) {\n        return false;\n      }\n      for (let i = 0, ii = arr1.length; i < ii; i++) {\n        if (arr1[i] !== arr2[i]) {\n          return false;\n        }\n      }\n      return true;\n    }\n    function getModificationDate(date = new Date()) {\n      const buffer = [date.getUTCFullYear().toString(), (date.getUTCMonth() + 1).toString().padStart(2, \"0\"), date.getUTCDate().toString().padStart(2, \"0\"), date.getUTCHours().toString().padStart(2, \"0\"), date.getUTCMinutes().toString().padStart(2, \"0\"), date.getUTCSeconds().toString().padStart(2, \"0\")];\n      return buffer.join(\"\");\n    }\n    class PromiseCapability {\n      #settled = false;\n      constructor() {\n        this.promise = new Promise((resolve, reject) => {\n          this.resolve = data => {\n            this.#settled = true;\n            resolve(data);\n          };\n          this.reject = reason => {\n            this.#settled = true;\n            reject(reason);\n          };\n        });\n      }\n      get settled() {\n        return this.#settled;\n      }\n    }\n    let NormalizeRegex = null;\n    let NormalizationMap = null;\n    function normalizeUnicode(str) {\n      if (!NormalizeRegex) {\n        NormalizeRegex = /([\\u00a0\\u00b5\\u037e\\u0eb3\\u2000-\\u200a\\u202f\\u2126\\ufb00-\\ufb04\\ufb06\\ufb20-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40-\\ufb41\\ufb43-\\ufb44\\ufb46-\\ufba1\\ufba4-\\ufba9\\ufbae-\\ufbb1\\ufbd3-\\ufbdc\\ufbde-\\ufbe7\\ufbea-\\ufbf8\\ufbfc-\\ufbfd\\ufc00-\\ufc5d\\ufc64-\\ufcf1\\ufcf5-\\ufd3d\\ufd88\\ufdf4\\ufdfa-\\ufdfb\\ufe71\\ufe77\\ufe79\\ufe7b\\ufe7d]+)|(\\ufb05+)/gu;\n        NormalizationMap = new Map([[\"ﬅ\", \"ſt\"]]);\n      }\n      return str.replaceAll(NormalizeRegex, (_, p1, p2) => {\n        return p1 ? p1.normalize(\"NFKC\") : NormalizationMap.get(p2);\n      });\n    }\n    function getUuid() {\n      if (typeof crypto !== \"undefined\" && typeof crypto?.randomUUID === \"function\") {\n        return crypto.randomUUID();\n      }\n      const buf = new Uint8Array(32);\n      if (typeof crypto !== \"undefined\" && typeof crypto?.getRandomValues === \"function\") {\n        crypto.getRandomValues(buf);\n      } else {\n        for (let i = 0; i < 32; i++) {\n          buf[i] = Math.floor(Math.random() * 255);\n        }\n      }\n      return bytesToString(buf);\n    }\n    const AnnotationPrefix = \"pdfjs_internal_id_\";\n\n    /***/\n  }\n\n  /******/\n};\n/************************************************************************/\n/******/ // The module cache\n/******/\nvar __webpack_module_cache__ = {};\n/******/\n/******/ // The require function\n/******/\nfunction __webpack_require__(moduleId) {\n  /******/ // Check if module is in cache\n  /******/var cachedModule = __webpack_module_cache__[moduleId];\n  /******/\n  if (cachedModule !== undefined) {\n    /******/return cachedModule.exports;\n    /******/\n  }\n  /******/ // Create a new module (and put it into the cache)\n  /******/\n  var module = __webpack_module_cache__[moduleId] = {\n    /******/ // no module.id needed\n    /******/ // no module.loaded needed\n    /******/exports: {}\n    /******/\n  };\n  /******/\n  /******/ // Execute the module function\n  /******/\n  __webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n  /******/\n  /******/ // Return the exports of the module\n  /******/\n  return module.exports;\n  /******/\n}\n/******/\n/************************************************************************/\n/******/ /* webpack/runtime/async module */\n/******/\n(() => {\n  /******/var webpackQueues = typeof Symbol === \"function\" ? Symbol(\"webpack queues\") : \"__webpack_queues__\";\n  /******/\n  var webpackExports = typeof Symbol === \"function\" ? Symbol(\"webpack exports\") : \"__webpack_exports__\";\n  /******/\n  var webpackError = typeof Symbol === \"function\" ? Symbol(\"webpack error\") : \"__webpack_error__\";\n  /******/\n  var resolveQueue = queue => {\n    /******/if (queue && queue.d < 1) {\n      /******/queue.d = 1;\n      /******/\n      queue.forEach(fn => fn.r--);\n      /******/\n      queue.forEach(fn => fn.r-- ? fn.r++ : fn());\n      /******/\n    }\n    /******/\n  };\n  /******/\n  var wrapDeps = deps => deps.map(dep => {\n    /******/if (dep !== null && typeof dep === \"object\") {\n      /******/if (dep[webpackQueues]) return dep;\n      /******/\n      if (dep.then) {\n        /******/var queue = [];\n        /******/\n        queue.d = 0;\n        /******/\n        dep.then(r => {\n          /******/obj[webpackExports] = r;\n          /******/\n          resolveQueue(queue);\n          /******/\n        }, e => {\n          /******/obj[webpackError] = e;\n          /******/\n          resolveQueue(queue);\n          /******/\n        });\n        /******/\n        var obj = {};\n        /******/\n        obj[webpackQueues] = fn => fn(queue);\n        /******/\n        return obj;\n        /******/\n      }\n      /******/\n    }\n    /******/\n    var ret = {};\n    /******/\n    ret[webpackQueues] = x => {};\n    /******/\n    ret[webpackExports] = dep;\n    /******/\n    return ret;\n    /******/\n  });\n  /******/\n  __webpack_require__.a = (module, body, hasAwait) => {\n    /******/var queue;\n    /******/\n    hasAwait && ((queue = []).d = -1);\n    /******/\n    var depQueues = new Set();\n    /******/\n    var exports = module.exports;\n    /******/\n    var currentDeps;\n    /******/\n    var outerResolve;\n    /******/\n    var reject;\n    /******/\n    var promise = new Promise((resolve, rej) => {\n      /******/reject = rej;\n      /******/\n      outerResolve = resolve;\n      /******/\n    });\n    /******/\n    promise[webpackExports] = exports;\n    /******/\n    promise[webpackQueues] = fn => (queue && fn(queue), depQueues.forEach(fn), promise[\"catch\"](x => {}));\n    /******/\n    module.exports = promise;\n    /******/\n    body(deps => {\n      /******/currentDeps = wrapDeps(deps);\n      /******/\n      var fn;\n      /******/\n      var getResult = () => currentDeps.map(d => {\n        /******/if (d[webpackError]) throw d[webpackError];\n        /******/\n        return d[webpackExports];\n        /******/\n      });\n      /******/\n      var promise = new Promise(resolve => {\n        /******/fn = () => resolve(getResult);\n        /******/\n        fn.r = 0;\n        /******/\n        var fnQueue = q => q !== queue && !depQueues.has(q) && (depQueues.add(q), q && !q.d && (fn.r++, q.push(fn)));\n        /******/\n        currentDeps.map(dep => dep[webpackQueues](fnQueue));\n        /******/\n      });\n      /******/\n      return fn.r ? promise : getResult();\n      /******/\n    }, err => (err ? reject(promise[webpackError] = err) : outerResolve(exports), resolveQueue(queue)));\n    /******/\n    queue && queue.d < 0 && (queue.d = 0);\n    /******/\n  };\n  /******/\n})();\n/******/\n/******/ /* webpack/runtime/define property getters */\n/******/\n(() => {\n  /******/ // define getter functions for harmony exports\n  /******/__webpack_require__.d = (exports, definition) => {\n    /******/for (var key in definition) {\n      /******/if (__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n        /******/Object.defineProperty(exports, key, {\n          enumerable: true,\n          get: definition[key]\n        });\n        /******/\n      }\n      /******/\n    }\n    /******/\n  };\n  /******/\n})();\n/******/\n/******/ /* webpack/runtime/hasOwnProperty shorthand */\n/******/\n(() => {\n  /******/__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\n  /******/\n})();\n/******/\n/************************************************************************/\n/******/\n/******/ // startup\n/******/ // Load entry module and return exports\n/******/ // This entry module used 'module' so it can't be inlined\n/******/\nvar __webpack_exports__ = __webpack_require__(907);\n/******/\n__webpack_exports__ = globalThis.pdfjsLib = await (globalThis.pdfjsLibPromise = __webpack_exports__);\n/******/\nvar __webpack_exports__AbortException = __webpack_exports__.AbortException;\n/******/\nvar __webpack_exports__AnnotationEditorLayer = __webpack_exports__.AnnotationEditorLayer;\n/******/\nvar __webpack_exports__AnnotationEditorParamsType = __webpack_exports__.AnnotationEditorParamsType;\n/******/\nvar __webpack_exports__AnnotationEditorType = __webpack_exports__.AnnotationEditorType;\n/******/\nvar __webpack_exports__AnnotationEditorUIManager = __webpack_exports__.AnnotationEditorUIManager;\n/******/\nvar __webpack_exports__AnnotationLayer = __webpack_exports__.AnnotationLayer;\n/******/\nvar __webpack_exports__AnnotationMode = __webpack_exports__.AnnotationMode;\n/******/\nvar __webpack_exports__CMapCompressionType = __webpack_exports__.CMapCompressionType;\n/******/\nvar __webpack_exports__DOMSVGFactory = __webpack_exports__.DOMSVGFactory;\n/******/\nvar __webpack_exports__DrawLayer = __webpack_exports__.DrawLayer;\n/******/\nvar __webpack_exports__FeatureTest = __webpack_exports__.FeatureTest;\n/******/\nvar __webpack_exports__GlobalWorkerOptions = __webpack_exports__.GlobalWorkerOptions;\n/******/\nvar __webpack_exports__ImageKind = __webpack_exports__.ImageKind;\n/******/\nvar __webpack_exports__InvalidPDFException = __webpack_exports__.InvalidPDFException;\n/******/\nvar __webpack_exports__MissingPDFException = __webpack_exports__.MissingPDFException;\n/******/\nvar __webpack_exports__OPS = __webpack_exports__.OPS;\n/******/\nvar __webpack_exports__Outliner = __webpack_exports__.Outliner;\n/******/\nvar __webpack_exports__PDFDataRangeTransport = __webpack_exports__.PDFDataRangeTransport;\n/******/\nvar __webpack_exports__PDFDateString = __webpack_exports__.PDFDateString;\n/******/\nvar __webpack_exports__PDFWorker = __webpack_exports__.PDFWorker;\n/******/\nvar __webpack_exports__PasswordResponses = __webpack_exports__.PasswordResponses;\n/******/\nvar __webpack_exports__PermissionFlag = __webpack_exports__.PermissionFlag;\n/******/\nvar __webpack_exports__PixelsPerInch = __webpack_exports__.PixelsPerInch;\n/******/\nvar __webpack_exports__PromiseCapability = __webpack_exports__.PromiseCapability;\n/******/\nvar __webpack_exports__RenderingCancelledException = __webpack_exports__.RenderingCancelledException;\n/******/\nvar __webpack_exports__UnexpectedResponseException = __webpack_exports__.UnexpectedResponseException;\n/******/\nvar __webpack_exports__Util = __webpack_exports__.Util;\n/******/\nvar __webpack_exports__VerbosityLevel = __webpack_exports__.VerbosityLevel;\n/******/\nvar __webpack_exports__XfaLayer = __webpack_exports__.XfaLayer;\n/******/\nvar __webpack_exports__build = __webpack_exports__.build;\n/******/\nvar __webpack_exports__createValidAbsoluteUrl = __webpack_exports__.createValidAbsoluteUrl;\n/******/\nvar __webpack_exports__fetchData = __webpack_exports__.fetchData;\n/******/\nvar __webpack_exports__getDocument = __webpack_exports__.getDocument;\n/******/\nvar __webpack_exports__getFilenameFromUrl = __webpack_exports__.getFilenameFromUrl;\n/******/\nvar __webpack_exports__getPdfFilenameFromUrl = __webpack_exports__.getPdfFilenameFromUrl;\n/******/\nvar __webpack_exports__getXfaPageViewport = __webpack_exports__.getXfaPageViewport;\n/******/\nvar __webpack_exports__isDataScheme = __webpack_exports__.isDataScheme;\n/******/\nvar __webpack_exports__isPdfFile = __webpack_exports__.isPdfFile;\n/******/\nvar __webpack_exports__noContextMenu = __webpack_exports__.noContextMenu;\n/******/\nvar __webpack_exports__normalizeUnicode = __webpack_exports__.normalizeUnicode;\n/******/\nvar __webpack_exports__renderTextLayer = __webpack_exports__.renderTextLayer;\n/******/\nvar __webpack_exports__setLayerDimensions = __webpack_exports__.setLayerDimensions;\n/******/\nvar __webpack_exports__shadow = __webpack_exports__.shadow;\n/******/\nvar __webpack_exports__updateTextLayer = __webpack_exports__.updateTextLayer;\n/******/\nvar __webpack_exports__version = __webpack_exports__.version;\n/******/\nexport { __webpack_exports__AbortException as AbortException, __webpack_exports__AnnotationEditorLayer as AnnotationEditorLayer, __webpack_exports__AnnotationEditorParamsType as AnnotationEditorParamsType, __webpack_exports__AnnotationEditorType as AnnotationEditorType, __webpack_exports__AnnotationEditorUIManager as AnnotationEditorUIManager, __webpack_exports__AnnotationLayer as AnnotationLayer, __webpack_exports__AnnotationMode as AnnotationMode, __webpack_exports__CMapCompressionType as CMapCompressionType, __webpack_exports__DOMSVGFactory as DOMSVGFactory, __webpack_exports__DrawLayer as DrawLayer, __webpack_exports__FeatureTest as FeatureTest, __webpack_exports__GlobalWorkerOptions as GlobalWorkerOptions, __webpack_exports__ImageKind as ImageKind, __webpack_exports__InvalidPDFException as InvalidPDFException, __webpack_exports__MissingPDFException as MissingPDFException, __webpack_exports__OPS as OPS, __webpack_exports__Outliner as Outliner, __webpack_exports__PDFDataRangeTransport as PDFDataRangeTransport, __webpack_exports__PDFDateString as PDFDateString, __webpack_exports__PDFWorker as PDFWorker, __webpack_exports__PasswordResponses as PasswordResponses, __webpack_exports__PermissionFlag as PermissionFlag, __webpack_exports__PixelsPerInch as PixelsPerInch, __webpack_exports__PromiseCapability as PromiseCapability, __webpack_exports__RenderingCancelledException as RenderingCancelledException, __webpack_exports__UnexpectedResponseException as UnexpectedResponseException, __webpack_exports__Util as Util, __webpack_exports__VerbosityLevel as VerbosityLevel, __webpack_exports__XfaLayer as XfaLayer, __webpack_exports__build as build, __webpack_exports__createValidAbsoluteUrl as createValidAbsoluteUrl, __webpack_exports__fetchData as fetchData, __webpack_exports__getDocument as getDocument, __webpack_exports__getFilenameFromUrl as getFilenameFromUrl, __webpack_exports__getPdfFilenameFromUrl as getPdfFilenameFromUrl, __webpack_exports__getXfaPageViewport as getXfaPageViewport, __webpack_exports__isDataScheme as isDataScheme, __webpack_exports__isPdfFile as isPdfFile, __webpack_exports__noContextMenu as noContextMenu, __webpack_exports__normalizeUnicode as normalizeUnicode, __webpack_exports__renderTextLayer as renderTextLayer, __webpack_exports__setLayerDimensions as setLayerDimensions, __webpack_exports__shadow as shadow, __webpack_exports__updateTextLayer as updateTextLayer, __webpack_exports__version as version };\n/******/","map":{"version":3,"names":["makeColorComp","n","Math","floor","max","min","toString","padStart","scaleAndClamp","x","ColorConverters","CMYK_G","c","y","m","k","G_CMYK","g","G_RGB","G_rgb","G_HTML","G","RGB_G","r","b","RGB_rgb","color","map","RGB_HTML","join","T_HTML","T_rgb","CMYK_RGB","CMYK_rgb","CMYK_HTML","components","rgb","slice","RGB_CMYK","DEFAULT_TAB_INDEX","DEFAULT_FONT_SIZE","GetElementsByNameSet","WeakSet","getRectDims","rect","width","height","AnnotationElementFactory","create","parameters","subtype","data","annotationType","util","AnnotationType","LINK","LinkAnnotationElement","TEXT","TextAnnotationElement","WIDGET","fieldType","TextWidgetAnnotationElement","radioButton","RadioButtonWidgetAnnotationElement","checkBox","CheckboxWidgetAnnotationElement","PushButtonWidgetAnnotationElement","ChoiceWidgetAnnotationElement","SignatureWidgetAnnotationElement","WidgetAnnotationElement","POPUP","PopupAnnotationElement","FREETEXT","FreeTextAnnotationElement","LINE","LineAnnotationElement","SQUARE","SquareAnnotationElement","CIRCLE","CircleAnnotationElement","POLYLINE","PolylineAnnotationElement","CARET","CaretAnnotationElement","INK","InkAnnotationElement","POLYGON","PolygonAnnotationElement","HIGHLIGHT","HighlightAnnotationElement","UNDERLINE","UnderlineAnnotationElement","SQUIGGLY","SquigglyAnnotationElement","STRIKEOUT","StrikeOutAnnotationElement","STAMP","StampAnnotationElement","FILEATTACHMENT","FileAttachmentAnnotationElement","AnnotationElement","hasBorder","constructor","isRenderable","ignoreBorder","createQuadrilaterals","layer","linkService","downloadManager","imageResourcesPath","renderForms","svgFactory","annotationStorage","enableScripting","hasJSActions","_fieldObjects","fieldObjects","parent","container","_createContainer","_createQuadrilaterals","_hasPopupData","titleObj","contentsObj","richText","str","hasPopupData","page","viewport","document","createElement","setAttribute","id","tabIndex","style","zIndex","popupRef","noRotate","classList","add","pageWidth","pageHeight","pageX","pageY","rawDims","rotation","hasOwnCanvas","setRotation","Util","normalizeRect","view","borderStyle","borderWidth","horizontalRadius","horizontalCornerRadius","verticalRadius","verticalCornerRadius","radius","borderRadius","AnnotationBorderStyleType","SOLID","DASHED","BEVELED","warn","INSET","borderBottomStyle","borderColor","makeHexColor","left","top","angle","elementWidth","elementHeight","_commonActions","setColor","jsName","styleName","event","detail","colorType","colorArray","target","setValue","shadow","display","hidden","visibility","noView","noPrint","print","focus","setTimeout","preventScroll","userName","title","readonly","disabled","required","_setRequired","bgColor","fillColor","fgColor","textColor","strokeColor","_dispatchEventFromSandbox","actions","jsEvent","commonActions","name","Object","keys","action","_setDefaultPropertiesFromJS","element","storedData","getRawValue","actionName","entries","eventProxy","quadPoints","rectBlX","rectBlY","rectTrX","rectTrY","length","trX","trY","blX","blY","svgBuffer","svg","defs","append","clipPath","rectWidth","rectHeight","push","backgroundImage","_createPopup","popup","modificationDate","parentRect","elements","div","render","unreachable","_getElementsByName","skipId","fields","fieldObj","exportValues","exportValue","domElement","querySelector","has","getElementsByName","getAttribute","show","maybeShow","hide","forceHide","getElementsToTriggerPopup","addHighlightArea","triggers","Array","isArray","_isEditable","_editOnDoubleClick","annotationEditorType","mode","editId","addEventListener","eventBus","dispatch","source","options","isTooltipOnly","link","isBound","url","addLinkAttributes","newWindow","_bindNamedAction","attachment","bindAttachment","attachmentDest","setOCGState","bindSetOCGState","dest","_bindLink","Action","_bindJSAction","resetForm","_bindResetFormAction","setInternalLink","#setInternalLink","destination","href","getDestinationHash","onclick","goToDestination","getAnchorUrl","executeNamedAction","#bindAttachment","openOrDownloadData","content","filename","#bindSetOCGState","executeSetOCGState","Map","get","otherClickAction","resetFormFields","refs","resetFormRefs","include","allFields","fieldIds","Set","fieldName","values","field","storage","allIds","type","value","defaultValue","dispatchEvent","Event","ids","image","src","toLowerCase","JSON","stringify","alternativeText","showElementAndHideCanvas","previousSibling","nodeName","_getKeyModifier","FeatureTest","platform","isMac","metaKey","ctrlKey","_setEventListener","elementData","baseName","eventName","valueGetter","includes","shift","shiftKey","modifier","focused","relatedTarget","_setEventListeners","names","getter","Blur","Focus","_setBackgroundColor","backgroundColor","_setTextStyle","TEXT_ALIGNMENT","fontColor","defaultAppearanceData","fontSize","computedFontSize","BORDER_SIZE","roundToOneDecimal","round","multiLine","abs","numberOfLines","LINE_FACTOR","lineHeight","textAlignment","textAlign","isRequired","removeAttribute","hasAppearance","fieldValue","setPropertyOnSiblings","base","key","keyInStorage","getValue","textContent","maxLen","charLimit","fieldFormattedValues","formattedValue","comb","replaceAll","userValue","lastCommittedValue","commitKey","doNotScroll","overflowY","overflowX","readOnly","maxLength","defaultFieldValue","blurListener","undefined","scrollLeft","activeElement","selRange","setSelectionRange","willCommit","selStart","selectionStart","selEnd","selectionEnd","_blurListener","Keystroke","inputType","match","substring","preventDefault","change","fieldWidth","combWidth","letterSpacing","verticalAlign","checked","checkbox","curChecked","buttonValue","radio","pdfButtonValue","linkElement","lastChild","selectElement","addAnEmptyEntry","combo","size","multiSelect","multiple","option","selected","optionElement","displayValue","removeEmptyEntry","noneOptionElement","prepend","remove","removeEventListener","isExport","selectedIndex","prototype","filter","call","selectedValues","getItems","multipleSelection","index","i","findIndex","items","clear","insert","selectChild","children","before","item","indices","editable","changeEx","keyDown","PopupElement","open","elementIds","AnnotationPrefix","boundKeyDown","bind","boundHide","boundShow","boundToggle","toggle","dateObj","pinned","wasVisible","display_utils","PDFDateString","toDateObject","trigger","flatMap","e","className","baseColor","outlineColor","CSS","supports","BACKGROUND_ENLIGHT","header","dir","date","toLocaleDateString","time","toLocaleTimeString","xfa_layer","XfaLayer","xfaHtml","html","intent","contents","_formatContents","useParentRect","intersect","normalizedRect","HORIZONTAL_SPACE_AFTER_ANNOTATION","parentWidth","popupLeft","popupTop","p","lines","split","ii","line","createTextNode","#keyDown","altKey","#toggle","#show","isVisible","parseInt","#hide","textPosition","AnnotationEditorType","lineSpan","lineCoordinates","square","circle","polyline","containerClassName","svgElementName","points","coordinate","vertices","polylines","inkList","inkLists","file","getFilenameFromUrl","fillAlpha","test","download","evt","#download","AnnotationLayer","accessibilityManager","annotationCanvasMap","editableAnnotations","appendElement","#appendElement","contentElement","firstChild","moveElementInDOM","params","annotations","setLayerDimensions","popupToElements","elementParams","DOMSVGFactory","annotation_storage","AnnotationStorage","noHTML","isPopupAnnotation","set","rendered","setAnnotationCanvasMap","update","#setAnnotationCanvasMap","canvas","replaceWith","getEditableAnnotations","from","getEditableAnnotation","SerializableEmpty","freeze","hash","transfer","modified","onSetModified","onResetModified","onAnnotationEditor","assign","delete","resetModified","_editor_editor_js__WEBPACK_IMPORTED_MODULE_1__","AnnotationEditor","obj","entry","val","setModified","_type","getAll","_shared_util_js__WEBPACK_IMPORTED_MODULE_0__","objectFromMap","setAll","#setModified","PrintAnnotationStorage","serializable","_shared_murmurhash3_js__WEBPACK_IMPORTED_MODULE_2__","MurmurHash3_64","context","hasBitmap","serialized","serialize","bitmap","hexdigest","clone","structuredClone","DEFAULT_RANGE_CHUNK_SIZE","RENDERING_CANCELLED_TIMEOUT","DELAYED_CLEANUP_TIMEOUT","DefaultCanvasFactory","isNodeJS","display_node_utils__WEBPACK_IMPORTED_MODULE_4__","NodeCanvasFactory","_display_utils_js__WEBPACK_IMPORTED_MODULE_2__","DOMCanvasFactory","DefaultCMapReaderFactory","NodeCMapReaderFactory","DOMCMapReaderFactory","DefaultFilterFactory","NodeFilterFactory","DOMFilterFactory","DefaultStandardFontDataFactory","NodeStandardFontDataFactory","DOMStandardFontDataFactory","getDocument","URL","isArrayBuffer","Error","range","task","PDFDocumentLoadingTask","docId","getUrlProp","getDataProp","httpHeaders","withCredentials","password","rangeTransport","PDFDataRangeTransport","rangeChunkSize","Number","isInteger","worker","PDFWorker","verbosity","docBaseUrl","isDataScheme","cMapUrl","cMapPacked","CMapReaderFactory","standardFontDataUrl","StandardFontDataFactory","ignoreErrors","stopAtErrors","maxImageSize","isEvalSupported","isOffscreenCanvasSupported","canvasMaxAreaInBytes","disableFontFace","fontExtraProperties","enableXfa","ownerDocument","globalThis","disableRange","disableStream","disableAutoFetch","pdfBug","NaN","useSystemFonts","useWorkerFetch","isValidFetchUrl","baseURI","canvasFactory","filterFactory","styleElement","setVerbosityLevel","transportFactory","cMapReaderFactory","baseUrl","isCompressed","standardFontDataFactory","workerParams","port","_worker_options_js__WEBPACK_IMPORTED_MODULE_6__","GlobalWorkerOptions","workerPort","fromPort","_worker","fetchDocParams","apiVersion","evaluatorOptions","transportParams","promise","then","destroyed","workerIdPromise","_fetchDocument","networkStreamPromise","Promise","resolve","networkStream","_transport_stream_js__WEBPACK_IMPORTED_MODULE_10__","PDFDataTransportStream","initialData","progressiveDone","contentDispositionFilename","createPDFNetworkStream","display_node_stream__WEBPACK_IMPORTED_MODULE_13__","PDFNodeStream","display_fetch_stream__WEBPACK_IMPORTED_MODULE_11__","PDFFetchStream","display_network__WEBPACK_IMPORTED_MODULE_12__","PDFNetworkStream","all","workerId","messageHandler","_shared_message_handler_js__WEBPACK_IMPORTED_MODULE_7__","MessageHandler","transport","WorkerTransport","_transport","send","catch","_capability","reject","sendWithPromise","buffer","window","location","Buffer","Uint8Array","byteLength","stringToBytes","isNaN","PromiseCapability","onPassword","onProgress","destroy","_pendingDestroy","ex","_rangeListeners","_progressListeners","_progressiveReadListeners","_progressiveDoneListeners","_readyCapability","addRangeListener","listener","addProgressListener","addProgressiveReadListener","addProgressiveDoneListener","onDataRange","begin","chunk","onDataProgress","loaded","total","onDataProgressiveRead","onDataProgressiveDone","transportReady","requestDataRange","end","abort","PDFDocumentProxy","pdfInfo","_pdfInfo","numPages","fingerprints","isPureXfa","_htmlForXfa","allXfaHtml","getPage","pageNumber","getPageIndex","ref","getDestinations","getDestination","getPageLabels","getPageLayout","getPageMode","getViewerPreferences","getOpenAction","getAttachments","getJSActions","getDocJSActions","getOutline","getOptionalContentConfig","getPermissions","getMetadata","getMarkInfo","getData","saveDocument","getDownloadInfo","downloadInfoCapability","cleanup","keepLoadedFonts","startCleanup","loadingTask","loadingParams","getFieldObjects","getCalculationOrderIds","PDFPageProxy","delayedCleanupTimeout","pendingCleanup","pageIndex","pageInfo","_pageIndex","_pageInfo","_stats","StatTimer","_pdfBug","commonObjs","objs","PDFObjects","_maybeCleanupAfterRender","_intentStates","rotate","userUnit","getViewport","scale","offsetX","offsetY","dontFlip","PageViewport","viewBox","getAnnotations","intentArgs","getRenderingIntent","renderingIntent","getPageJSActions","getXfa","canvasContext","annotationMode","AnnotationMode","ENABLE","transform","background","optionalContentConfigPromise","pageColors","printAnnotationStorage","abortDelayedCleanup","intentState","cacheKey","streamReaderCancelTimeout","clearTimeout","intentPrint","RenderingIntentFlag","PRINT","displayReadyCapability","operatorList","fnArray","argsArray","lastChunk","separateAnnots","_pumpOperatorList","complete","error","renderTasks","internalRenderTask","tryCleanup","capability","_abortOperatorList","reason","timeEnd","InternalRenderTask","callback","useRequestAnimationFrame","renderTask","transparency","optionalContentConfig","initializeGraphics","operatorListChanged","getOperatorList","opListReadCapability","opListTask","streamTextContent","includeMarkedContent","disableNormalization","TEXT_CONTENT_CHUNK_SIZE","sendWithStream","highWaterMark","getTextContent","xfa","_xfa_text_js__WEBPACK_IMPORTED_MODULE_14__","XfaText","readableStream","pump","reader","read","done","styles","getReader","getStructTree","_destroy","waitOn","force","completed","cancel","resetStats","success","#tryCleanup","delayed","#abortDelayedCleanup","_startRenderPage","_renderPageChunk","operatorListChunk","annotationStorageSerializable","streamReader","RenderingCancelledException","delay","extraDelay","AbortException","message","curCacheKey","curIntentState","stats","LoopbackPort","listeners","deferred","postMessage","terminate","PDFWorkerUtil","isWorkerDisabled","fakeWorkerId","workerSrc","isSameOrigin","otherUrl","origin","other","createCDNWrapper","wrapper","createObjectURL","Blob","workerPorts","getVerbosityLevel","_port","_webWorker","_messageHandler","WeakMap","_initializeFromPort","_initialize","on","mainThreadWorkerMessageHandler","Worker","terminateEarly","onWorkerError","_setupFakeWorker","sendTest","testObj","info","_setupFakeWorkerGlobal","WorkerMessageHandler","workerHandler","setup","cachedPort","#mainThreadWorkerMessageHandler","pdfjsWorker","loader","methodPromises","pageCache","pagePromises","passwordCapability","factory","fontLoader","_font_loader_js__WEBPACK_IMPORTED_MODULE_3__","FontLoader","_params","destroyCapability","_networkStream","_fullReader","_lastProgress","setupMessageHandler","cacheSimpleMethod","#cacheSimpleMethod","cachedPromise","_annotation_storage_js__WEBPACK_IMPORTED_MODULE_1__","isOpList","DISPLAY","ANY","DISABLE","ANNOTATIONS_DISABLE","ENABLE_FORMS","ANNOTATIONS_FORMS","ENABLE_STORAGE","ANNOTATIONS_STORAGE","OPLIST","hasOwnProperty","terminated","cancelAllRequests","sink","assert","getFullReader","onPull","close","ArrayBuffer","enqueue","onCancel","ready","readyReason","headersCapability","fullReader","headersReady","isStreamingSupported","isRangeSupported","contentLength","rangeReader","getRangeReader","_numPages","htmlForXfa","PasswordException","code","InvalidPDFException","MissingPDFException","UnexpectedResponseException","status","UnknownErrorException","details","exception","updatePassword","exportedData","exportedError","inspectFont","FontInspector","enabled","font","fontAdded","FontFaceObject","finally","imageData","pageProxy","MAX_IMAGE_SIZE_TO_CACHE","fetch","num","gen","results","_optional_content_config_js__WEBPACK_IMPORTED_MODULE_9__","OptionalContentConfig","metadata","_metadata_js__WEBPACK_IMPORTED_MODULE_8__","Metadata","cleanupSuccessful","ensureObj","#ensureObj","objId","settled","RenderTask","onContinue","form","canvasInUse","operatorListIdx","running","graphicsReadyCallback","graphicsReady","_useRequestAnimationFrame","cancelled","_cancelBound","_continueBound","_continue","_scheduleNextBound","_scheduleNext","_nextBound","_next","_canvas","StepperManager","stepper","init","nextBreakPoint","getNextBreakPoint","gfx","_canvas_js__WEBPACK_IMPORTED_MODULE_5__","CanvasGraphics","beginDrawing","endDrawing","updateOperatorList","requestAnimationFrame","executeOperatorList","version","build","BaseFilterFactory","addFilter","maps","addHCMFilter","addHighlightHCMFilter","newFgColor","newBgColor","keepHCM","BaseCanvasFactory","_createCanvas","getContext","reset","canvasAndContext","BaseCMapReaderFactory","compressionType","CMapCompressionType","BINARY","NONE","_fetchData","BaseStandardFontDataFactory","BaseSVGFactory","skipDimensions","_createSVG","PathType","FILL","STROKE","SHADING","applyBoundingBox","ctx","bbox","region","Path2D","clip","BaseShadingPattern","getPattern","RadialAxialShadingPattern","IR","_bbox","_colorStops","_p0","_p1","_r0","_r1","matrix","_createGradient","grad","createLinearGradient","createRadialGradient","colorStop","addColorStop","owner","inverse","pathType","pattern","ownerBBox","current","getClippedPathBoundingBox","getCurrentTransform","ceil","tmpCanvas","cachedCanvases","getCanvas","tmpCtx","clearRect","beginPath","translate","baseTransform","fillStyle","fill","createPattern","domMatrix","DOMMatrix","setTransform","drawTriangle","p1","p2","p3","c1","c2","c3","coords","colors","bytes","rowSize","tmp","x1","scaleX","y1","scaleY","x2","y2","x3","y3","c1r","c1g","c1b","c2r","c2g","c2b","c3r","c3g","c3b","minY","maxY","xa","car","cag","cab","xb","cbr","cbg","cbb","x1_","x2_","j","drawFigure","figure","ps","cs","verticesPerRow","rows","cols","q","MeshShadingPattern","_coords","_colors","_figures","_bounds","_background","_createMeshCanvas","combinedScale","EXPECTED_SCALE","MAX_PATTERN_SIZE","boundsWidth","boundsHeight","paddedWidth","paddedHeight","createImageData","putImageData","singularValueDecompose2dScale","matrixScale","temporaryPatternCanvas","DummyShadingPattern","getShadingPattern","PaintType","COLORED","UNCOLORED","TilingPattern","canvasGraphicsFactory","xstep","ystep","paintType","tilingType","createPatternCanvas","x0","y0","curMatrixScale","dimx","getSizeAndScale","dimy","graphics","createCanvasGraphics","groupLevel","setFillAndStrokeStyleToContext","adjustedX0","adjustedY0","adjustedX1","adjustedY1","save","clipBbox","step","realOutputSize","maxSize","bboxWidth","bboxHeight","updateRectMinMax","endPath","strokeStyle","cssColor","FormatError","convertToRGBA","kind","ImageKind","GRAYSCALE_1BPP","convertBlackAndWhiteToRGBA","RGB_24BPP","convertRGBToRGBA","srcPos","nonBlackColor","inverseDecode","black","isLittleEndian","zeroMapping","oneMapping","widthInSource","widthRemainder","srcLength","Uint32Array","destPos","elem","len32","src32","s1","s2","s3","jj","grayToRGBA","MIN_FONT_SIZE","MAX_FONT_SIZE","MAX_GROUP_SIZE","EXECUTION_TIME","EXECUTION_STEPS","MAX_SIZE_TO_COMPILE","FULL_CHUNK_HEIGHT","mirrorContextOperations","destCtx","_removeMirroring","__originalSave","__originalRestore","restore","__originalRotate","__originalScale","__originalTranslate","__originalTransform","__originalSetTransform","__originalResetTransform","resetTransform","__originalClip","__originalMoveTo","moveTo","__originalLineTo","lineTo","__originalBezierCurveTo","bezierCurveTo","__originalRect","__originalClosePath","closePath","__originalBeginPath","ctxSave","ctxRestore","ctxTranslate","ctxScale","ctxTransform","a","d","f","ctxSetTransform","ctxResetTransform","ctxRotate","rule","cp1x","cp1y","cp2x","cp2y","CachedCanvases","cache","canvasEntry","drawImageAtIntegerCoords","srcImg","srcX","srcY","srcW","srcH","destX","destY","destW","destH","tx","ty","tlX","rTlX","tlY","rTlY","brX","rWidth","brY","rHeight","sign","drawImage","hypot","compileType3Glyph","imgData","POINT_TO_PROCESS_LIMIT","POINT_TYPES","width1","j0","lineSize","pos","mask","count","sum","steps","Int32Array","path","p0","pp","drawOutline","CanvasExtraState","alphaIsShape","fontSizeScale","textMatrix","IDENTITY_MATRIX","textMatrixScale","fontMatrix","FONT_IDENTITY_MATRIX","leading","lineX","lineY","charSpacing","wordSpacing","textHScale","textRenderingMode","TextRenderingMode","textRise","patternFill","strokeAlpha","lineWidth","activeSMask","transferMaps","startNewPathAndClipBox","clipBox","setCurrentPoint","updatePathMinMax","applyTransform","minX","maxX","p4","updateScalingPathMinMax","minMax","scaleMinMax","updateCurvePathMinMax","box","bezierBoundingBox","getPathBoundingBox","xStrokePad","yStrokePad","updateClipFromPath","isEmptyClip","Infinity","putBinaryImageData","ImageData","partialChunkHeight","fullChunks","totalChunks","chunkImgData","thisChunkHeight","elemsInThisChunk","dest32","dest32DataLength","fullSrcDiff","white","srcDiff","kEnd","kEndUnrolled","srcByte","RGBA_32BPP","subarray","putBinaryImageMask","copyCtxState","sourceCtx","properties","property","setLineDash","getLineDash","lineDashOffset","resetCtxToDefault","fillRule","globalAlpha","lineCap","lineJoin","miterLimit","globalCompositeOperation","composeSMaskBackdrop","r0","g0","b0","alpha","alpha_","composeSMaskAlpha","maskData","layerData","transferMap","composeSMaskLuminosity","genericComposeSMask","maskCtx","layerCtx","backdrop","layerOffsetX","layerOffsetY","maskOffsetX","maskOffsetY","hasBackdrop","composeFn","PIXELS_TO_PROCESS","chunkSize","row","chunkHeight","getImageData","composeSMask","smask","layerBox","layerWidth","layerHeight","getImageSmoothingEnabled","interpolate","fround","actualScale","devicePixelRatio","PixelsPerInch","PDF_TO_CSS_UNITS","LINE_CAP_STYLES","LINE_JOIN_STYLES","NORMAL_CLIP","EO_CLIP","canvasCtx","markedContentStack","stateStack","pendingClip","pendingEOFill","res","xobjs","groupStack","processingType3","baseTransformStack","smaskStack","smaskCounter","tempSMask","suspendedCtx","contentVisible","cachedPatterns","viewportScale","outputScaleX","outputScaleY","_cachedScaleForStroking","_cachedGetSinglePixelWidth","_cachedBitmapsMap","getObject","fallback","startsWith","savedFillStyle","fillRect","transparentCanvas","compositeCtx","executionStartIdx","continueCallback","argsArrayLen","chunkOperations","endTime","Date","now","fnId","breakIt","OPS","dependency","apply","depObjId","objsPool","restoreInitialState","#restoreInitialState","inSMaskMode","HTMLCanvasElement","drawFilter","#drawFilter","hcmFilterId","foreground","savedFilter","_scaleImage","img","inverseTransform","widthScale","heightScale","paintWidth","paintHeight","tmpCanvasId","newWidth","newHeight","_createMaskCanvas","isPatternFill","currentTransform","scaled","maskCanvas","mainKey","cachedImage","maskToCanvas","getAxialAlignedBoundingBox","drawnWidth","drawnHeight","fillCanvas","fillCtx","getCurrentTransformInverse","imageSmoothingEnabled","setLineWidth","setLineCap","setLineJoin","setMiterLimit","limit","setDash","dashArray","dashPhase","setRenderingIntent","setFlatness","flatness","setGState","states","setFont","checkSMaskState","beginSMaskMode","endSMaskMode","cacheId","scratchCanvas","compose","dirtyBox","old","pop","constructPath","ops","args","startX","startY","isScalingMatrix","minMaxForBezier","rectangle","xw","yh","curveTo","curveTo2","curveTo3","stroke","consumePath","rescaleAndStroke","closeStroke","needRestore","eoFill","fillStroke","eoFillStroke","closeFillStroke","closeEOFillStroke","eoClip","beginText","endText","paths","pendingTextPaths","addToPath","setCharSpacing","spacing","setWordSpacing","setHScale","setLeading","fontRefName","fontObj","fontDirection","isType3Font","loadedName","typeface","systemFontInfo","css","fallbackName","bold","italic","browserFontSize","setTextRenderingMode","setTextRise","rise","moveText","setLeadingMoveText","setTextMatrix","nextLine","paintChar","character","patternTransform","fillStrokeMode","FILL_STROKE_MASK","isAddToPathSet","ADD_TO_PATH_FLAG","missingFile","getPathGenerator","FILL_STROKE","fillText","strokeText","isFontSubpixelAAEnabled","showText","glyphs","showType3Text","glyphsLength","vertical","spacingDir","defaultVMetrics","widthAdvanceScale","simpleFillText","getSinglePixelWidth","isInvalidPDFjsFont","chars","glyph","unicode","restoreNeeded","isSpace","fontChar","accent","scaledX","scaledY","vmetric","vx","vy","remeasure","measuredWidth","measureText","characterScaleX","isInFont","scaledAccentX","offset","scaledAccentY","charWidth","isTextInvisible","INVISIBLE","spacingLength","charProcOperatorList","operatorListId","transformed","setCharWidth","xWidth","yWidth","setCharWidthAndBounds","llx","lly","urx","ury","getColorN_Pattern","_getPattern","setStrokeColorN","arguments","setFillColorN","setStrokeRGBColor","setFillRGBColor","shadingFill","inv","beginInlineImage","beginImageData","paintFormXObjectBegin","paintFormXObjectEnd","beginGroup","group","currentCtx","isolated","knockout","bounds","canvasBounds","groupCtx","startTransformInverse","endGroup","currentMtx","beginAnnotation","canvasWidth","canvasHeight","annotationCanvas","savedCtx","endAnnotation","paintImageMaskXObject","compiled","paintImageMaskXObjectRepeat","skewX","skewY","positions","trans","paintImageMaskXObjectGroup","images","paintImageXObject","paintInlineImageXObject","paintImageXObjectRepeat","w","h","paintInlineImageXObjectGroup","applyTransferMapsToCanvas","applyTransferMapsToBitmap","imgToPaint","HTMLElement","paintSolidColorImageMask","markPoint","tag","markPointProps","beginMarkedContent","visible","beginMarkedContentProps","isContentVisible","endMarkedContent","beginCompat","endCompat","isEmpty","absDet","normX","normY","getScaleForStroking","getTransform","scaledLineWidth","scaledXLineWidth","scaledYLineWidth","baseArea","saveRestore","dashes","op","SVG_NS","PDF","_base_factory_js__WEBPACK_IMPORTED_MODULE_0__","_cache","_defs","hcmFilter","hcmKey","hcmUrl","hcmHighlightFilter","hcmHighlightKey","hcmHighlightUrl","#cache","#defs","contain","position","createElementNS","body","tableR","tableG","tableB","mapR","mapG","mapB","bufferR","bufferG","bufferB","createFilter","addTransferMapConversion","fgRGB","getRGB","_shared_util_js__WEBPACK_IMPORTED_MODULE_1__","bgRGB","table","addGrayConversion","getSteps","start","arr","fgGray","bgGray","newFgRGB","newBgRGB","fg","bg","newStart","newStep","prev","parentNode","#addGrayConversion","feColorMatrix","#createFilter","appendFeFunc","#appendFeFunc","feComponentTransfer","func","feFunc","#addTransferMapConversion","rTable","gTable","bTable","#getRGB","getComputedStyle","getPropertyValue","_document","fetchData","response","ok","statusText","arrayBuffer","blob","json","text","request","XMLHttpRequest","responseType","onreadystatechange","readyState","DONE","responseText","cMapData","centerX","centerY","rotateA","rotateB","rotateC","rotateD","offsetCanvasX","offsetCanvasY","convertToViewportPoint","convertToViewportRectangle","topLeft","bottomRight","convertToPdfPoint","applyInverseTransform","BaseException","msg","trim","isPdfFile","onlyStripPath","lastIndexOf","getPdfFilenameFromUrl","defaultFilename","reURI","reFilename","splitURI","exec","suggestedFilename","decodeURIComponent","started","times","outBuf","longest","padEnd","protocol","noContextMenu","deprecated","console","log","pdfDateStringRegex","input","RegExp","matches","year","month","day","hour","minute","second","universalTimeRelation","offsetHour","offsetMinute","UTC","getXfaPageViewport","xfaPage","attributes","colorRGB","getColorValues","span","computedColor","invertSelf","mustFlip","mustRotate","useRound","isCSSRoundSupported","widthStr","heightStr","DrawLayer","mapping","setParent","root","_svgFactory","_display_utils_js__WEBPACK_IMPORTED_MODULE_0__","setBox","#setBox","createSVG","#createSVG","highlight","outlines","opacity","pathId","extractPathFromHighlightOutlines","clipPathId","clipPathUse","use","highlightOutline","use1","use2","cloneNode","#extractPathFromHighlightOutlines","polygons","polygon","prevX","prevY","updateBox","changeColor","changeOpacity","addClass","removeClass","FreeTextEditor","editor_editor","boundEditorDivBlur","editorDivBlur","boundEditorDivFocus","editorDivFocus","boundEditorDivInput","editorDivInput","boundEditorDivKeydown","editorDivKeydown","editorDivId","_freeTextDefaultContent","_internalPadding","_defaultColor","_defaultFontSize","_keyboardManager","proto","arrowChecker","self","small","tools","AnnotationEditorUIManager","TRANSLATE_SMALL","big","TRANSLATE_BIG","KeyboardManager","commitOrRemove","bubbles","_translateEmpty","checker","_editorType","_defaultLineColor","initialize","l10n","strings","documentElement","parseFloat","updateDefaultParams","AnnotationEditorParamsType","FREETEXT_SIZE","FREETEXT_COLOR","updateParams","updateFontSize","updateColor","defaultPropertiesToUpdate","propertiesToUpdate","#updateFontSize","setFontsize","editorDiv","parentScale","setEditorDimensions","savedFontsize","addCommands","cmd","undo","mustExec","overwriteIfSameType","keepUndo","#updateColor","savedColor","_uiManager","translateSelectedEditors","getInitialTranslation","rebuild","isAttachedToDOM","enableEditMode","isInEditMode","setEditingState","updateToolbar","overlayDiv","contentEditable","_isDraggable","disableEditMode","isEditing","focusin","_focusEventsAllowed","onceAdded","cheatInitialRect","_initialOptions","isCentered","center","innerText","extractText","#extractText","divs","getElementsByTagName","replace","#setEditorDimensions","parentHeight","parentDimensions","getBoundingClientRect","currentLayer","savedDisplay","parentRotation","fixAndSetPosition","commit","savedText","newText","trimEnd","setText","setContent","shouldGetKeyboardEvents","enterInEditMode","dblclick","keydown","disableEditing","enableEditing","baseX","baseY","_l10nPromise","bindEvents","annotationElementId","pageTranslationToScreen","pageDimensions","pageTranslation","posX","posY","setAt","#setContent","replaceChildren","contentDiv","deserialize","uiManager","annotation_layer","deleted","editor","isForCopying","padding","getRect","_colorManager","convert","structTreeParentId","_structTreeParentId","hasElementChanged","#hasElementChanged","some","#cheatInitialRect","InkEditor","baseHeight","baseWidth","boundCanvasPointermove","canvasPointermove","boundCanvasPointerleave","canvasPointerleave","boundCanvasPointerup","canvasPointerup","boundCanvasPointerdown","canvasPointerdown","canvasContextMenuTimeoutId","currentPath2D","hasSomethingToDraw","isCanvasInitialized","observer","realWidth","realHeight","requestFrameCallback","_defaultOpacity","_defaultThickness","thickness","bezierPath2D","allRawPaths","currentPath","scaleFactor","translationX","translationY","_willKeepAspectRatio","INK_THICKNESS","INK_COLOR","INK_OPACITY","updateThickness","updateOpacity","#updateThickness","savedThickness","fitToContent","redraw","#updateOpacity","savedOpacity","createCanvas","createObserver","setCanvasDims","disconnect","removeShouldRescale","addShouldRescale","onScaleChanging","setDimensions","getInitialBBox","#getInitialBBox","setStroke","#setStroke","opacityToHex","startDrawing","#startDrawing","drawPoints","draw","#draw","lastX","lastY","at","path2D","makeBezierCurve","#endPath","lastPoint","stopDrawing","#stopDrawing","bezier","generateBezierPoints","xy","#drawPoints","lastPoints","xMin","xMax","yMin","yMax","#makeBezierCurve","#generateBezierPoints","bezierPoints","control1","control2","#redraw","updateTransform","setInForeground","select","addInkEditorIfNeeded","moveInDOM","button","pointerType","contains","#endDrawing","addToAnnotationStorage","setInBackground","#createCanvas","#createObserver","ResizeObserver","contentRect","observe","isResizable","setDims","setAspectRatio","#setCanvasDims","roundedWidth","roundedHeight","setScaleFactor","fixDims","#setScaleFactor","getPadding","scaleFactorW","scaleFactorH","#updateTransform","buildPath2D","#buildPath2D","first","toPDFCoordinates","#toPDFCoordinates","fromPDFCoordinates","#fromPDFCoordinates","serializePaths","#serializePaths","s","shiftX","shiftY","p10","p11","p20","p21","p30","p31","p40","p41","getBbox","#getBbox","#getPadding","#fitToContent","firstTime","MIN_SIZE","prevTranslationX","prevTranslationY","unscaledPadding","StampEditor","bitmapId","bitmapPromise","bitmapUrl","bitmapFile","bitmapFileName","resizeTimeoutId","isSvg","hasBeenAddedInUndoStack","supportedTypes","types","supportedTypesStr","isHandlingMimeForPasting","mime","paste","pasteEditor","getAsFile","getBitmapFetched","#getBitmapFetched","fromId","getBitmapDone","#getBitmapDone","enableWaiting","getBitmap","#getBitmap","imageManager","getFromId","getFromUrl","getFromFile","accept","files","click","deleteId","MAX_RATIO","factor","drawBitmap","addUndoableEditor","_eventBus","editorType","addAltTextButton","#setDimensions","TIME_TO_WAIT","scaleBitmap","#scaleBitmap","bitmapWidth","bitmapHeight","prevWidth","prevHeight","offscreen","OffscreenCanvas","transferToImageBitmap","#drawBitmap","getImageForAltText","serializeBitmap","#serializeBitmap","toUrl","getSvgUrl","toDataURL","accessibilityData","isValidId","altTextData","decorative","altText","alt","stamps","area","prevData","AnnotationEditorLayer","allowClick","annotationLayer","boundPointerup","pointerup","boundPointerdown","pointerdown","editorFocusTimeoutId","editors","hadPointerDown","isCleaningUp","isDisabling","_initialized","editorTypes","registerEditorTypes","addLayer","updateMode","getMode","disableClick","enableClick","isCommitting","createAndAddNewEditor","togglePointerEvents","enable","annotationElementIds","editables","isDeletedAnnotationElement","addOrRebuild","disable","hiddenAnnotationIds","setActiveEditor","currentActive","getActive","attach","removeDeletedAnnotationElement","detach","removePointerInTextLayer","addDeletedAnnotationElement","removeEditor","changeParent","deleteAnnotationElement","addEditor","moveEditorInDOM","once","needsToBeRebuilt","getNextId","getId","createNewEditor","#createNewEditor","getCenterPoint","#createAndAddNewEditor","#getCenterPoint","innerWidth","innerHeight","addNewEditor","setSelected","toggleSelected","isSelected","unselect","unselectAll","findNewParent","findParent","removeLayer","#cleanup","getEditors","EditorToolbar","toolbar","buttons","editToolbar","pointerDown","addDeleteButton","#pointerDown","stopPropagation","focusIn","#focusIn","focusOut","#focusOut","addListenersToElement","#addListenersToElement","capture","#addDeleteButton","allResizerDivs","altTextDecorative","altTextButton","altTextTooltip","altTextTooltipTimeout","altTextWasFromKeyBoard","keepAspectRatio","resizersDiv","savedDimensions","boundFocusin","boundFocusout","focusout","focusedResizerName","hasBeenClicked","isResizerEnabledForKeyboard","moveInDOMTimeout","isDraggable","_zIndex","_borderLineWidth","ColorManager","SMALL_EDITOR_SIZE","_resizerKeyboardManager","resize","_resizeWithKeyboard","_stopResizingWithKeyboard","pageRotation","viewParameters","getPrototypeOf","getHexCode","fakeEditor","FakeEditor","_value","isEnterHandled","stopResizing","closest","isMultipleSelection","screenToPageTranslation","#translate","translateInPage","scrollIntoView","block","drag","bx","by","getBaseTranslation","toFixed","#getBaseTranslation","rotatePoint","#rotatePoint","getRotationMatrix","#getRotationMatrix","realScale","scaledWidth","scaledHeight","widthPercent","endsWith","heightPercent","createResizers","#createResizers","classes","resizerPointerdown","#resizerPointerdown","toggleAltTextButton","boundResizerPointermove","resizerPointermove","savedDraggable","pointerMoveOptions","passive","savedX","savedY","savedWidth","savedHeight","savedParentCursor","cursor","savedCursor","pointerUpCallback","addResizeToUndoStack","#addResizeToUndoStack","newX","newY","#resizerPointermove","minWidth","minHeight","rotationMatrix","transf","invRotationMatrix","invTransf","getPoint","getOpposite","isDiagonal","isHorizontal","point","oppositePoint","transfOppositePoint","oppositeX","oppositeY","ratioX","ratioY","deltaX","deltaY","movementX","movementY","oldDiag","onClick","editAltText","setAltTextButtonState","PERCENT","#setAltTextButtonState","tooltip","DELAY_TO_SHOW_TOOLTIP","#toggleAltTextButton","altTextFinish","focusVisible","addEditToolbar","removeEditToolbar","getClientDimensions","maxWidth","maxHeight","setUpDragSession","#setUpDragSession","pointerMoveCallback","dragSelectedEditors","endDragSession","_setParentAndPosition","getRectInCurrentCoords","makeResizable","boundResizerKeydown","resizerKeydown","boundResizerBlur","resizerBlur","resizerFocus","firstPosition","nextFirstPosition","child","setResizerTabIndex","stopImmediatePropagation","#resizerKeydown","#resizerBlur","#resizerFocus","#setResizerTabIndex","#stopResizing","aspectRatio","Outliner","verticalEdges","intervals","boxes","innerMargin","isLTR","NUMBER_OF_DIGITS","EPSILON","right","shiftedMinX","shiftedMinY","lastEdge","edge","getOutlines","sort","outlineVerticalEdges","breakEdge","#getOutlines","edges","allEdges","edge1","edge2","outline","next","lastPointX","lastPointY","binarySearch","#binarySearch","array","middle","#insert","splice","#remove","#breakEdge","y4","IdManager","AnnotationEditorPrefix","ImageManager","baseId","getUuid","_isSVGFittingCanvas","Image","decode","#get","rawData","refCounter","_display_utils_js__WEBPACK_IMPORTED_MODULE_1__","mustRemoveAspectRatioPromise","fileReader","FileReader","imageElement","imagePromise","onload","svgUrl","result","onerror","readAsDataURL","createImageBitmap","lastModified","CommandManager","commands","locked","redo","hasSomethingToUndo","hasSomethingToRedo","callbacks","allKeys","isMacKey","#serialize","_colorsMapping","matchMedia","RGB","every","activeEditor","allEditors","allLayers","altTextManager","commandManager","currentPageIndex","deletedAnnotationsElementIds","draggingEditors","editorsToRescale","focusMainContainerTimeoutId","idManager","isEnabled","isWaiting","lastActiveElement","selectedEditors","boundBlur","blur","boundFocus","boundCopy","copy","boundCut","cut","boundPaste","boundKeydown","boundOnEditingAction","onEditingAction","boundOnPageChanging","onPageChanging","boundOnScaleChanging","boundOnRotationChanging","onRotationChanging","previousStates","hasSelectedEditor","translation","translationTimeoutId","viewer","hasSomethingToControl","textInputChecker","_self","el","HTMLInputElement","selectAll","addNewEditorFromKeyboard","HTMLButtonElement","pdfDocument","_on","removeKeyboardManager","removeFocusManager","_off","direction","focusMainContainer","layerX","layerY","disableUserSelect","pagesRotation","addFocusManager","#addFocusManager","#removeFocusManager","hasSelection","lastEditor","addKeyboardManager","#addKeyboardManager","#removeKeyboardManager","addCopyPasteListeners","#addCopyPasteListeners","removeCopyPasteListeners","#removeCopyPasteListeners","addEditListeners","removeEditListeners","clipboardData","setData","parse","newEditors","deserializedEditor","addEditorToLayer","selectEditors","isEditorHandlingKeyboard","dispatchUpdateStates","#dispatchUpdateStates","hasChanged","dispatchUpdateUI","#dispatchUpdateUI","getLayer","isFromKeyboard","disableAll","enableAll","CREATE","mustWait","#enableAll","#disableAll","getEditor","#addEditorToLayer","ed","firstSelectedEditor","#isEmpty","#selectEditors","noCommit","totalX","totalY","savedPageIndex","newPageIndex","mustBeAddedInUndoStack","move","isActive","createFetchOptions","headers","abortController","method","signal","credentials","redirect","createHeaders","Headers","getArrayBuffer","isHttp","_fullRequestReader","_rangeRequestReaders","_progressiveDataLength","_loaded","PDFFetchStreamReader","PDFFetchStreamRangeReader","stream","_stream","_reader","_filename","_withCredentials","_contentLength","_headersCapability","_disableRange","_rangeChunkSize","_abortController","AbortController","_isStreamingSupported","_isRangeSupported","_headers","_network_utils_js__WEBPACK_IMPORTED_MODULE_1__","validateResponseStatus","createResponseStatusError","getResponseHeader","allowRangeRequests","suggestedLength","validateRangeRequestCapabilities","extractFilenameFromHeader","_readCapability","systemFonts","nativeFontFaces","loadingRequests","loadTestFontId","addNativeFontFace","nativeFontFace","fonts","removeNativeFontFace","insertRule","styleSheet","sheet","cssRules","loadSystemFont","_inspectFont","isFontLoadingAPISupported","fontFace","FontFace","load","baseFontName","attached","createNativeFontFace","family","createFontFaceRule","isSyncFontLoadingSupported","_queueLoadingCallback","_prepareFontLoadEvent","hasFonts","supported","navigator","userAgent","completeRequest","otherRequest","_loadTestFont","testFont","atob","int32","charCodeAt","spliceString","chunk1","chunk2","called","isFontReady","COMMENT_OFFSET","CFF_CHECKSUM_OFFSET","XXXX_VALUE","checksum","string32","btoa","fontFamily","translatedData","compiledGlyphs","cssFontInfo","weight","fontWeight","italicAngle","bytesToString","mimetype","cmds","jsBuf","Function","metadataMap","parsedData","getRaw","OK_RESPONSE","PARTIAL_CONTENT_RESPONSE","xhr","NetworkManager","currXhrId","pendingRequests","requestRange","prop","requestFull","xhrId","pendingRequest","setRequestHeader","expectedStatus","onError","onStateChange","onprogress","onHeadersReceived","onDone","xhrStatus","ok_response_on_range_request","rangeHeader","getRequestXhr","isPendingRequest","abortRequest","_source","_manager","_onRangeRequestReaderClosed","indexOf","PDFNetworkStreamFullRequestReader","PDFNetworkStreamRangeRequestReader","onClosed","manager","_onHeadersReceived","_onDone","_onError","_onProgress","_url","_fullRequestId","_headersReceivedCapability","_cachedChunks","_requests","_done","_storedError","fullRequestXhrId","fullRequestXhr","requestCapability","lengthComputable","_requestId","_queuedChunk","_close","getFilenameFromContentDispositionHeader","contentDisposition","needsEncodingFixup","toParamRegExp","rfc2616unquote","unescape","rfc5987decode","rfc2047decode","fixupEncoding","rfc2231getparam","attributePattern","flags","textdecode","encoding","decoder","TextDecoder","fatal","contentDispositionStr","iter","quot","part","parts","quotindex","extvalue","encodingend","langvalue","charset","hex","String","fromCharCode","returnValues","contentEncoding","fs","http","https","fileUriRegex","parseUrl","sourceUrl","parsedUrl","host","isFsUrl","PDFNodeStreamFsFullReader","PDFNodeStreamFullReader","PDFNodeStreamFsRangeReader","PDFNodeStreamRangeReader","BaseFullReader","_readableStream","_error","_setReadableStream","BaseRangeReader","createRequestOptions","auth","hostname","handleResponse","statusCode","_request","_httpHeaders","Range","lstat","stat","createReadStream","path2d_polyfill","readFile","INTERNAL","Symbol","OptionalContentGroup","_setVisible","internal","cachedGetHash","groups","initialHash","order","creator","baseState","off","getHash","evaluateVisibilityExpression","#evaluateVisibilityExpression","operator","state","expression","policy","setVisibility","hasInitialVisibility","getOrder","getGroups","getGroup","_shared_murmurhash3_js__WEBPACK_IMPORTED_MODULE_1__","MAX_TEXT_DIVS_TO_RENDER","DEFAULT_FONT_ASCENT","ascentCache","getCtx","getAscent","cachedAscent","metrics","ascent","fontBoundingBoxAscent","descent","fontBoundingBoxDescent","ratio","pixels","appendText","geom","textDiv","textDivProperties","hasText","hasEOL","_textDivs","_transform","atan2","fontName","PI","_fontInspectorEnabled","fontSubstitution","fontHeight","fontAscent","_isOffscreenCanvasSupported","sin","cos","scaleFactorStr","divStyle","_container","_rootContainer","_pageWidth","_pageHeight","dataset","fontSubstitutionLoadedName","shouldScaleText","absScaleX","absScaleY","_textDivProperties","_isReadableStream","_layoutText","layout","prevFontSize","prevFontFamily","_canceled","textDivs","textDivsLength","TextLayerRenderTask","textContentSource","textContentItemsStr","_textContentSource","ReadableStream","_textContentItemsStr","_layoutTextParams","_processItems","styleCache","br","_render","renderTextLayer","updateTextLayer","mustRescale","pdfDataRangeTransport","_queuedChunks","_progressiveDone","_contentDispositionFilename","_pdfDataRangeTransport","_rangeReaders","_onReceiveData","_onProgressiveDone","_enqueue","found","_begin","_removeRangeReader","queuedChunks","PDFDataTransportStreamReader","PDFDataTransportStreamRangeReader","_headersReady","_end","requestsCapability","setupStorage","xfaOn","xfaOff","setAttributes","isHTMLAnchorElement","HTMLAnchorElement","dataId","rootHtml","isNotForRichText","rootDiv","node","_xfa_text_js__WEBPACK_IMPORTED_MODULE_0__","shouldBuildText","stack","childHtml","xmlns","querySelectorAll","output","walk","pdfjsVersion","pdfjsBuild","CallbackKind","UNKNOWN","DATA","ERROR","StreamKind","CANCEL","CANCEL_COMPLETE","CLOSE","ENQUEUE","PULL","PULL_COMPLETE","START_COMPLETE","wrapReason","_util_js__WEBPACK_IMPORTED_MODULE_0__","sourceName","targetName","comObj","callbackId","streamId","streamSinks","streamControllers","callbackCapabilities","actionHandler","_onComObjOnMessage","processStreamMessage","cbSourceName","cbTargetName","createStreamSink","handler","ah","transfers","queueingStrategy","controller","startCapability","startCall","pullCall","cancelCall","isClosed","desiredSize","pull","pullCapability","cancelCapability","#createStreamSink","streamSink","isCancelled","lastDesiredSize","sinkCapability","#processStreamMessage","streamController","deleteStreamController","#deleteStreamController","allSettled","SEED","MASK_HIGH","MASK_LOW","seed","h1","h2","blockCounts","tailLength","dataUint32","k1","k2","C1","C2","C1_LOW","C2_LOW","process","versions","nw","electron","LINE_DESCENT_FACTOR","BASELINE_FACTOR","SAVE","RESIZE","FREETEXT_OPACITY","PermissionFlag","MODIFY_CONTENTS","COPY","MODIFY_ANNOTATIONS","FILL_INTERACTIVE_FORMS","COPY_FOR_ACCESSIBILITY","ASSEMBLE","PRINT_HIGH_QUALITY","FILL_ADD_TO_PATH","STROKE_ADD_TO_PATH","FILL_STROKE_ADD_TO_PATH","ADD_TO_PATH","SOUND","MOVIE","SCREEN","PRINTERMARK","TRAPNET","WATERMARK","THREED","REDACT","AnnotationReplyType","GROUP","REPLY","AnnotationFlag","HIDDEN","NOZOOM","NOROTATE","NOVIEW","READONLY","LOCKED","TOGGLENOVIEW","LOCKEDCONTENTS","AnnotationFieldFlag","REQUIRED","NOEXPORT","MULTILINE","PASSWORD","NOTOGGLETOOFF","RADIO","PUSHBUTTON","COMBO","EDIT","SORT","FILESELECT","MULTISELECT","DONOTSPELLCHECK","DONOTSCROLL","COMB","RICHTEXT","RADIOSINUNISON","COMMITONSELCHANGE","AnnotationActionEventType","E","X","D","U","Fo","Bl","PO","PC","PV","K","F","V","C","DocumentActionEventType","WC","WS","DS","WP","DP","PageActionEventType","O","VerbosityLevel","ERRORS","WARNINGS","INFOS","showSpacedText","nextLineShowText","nextLineSetSpacingShowText","setStrokeColorSpace","setFillColorSpace","setStrokeColor","setFillColor","setStrokeGray","setFillGray","setStrokeCMYKColor","setFillCMYKColor","endInlineImage","paintXObject","PasswordResponses","NEED_PASSWORD","INCORRECT_PASSWORD","level","cond","_isValidProtocol","createValidAbsoluteUrl","addDefaultProtocol","dots","tryConvertEncoding","stringToUTF8String","absoluteUrl","nonSerializable","defineProperty","enumerable","configurable","writable","BaseExceptionClosure","MAX_ARGUMENT_COUNT","strBuf","chunkEnd","objectSize","buffer8","view32","hexNumbers","temp","m1","m2","xt","yt","transpose","sqrt","sx","sy","rect1","rect2","xLow","xHigh","yLow","yHigh","tvalues","t","t1","t2","b2ac","sqrtb2ac","mt","jlen","PDFStringTranslateTable","stringToPDFString","decoded","charCode","charAt","escape","utf8StringToString","encodeURIComponent","v","isArrayEqual","arr1","arr2","getModificationDate","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","NormalizeRegex","NormalizationMap","normalizeUnicode","_","normalize","crypto","randomUUID","buf","getRandomValues","random","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","webpackQueues","webpackExports","webpackError","resolveQueue","queue","forEach","fn","wrapDeps","deps","dep","ret","hasAwait","depQueues","currentDeps","outerResolve","rej","getResult","fnQueue","err","definition","o","__webpack_exports__"],"sources":["webpack://pdf.js/src/shared/scripting_utils.js","webpack://pdf.js/src/display/annotation_layer.js","webpack://pdf.js/src/display/annotation_storage.js","webpack://pdf.js/src/display/api.js","webpack://pdf.js/src/display/base_factory.js","webpack://pdf.js/src/display/pattern_helper.js","webpack://pdf.js/src/shared/image_utils.js","webpack://pdf.js/src/display/canvas.js","webpack://pdf.js/src/display/display_utils.js","webpack://pdf.js/src/display/draw_layer.js","webpack://pdf.js/src/display/editor/freetext.js","webpack://pdf.js/src/display/editor/ink.js","webpack://pdf.js/src/display/editor/stamp.js","webpack://pdf.js/src/display/editor/annotation_editor_layer.js","webpack://pdf.js/src/display/editor/toolbar.js","webpack://pdf.js/src/display/editor/editor.js","webpack://pdf.js/src/display/editor/outliner.js","webpack://pdf.js/src/display/editor/tools.js","webpack://pdf.js/src/display/fetch_stream.js","webpack://pdf.js/src/display/font_loader.js","webpack://pdf.js/src/display/metadata.js","webpack://pdf.js/src/display/network.js","webpack://pdf.js/src/display/content_disposition.js","webpack://pdf.js/src/display/network_utils.js","webpack://pdf.js/src/display/node_stream.js","webpack://pdf.js/src/display/node_utils.js","webpack://pdf.js/src/display/optional_content_config.js","webpack://pdf.js/src/display/text_layer.js","webpack://pdf.js/src/display/transport_stream.js","webpack://pdf.js/src/display/worker_options.js","webpack://pdf.js/src/display/xfa_layer.js","webpack://pdf.js/src/display/xfa_text.js","webpack://pdf.js/src/pdf.js","webpack://pdf.js/src/shared/message_handler.js","webpack://pdf.js/src/shared/murmurhash3.js","webpack://pdf.js/src/shared/util.js","webpack://pdf.js/webpack/bootstrap","webpack://pdf.js/webpack/runtime/async module","webpack://pdf.js/webpack/runtime/define property getters","webpack://pdf.js/webpack/runtime/hasOwnProperty shorthand","webpack://pdf.js/webpack/before-startup","webpack://pdf.js/webpack/startup","webpack://pdf.js/webpack/after-startup"],"sourcesContent":["/* Copyright 2020 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * PLEASE NOTE: This file is currently imported in both the `../display/` and\n *              `../scripting_api/` folders, hence be EXTREMELY careful about\n *              introducing any dependencies here since that can lead to an\n *              unexpected/unnecessary size increase of the *built* files.\n */\n\nfunction makeColorComp(n) {\n  return Math.floor(Math.max(0, Math.min(1, n)) * 255)\n    .toString(16)\n    .padStart(2, \"0\");\n}\n\nfunction scaleAndClamp(x) {\n  return Math.max(0, Math.min(255, 255 * x));\n}\n\n// PDF specifications section 10.3\nclass ColorConverters {\n  static CMYK_G([c, y, m, k]) {\n    return [\"G\", 1 - Math.min(1, 0.3 * c + 0.59 * m + 0.11 * y + k)];\n  }\n\n  static G_CMYK([g]) {\n    return [\"CMYK\", 0, 0, 0, 1 - g];\n  }\n\n  static G_RGB([g]) {\n    return [\"RGB\", g, g, g];\n  }\n\n  static G_rgb([g]) {\n    g = scaleAndClamp(g);\n    return [g, g, g];\n  }\n\n  static G_HTML([g]) {\n    const G = makeColorComp(g);\n    return `#${G}${G}${G}`;\n  }\n\n  static RGB_G([r, g, b]) {\n    return [\"G\", 0.3 * r + 0.59 * g + 0.11 * b];\n  }\n\n  static RGB_rgb(color) {\n    return color.map(scaleAndClamp);\n  }\n\n  static RGB_HTML(color) {\n    return `#${color.map(makeColorComp).join(\"\")}`;\n  }\n\n  static T_HTML() {\n    return \"#00000000\";\n  }\n\n  static T_rgb() {\n    return [null];\n  }\n\n  static CMYK_RGB([c, y, m, k]) {\n    return [\n      \"RGB\",\n      1 - Math.min(1, c + k),\n      1 - Math.min(1, m + k),\n      1 - Math.min(1, y + k),\n    ];\n  }\n\n  static CMYK_rgb([c, y, m, k]) {\n    return [\n      scaleAndClamp(1 - Math.min(1, c + k)),\n      scaleAndClamp(1 - Math.min(1, m + k)),\n      scaleAndClamp(1 - Math.min(1, y + k)),\n    ];\n  }\n\n  static CMYK_HTML(components) {\n    const rgb = this.CMYK_RGB(components).slice(1);\n    return this.RGB_HTML(rgb);\n  }\n\n  static RGB_CMYK([r, g, b]) {\n    const c = 1 - r;\n    const m = 1 - g;\n    const y = 1 - b;\n    const k = Math.min(c, m, y);\n    return [\"CMYK\", c, m, y, k];\n  }\n}\n\nexport { ColorConverters };\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./api\").PDFPageProxy} PDFPageProxy */\n/** @typedef {import(\"./display_utils\").PageViewport} PageViewport */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../../web/text_accessibility.js\").TextAccessibilityManager} TextAccessibilityManager */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../../web/interfaces\").IDownloadManager} IDownloadManager */\n/** @typedef {import(\"../../web/interfaces\").IPDFLinkService} IPDFLinkService */\n\nimport {\n  AnnotationBorderStyleType,\n  AnnotationEditorType,\n  AnnotationPrefix,\n  AnnotationType,\n  FeatureTest,\n  LINE_FACTOR,\n  shadow,\n  unreachable,\n  Util,\n  warn,\n} from \"../shared/util.js\";\nimport {\n  DOMSVGFactory,\n  getFilenameFromUrl,\n  PDFDateString,\n  setLayerDimensions,\n} from \"./display_utils.js\";\nimport { AnnotationStorage } from \"./annotation_storage.js\";\nimport { ColorConverters } from \"../shared/scripting_utils.js\";\nimport { XfaLayer } from \"./xfa_layer.js\";\n\nconst DEFAULT_TAB_INDEX = 1000;\nconst DEFAULT_FONT_SIZE = 9;\nconst GetElementsByNameSet = new WeakSet();\n\nfunction getRectDims(rect) {\n  return {\n    width: rect[2] - rect[0],\n    height: rect[3] - rect[1],\n  };\n}\n\n/**\n * @typedef {Object} AnnotationElementParameters\n * @property {Object} data\n * @property {HTMLDivElement} layer\n * @property {IPDFLinkService} linkService\n * @property {IDownloadManager} [downloadManager]\n * @property {AnnotationStorage} [annotationStorage]\n * @property {string} [imageResourcesPath] - Path for image resources, mainly\n *   for annotation icons. Include trailing slash.\n * @property {boolean} renderForms\n * @property {Object} svgFactory\n * @property {boolean} [enableScripting]\n * @property {boolean} [hasJSActions]\n * @property {Object} [fieldObjects]\n */\n\nclass AnnotationElementFactory {\n  /**\n   * @param {AnnotationElementParameters} parameters\n   * @returns {AnnotationElement}\n   */\n  static create(parameters) {\n    const subtype = parameters.data.annotationType;\n\n    switch (subtype) {\n      case AnnotationType.LINK:\n        return new LinkAnnotationElement(parameters);\n\n      case AnnotationType.TEXT:\n        return new TextAnnotationElement(parameters);\n\n      case AnnotationType.WIDGET:\n        const fieldType = parameters.data.fieldType;\n\n        switch (fieldType) {\n          case \"Tx\":\n            return new TextWidgetAnnotationElement(parameters);\n          case \"Btn\":\n            if (parameters.data.radioButton) {\n              return new RadioButtonWidgetAnnotationElement(parameters);\n            } else if (parameters.data.checkBox) {\n              return new CheckboxWidgetAnnotationElement(parameters);\n            }\n            return new PushButtonWidgetAnnotationElement(parameters);\n          case \"Ch\":\n            return new ChoiceWidgetAnnotationElement(parameters);\n          case \"Sig\":\n            return new SignatureWidgetAnnotationElement(parameters);\n        }\n        return new WidgetAnnotationElement(parameters);\n\n      case AnnotationType.POPUP:\n        return new PopupAnnotationElement(parameters);\n\n      case AnnotationType.FREETEXT:\n        return new FreeTextAnnotationElement(parameters);\n\n      case AnnotationType.LINE:\n        return new LineAnnotationElement(parameters);\n\n      case AnnotationType.SQUARE:\n        return new SquareAnnotationElement(parameters);\n\n      case AnnotationType.CIRCLE:\n        return new CircleAnnotationElement(parameters);\n\n      case AnnotationType.POLYLINE:\n        return new PolylineAnnotationElement(parameters);\n\n      case AnnotationType.CARET:\n        return new CaretAnnotationElement(parameters);\n\n      case AnnotationType.INK:\n        return new InkAnnotationElement(parameters);\n\n      case AnnotationType.POLYGON:\n        return new PolygonAnnotationElement(parameters);\n\n      case AnnotationType.HIGHLIGHT:\n        return new HighlightAnnotationElement(parameters);\n\n      case AnnotationType.UNDERLINE:\n        return new UnderlineAnnotationElement(parameters);\n\n      case AnnotationType.SQUIGGLY:\n        return new SquigglyAnnotationElement(parameters);\n\n      case AnnotationType.STRIKEOUT:\n        return new StrikeOutAnnotationElement(parameters);\n\n      case AnnotationType.STAMP:\n        return new StampAnnotationElement(parameters);\n\n      case AnnotationType.FILEATTACHMENT:\n        return new FileAttachmentAnnotationElement(parameters);\n\n      default:\n        return new AnnotationElement(parameters);\n    }\n  }\n}\n\nclass AnnotationElement {\n  #hasBorder = false;\n\n  constructor(\n    parameters,\n    {\n      isRenderable = false,\n      ignoreBorder = false,\n      createQuadrilaterals = false,\n    } = {}\n  ) {\n    this.isRenderable = isRenderable;\n    this.data = parameters.data;\n    this.layer = parameters.layer;\n    this.linkService = parameters.linkService;\n    this.downloadManager = parameters.downloadManager;\n    this.imageResourcesPath = parameters.imageResourcesPath;\n    this.renderForms = parameters.renderForms;\n    this.svgFactory = parameters.svgFactory;\n    this.annotationStorage = parameters.annotationStorage;\n    this.enableScripting = parameters.enableScripting;\n    this.hasJSActions = parameters.hasJSActions;\n    this._fieldObjects = parameters.fieldObjects;\n    this.parent = parameters.parent;\n\n    if (isRenderable) {\n      this.container = this._createContainer(ignoreBorder);\n    }\n    if (createQuadrilaterals) {\n      this._createQuadrilaterals();\n    }\n  }\n\n  static _hasPopupData({ titleObj, contentsObj, richText }) {\n    return !!(titleObj?.str || contentsObj?.str || richText?.str);\n  }\n\n  get hasPopupData() {\n    return AnnotationElement._hasPopupData(this.data);\n  }\n\n  /**\n   * Create an empty container for the annotation's HTML element.\n   *\n   * @private\n   * @param {boolean} ignoreBorder\n   * @memberof AnnotationElement\n   * @returns {HTMLElement} A section element.\n   */\n  _createContainer(ignoreBorder) {\n    const {\n      data,\n      parent: { page, viewport },\n    } = this;\n\n    const container = document.createElement(\"section\");\n    container.setAttribute(\"data-annotation-id\", data.id);\n    if (!(this instanceof WidgetAnnotationElement)) {\n      container.tabIndex = DEFAULT_TAB_INDEX;\n    }\n\n    // The accessibility manager will move the annotation in the DOM in\n    // order to match the visual ordering.\n    // But if an annotation is above an other one, then we must draw it\n    // after the other one whatever the order is in the DOM, hence the\n    // use of the z-index.\n    container.style.zIndex = this.parent.zIndex++;\n\n    if (this.data.popupRef) {\n      container.setAttribute(\"aria-haspopup\", \"dialog\");\n    }\n\n    if (data.noRotate) {\n      container.classList.add(\"norotate\");\n    }\n\n    const { pageWidth, pageHeight, pageX, pageY } = viewport.rawDims;\n\n    if (!data.rect || this instanceof PopupAnnotationElement) {\n      const { rotation } = data;\n      if (!data.hasOwnCanvas && rotation !== 0) {\n        this.setRotation(rotation, container);\n      }\n      return container;\n    }\n\n    const { width, height } = getRectDims(data.rect);\n\n    // Do *not* modify `data.rect`, since that will corrupt the annotation\n    // position on subsequent calls to `_createContainer` (see issue 6804).\n    const rect = Util.normalizeRect([\n      data.rect[0],\n      page.view[3] - data.rect[1] + page.view[1],\n      data.rect[2],\n      page.view[3] - data.rect[3] + page.view[1],\n    ]);\n\n    if (!ignoreBorder && data.borderStyle.width > 0) {\n      container.style.borderWidth = `${data.borderStyle.width}px`;\n\n      const horizontalRadius = data.borderStyle.horizontalCornerRadius;\n      const verticalRadius = data.borderStyle.verticalCornerRadius;\n      if (horizontalRadius > 0 || verticalRadius > 0) {\n        const radius = `calc(${horizontalRadius}px * var(--scale-factor)) / calc(${verticalRadius}px * var(--scale-factor))`;\n        container.style.borderRadius = radius;\n      } else if (this instanceof RadioButtonWidgetAnnotationElement) {\n        const radius = `calc(${width}px * var(--scale-factor)) / calc(${height}px * var(--scale-factor))`;\n        container.style.borderRadius = radius;\n      }\n\n      switch (data.borderStyle.style) {\n        case AnnotationBorderStyleType.SOLID:\n          container.style.borderStyle = \"solid\";\n          break;\n\n        case AnnotationBorderStyleType.DASHED:\n          container.style.borderStyle = \"dashed\";\n          break;\n\n        case AnnotationBorderStyleType.BEVELED:\n          warn(\"Unimplemented border style: beveled\");\n          break;\n\n        case AnnotationBorderStyleType.INSET:\n          warn(\"Unimplemented border style: inset\");\n          break;\n\n        case AnnotationBorderStyleType.UNDERLINE:\n          container.style.borderBottomStyle = \"solid\";\n          break;\n\n        default:\n          break;\n      }\n\n      const borderColor = data.borderColor || null;\n      if (borderColor) {\n        this.#hasBorder = true;\n        container.style.borderColor = Util.makeHexColor(\n          borderColor[0] | 0,\n          borderColor[1] | 0,\n          borderColor[2] | 0\n        );\n      } else {\n        // Transparent (invisible) border, so do not draw it at all.\n        container.style.borderWidth = 0;\n      }\n    }\n\n    container.style.left = `${(100 * (rect[0] - pageX)) / pageWidth}%`;\n    container.style.top = `${(100 * (rect[1] - pageY)) / pageHeight}%`;\n\n    const { rotation } = data;\n    if (data.hasOwnCanvas || rotation === 0) {\n      container.style.width = `${(100 * width) / pageWidth}%`;\n      container.style.height = `${(100 * height) / pageHeight}%`;\n    } else {\n      this.setRotation(rotation, container);\n    }\n\n    return container;\n  }\n\n  setRotation(angle, container = this.container) {\n    if (!this.data.rect) {\n      return;\n    }\n    const { pageWidth, pageHeight } = this.parent.viewport.rawDims;\n    const { width, height } = getRectDims(this.data.rect);\n\n    let elementWidth, elementHeight;\n    if (angle % 180 === 0) {\n      elementWidth = (100 * width) / pageWidth;\n      elementHeight = (100 * height) / pageHeight;\n    } else {\n      elementWidth = (100 * height) / pageWidth;\n      elementHeight = (100 * width) / pageHeight;\n    }\n\n    container.style.width = `${elementWidth}%`;\n    container.style.height = `${elementHeight}%`;\n\n    container.setAttribute(\"data-main-rotation\", (360 - angle) % 360);\n  }\n\n  get _commonActions() {\n    const setColor = (jsName, styleName, event) => {\n      const color = event.detail[jsName];\n      const colorType = color[0];\n      const colorArray = color.slice(1);\n      event.target.style[styleName] =\n        ColorConverters[`${colorType}_HTML`](colorArray);\n      this.annotationStorage.setValue(this.data.id, {\n        [styleName]: ColorConverters[`${colorType}_rgb`](colorArray),\n      });\n    };\n\n    return shadow(this, \"_commonActions\", {\n      display: event => {\n        const { display } = event.detail;\n        // See scripting/constants.js for the values of `Display`.\n        // 0 = visible, 1 = hidden, 2 = noPrint and 3 = noView.\n        const hidden = display % 2 === 1;\n        this.container.style.visibility = hidden ? \"hidden\" : \"visible\";\n        this.annotationStorage.setValue(this.data.id, {\n          noView: hidden,\n          noPrint: display === 1 || display === 2,\n        });\n      },\n      print: event => {\n        this.annotationStorage.setValue(this.data.id, {\n          noPrint: !event.detail.print,\n        });\n      },\n      hidden: event => {\n        const { hidden } = event.detail;\n        this.container.style.visibility = hidden ? \"hidden\" : \"visible\";\n        this.annotationStorage.setValue(this.data.id, {\n          noPrint: hidden,\n          noView: hidden,\n        });\n      },\n      focus: event => {\n        setTimeout(() => event.target.focus({ preventScroll: false }), 0);\n      },\n      userName: event => {\n        // tooltip\n        event.target.title = event.detail.userName;\n      },\n      readonly: event => {\n        event.target.disabled = event.detail.readonly;\n      },\n      required: event => {\n        this._setRequired(event.target, event.detail.required);\n      },\n      bgColor: event => {\n        setColor(\"bgColor\", \"backgroundColor\", event);\n      },\n      fillColor: event => {\n        setColor(\"fillColor\", \"backgroundColor\", event);\n      },\n      fgColor: event => {\n        setColor(\"fgColor\", \"color\", event);\n      },\n      textColor: event => {\n        setColor(\"textColor\", \"color\", event);\n      },\n      borderColor: event => {\n        setColor(\"borderColor\", \"borderColor\", event);\n      },\n      strokeColor: event => {\n        setColor(\"strokeColor\", \"borderColor\", event);\n      },\n      rotation: event => {\n        const angle = event.detail.rotation;\n        this.setRotation(angle);\n        this.annotationStorage.setValue(this.data.id, {\n          rotation: angle,\n        });\n      },\n    });\n  }\n\n  _dispatchEventFromSandbox(actions, jsEvent) {\n    const commonActions = this._commonActions;\n    for (const name of Object.keys(jsEvent.detail)) {\n      const action = actions[name] || commonActions[name];\n      action?.(jsEvent);\n    }\n  }\n\n  _setDefaultPropertiesFromJS(element) {\n    if (!this.enableScripting) {\n      return;\n    }\n\n    // Some properties may have been updated thanks to JS.\n    const storedData = this.annotationStorage.getRawValue(this.data.id);\n    if (!storedData) {\n      return;\n    }\n\n    const commonActions = this._commonActions;\n    for (const [actionName, detail] of Object.entries(storedData)) {\n      const action = commonActions[actionName];\n      if (action) {\n        const eventProxy = {\n          detail: {\n            [actionName]: detail,\n          },\n          target: element,\n        };\n        action(eventProxy);\n        // The action has been consumed: no need to keep it.\n        delete storedData[actionName];\n      }\n    }\n  }\n\n  /**\n   * Create quadrilaterals from the annotation's quadpoints.\n   *\n   * @private\n   * @memberof AnnotationElement\n   */\n  _createQuadrilaterals() {\n    if (!this.container) {\n      return;\n    }\n    const { quadPoints } = this.data;\n    if (!quadPoints) {\n      return;\n    }\n\n    const [rectBlX, rectBlY, rectTrX, rectTrY] = this.data.rect;\n\n    if (quadPoints.length === 1) {\n      const [, { x: trX, y: trY }, { x: blX, y: blY }] = quadPoints[0];\n      if (\n        rectTrX === trX &&\n        rectTrY === trY &&\n        rectBlX === blX &&\n        rectBlY === blY\n      ) {\n        // The quadpoints cover the whole annotation rectangle, so no need to\n        // create a quadrilateral.\n        return;\n      }\n    }\n\n    const { style } = this.container;\n    let svgBuffer;\n    if (this.#hasBorder) {\n      const { borderColor, borderWidth } = style;\n      style.borderWidth = 0;\n      svgBuffer = [\n        \"url('data:image/svg+xml;utf8,\",\n        `<svg xmlns=\"http://www.w3.org/2000/svg\"`,\n        ` preserveAspectRatio=\"none\" viewBox=\"0 0 1 1\">`,\n        `<g fill=\"transparent\" stroke=\"${borderColor}\" stroke-width=\"${borderWidth}\">`,\n      ];\n      this.container.classList.add(\"hasBorder\");\n    }\n\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n      this.container.classList.add(\"hasClipPath\");\n    }\n\n    const width = rectTrX - rectBlX;\n    const height = rectTrY - rectBlY;\n\n    const { svgFactory } = this;\n    const svg = svgFactory.createElement(\"svg\");\n    svg.classList.add(\"quadrilateralsContainer\");\n    svg.setAttribute(\"width\", 0);\n    svg.setAttribute(\"height\", 0);\n    const defs = svgFactory.createElement(\"defs\");\n    svg.append(defs);\n    const clipPath = svgFactory.createElement(\"clipPath\");\n    const id = `clippath_${this.data.id}`;\n    clipPath.setAttribute(\"id\", id);\n    clipPath.setAttribute(\"clipPathUnits\", \"objectBoundingBox\");\n    defs.append(clipPath);\n\n    for (const [, { x: trX, y: trY }, { x: blX, y: blY }] of quadPoints) {\n      const rect = svgFactory.createElement(\"rect\");\n      const x = (blX - rectBlX) / width;\n      const y = (rectTrY - trY) / height;\n      const rectWidth = (trX - blX) / width;\n      const rectHeight = (trY - blY) / height;\n      rect.setAttribute(\"x\", x);\n      rect.setAttribute(\"y\", y);\n      rect.setAttribute(\"width\", rectWidth);\n      rect.setAttribute(\"height\", rectHeight);\n      clipPath.append(rect);\n      svgBuffer?.push(\n        `<rect vector-effect=\"non-scaling-stroke\" x=\"${x}\" y=\"${y}\" width=\"${rectWidth}\" height=\"${rectHeight}\"/>`\n      );\n    }\n\n    if (this.#hasBorder) {\n      svgBuffer.push(`</g></svg>')`);\n      style.backgroundImage = svgBuffer.join(\"\");\n    }\n\n    this.container.append(svg);\n    this.container.style.clipPath = `url(#${id})`;\n  }\n\n  /**\n   * Create a popup for the annotation's HTML element. This is used for\n   * annotations that do not have a Popup entry in the dictionary, but\n   * are of a type that works with popups (such as Highlight annotations).\n   *\n   * @private\n   * @memberof AnnotationElement\n   */\n  _createPopup() {\n    const { container, data } = this;\n    container.setAttribute(\"aria-haspopup\", \"dialog\");\n\n    const popup = new PopupAnnotationElement({\n      data: {\n        color: data.color,\n        titleObj: data.titleObj,\n        modificationDate: data.modificationDate,\n        contentsObj: data.contentsObj,\n        richText: data.richText,\n        parentRect: data.rect,\n        borderStyle: 0,\n        id: `popup_${data.id}`,\n        rotation: data.rotation,\n      },\n      parent: this.parent,\n      elements: [this],\n    });\n    this.parent.div.append(popup.render());\n  }\n\n  /**\n   * Render the annotation's HTML element(s).\n   *\n   * @public\n   * @memberof AnnotationElement\n   */\n  render() {\n    unreachable(\"Abstract method `AnnotationElement.render` called\");\n  }\n\n  /**\n   * @private\n   * @returns {Array}\n   */\n  _getElementsByName(name, skipId = null) {\n    const fields = [];\n\n    if (this._fieldObjects) {\n      const fieldObj = this._fieldObjects[name];\n      if (fieldObj) {\n        for (const { page, id, exportValues } of fieldObj) {\n          if (page === -1) {\n            continue;\n          }\n          if (id === skipId) {\n            continue;\n          }\n          const exportValue =\n            typeof exportValues === \"string\" ? exportValues : null;\n\n          const domElement = document.querySelector(\n            `[data-element-id=\"${id}\"]`\n          );\n          if (domElement && !GetElementsByNameSet.has(domElement)) {\n            warn(`_getElementsByName - element not allowed: ${id}`);\n            continue;\n          }\n          fields.push({ id, exportValue, domElement });\n        }\n      }\n      return fields;\n    }\n    // Fallback to a regular DOM lookup, to ensure that the standalone\n    // viewer components won't break.\n    for (const domElement of document.getElementsByName(name)) {\n      const { exportValue } = domElement;\n      const id = domElement.getAttribute(\"data-element-id\");\n      if (id === skipId) {\n        continue;\n      }\n      if (!GetElementsByNameSet.has(domElement)) {\n        continue;\n      }\n      fields.push({ id, exportValue, domElement });\n    }\n    return fields;\n  }\n\n  show() {\n    if (this.container) {\n      this.container.hidden = false;\n    }\n    this.popup?.maybeShow();\n  }\n\n  hide() {\n    if (this.container) {\n      this.container.hidden = true;\n    }\n    this.popup?.forceHide();\n  }\n\n  /**\n   * Get the HTML element(s) which can trigger a popup when clicked or hovered.\n   *\n   * @public\n   * @memberof AnnotationElement\n   * @returns {Array<HTMLElement>|HTMLElement} An array of elements or an\n   *          element.\n   */\n  getElementsToTriggerPopup() {\n    return this.container;\n  }\n\n  addHighlightArea() {\n    const triggers = this.getElementsToTriggerPopup();\n    if (Array.isArray(triggers)) {\n      for (const element of triggers) {\n        element.classList.add(\"highlightArea\");\n      }\n    } else {\n      triggers.classList.add(\"highlightArea\");\n    }\n  }\n\n  get _isEditable() {\n    return false;\n  }\n\n  _editOnDoubleClick() {\n    if (!this._isEditable) {\n      return;\n    }\n    const {\n      annotationEditorType: mode,\n      data: { id: editId },\n    } = this;\n    this.container.addEventListener(\"dblclick\", () => {\n      this.linkService.eventBus?.dispatch(\"switchannotationeditormode\", {\n        source: this,\n        mode,\n        editId,\n      });\n    });\n  }\n}\n\nclass LinkAnnotationElement extends AnnotationElement {\n  constructor(parameters, options = null) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: !!options?.ignoreBorder,\n      createQuadrilaterals: true,\n    });\n    this.isTooltipOnly = parameters.data.isTooltipOnly;\n  }\n\n  render() {\n    const { data, linkService } = this;\n    const link = document.createElement(\"a\");\n    link.setAttribute(\"data-element-id\", data.id);\n    let isBound = false;\n\n    if (data.url) {\n      linkService.addLinkAttributes(link, data.url, data.newWindow);\n      isBound = true;\n    } else if (data.action) {\n      this._bindNamedAction(link, data.action);\n      isBound = true;\n    } else if (data.attachment) {\n      this.#bindAttachment(link, data.attachment, data.attachmentDest);\n      isBound = true;\n    } else if (data.setOCGState) {\n      this.#bindSetOCGState(link, data.setOCGState);\n      isBound = true;\n    } else if (data.dest) {\n      this._bindLink(link, data.dest);\n      isBound = true;\n    } else {\n      if (\n        data.actions &&\n        (data.actions.Action ||\n          data.actions[\"Mouse Up\"] ||\n          data.actions[\"Mouse Down\"]) &&\n        this.enableScripting &&\n        this.hasJSActions\n      ) {\n        this._bindJSAction(link, data);\n        isBound = true;\n      }\n\n      if (data.resetForm) {\n        this._bindResetFormAction(link, data.resetForm);\n        isBound = true;\n      } else if (this.isTooltipOnly && !isBound) {\n        this._bindLink(link, \"\");\n        isBound = true;\n      }\n    }\n\n    this.container.classList.add(\"linkAnnotation\");\n    if (isBound) {\n      this.container.append(link);\n    }\n\n    return this.container;\n  }\n\n  #setInternalLink() {\n    this.container.setAttribute(\"data-internal-link\", \"\");\n  }\n\n  /**\n   * Bind internal links to the link element.\n   *\n   * @private\n   * @param {Object} link\n   * @param {Object} destination\n   * @memberof LinkAnnotationElement\n   */\n  _bindLink(link, destination) {\n    link.href = this.linkService.getDestinationHash(destination);\n    link.onclick = () => {\n      if (destination) {\n        this.linkService.goToDestination(destination);\n      }\n      return false;\n    };\n    if (destination || destination === /* isTooltipOnly = */ \"\") {\n      this.#setInternalLink();\n    }\n  }\n\n  /**\n   * Bind named actions to the link element.\n   *\n   * @private\n   * @param {Object} link\n   * @param {Object} action\n   * @memberof LinkAnnotationElement\n   */\n  _bindNamedAction(link, action) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n    link.onclick = () => {\n      this.linkService.executeNamedAction(action);\n      return false;\n    };\n    this.#setInternalLink();\n  }\n\n  /**\n   * Bind attachments to the link element.\n   * @param {Object} link\n   * @param {Object} attachment\n   * @param {str} [dest]\n   */\n  #bindAttachment(link, attachment, dest = null) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n    link.onclick = () => {\n      this.downloadManager?.openOrDownloadData(\n        attachment.content,\n        attachment.filename,\n        dest\n      );\n      return false;\n    };\n    this.#setInternalLink();\n  }\n\n  /**\n   * Bind SetOCGState actions to the link element.\n   * @param {Object} link\n   * @param {Object} action\n   */\n  #bindSetOCGState(link, action) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n    link.onclick = () => {\n      this.linkService.executeSetOCGState(action);\n      return false;\n    };\n    this.#setInternalLink();\n  }\n\n  /**\n   * Bind JS actions to the link element.\n   *\n   * @private\n   * @param {Object} link\n   * @param {Object} data\n   * @memberof LinkAnnotationElement\n   */\n  _bindJSAction(link, data) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n    const map = new Map([\n      [\"Action\", \"onclick\"],\n      [\"Mouse Up\", \"onmouseup\"],\n      [\"Mouse Down\", \"onmousedown\"],\n    ]);\n    for (const name of Object.keys(data.actions)) {\n      const jsName = map.get(name);\n      if (!jsName) {\n        continue;\n      }\n      link[jsName] = () => {\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: data.id,\n            name,\n          },\n        });\n        return false;\n      };\n    }\n\n    if (!link.onclick) {\n      link.onclick = () => false;\n    }\n    this.#setInternalLink();\n  }\n\n  _bindResetFormAction(link, resetForm) {\n    const otherClickAction = link.onclick;\n    if (!otherClickAction) {\n      link.href = this.linkService.getAnchorUrl(\"\");\n    }\n    this.#setInternalLink();\n\n    if (!this._fieldObjects) {\n      warn(\n        `_bindResetFormAction - \"resetForm\" action not supported, ` +\n          \"ensure that the `fieldObjects` parameter is provided.\"\n      );\n      if (!otherClickAction) {\n        link.onclick = () => false;\n      }\n      return;\n    }\n\n    link.onclick = () => {\n      otherClickAction?.();\n\n      const {\n        fields: resetFormFields,\n        refs: resetFormRefs,\n        include,\n      } = resetForm;\n\n      const allFields = [];\n      if (resetFormFields.length !== 0 || resetFormRefs.length !== 0) {\n        const fieldIds = new Set(resetFormRefs);\n        for (const fieldName of resetFormFields) {\n          const fields = this._fieldObjects[fieldName] || [];\n          for (const { id } of fields) {\n            fieldIds.add(id);\n          }\n        }\n        for (const fields of Object.values(this._fieldObjects)) {\n          for (const field of fields) {\n            if (fieldIds.has(field.id) === include) {\n              allFields.push(field);\n            }\n          }\n        }\n      } else {\n        for (const fields of Object.values(this._fieldObjects)) {\n          allFields.push(...fields);\n        }\n      }\n\n      const storage = this.annotationStorage;\n      const allIds = [];\n      for (const field of allFields) {\n        const { id } = field;\n        allIds.push(id);\n        switch (field.type) {\n          case \"text\": {\n            const value = field.defaultValue || \"\";\n            storage.setValue(id, { value });\n            break;\n          }\n          case \"checkbox\":\n          case \"radiobutton\": {\n            const value = field.defaultValue === field.exportValues;\n            storage.setValue(id, { value });\n            break;\n          }\n          case \"combobox\":\n          case \"listbox\": {\n            const value = field.defaultValue || \"\";\n            storage.setValue(id, { value });\n            break;\n          }\n          default:\n            continue;\n        }\n\n        const domElement = document.querySelector(`[data-element-id=\"${id}\"]`);\n        if (!domElement) {\n          continue;\n        } else if (!GetElementsByNameSet.has(domElement)) {\n          warn(`_bindResetFormAction - element not allowed: ${id}`);\n          continue;\n        }\n        domElement.dispatchEvent(new Event(\"resetform\"));\n      }\n\n      if (this.enableScripting) {\n        // Update the values in the sandbox.\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: \"app\",\n            ids: allIds,\n            name: \"ResetForm\",\n          },\n        });\n      }\n\n      return false;\n    };\n  }\n}\n\nclass TextAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, { isRenderable: true });\n  }\n\n  render() {\n    this.container.classList.add(\"textAnnotation\");\n\n    const image = document.createElement(\"img\");\n    image.src =\n      this.imageResourcesPath +\n      \"annotation-\" +\n      this.data.name.toLowerCase() +\n      \".svg\";\n    image.setAttribute(\"data-l10n-id\", \"pdfjs-text-annotation-type\");\n    image.setAttribute(\n      \"data-l10n-args\",\n      JSON.stringify({ type: this.data.name })\n    );\n\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    this.container.append(image);\n    return this.container;\n  }\n}\n\nclass WidgetAnnotationElement extends AnnotationElement {\n  render() {\n    // Show only the container for unsupported field types.\n    if (this.data.alternativeText) {\n      this.container.title = this.data.alternativeText;\n    }\n\n    return this.container;\n  }\n\n  showElementAndHideCanvas(element) {\n    if (this.data.hasOwnCanvas) {\n      if (element.previousSibling?.nodeName === \"CANVAS\") {\n        element.previousSibling.hidden = true;\n      }\n      element.hidden = false;\n    }\n  }\n\n  _getKeyModifier(event) {\n    return FeatureTest.platform.isMac ? event.metaKey : event.ctrlKey;\n  }\n\n  _setEventListener(element, elementData, baseName, eventName, valueGetter) {\n    if (baseName.includes(\"mouse\")) {\n      // Mouse events\n      element.addEventListener(baseName, event => {\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: this.data.id,\n            name: eventName,\n            value: valueGetter(event),\n            shift: event.shiftKey,\n            modifier: this._getKeyModifier(event),\n          },\n        });\n      });\n    } else {\n      // Non-mouse events\n      element.addEventListener(baseName, event => {\n        if (baseName === \"blur\") {\n          if (!elementData.focused || !event.relatedTarget) {\n            return;\n          }\n          elementData.focused = false;\n        } else if (baseName === \"focus\") {\n          if (elementData.focused) {\n            return;\n          }\n          elementData.focused = true;\n        }\n\n        if (!valueGetter) {\n          return;\n        }\n\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: this.data.id,\n            name: eventName,\n            value: valueGetter(event),\n          },\n        });\n      });\n    }\n  }\n\n  _setEventListeners(element, elementData, names, getter) {\n    for (const [baseName, eventName] of names) {\n      if (eventName === \"Action\" || this.data.actions?.[eventName]) {\n        if (eventName === \"Focus\" || eventName === \"Blur\") {\n          elementData ||= { focused: false };\n        }\n        this._setEventListener(\n          element,\n          elementData,\n          baseName,\n          eventName,\n          getter\n        );\n        if (eventName === \"Focus\" && !this.data.actions?.Blur) {\n          // Ensure that elementData will have the correct value.\n          this._setEventListener(element, elementData, \"blur\", \"Blur\", null);\n        } else if (eventName === \"Blur\" && !this.data.actions?.Focus) {\n          this._setEventListener(element, elementData, \"focus\", \"Focus\", null);\n        }\n      }\n    }\n  }\n\n  _setBackgroundColor(element) {\n    const color = this.data.backgroundColor || null;\n    element.style.backgroundColor =\n      color === null\n        ? \"transparent\"\n        : Util.makeHexColor(color[0], color[1], color[2]);\n  }\n\n  /**\n   * Apply text styles to the text in the element.\n   *\n   * @private\n   * @param {HTMLDivElement} element\n   * @memberof TextWidgetAnnotationElement\n   */\n  _setTextStyle(element) {\n    const TEXT_ALIGNMENT = [\"left\", \"center\", \"right\"];\n    const { fontColor } = this.data.defaultAppearanceData;\n    const fontSize =\n      this.data.defaultAppearanceData.fontSize || DEFAULT_FONT_SIZE;\n\n    const style = element.style;\n\n    // TODO: If the font-size is zero, calculate it based on the height and\n    //       width of the element.\n    // Not setting `style.fontSize` will use the default font-size for now.\n\n    // We don't use the font, as specified in the PDF document, for the <input>\n    // element. Hence using the original `fontSize` could look bad, which is why\n    // it's instead based on the field height.\n    // If the height is \"big\" then it could lead to a too big font size\n    // so in this case use the one we've in the pdf (hence the min).\n    let computedFontSize;\n    const BORDER_SIZE = 2;\n    const roundToOneDecimal = x => Math.round(10 * x) / 10;\n    if (this.data.multiLine) {\n      const height = Math.abs(\n        this.data.rect[3] - this.data.rect[1] - BORDER_SIZE\n      );\n      const numberOfLines = Math.round(height / (LINE_FACTOR * fontSize)) || 1;\n      const lineHeight = height / numberOfLines;\n      computedFontSize = Math.min(\n        fontSize,\n        roundToOneDecimal(lineHeight / LINE_FACTOR)\n      );\n    } else {\n      const height = Math.abs(\n        this.data.rect[3] - this.data.rect[1] - BORDER_SIZE\n      );\n      computedFontSize = Math.min(\n        fontSize,\n        roundToOneDecimal(height / LINE_FACTOR)\n      );\n    }\n    style.fontSize = `calc(${computedFontSize}px * var(--scale-factor))`;\n\n    style.color = Util.makeHexColor(fontColor[0], fontColor[1], fontColor[2]);\n\n    if (this.data.textAlignment !== null) {\n      style.textAlign = TEXT_ALIGNMENT[this.data.textAlignment];\n    }\n  }\n\n  _setRequired(element, isRequired) {\n    if (isRequired) {\n      element.setAttribute(\"required\", true);\n    } else {\n      element.removeAttribute(\"required\");\n    }\n    element.setAttribute(\"aria-required\", isRequired);\n  }\n}\n\nclass TextWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    const isRenderable =\n      parameters.renderForms ||\n      parameters.data.hasOwnCanvas ||\n      (!parameters.data.hasAppearance && !!parameters.data.fieldValue);\n    super(parameters, { isRenderable });\n  }\n\n  setPropertyOnSiblings(base, key, value, keyInStorage) {\n    const storage = this.annotationStorage;\n    for (const element of this._getElementsByName(\n      base.name,\n      /* skipId = */ base.id\n    )) {\n      if (element.domElement) {\n        element.domElement[key] = value;\n      }\n      storage.setValue(element.id, { [keyInStorage]: value });\n    }\n  }\n\n  render() {\n    const storage = this.annotationStorage;\n    const id = this.data.id;\n\n    this.container.classList.add(\"textWidgetAnnotation\");\n\n    let element = null;\n    if (this.renderForms) {\n      // NOTE: We cannot set the values using `element.value` below, since it\n      //       prevents the AnnotationLayer rasterizer in `test/driver.js`\n      //       from parsing the elements correctly for the reference tests.\n      const storedData = storage.getValue(id, {\n        value: this.data.fieldValue,\n      });\n      let textContent = storedData.value || \"\";\n      const maxLen = storage.getValue(id, {\n        charLimit: this.data.maxLen,\n      }).charLimit;\n      if (maxLen && textContent.length > maxLen) {\n        textContent = textContent.slice(0, maxLen);\n      }\n\n      let fieldFormattedValues =\n        storedData.formattedValue || this.data.textContent?.join(\"\\n\") || null;\n      if (fieldFormattedValues && this.data.comb) {\n        fieldFormattedValues = fieldFormattedValues.replaceAll(/\\s+/g, \"\");\n      }\n\n      const elementData = {\n        userValue: textContent,\n        formattedValue: fieldFormattedValues,\n        lastCommittedValue: null,\n        commitKey: 1,\n        focused: false,\n      };\n\n      if (this.data.multiLine) {\n        element = document.createElement(\"textarea\");\n        element.textContent = fieldFormattedValues ?? textContent;\n        if (this.data.doNotScroll) {\n          element.style.overflowY = \"hidden\";\n        }\n      } else {\n        element = document.createElement(\"input\");\n        element.type = \"text\";\n        element.setAttribute(\"value\", fieldFormattedValues ?? textContent);\n        if (this.data.doNotScroll) {\n          element.style.overflowX = \"hidden\";\n        }\n      }\n      if (this.data.hasOwnCanvas) {\n        element.hidden = true;\n      }\n      GetElementsByNameSet.add(element);\n      element.setAttribute(\"data-element-id\", id);\n\n      element.disabled = this.data.readOnly;\n      element.name = this.data.fieldName;\n      element.tabIndex = DEFAULT_TAB_INDEX;\n\n      this._setRequired(element, this.data.required);\n\n      if (maxLen) {\n        element.maxLength = maxLen;\n      }\n\n      element.addEventListener(\"input\", event => {\n        storage.setValue(id, { value: event.target.value });\n        this.setPropertyOnSiblings(\n          element,\n          \"value\",\n          event.target.value,\n          \"value\"\n        );\n        elementData.formattedValue = null;\n      });\n\n      element.addEventListener(\"resetform\", event => {\n        const defaultValue = this.data.defaultFieldValue ?? \"\";\n        element.value = elementData.userValue = defaultValue;\n        elementData.formattedValue = null;\n      });\n\n      let blurListener = event => {\n        const { formattedValue } = elementData;\n        if (formattedValue !== null && formattedValue !== undefined) {\n          event.target.value = formattedValue;\n        }\n        // Reset the cursor position to the start of the field (issue 12359).\n        event.target.scrollLeft = 0;\n      };\n\n      if (this.enableScripting && this.hasJSActions) {\n        element.addEventListener(\"focus\", event => {\n          if (elementData.focused) {\n            return;\n          }\n          const { target } = event;\n          if (elementData.userValue) {\n            target.value = elementData.userValue;\n          }\n          elementData.lastCommittedValue = target.value;\n          elementData.commitKey = 1;\n          if (!this.data.actions?.Focus) {\n            elementData.focused = true;\n          }\n        });\n\n        element.addEventListener(\"updatefromsandbox\", jsEvent => {\n          this.showElementAndHideCanvas(jsEvent.target);\n          const actions = {\n            value(event) {\n              elementData.userValue = event.detail.value ?? \"\";\n              storage.setValue(id, { value: elementData.userValue.toString() });\n              event.target.value = elementData.userValue;\n            },\n            formattedValue(event) {\n              const { formattedValue } = event.detail;\n              elementData.formattedValue = formattedValue;\n              if (\n                formattedValue !== null &&\n                formattedValue !== undefined &&\n                event.target !== document.activeElement\n              ) {\n                // Input hasn't the focus so display formatted string\n                event.target.value = formattedValue;\n              }\n              storage.setValue(id, {\n                formattedValue,\n              });\n            },\n            selRange(event) {\n              event.target.setSelectionRange(...event.detail.selRange);\n            },\n            charLimit: event => {\n              const { charLimit } = event.detail;\n              const { target } = event;\n              if (charLimit === 0) {\n                target.removeAttribute(\"maxLength\");\n                return;\n              }\n\n              target.setAttribute(\"maxLength\", charLimit);\n              let value = elementData.userValue;\n              if (!value || value.length <= charLimit) {\n                return;\n              }\n              value = value.slice(0, charLimit);\n              target.value = elementData.userValue = value;\n              storage.setValue(id, { value });\n\n              this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n                source: this,\n                detail: {\n                  id,\n                  name: \"Keystroke\",\n                  value,\n                  willCommit: true,\n                  commitKey: 1,\n                  selStart: target.selectionStart,\n                  selEnd: target.selectionEnd,\n                },\n              });\n            },\n          };\n          this._dispatchEventFromSandbox(actions, jsEvent);\n        });\n\n        // Even if the field hasn't any actions\n        // leaving it can still trigger some actions with Calculate\n        element.addEventListener(\"keydown\", event => {\n          elementData.commitKey = 1;\n          // If the key is one of Escape, Enter then the data are committed.\n          // If we've a Tab then data will be committed on blur.\n          let commitKey = -1;\n          if (event.key === \"Escape\") {\n            commitKey = 0;\n          } else if (event.key === \"Enter\" && !this.data.multiLine) {\n            // When we've a multiline field, \"Enter\" key is a key as the other\n            // hence we don't commit the data (Acrobat behaves the same way)\n            // (see issue #15627).\n            commitKey = 2;\n          } else if (event.key === \"Tab\") {\n            elementData.commitKey = 3;\n          }\n          if (commitKey === -1) {\n            return;\n          }\n          const { value } = event.target;\n          if (elementData.lastCommittedValue === value) {\n            return;\n          }\n          elementData.lastCommittedValue = value;\n          // Save the entered value\n          elementData.userValue = value;\n          this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n            source: this,\n            detail: {\n              id,\n              name: \"Keystroke\",\n              value,\n              willCommit: true,\n              commitKey,\n              selStart: event.target.selectionStart,\n              selEnd: event.target.selectionEnd,\n            },\n          });\n        });\n        const _blurListener = blurListener;\n        blurListener = null;\n        element.addEventListener(\"blur\", event => {\n          if (!elementData.focused || !event.relatedTarget) {\n            return;\n          }\n          if (!this.data.actions?.Blur) {\n            elementData.focused = false;\n          }\n          const { value } = event.target;\n          elementData.userValue = value;\n          if (elementData.lastCommittedValue !== value) {\n            this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n              source: this,\n              detail: {\n                id,\n                name: \"Keystroke\",\n                value,\n                willCommit: true,\n                commitKey: elementData.commitKey,\n                selStart: event.target.selectionStart,\n                selEnd: event.target.selectionEnd,\n              },\n            });\n          }\n          _blurListener(event);\n        });\n\n        if (this.data.actions?.Keystroke) {\n          element.addEventListener(\"beforeinput\", event => {\n            elementData.lastCommittedValue = null;\n            const { data, target } = event;\n            const { value, selectionStart, selectionEnd } = target;\n\n            let selStart = selectionStart,\n              selEnd = selectionEnd;\n\n            switch (event.inputType) {\n              // https://rawgit.com/w3c/input-events/v1/index.html#interface-InputEvent-Attributes\n              case \"deleteWordBackward\": {\n                const match = value\n                  .substring(0, selectionStart)\n                  .match(/\\w*[^\\w]*$/);\n                if (match) {\n                  selStart -= match[0].length;\n                }\n                break;\n              }\n              case \"deleteWordForward\": {\n                const match = value\n                  .substring(selectionStart)\n                  .match(/^[^\\w]*\\w*/);\n                if (match) {\n                  selEnd += match[0].length;\n                }\n                break;\n              }\n              case \"deleteContentBackward\":\n                if (selectionStart === selectionEnd) {\n                  selStart -= 1;\n                }\n                break;\n              case \"deleteContentForward\":\n                if (selectionStart === selectionEnd) {\n                  selEnd += 1;\n                }\n                break;\n            }\n\n            // We handle the event ourselves.\n            event.preventDefault();\n            this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n              source: this,\n              detail: {\n                id,\n                name: \"Keystroke\",\n                value,\n                change: data || \"\",\n                willCommit: false,\n                selStart,\n                selEnd,\n              },\n            });\n          });\n        }\n\n        this._setEventListeners(\n          element,\n          elementData,\n          [\n            [\"focus\", \"Focus\"],\n            [\"blur\", \"Blur\"],\n            [\"mousedown\", \"Mouse Down\"],\n            [\"mouseenter\", \"Mouse Enter\"],\n            [\"mouseleave\", \"Mouse Exit\"],\n            [\"mouseup\", \"Mouse Up\"],\n          ],\n          event => event.target.value\n        );\n      }\n\n      if (blurListener) {\n        element.addEventListener(\"blur\", blurListener);\n      }\n\n      if (this.data.comb) {\n        const fieldWidth = this.data.rect[2] - this.data.rect[0];\n        const combWidth = fieldWidth / maxLen;\n\n        element.classList.add(\"comb\");\n        element.style.letterSpacing = `calc(${combWidth}px * var(--scale-factor) - 1ch)`;\n      }\n    } else {\n      element = document.createElement(\"div\");\n      element.textContent = this.data.fieldValue;\n      element.style.verticalAlign = \"middle\";\n      element.style.display = \"table-cell\";\n\n      if (this.data.hasOwnCanvas) {\n        element.hidden = true;\n      }\n    }\n\n    this._setTextStyle(element);\n    this._setBackgroundColor(element);\n    this._setDefaultPropertiesFromJS(element);\n\n    this.container.append(element);\n    return this.container;\n  }\n}\n\nclass SignatureWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, { isRenderable: !!parameters.data.hasOwnCanvas });\n  }\n}\n\nclass CheckboxWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, { isRenderable: parameters.renderForms });\n  }\n\n  render() {\n    const storage = this.annotationStorage;\n    const data = this.data;\n    const id = data.id;\n    let value = storage.getValue(id, {\n      value: data.exportValue === data.fieldValue,\n    }).value;\n    if (typeof value === \"string\") {\n      // The value has been changed through js and set in annotationStorage.\n      value = value !== \"Off\";\n      storage.setValue(id, { value });\n    }\n\n    this.container.classList.add(\"buttonWidgetAnnotation\", \"checkBox\");\n\n    const element = document.createElement(\"input\");\n    GetElementsByNameSet.add(element);\n    element.setAttribute(\"data-element-id\", id);\n\n    element.disabled = data.readOnly;\n    this._setRequired(element, this.data.required);\n    element.type = \"checkbox\";\n    element.name = data.fieldName;\n    if (value) {\n      element.setAttribute(\"checked\", true);\n    }\n    element.setAttribute(\"exportValue\", data.exportValue);\n    element.tabIndex = DEFAULT_TAB_INDEX;\n\n    element.addEventListener(\"change\", event => {\n      const { name, checked } = event.target;\n      for (const checkbox of this._getElementsByName(name, /* skipId = */ id)) {\n        const curChecked = checked && checkbox.exportValue === data.exportValue;\n        if (checkbox.domElement) {\n          checkbox.domElement.checked = curChecked;\n        }\n        storage.setValue(checkbox.id, { value: curChecked });\n      }\n      storage.setValue(id, { value: checked });\n    });\n\n    element.addEventListener(\"resetform\", event => {\n      const defaultValue = data.defaultFieldValue || \"Off\";\n      event.target.checked = defaultValue === data.exportValue;\n    });\n\n    if (this.enableScripting && this.hasJSActions) {\n      element.addEventListener(\"updatefromsandbox\", jsEvent => {\n        const actions = {\n          value(event) {\n            event.target.checked = event.detail.value !== \"Off\";\n            storage.setValue(id, { value: event.target.checked });\n          },\n        };\n        this._dispatchEventFromSandbox(actions, jsEvent);\n      });\n\n      this._setEventListeners(\n        element,\n        null,\n        [\n          [\"change\", \"Validate\"],\n          [\"change\", \"Action\"],\n          [\"focus\", \"Focus\"],\n          [\"blur\", \"Blur\"],\n          [\"mousedown\", \"Mouse Down\"],\n          [\"mouseenter\", \"Mouse Enter\"],\n          [\"mouseleave\", \"Mouse Exit\"],\n          [\"mouseup\", \"Mouse Up\"],\n        ],\n        event => event.target.checked\n      );\n    }\n\n    this._setBackgroundColor(element);\n    this._setDefaultPropertiesFromJS(element);\n\n    this.container.append(element);\n    return this.container;\n  }\n}\n\nclass RadioButtonWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, { isRenderable: parameters.renderForms });\n  }\n\n  render() {\n    this.container.classList.add(\"buttonWidgetAnnotation\", \"radioButton\");\n    const storage = this.annotationStorage;\n    const data = this.data;\n    const id = data.id;\n    let value = storage.getValue(id, {\n      value: data.fieldValue === data.buttonValue,\n    }).value;\n    if (typeof value === \"string\") {\n      // The value has been changed through js and set in annotationStorage.\n      value = value !== data.buttonValue;\n      storage.setValue(id, { value });\n    }\n\n    if (value) {\n      // It's possible that multiple radio buttons are checked.\n      // So if this one is checked we just reset the other ones.\n      // (see bug 1864136). Then when the other ones will be rendered they will\n      // unchecked (because of their value in the storage).\n      // Consequently, the first checked radio button will be the only checked\n      // one.\n      for (const radio of this._getElementsByName(\n        data.fieldName,\n        /* skipId = */ id\n      )) {\n        storage.setValue(radio.id, { value: false });\n      }\n    }\n\n    const element = document.createElement(\"input\");\n    GetElementsByNameSet.add(element);\n    element.setAttribute(\"data-element-id\", id);\n\n    element.disabled = data.readOnly;\n    this._setRequired(element, this.data.required);\n    element.type = \"radio\";\n    element.name = data.fieldName;\n    if (value) {\n      element.setAttribute(\"checked\", true);\n    }\n    element.tabIndex = DEFAULT_TAB_INDEX;\n\n    element.addEventListener(\"change\", event => {\n      const { name, checked } = event.target;\n      for (const radio of this._getElementsByName(name, /* skipId = */ id)) {\n        storage.setValue(radio.id, { value: false });\n      }\n      storage.setValue(id, { value: checked });\n    });\n\n    element.addEventListener(\"resetform\", event => {\n      const defaultValue = data.defaultFieldValue;\n      event.target.checked =\n        defaultValue !== null &&\n        defaultValue !== undefined &&\n        defaultValue === data.buttonValue;\n    });\n\n    if (this.enableScripting && this.hasJSActions) {\n      const pdfButtonValue = data.buttonValue;\n      element.addEventListener(\"updatefromsandbox\", jsEvent => {\n        const actions = {\n          value: event => {\n            const checked = pdfButtonValue === event.detail.value;\n            for (const radio of this._getElementsByName(event.target.name)) {\n              const curChecked = checked && radio.id === id;\n              if (radio.domElement) {\n                radio.domElement.checked = curChecked;\n              }\n              storage.setValue(radio.id, { value: curChecked });\n            }\n          },\n        };\n        this._dispatchEventFromSandbox(actions, jsEvent);\n      });\n\n      this._setEventListeners(\n        element,\n        null,\n        [\n          [\"change\", \"Validate\"],\n          [\"change\", \"Action\"],\n          [\"focus\", \"Focus\"],\n          [\"blur\", \"Blur\"],\n          [\"mousedown\", \"Mouse Down\"],\n          [\"mouseenter\", \"Mouse Enter\"],\n          [\"mouseleave\", \"Mouse Exit\"],\n          [\"mouseup\", \"Mouse Up\"],\n        ],\n        event => event.target.checked\n      );\n    }\n\n    this._setBackgroundColor(element);\n    this._setDefaultPropertiesFromJS(element);\n\n    this.container.append(element);\n    return this.container;\n  }\n}\n\nclass PushButtonWidgetAnnotationElement extends LinkAnnotationElement {\n  constructor(parameters) {\n    super(parameters, { ignoreBorder: parameters.data.hasAppearance });\n  }\n\n  render() {\n    // The rendering and functionality of a push button widget annotation is\n    // equal to that of a link annotation, but may have more functionality, such\n    // as performing actions on form fields (resetting, submitting, et cetera).\n    const container = super.render();\n    container.classList.add(\"buttonWidgetAnnotation\", \"pushButton\");\n\n    if (this.data.alternativeText) {\n      container.title = this.data.alternativeText;\n    }\n\n    const linkElement = container.lastChild;\n    if (this.enableScripting && this.hasJSActions && linkElement) {\n      this._setDefaultPropertiesFromJS(linkElement);\n\n      linkElement.addEventListener(\"updatefromsandbox\", jsEvent => {\n        this._dispatchEventFromSandbox({}, jsEvent);\n      });\n    }\n\n    return container;\n  }\n}\n\nclass ChoiceWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, { isRenderable: parameters.renderForms });\n  }\n\n  render() {\n    this.container.classList.add(\"choiceWidgetAnnotation\");\n    const storage = this.annotationStorage;\n    const id = this.data.id;\n\n    const storedData = storage.getValue(id, {\n      value: this.data.fieldValue,\n    });\n\n    const selectElement = document.createElement(\"select\");\n    GetElementsByNameSet.add(selectElement);\n    selectElement.setAttribute(\"data-element-id\", id);\n\n    selectElement.disabled = this.data.readOnly;\n    this._setRequired(selectElement, this.data.required);\n    selectElement.name = this.data.fieldName;\n    selectElement.tabIndex = DEFAULT_TAB_INDEX;\n\n    let addAnEmptyEntry = this.data.combo && this.data.options.length > 0;\n\n    if (!this.data.combo) {\n      // List boxes have a size and (optionally) multiple selection.\n      selectElement.size = this.data.options.length;\n      if (this.data.multiSelect) {\n        selectElement.multiple = true;\n      }\n    }\n\n    selectElement.addEventListener(\"resetform\", event => {\n      const defaultValue = this.data.defaultFieldValue;\n      for (const option of selectElement.options) {\n        option.selected = option.value === defaultValue;\n      }\n    });\n\n    // Insert the options into the choice field.\n    for (const option of this.data.options) {\n      const optionElement = document.createElement(\"option\");\n      optionElement.textContent = option.displayValue;\n      optionElement.value = option.exportValue;\n      if (storedData.value.includes(option.exportValue)) {\n        optionElement.setAttribute(\"selected\", true);\n        addAnEmptyEntry = false;\n      }\n      selectElement.append(optionElement);\n    }\n\n    let removeEmptyEntry = null;\n    if (addAnEmptyEntry) {\n      const noneOptionElement = document.createElement(\"option\");\n      noneOptionElement.value = \" \";\n      noneOptionElement.setAttribute(\"hidden\", true);\n      noneOptionElement.setAttribute(\"selected\", true);\n      selectElement.prepend(noneOptionElement);\n\n      removeEmptyEntry = () => {\n        noneOptionElement.remove();\n        selectElement.removeEventListener(\"input\", removeEmptyEntry);\n        removeEmptyEntry = null;\n      };\n      selectElement.addEventListener(\"input\", removeEmptyEntry);\n    }\n\n    const getValue = isExport => {\n      const name = isExport ? \"value\" : \"textContent\";\n      const { options, multiple } = selectElement;\n      if (!multiple) {\n        return options.selectedIndex === -1\n          ? null\n          : options[options.selectedIndex][name];\n      }\n      return Array.prototype.filter\n        .call(options, option => option.selected)\n        .map(option => option[name]);\n    };\n\n    let selectedValues = getValue(/* isExport */ false);\n\n    const getItems = event => {\n      const options = event.target.options;\n      return Array.prototype.map.call(options, option => {\n        return { displayValue: option.textContent, exportValue: option.value };\n      });\n    };\n\n    if (this.enableScripting && this.hasJSActions) {\n      selectElement.addEventListener(\"updatefromsandbox\", jsEvent => {\n        const actions = {\n          value(event) {\n            removeEmptyEntry?.();\n            const value = event.detail.value;\n            const values = new Set(Array.isArray(value) ? value : [value]);\n            for (const option of selectElement.options) {\n              option.selected = values.has(option.value);\n            }\n            storage.setValue(id, {\n              value: getValue(/* isExport */ true),\n            });\n            selectedValues = getValue(/* isExport */ false);\n          },\n          multipleSelection(event) {\n            selectElement.multiple = true;\n          },\n          remove(event) {\n            const options = selectElement.options;\n            const index = event.detail.remove;\n            options[index].selected = false;\n            selectElement.remove(index);\n            if (options.length > 0) {\n              const i = Array.prototype.findIndex.call(\n                options,\n                option => option.selected\n              );\n              if (i === -1) {\n                options[0].selected = true;\n              }\n            }\n            storage.setValue(id, {\n              value: getValue(/* isExport */ true),\n              items: getItems(event),\n            });\n            selectedValues = getValue(/* isExport */ false);\n          },\n          clear(event) {\n            while (selectElement.length !== 0) {\n              selectElement.remove(0);\n            }\n            storage.setValue(id, { value: null, items: [] });\n            selectedValues = getValue(/* isExport */ false);\n          },\n          insert(event) {\n            const { index, displayValue, exportValue } = event.detail.insert;\n            const selectChild = selectElement.children[index];\n            const optionElement = document.createElement(\"option\");\n            optionElement.textContent = displayValue;\n            optionElement.value = exportValue;\n\n            if (selectChild) {\n              selectChild.before(optionElement);\n            } else {\n              selectElement.append(optionElement);\n            }\n            storage.setValue(id, {\n              value: getValue(/* isExport */ true),\n              items: getItems(event),\n            });\n            selectedValues = getValue(/* isExport */ false);\n          },\n          items(event) {\n            const { items } = event.detail;\n            while (selectElement.length !== 0) {\n              selectElement.remove(0);\n            }\n            for (const item of items) {\n              const { displayValue, exportValue } = item;\n              const optionElement = document.createElement(\"option\");\n              optionElement.textContent = displayValue;\n              optionElement.value = exportValue;\n              selectElement.append(optionElement);\n            }\n            if (selectElement.options.length > 0) {\n              selectElement.options[0].selected = true;\n            }\n            storage.setValue(id, {\n              value: getValue(/* isExport */ true),\n              items: getItems(event),\n            });\n            selectedValues = getValue(/* isExport */ false);\n          },\n          indices(event) {\n            const indices = new Set(event.detail.indices);\n            for (const option of event.target.options) {\n              option.selected = indices.has(option.index);\n            }\n            storage.setValue(id, {\n              value: getValue(/* isExport */ true),\n            });\n            selectedValues = getValue(/* isExport */ false);\n          },\n          editable(event) {\n            event.target.disabled = !event.detail.editable;\n          },\n        };\n        this._dispatchEventFromSandbox(actions, jsEvent);\n      });\n\n      selectElement.addEventListener(\"input\", event => {\n        const exportValue = getValue(/* isExport */ true);\n        storage.setValue(id, { value: exportValue });\n\n        event.preventDefault();\n\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id,\n            name: \"Keystroke\",\n            value: selectedValues,\n            changeEx: exportValue,\n            willCommit: false,\n            commitKey: 1,\n            keyDown: false,\n          },\n        });\n      });\n\n      this._setEventListeners(\n        selectElement,\n        null,\n        [\n          [\"focus\", \"Focus\"],\n          [\"blur\", \"Blur\"],\n          [\"mousedown\", \"Mouse Down\"],\n          [\"mouseenter\", \"Mouse Enter\"],\n          [\"mouseleave\", \"Mouse Exit\"],\n          [\"mouseup\", \"Mouse Up\"],\n          [\"input\", \"Action\"],\n          [\"input\", \"Validate\"],\n        ],\n        event => event.target.value\n      );\n    } else {\n      selectElement.addEventListener(\"input\", function (event) {\n        storage.setValue(id, { value: getValue(/* isExport */ true) });\n      });\n    }\n\n    if (this.data.combo) {\n      this._setTextStyle(selectElement);\n    } else {\n      // Just use the default font size...\n      // it's a bit hard to guess what is a good size.\n    }\n    this._setBackgroundColor(selectElement);\n    this._setDefaultPropertiesFromJS(selectElement);\n\n    this.container.append(selectElement);\n    return this.container;\n  }\n}\n\nclass PopupAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    const { data, elements } = parameters;\n    super(parameters, { isRenderable: AnnotationElement._hasPopupData(data) });\n    this.elements = elements;\n  }\n\n  render() {\n    this.container.classList.add(\"popupAnnotation\");\n\n    const popup = new PopupElement({\n      container: this.container,\n      color: this.data.color,\n      titleObj: this.data.titleObj,\n      modificationDate: this.data.modificationDate,\n      contentsObj: this.data.contentsObj,\n      richText: this.data.richText,\n      rect: this.data.rect,\n      parentRect: this.data.parentRect || null,\n      parent: this.parent,\n      elements: this.elements,\n      open: this.data.open,\n    });\n\n    const elementIds = [];\n    for (const element of this.elements) {\n      element.popup = popup;\n      elementIds.push(element.data.id);\n      element.addHighlightArea();\n    }\n\n    this.container.setAttribute(\n      \"aria-controls\",\n      elementIds.map(id => `${AnnotationPrefix}${id}`).join(\",\")\n    );\n\n    return this.container;\n  }\n}\n\nclass PopupElement {\n  #boundKeyDown = this.#keyDown.bind(this);\n\n  #boundHide = this.#hide.bind(this);\n\n  #boundShow = this.#show.bind(this);\n\n  #boundToggle = this.#toggle.bind(this);\n\n  #color = null;\n\n  #container = null;\n\n  #contentsObj = null;\n\n  #dateObj = null;\n\n  #elements = null;\n\n  #parent = null;\n\n  #parentRect = null;\n\n  #pinned = false;\n\n  #popup = null;\n\n  #rect = null;\n\n  #richText = null;\n\n  #titleObj = null;\n\n  #wasVisible = false;\n\n  constructor({\n    container,\n    color,\n    elements,\n    titleObj,\n    modificationDate,\n    contentsObj,\n    richText,\n    parent,\n    rect,\n    parentRect,\n    open,\n  }) {\n    this.#container = container;\n    this.#titleObj = titleObj;\n    this.#contentsObj = contentsObj;\n    this.#richText = richText;\n    this.#parent = parent;\n    this.#color = color;\n    this.#rect = rect;\n    this.#parentRect = parentRect;\n    this.#elements = elements;\n\n    // The modification date is shown in the popup instead of the creation\n    // date if it is available and can be parsed correctly, which is\n    // consistent with other viewers such as Adobe Acrobat.\n    this.#dateObj = PDFDateString.toDateObject(modificationDate);\n\n    this.trigger = elements.flatMap(e => e.getElementsToTriggerPopup());\n    // Attach the event listeners to the trigger element.\n    for (const element of this.trigger) {\n      element.addEventListener(\"click\", this.#boundToggle);\n      element.addEventListener(\"mouseenter\", this.#boundShow);\n      element.addEventListener(\"mouseleave\", this.#boundHide);\n      element.classList.add(\"popupTriggerArea\");\n    }\n\n    // Attach the event listener to toggle the popup with the keyboard.\n    for (const element of elements) {\n      element.container?.addEventListener(\"keydown\", this.#boundKeyDown);\n    }\n\n    this.#container.hidden = true;\n    if (open) {\n      this.#toggle();\n    }\n\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n      // Since the popup is lazily created, we need to ensure that it'll be\n      // created and displayed during reference tests.\n      this.#parent.popupShow.push(async () => {\n        if (this.#container.hidden) {\n          this.#show();\n        }\n      });\n    }\n  }\n\n  render() {\n    if (this.#popup) {\n      return;\n    }\n\n    const {\n      page: { view },\n      viewport: {\n        rawDims: { pageWidth, pageHeight, pageX, pageY },\n      },\n    } = this.#parent;\n    const popup = (this.#popup = document.createElement(\"div\"));\n    popup.className = \"popup\";\n\n    if (this.#color) {\n      const baseColor = (popup.style.outlineColor = Util.makeHexColor(\n        ...this.#color\n      ));\n      if (\n        (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n        CSS.supports(\"background-color\", \"color-mix(in srgb, red 30%, white)\")\n      ) {\n        popup.style.backgroundColor = `color-mix(in srgb, ${baseColor} 30%, white)`;\n      } else {\n        // color-mix isn't supported in some browsers hence this version.\n        // See https://developer.mozilla.org/en-US/docs/Web/CSS/color_value/color-mix#browser_compatibility\n        // TODO: Use color-mix when it's supported everywhere.\n        // Enlighten the color.\n        const BACKGROUND_ENLIGHT = 0.7;\n        popup.style.backgroundColor = Util.makeHexColor(\n          ...this.#color.map(c =>\n            Math.floor(BACKGROUND_ENLIGHT * (255 - c) + c)\n          )\n        );\n      }\n    }\n\n    const header = document.createElement(\"span\");\n    header.className = \"header\";\n    const title = document.createElement(\"h1\");\n    header.append(title);\n    ({ dir: title.dir, str: title.textContent } = this.#titleObj);\n    popup.append(header);\n\n    if (this.#dateObj) {\n      const modificationDate = document.createElement(\"span\");\n      modificationDate.classList.add(\"popupDate\");\n      modificationDate.setAttribute(\n        \"data-l10n-id\",\n        \"pdfjs-annotation-date-string\"\n      );\n      modificationDate.setAttribute(\n        \"data-l10n-args\",\n        JSON.stringify({\n          date: this.#dateObj.toLocaleDateString(),\n          time: this.#dateObj.toLocaleTimeString(),\n        })\n      );\n      header.append(modificationDate);\n    }\n\n    const contentsObj = this.#contentsObj;\n    const richText = this.#richText;\n    if (\n      richText?.str &&\n      (!contentsObj?.str || contentsObj.str === richText.str)\n    ) {\n      XfaLayer.render({\n        xfaHtml: richText.html,\n        intent: \"richText\",\n        div: popup,\n      });\n      popup.lastChild.classList.add(\"richText\", \"popupContent\");\n    } else {\n      const contents = this._formatContents(contentsObj);\n      popup.append(contents);\n    }\n\n    let useParentRect = !!this.#parentRect;\n    let rect = useParentRect ? this.#parentRect : this.#rect;\n    for (const element of this.#elements) {\n      if (!rect || Util.intersect(element.data.rect, rect) !== null) {\n        rect = element.data.rect;\n        useParentRect = true;\n        break;\n      }\n    }\n\n    const normalizedRect = Util.normalizeRect([\n      rect[0],\n      view[3] - rect[1] + view[1],\n      rect[2],\n      view[3] - rect[3] + view[1],\n    ]);\n\n    const HORIZONTAL_SPACE_AFTER_ANNOTATION = 5;\n    const parentWidth = useParentRect\n      ? rect[2] - rect[0] + HORIZONTAL_SPACE_AFTER_ANNOTATION\n      : 0;\n    const popupLeft = normalizedRect[0] + parentWidth;\n    const popupTop = normalizedRect[1];\n\n    const { style } = this.#container;\n    style.left = `${(100 * (popupLeft - pageX)) / pageWidth}%`;\n    style.top = `${(100 * (popupTop - pageY)) / pageHeight}%`;\n\n    this.#container.append(popup);\n  }\n\n  /**\n   * Format the contents of the popup by adding newlines where necessary.\n   *\n   * @private\n   * @param {Object<string, string>} contentsObj\n   * @memberof PopupElement\n   * @returns {HTMLParagraphElement}\n   */\n  _formatContents({ str, dir }) {\n    const p = document.createElement(\"p\");\n    p.classList.add(\"popupContent\");\n    p.dir = dir;\n    const lines = str.split(/(?:\\r\\n?|\\n)/);\n    for (let i = 0, ii = lines.length; i < ii; ++i) {\n      const line = lines[i];\n      p.append(document.createTextNode(line));\n      if (i < ii - 1) {\n        p.append(document.createElement(\"br\"));\n      }\n    }\n    return p;\n  }\n\n  #keyDown(event) {\n    if (event.altKey || event.shiftKey || event.ctrlKey || event.metaKey) {\n      return;\n    }\n\n    if (event.key === \"Enter\" || (event.key === \"Escape\" && this.#pinned)) {\n      this.#toggle();\n    }\n  }\n\n  /**\n   * Toggle the visibility of the popup.\n   */\n  #toggle() {\n    this.#pinned = !this.#pinned;\n    if (this.#pinned) {\n      this.#show();\n      this.#container.addEventListener(\"click\", this.#boundToggle);\n      this.#container.addEventListener(\"keydown\", this.#boundKeyDown);\n    } else {\n      this.#hide();\n      this.#container.removeEventListener(\"click\", this.#boundToggle);\n      this.#container.removeEventListener(\"keydown\", this.#boundKeyDown);\n    }\n  }\n\n  /**\n   * Show the popup.\n   */\n  #show() {\n    if (!this.#popup) {\n      this.render();\n    }\n    if (!this.isVisible) {\n      this.#container.hidden = false;\n      this.#container.style.zIndex =\n        parseInt(this.#container.style.zIndex) + 1000;\n    } else if (this.#pinned) {\n      this.#container.classList.add(\"focused\");\n    }\n  }\n\n  /**\n   * Hide the popup.\n   */\n  #hide() {\n    this.#container.classList.remove(\"focused\");\n    if (this.#pinned || !this.isVisible) {\n      return;\n    }\n    this.#container.hidden = true;\n    this.#container.style.zIndex =\n      parseInt(this.#container.style.zIndex) - 1000;\n  }\n\n  forceHide() {\n    this.#wasVisible = this.isVisible;\n    if (!this.#wasVisible) {\n      return;\n    }\n    this.#container.hidden = true;\n  }\n\n  maybeShow() {\n    if (!this.#wasVisible) {\n      return;\n    }\n    this.#wasVisible = false;\n    this.#container.hidden = false;\n  }\n\n  get isVisible() {\n    return this.#container.hidden === false;\n  }\n}\n\nclass FreeTextAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, { isRenderable: true, ignoreBorder: true });\n    this.textContent = parameters.data.textContent;\n    this.textPosition = parameters.data.textPosition;\n    this.annotationEditorType = AnnotationEditorType.FREETEXT;\n  }\n\n  render() {\n    this.container.classList.add(\"freeTextAnnotation\");\n\n    if (this.textContent) {\n      const content = document.createElement(\"div\");\n      content.classList.add(\"annotationTextContent\");\n      content.setAttribute(\"role\", \"comment\");\n      for (const line of this.textContent) {\n        const lineSpan = document.createElement(\"span\");\n        lineSpan.textContent = line;\n        content.append(lineSpan);\n      }\n      this.container.append(content);\n    }\n\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    this._editOnDoubleClick();\n\n    return this.container;\n  }\n\n  get _isEditable() {\n    return this.data.hasOwnCanvas;\n  }\n}\n\nclass LineAnnotationElement extends AnnotationElement {\n  #line = null;\n\n  constructor(parameters) {\n    super(parameters, { isRenderable: true, ignoreBorder: true });\n  }\n\n  render() {\n    this.container.classList.add(\"lineAnnotation\");\n\n    // Create an invisible line with the same starting and ending coordinates\n    // that acts as the trigger for the popup. Only the line itself should\n    // trigger the popup, not the entire container.\n    const data = this.data;\n    const { width, height } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(\n      width,\n      height,\n      /* skipDimensions = */ true\n    );\n\n    // PDF coordinates are calculated from a bottom left origin, so transform\n    // the line coordinates to a top left origin for the SVG element.\n    const line = (this.#line = this.svgFactory.createElement(\"svg:line\"));\n    line.setAttribute(\"x1\", data.rect[2] - data.lineCoordinates[0]);\n    line.setAttribute(\"y1\", data.rect[3] - data.lineCoordinates[1]);\n    line.setAttribute(\"x2\", data.rect[2] - data.lineCoordinates[2]);\n    line.setAttribute(\"y2\", data.rect[3] - data.lineCoordinates[3]);\n    // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n    // won't be possible to open/close the popup (note e.g. issue 11122).\n    line.setAttribute(\"stroke-width\", data.borderStyle.width || 1);\n    line.setAttribute(\"stroke\", \"transparent\");\n    line.setAttribute(\"fill\", \"transparent\");\n\n    svg.append(line);\n    this.container.append(svg);\n\n    // Create the popup ourselves so that we can bind it to the line instead\n    // of to the entire container (which is the default).\n    if (!data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#line;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\n\nclass SquareAnnotationElement extends AnnotationElement {\n  #square = null;\n\n  constructor(parameters) {\n    super(parameters, { isRenderable: true, ignoreBorder: true });\n  }\n\n  render() {\n    this.container.classList.add(\"squareAnnotation\");\n\n    // Create an invisible square with the same rectangle that acts as the\n    // trigger for the popup. Only the square itself should trigger the\n    // popup, not the entire container.\n    const data = this.data;\n    const { width, height } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(\n      width,\n      height,\n      /* skipDimensions = */ true\n    );\n\n    // The browser draws half of the borders inside the square and half of\n    // the borders outside the square by default. This behavior cannot be\n    // changed programmatically, so correct for that here.\n    const borderWidth = data.borderStyle.width;\n    const square = (this.#square = this.svgFactory.createElement(\"svg:rect\"));\n    square.setAttribute(\"x\", borderWidth / 2);\n    square.setAttribute(\"y\", borderWidth / 2);\n    square.setAttribute(\"width\", width - borderWidth);\n    square.setAttribute(\"height\", height - borderWidth);\n    // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n    // won't be possible to open/close the popup (note e.g. issue 11122).\n    square.setAttribute(\"stroke-width\", borderWidth || 1);\n    square.setAttribute(\"stroke\", \"transparent\");\n    square.setAttribute(\"fill\", \"transparent\");\n\n    svg.append(square);\n    this.container.append(svg);\n\n    // Create the popup ourselves so that we can bind it to the square instead\n    // of to the entire container (which is the default).\n    if (!data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#square;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\n\nclass CircleAnnotationElement extends AnnotationElement {\n  #circle = null;\n\n  constructor(parameters) {\n    super(parameters, { isRenderable: true, ignoreBorder: true });\n  }\n\n  render() {\n    this.container.classList.add(\"circleAnnotation\");\n\n    // Create an invisible circle with the same ellipse that acts as the\n    // trigger for the popup. Only the circle itself should trigger the\n    // popup, not the entire container.\n    const data = this.data;\n    const { width, height } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(\n      width,\n      height,\n      /* skipDimensions = */ true\n    );\n\n    // The browser draws half of the borders inside the circle and half of\n    // the borders outside the circle by default. This behavior cannot be\n    // changed programmatically, so correct for that here.\n    const borderWidth = data.borderStyle.width;\n    const circle = (this.#circle =\n      this.svgFactory.createElement(\"svg:ellipse\"));\n    circle.setAttribute(\"cx\", width / 2);\n    circle.setAttribute(\"cy\", height / 2);\n    circle.setAttribute(\"rx\", width / 2 - borderWidth / 2);\n    circle.setAttribute(\"ry\", height / 2 - borderWidth / 2);\n    // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n    // won't be possible to open/close the popup (note e.g. issue 11122).\n    circle.setAttribute(\"stroke-width\", borderWidth || 1);\n    circle.setAttribute(\"stroke\", \"transparent\");\n    circle.setAttribute(\"fill\", \"transparent\");\n\n    svg.append(circle);\n    this.container.append(svg);\n\n    // Create the popup ourselves so that we can bind it to the circle instead\n    // of to the entire container (which is the default).\n    if (!data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#circle;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\n\nclass PolylineAnnotationElement extends AnnotationElement {\n  #polyline = null;\n\n  constructor(parameters) {\n    super(parameters, { isRenderable: true, ignoreBorder: true });\n\n    this.containerClassName = \"polylineAnnotation\";\n    this.svgElementName = \"svg:polyline\";\n  }\n\n  render() {\n    this.container.classList.add(this.containerClassName);\n\n    // Create an invisible polyline with the same points that acts as the\n    // trigger for the popup. Only the polyline itself should trigger the\n    // popup, not the entire container.\n    const data = this.data;\n    const { width, height } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(\n      width,\n      height,\n      /* skipDimensions = */ true\n    );\n\n    // Convert the vertices array to a single points string that the SVG\n    // polyline element expects (\"x1,y1 x2,y2 ...\"). PDF coordinates are\n    // calculated from a bottom left origin, so transform the polyline\n    // coordinates to a top left origin for the SVG element.\n    let points = [];\n    for (const coordinate of data.vertices) {\n      const x = coordinate.x - data.rect[0];\n      const y = data.rect[3] - coordinate.y;\n      points.push(x + \",\" + y);\n    }\n    points = points.join(\" \");\n\n    const polyline = (this.#polyline = this.svgFactory.createElement(\n      this.svgElementName\n    ));\n    polyline.setAttribute(\"points\", points);\n    // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n    // won't be possible to open/close the popup (note e.g. issue 11122).\n    polyline.setAttribute(\"stroke-width\", data.borderStyle.width || 1);\n    polyline.setAttribute(\"stroke\", \"transparent\");\n    polyline.setAttribute(\"fill\", \"transparent\");\n\n    svg.append(polyline);\n    this.container.append(svg);\n\n    // Create the popup ourselves so that we can bind it to the polyline\n    // instead of to the entire container (which is the default).\n    if (!data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#polyline;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\n\nclass PolygonAnnotationElement extends PolylineAnnotationElement {\n  constructor(parameters) {\n    // Polygons are specific forms of polylines, so reuse their logic.\n    super(parameters);\n\n    this.containerClassName = \"polygonAnnotation\";\n    this.svgElementName = \"svg:polygon\";\n  }\n}\n\nclass CaretAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, { isRenderable: true, ignoreBorder: true });\n  }\n\n  render() {\n    this.container.classList.add(\"caretAnnotation\");\n\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    return this.container;\n  }\n}\n\nclass InkAnnotationElement extends AnnotationElement {\n  #polylines = [];\n\n  constructor(parameters) {\n    super(parameters, { isRenderable: true, ignoreBorder: true });\n\n    this.containerClassName = \"inkAnnotation\";\n\n    // Use the polyline SVG element since it allows us to use coordinates\n    // directly and to draw both straight lines and curves.\n    this.svgElementName = \"svg:polyline\";\n    this.annotationEditorType = AnnotationEditorType.INK;\n  }\n\n  render() {\n    this.container.classList.add(this.containerClassName);\n\n    // Create an invisible polyline with the same points that acts as the\n    // trigger for the popup.\n    const data = this.data;\n    const { width, height } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(\n      width,\n      height,\n      /* skipDimensions = */ true\n    );\n\n    for (const inkList of data.inkLists) {\n      // Convert the ink list to a single points string that the SVG\n      // polyline element expects (\"x1,y1 x2,y2 ...\"). PDF coordinates are\n      // calculated from a bottom left origin, so transform the polyline\n      // coordinates to a top left origin for the SVG element.\n      let points = [];\n      for (const coordinate of inkList) {\n        const x = coordinate.x - data.rect[0];\n        const y = data.rect[3] - coordinate.y;\n        points.push(`${x},${y}`);\n      }\n      points = points.join(\" \");\n\n      const polyline = this.svgFactory.createElement(this.svgElementName);\n      this.#polylines.push(polyline);\n      polyline.setAttribute(\"points\", points);\n      // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n      // won't be possible to open/close the popup (note e.g. issue 11122).\n      polyline.setAttribute(\"stroke-width\", data.borderStyle.width || 1);\n      polyline.setAttribute(\"stroke\", \"transparent\");\n      polyline.setAttribute(\"fill\", \"transparent\");\n\n      // Create the popup ourselves so that we can bind it to the polyline\n      // instead of to the entire container (which is the default).\n      if (!data.popupRef && this.hasPopupData) {\n        this._createPopup();\n      }\n\n      svg.append(polyline);\n    }\n\n    this.container.append(svg);\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#polylines;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\n\nclass HighlightAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true,\n      createQuadrilaterals: true,\n    });\n  }\n\n  render() {\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    this.container.classList.add(\"highlightAnnotation\");\n    return this.container;\n  }\n}\n\nclass UnderlineAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true,\n      createQuadrilaterals: true,\n    });\n  }\n\n  render() {\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    this.container.classList.add(\"underlineAnnotation\");\n    return this.container;\n  }\n}\n\nclass SquigglyAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true,\n      createQuadrilaterals: true,\n    });\n  }\n\n  render() {\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    this.container.classList.add(\"squigglyAnnotation\");\n    return this.container;\n  }\n}\n\nclass StrikeOutAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true,\n      createQuadrilaterals: true,\n    });\n  }\n\n  render() {\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    this.container.classList.add(\"strikeoutAnnotation\");\n    return this.container;\n  }\n}\n\nclass StampAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, { isRenderable: true, ignoreBorder: true });\n  }\n\n  render() {\n    this.container.classList.add(\"stampAnnotation\");\n\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    return this.container;\n  }\n}\n\nclass FileAttachmentAnnotationElement extends AnnotationElement {\n  #trigger = null;\n\n  constructor(parameters) {\n    super(parameters, { isRenderable: true });\n\n    const { filename, content } = this.data.file;\n    this.filename = getFilenameFromUrl(filename, /* onlyStripPath = */ true);\n    this.content = content;\n\n    this.linkService.eventBus?.dispatch(\"fileattachmentannotation\", {\n      source: this,\n      filename,\n      content,\n    });\n  }\n\n  render() {\n    this.container.classList.add(\"fileAttachmentAnnotation\");\n\n    const { container, data } = this;\n    let trigger;\n    if (data.hasAppearance || data.fillAlpha === 0) {\n      trigger = document.createElement(\"div\");\n    } else {\n      // Unfortunately it seems that it's not clearly specified exactly what\n      // names are actually valid, since Table 184 contains:\n      //   Conforming readers shall provide predefined icon appearances for at\n      //   least the following standard names: GraphPushPin, PaperclipTag.\n      //   Additional names may be supported as well. Default value: PushPin.\n      trigger = document.createElement(\"img\");\n      trigger.src = `${this.imageResourcesPath}annotation-${\n        /paperclip/i.test(data.name) ? \"paperclip\" : \"pushpin\"\n      }.svg`;\n\n      if (data.fillAlpha && data.fillAlpha < 1) {\n        trigger.style = `filter: opacity(${Math.round(\n          data.fillAlpha * 100\n        )}%);`;\n\n        if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n          this.container.classList.add(\"hasFillAlpha\");\n        }\n      }\n    }\n    trigger.addEventListener(\"dblclick\", this.#download.bind(this));\n    this.#trigger = trigger;\n\n    const { isMac } = FeatureTest.platform;\n    container.addEventListener(\"keydown\", evt => {\n      if (evt.key === \"Enter\" && (isMac ? evt.metaKey : evt.ctrlKey)) {\n        this.#download();\n      }\n    });\n\n    if (!data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    } else {\n      trigger.classList.add(\"popupTriggerArea\");\n    }\n\n    container.append(trigger);\n    return container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#trigger;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n\n  /**\n   * Download the file attachment associated with this annotation.\n   */\n  #download() {\n    this.downloadManager?.openOrDownloadData(this.content, this.filename);\n  }\n}\n\n/**\n * @typedef {Object} AnnotationLayerParameters\n * @property {PageViewport} viewport\n * @property {HTMLDivElement} div\n * @property {Array} annotations\n * @property {PDFPageProxy} page\n * @property {IPDFLinkService} linkService\n * @property {IDownloadManager} downloadManager\n * @property {AnnotationStorage} [annotationStorage]\n * @property {string} [imageResourcesPath] - Path for image resources, mainly\n *   for annotation icons. Include trailing slash.\n * @property {boolean} renderForms\n * @property {boolean} [enableScripting] - Enable embedded script execution.\n * @property {boolean} [hasJSActions] - Some fields have JS actions.\n *   The default value is `false`.\n * @property {Object<string, Array<Object>> | null} [fieldObjects]\n * @property {Map<string, HTMLCanvasElement>} [annotationCanvasMap]\n * @property {TextAccessibilityManager} [accessibilityManager]\n */\n\n/**\n * Manage the layer containing all the annotations.\n */\nclass AnnotationLayer {\n  #accessibilityManager = null;\n\n  #annotationCanvasMap = null;\n\n  #editableAnnotations = new Map();\n\n  constructor({\n    div,\n    accessibilityManager,\n    annotationCanvasMap,\n    page,\n    viewport,\n  }) {\n    this.div = div;\n    this.#accessibilityManager = accessibilityManager;\n    this.#annotationCanvasMap = annotationCanvasMap;\n    this.page = page;\n    this.viewport = viewport;\n    this.zIndex = 0;\n\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n      // For testing purposes.\n      Object.defineProperty(this, \"showPopups\", {\n        value: async () => {\n          for (const show of this.popupShow) {\n            await show();\n          }\n        },\n      });\n      this.popupShow = [];\n    }\n  }\n\n  #appendElement(element, id) {\n    const contentElement = element.firstChild || element;\n    contentElement.id = `${AnnotationPrefix}${id}`;\n\n    this.div.append(element);\n    this.#accessibilityManager?.moveElementInDOM(\n      this.div,\n      element,\n      contentElement,\n      /* isRemovable = */ false\n    );\n  }\n\n  /**\n   * Render a new annotation layer with all annotation elements.\n   *\n   * @param {AnnotationLayerParameters} params\n   * @memberof AnnotationLayer\n   */\n  async render(params) {\n    const { annotations } = params;\n    const layer = this.div;\n    setLayerDimensions(layer, this.viewport);\n\n    const popupToElements = new Map();\n    const elementParams = {\n      data: null,\n      layer,\n      linkService: params.linkService,\n      downloadManager: params.downloadManager,\n      imageResourcesPath: params.imageResourcesPath || \"\",\n      renderForms: params.renderForms !== false,\n      svgFactory: new DOMSVGFactory(),\n      annotationStorage: params.annotationStorage || new AnnotationStorage(),\n      enableScripting: params.enableScripting === true,\n      hasJSActions: params.hasJSActions,\n      fieldObjects: params.fieldObjects,\n      parent: this,\n      elements: null,\n    };\n\n    for (const data of annotations) {\n      if (data.noHTML) {\n        continue;\n      }\n      const isPopupAnnotation = data.annotationType === AnnotationType.POPUP;\n      if (!isPopupAnnotation) {\n        const { width, height } = getRectDims(data.rect);\n        if (width <= 0 || height <= 0) {\n          continue; // Ignore empty annotations.\n        }\n      } else {\n        const elements = popupToElements.get(data.id);\n        if (!elements) {\n          // Ignore popup annotations without a corresponding annotation.\n          continue;\n        }\n        elementParams.elements = elements;\n      }\n      elementParams.data = data;\n      const element = AnnotationElementFactory.create(elementParams);\n\n      if (!element.isRenderable) {\n        continue;\n      }\n\n      if (!isPopupAnnotation && data.popupRef) {\n        const elements = popupToElements.get(data.popupRef);\n        if (!elements) {\n          popupToElements.set(data.popupRef, [element]);\n        } else {\n          elements.push(element);\n        }\n      }\n\n      if (element.annotationEditorType > 0) {\n        this.#editableAnnotations.set(element.data.id, element);\n      }\n\n      const rendered = element.render();\n      if (data.hidden) {\n        rendered.style.visibility = \"hidden\";\n      }\n      this.#appendElement(rendered, data.id);\n    }\n\n    this.#setAnnotationCanvasMap();\n  }\n\n  /**\n   * Update the annotation elements on existing annotation layer.\n   *\n   * @param {AnnotationLayerParameters} viewport\n   * @memberof AnnotationLayer\n   */\n  update({ viewport }) {\n    const layer = this.div;\n    this.viewport = viewport;\n    setLayerDimensions(layer, { rotation: viewport.rotation });\n\n    this.#setAnnotationCanvasMap();\n    layer.hidden = false;\n  }\n\n  #setAnnotationCanvasMap() {\n    if (!this.#annotationCanvasMap) {\n      return;\n    }\n    const layer = this.div;\n    for (const [id, canvas] of this.#annotationCanvasMap) {\n      const element = layer.querySelector(`[data-annotation-id=\"${id}\"]`);\n      if (!element) {\n        continue;\n      }\n\n      const { firstChild } = element;\n      if (!firstChild) {\n        element.append(canvas);\n      } else if (firstChild.nodeName === \"CANVAS\") {\n        firstChild.replaceWith(canvas);\n      } else {\n        firstChild.before(canvas);\n      }\n    }\n    this.#annotationCanvasMap.clear();\n  }\n\n  getEditableAnnotations() {\n    return Array.from(this.#editableAnnotations.values());\n  }\n\n  getEditableAnnotation(id) {\n    return this.#editableAnnotations.get(id);\n  }\n}\n\nexport {\n  AnnotationLayer,\n  FreeTextAnnotationElement,\n  InkAnnotationElement,\n  StampAnnotationElement,\n};\n","/* Copyright 2020 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { objectFromMap, unreachable } from \"../shared/util.js\";\nimport { AnnotationEditor } from \"./editor/editor.js\";\nimport { MurmurHash3_64 } from \"../shared/murmurhash3.js\";\n\nconst SerializableEmpty = Object.freeze({\n  map: null,\n  hash: \"\",\n  transfer: undefined,\n});\n\n/**\n * Key/value storage for annotation data in forms.\n */\nclass AnnotationStorage {\n  #modified = false;\n\n  #storage = new Map();\n\n  constructor() {\n    // Callbacks to signal when the modification state is set or reset.\n    // This is used by the viewer to only bind on `beforeunload` if forms\n    // are actually edited to prevent doing so unconditionally since that\n    // can have undesirable effects.\n    this.onSetModified = null;\n    this.onResetModified = null;\n    this.onAnnotationEditor = null;\n  }\n\n  /**\n   * Get the value for a given key if it exists, or return the default value.\n   * @param {string} key\n   * @param {Object} defaultValue\n   * @returns {Object}\n   */\n  getValue(key, defaultValue) {\n    const value = this.#storage.get(key);\n    if (value === undefined) {\n      return defaultValue;\n    }\n\n    return Object.assign(defaultValue, value);\n  }\n\n  /**\n   * Get the value for a given key.\n   * @param {string} key\n   * @returns {Object}\n   */\n  getRawValue(key) {\n    return this.#storage.get(key);\n  }\n\n  /**\n   * Remove a value from the storage.\n   * @param {string} key\n   */\n  remove(key) {\n    this.#storage.delete(key);\n\n    if (this.#storage.size === 0) {\n      this.resetModified();\n    }\n\n    if (typeof this.onAnnotationEditor === \"function\") {\n      for (const value of this.#storage.values()) {\n        if (value instanceof AnnotationEditor) {\n          return;\n        }\n      }\n      this.onAnnotationEditor(null);\n    }\n  }\n\n  /**\n   * Set the value for a given key\n   * @param {string} key\n   * @param {Object} value\n   */\n  setValue(key, value) {\n    const obj = this.#storage.get(key);\n    let modified = false;\n    if (obj !== undefined) {\n      for (const [entry, val] of Object.entries(value)) {\n        if (obj[entry] !== val) {\n          modified = true;\n          obj[entry] = val;\n        }\n      }\n    } else {\n      modified = true;\n      this.#storage.set(key, value);\n    }\n    if (modified) {\n      this.#setModified();\n    }\n\n    if (\n      value instanceof AnnotationEditor &&\n      typeof this.onAnnotationEditor === \"function\"\n    ) {\n      this.onAnnotationEditor(value.constructor._type);\n    }\n  }\n\n  /**\n   * Check if the storage contains the given key.\n   * @param {string} key\n   * @returns {boolean}\n   */\n  has(key) {\n    return this.#storage.has(key);\n  }\n\n  /**\n   * @returns {Object | null}\n   */\n  getAll() {\n    return this.#storage.size > 0 ? objectFromMap(this.#storage) : null;\n  }\n\n  /**\n   * @param {Object} obj\n   */\n  setAll(obj) {\n    for (const [key, val] of Object.entries(obj)) {\n      this.setValue(key, val);\n    }\n  }\n\n  get size() {\n    return this.#storage.size;\n  }\n\n  #setModified() {\n    if (!this.#modified) {\n      this.#modified = true;\n      if (typeof this.onSetModified === \"function\") {\n        this.onSetModified();\n      }\n    }\n  }\n\n  resetModified() {\n    if (this.#modified) {\n      this.#modified = false;\n      if (typeof this.onResetModified === \"function\") {\n        this.onResetModified();\n      }\n    }\n  }\n\n  /**\n   * @returns {PrintAnnotationStorage}\n   */\n  get print() {\n    return new PrintAnnotationStorage(this);\n  }\n\n  /**\n   * PLEASE NOTE: Only intended for usage within the API itself.\n   * @ignore\n   */\n  get serializable() {\n    if (this.#storage.size === 0) {\n      return SerializableEmpty;\n    }\n    const map = new Map(),\n      hash = new MurmurHash3_64(),\n      transfer = [];\n    const context = Object.create(null);\n    let hasBitmap = false;\n\n    for (const [key, val] of this.#storage) {\n      const serialized =\n        val instanceof AnnotationEditor\n          ? val.serialize(/* isForCopying = */ false, context)\n          : val;\n      if (serialized) {\n        map.set(key, serialized);\n\n        hash.update(`${key}:${JSON.stringify(serialized)}`);\n        hasBitmap ||= !!serialized.bitmap;\n      }\n    }\n\n    if (hasBitmap) {\n      // We must transfer the bitmap data separately, since it can be changed\n      // during serialization with SVG images.\n      for (const value of map.values()) {\n        if (value.bitmap) {\n          transfer.push(value.bitmap);\n        }\n      }\n    }\n\n    return map.size > 0\n      ? { map, hash: hash.hexdigest(), transfer }\n      : SerializableEmpty;\n  }\n}\n\n/**\n * A special `AnnotationStorage` for use during printing, where the serializable\n * data is *frozen* upon initialization, to prevent scripting from modifying its\n * contents. (Necessary since printing is triggered synchronously in browsers.)\n */\nclass PrintAnnotationStorage extends AnnotationStorage {\n  #serializable;\n\n  constructor(parent) {\n    super();\n    const { map, hash, transfer } = parent.serializable;\n    // Create a *copy* of the data, since Objects are passed by reference in JS.\n    const clone = structuredClone(map, transfer ? { transfer } : null);\n\n    this.#serializable = { map: clone, hash, transfer };\n  }\n\n  /**\n   * @returns {PrintAnnotationStorage}\n   */\n  // eslint-disable-next-line getter-return\n  get print() {\n    unreachable(\"Should not call PrintAnnotationStorage.print\");\n  }\n\n  /**\n   * PLEASE NOTE: Only intended for usage within the API itself.\n   * @ignore\n   */\n  get serializable() {\n    return this.#serializable;\n  }\n}\n\nexport { AnnotationStorage, PrintAnnotationStorage, SerializableEmpty };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @module pdfjsLib\n */\n\nimport {\n  AbortException,\n  AnnotationMode,\n  assert,\n  getVerbosityLevel,\n  info,\n  InvalidPDFException,\n  isArrayBuffer,\n  isNodeJS,\n  MAX_IMAGE_SIZE_TO_CACHE,\n  MissingPDFException,\n  PasswordException,\n  PromiseCapability,\n  RenderingIntentFlag,\n  setVerbosityLevel,\n  shadow,\n  stringToBytes,\n  UnexpectedResponseException,\n  UnknownErrorException,\n  unreachable,\n  warn,\n} from \"../shared/util.js\";\nimport {\n  AnnotationStorage,\n  PrintAnnotationStorage,\n  SerializableEmpty,\n} from \"./annotation_storage.js\";\nimport {\n  DOMCanvasFactory,\n  DOMCMapReaderFactory,\n  DOMFilterFactory,\n  DOMStandardFontDataFactory,\n  isDataScheme,\n  isValidFetchUrl,\n  PageViewport,\n  RenderingCancelledException,\n  StatTimer,\n} from \"./display_utils.js\";\nimport { FontFaceObject, FontLoader } from \"./font_loader.js\";\nimport {\n  NodeCanvasFactory,\n  NodeCMapReaderFactory,\n  NodeFilterFactory,\n  NodeStandardFontDataFactory,\n} from \"display-node_utils\";\nimport { CanvasGraphics } from \"./canvas.js\";\nimport { GlobalWorkerOptions } from \"./worker_options.js\";\nimport { MessageHandler } from \"../shared/message_handler.js\";\nimport { Metadata } from \"./metadata.js\";\nimport { OptionalContentConfig } from \"./optional_content_config.js\";\nimport { PDFDataTransportStream } from \"./transport_stream.js\";\nimport { PDFFetchStream } from \"display-fetch_stream\";\nimport { PDFNetworkStream } from \"display-network\";\nimport { PDFNodeStream } from \"display-node_stream\";\nimport { XfaText } from \"./xfa_text.js\";\n\nconst DEFAULT_RANGE_CHUNK_SIZE = 65536; // 2^16 = 65536\nconst RENDERING_CANCELLED_TIMEOUT = 100; // ms\nconst DELAYED_CLEANUP_TIMEOUT = 5000; // ms\n\nconst DefaultCanvasFactory =\n  typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"GENERIC\") && isNodeJS\n    ? NodeCanvasFactory\n    : DOMCanvasFactory;\nconst DefaultCMapReaderFactory =\n  typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"GENERIC\") && isNodeJS\n    ? NodeCMapReaderFactory\n    : DOMCMapReaderFactory;\nconst DefaultFilterFactory =\n  typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"GENERIC\") && isNodeJS\n    ? NodeFilterFactory\n    : DOMFilterFactory;\nconst DefaultStandardFontDataFactory =\n  typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"GENERIC\") && isNodeJS\n    ? NodeStandardFontDataFactory\n    : DOMStandardFontDataFactory;\n\n/**\n * @typedef { Int8Array | Uint8Array | Uint8ClampedArray |\n *            Int16Array | Uint16Array |\n *            Int32Array | Uint32Array | Float32Array |\n *            Float64Array\n * } TypedArray\n */\n\n/**\n * @typedef { TypedArray | ArrayBuffer | Array<number> | string } BinaryData\n */\n\n/**\n * @typedef {Object} RefProxy\n * @property {number} num\n * @property {number} gen\n */\n\n/**\n * Document initialization / loading parameters object.\n *\n * @typedef {Object} DocumentInitParameters\n * @property {string | URL} [url] - The URL of the PDF.\n * @property {BinaryData} [data] - Binary PDF data.\n *   Use TypedArrays (Uint8Array) to improve the memory usage. If PDF data is\n *   BASE64-encoded, use `atob()` to convert it to a binary string first.\n *\n *   NOTE: If TypedArrays are used they will generally be transferred to the\n *   worker-thread. This will help reduce main-thread memory usage, however\n *   it will take ownership of the TypedArrays.\n * @property {Object} [httpHeaders] - Basic authentication headers.\n * @property {boolean} [withCredentials] - Indicates whether or not\n *   cross-site Access-Control requests should be made using credentials such\n *   as cookies or authorization headers. The default is `false`.\n * @property {string} [password] - For decrypting password-protected PDFs.\n * @property {number} [length] - The PDF file length. It's used for progress\n *   reports and range requests operations.\n * @property {PDFDataRangeTransport} [range] - Allows for using a custom range\n *   transport implementation.\n * @property {number} [rangeChunkSize] - Specify maximum number of bytes fetched\n *   per range request. The default value is {@link DEFAULT_RANGE_CHUNK_SIZE}.\n * @property {PDFWorker} [worker] - The worker that will be used for loading and\n *   parsing the PDF data.\n * @property {number} [verbosity] - Controls the logging level; the constants\n *   from {@link VerbosityLevel} should be used.\n * @property {string} [docBaseUrl] - The base URL of the document, used when\n *   attempting to recover valid absolute URLs for annotations, and outline\n *   items, that (incorrectly) only specify relative URLs.\n * @property {string} [cMapUrl] - The URL where the predefined Adobe CMaps are\n *   located. Include the trailing slash.\n * @property {boolean} [cMapPacked] - Specifies if the Adobe CMaps are binary\n *   packed or not. The default value is `true`.\n * @property {Object} [CMapReaderFactory] - The factory that will be used when\n *   reading built-in CMap files. Providing a custom factory is useful for\n *   environments without Fetch API or `XMLHttpRequest` support, such as\n *   Node.js. The default value is {DOMCMapReaderFactory}.\n * @property {boolean} [useSystemFonts] - When `true`, fonts that aren't\n *   embedded in the PDF document will fallback to a system font.\n *   The default value is `true` in web environments and `false` in Node.js;\n *   unless `disableFontFace === true` in which case this defaults to `false`\n *   regardless of the environment (to prevent completely broken fonts).\n * @property {string} [standardFontDataUrl] - The URL where the standard font\n *   files are located. Include the trailing slash.\n * @property {Object} [StandardFontDataFactory] - The factory that will be used\n *   when reading the standard font files. Providing a custom factory is useful\n *   for environments without Fetch API or `XMLHttpRequest` support, such as\n *   Node.js. The default value is {DOMStandardFontDataFactory}.\n * @property {boolean} [useWorkerFetch] - Enable using the Fetch API in the\n *   worker-thread when reading CMap and standard font files. When `true`,\n *   the `CMapReaderFactory` and `StandardFontDataFactory` options are ignored.\n *   The default value is `true` in web environments and `false` in Node.js.\n * @property {boolean} [stopAtErrors] - Reject certain promises, e.g.\n *   `getOperatorList`, `getTextContent`, and `RenderTask`, when the associated\n *   PDF data cannot be successfully parsed, instead of attempting to recover\n *   whatever possible of the data. The default value is `false`.\n * @property {number} [maxImageSize] - The maximum allowed image size in total\n *   pixels, i.e. width * height. Images above this value will not be rendered.\n *   Use -1 for no limit, which is also the default value.\n * @property {boolean} [isEvalSupported] - Determines if we can evaluate strings\n *   as JavaScript. Primarily used to improve performance of font rendering, and\n *   when parsing PDF functions. The default value is `true`.\n * @property {boolean} [isOffscreenCanvasSupported] - Determines if we can use\n *   `OffscreenCanvas` in the worker. Primarily used to improve performance of\n *   image conversion/rendering.\n *   The default value is `true` in web environments and `false` in Node.js.\n * @property {number} [canvasMaxAreaInBytes] - The integer value is used to\n *   know when an image must be resized (uses `OffscreenCanvas` in the worker).\n *   If it's -1 then a possibly slow algorithm is used to guess the max value.\n * @property {boolean} [disableFontFace] - By default fonts are converted to\n *   OpenType fonts and loaded via the Font Loading API or `@font-face` rules.\n *   If disabled, fonts will be rendered using a built-in font renderer that\n *   constructs the glyphs with primitive path commands.\n *   The default value is `false` in web environments and `true` in Node.js.\n * @property {boolean} [fontExtraProperties] - Include additional properties,\n *   which are unused during rendering of PDF documents, when exporting the\n *   parsed font data from the worker-thread. This may be useful for debugging\n *   purposes (and backwards compatibility), but note that it will lead to\n *   increased memory usage. The default value is `false`.\n * @property {boolean} [enableXfa] - Render Xfa forms if any.\n *   The default value is `false`.\n * @property {HTMLDocument} [ownerDocument] - Specify an explicit document\n *   context to create elements with and to load resources, such as fonts,\n *   into. Defaults to the current document.\n * @property {boolean} [disableRange] - Disable range request loading of PDF\n *   files. When enabled, and if the server supports partial content requests,\n *   then the PDF will be fetched in chunks. The default value is `false`.\n * @property {boolean} [disableStream] - Disable streaming of PDF file data.\n *   By default PDF.js attempts to load PDF files in chunks. The default value\n *   is `false`.\n * @property {boolean} [disableAutoFetch] - Disable pre-fetching of PDF file\n *   data. When range requests are enabled PDF.js will automatically keep\n *   fetching more data even if it isn't needed to display the current page.\n *   The default value is `false`.\n *\n *   NOTE: It is also necessary to disable streaming, see above, in order for\n *   disabling of pre-fetching to work correctly.\n * @property {boolean} [pdfBug] - Enables special hooks for debugging PDF.js\n *   (see `web/debugger.js`). The default value is `false`.\n * @property {Object} [canvasFactory] - The factory instance that will be used\n *   when creating canvases. The default value is {new DOMCanvasFactory()}.\n * @property {Object} [filterFactory] - A factory instance that will be used\n *   to create SVG filters when rendering some images on the main canvas.\n */\n\n/**\n * This is the main entry point for loading a PDF and interacting with it.\n *\n * NOTE: If a URL is used to fetch the PDF data a standard Fetch API call (or\n * XHR as fallback) is used, which means it must follow same origin rules,\n * e.g. no cross-domain requests without CORS.\n *\n * @param {string | URL | TypedArray | ArrayBuffer | DocumentInitParameters}\n *   src - Can be a URL where a PDF file is located, a typed array (Uint8Array)\n *         already populated with data, or a parameter object.\n * @returns {PDFDocumentLoadingTask}\n */\nfunction getDocument(src) {\n  if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n    if (typeof src === \"string\" || src instanceof URL) {\n      src = { url: src };\n    } else if (isArrayBuffer(src)) {\n      src = { data: src };\n    }\n  }\n  if (typeof src !== \"object\") {\n    throw new Error(\"Invalid parameter in getDocument, need parameter object.\");\n  }\n  if (!src.url && !src.data && !src.range) {\n    throw new Error(\n      \"Invalid parameter object: need either .data, .range or .url\"\n    );\n  }\n  const task = new PDFDocumentLoadingTask();\n  const { docId } = task;\n\n  const url = src.url ? getUrlProp(src.url) : null;\n  const data = src.data ? getDataProp(src.data) : null;\n  const httpHeaders = src.httpHeaders || null;\n  const withCredentials = src.withCredentials === true;\n  const password = src.password ?? null;\n  const rangeTransport =\n    src.range instanceof PDFDataRangeTransport ? src.range : null;\n  const rangeChunkSize =\n    Number.isInteger(src.rangeChunkSize) && src.rangeChunkSize > 0\n      ? src.rangeChunkSize\n      : DEFAULT_RANGE_CHUNK_SIZE;\n  let worker = src.worker instanceof PDFWorker ? src.worker : null;\n  const verbosity = src.verbosity;\n  // Ignore \"data:\"-URLs, since they can't be used to recover valid absolute\n  // URLs anyway. We want to avoid sending them to the worker-thread, since\n  // they contain the *entire* PDF document and can thus be arbitrarily long.\n  const docBaseUrl =\n    typeof src.docBaseUrl === \"string\" && !isDataScheme(src.docBaseUrl)\n      ? src.docBaseUrl\n      : null;\n  const cMapUrl = typeof src.cMapUrl === \"string\" ? src.cMapUrl : null;\n  const cMapPacked = src.cMapPacked !== false;\n  const CMapReaderFactory = src.CMapReaderFactory || DefaultCMapReaderFactory;\n  const standardFontDataUrl =\n    typeof src.standardFontDataUrl === \"string\"\n      ? src.standardFontDataUrl\n      : null;\n  const StandardFontDataFactory =\n    src.StandardFontDataFactory || DefaultStandardFontDataFactory;\n  const ignoreErrors = src.stopAtErrors !== true;\n  const maxImageSize =\n    Number.isInteger(src.maxImageSize) && src.maxImageSize > -1\n      ? src.maxImageSize\n      : -1;\n  const isEvalSupported = src.isEvalSupported !== false;\n  const isOffscreenCanvasSupported =\n    typeof src.isOffscreenCanvasSupported === \"boolean\"\n      ? src.isOffscreenCanvasSupported\n      : !isNodeJS;\n  const canvasMaxAreaInBytes = Number.isInteger(src.canvasMaxAreaInBytes)\n    ? src.canvasMaxAreaInBytes\n    : -1;\n  const disableFontFace =\n    typeof src.disableFontFace === \"boolean\" ? src.disableFontFace : isNodeJS;\n  const fontExtraProperties = src.fontExtraProperties === true;\n  const enableXfa = src.enableXfa === true;\n  const ownerDocument = src.ownerDocument || globalThis.document;\n  const disableRange = src.disableRange === true;\n  const disableStream = src.disableStream === true;\n  const disableAutoFetch = src.disableAutoFetch === true;\n  const pdfBug = src.pdfBug === true;\n\n  // Parameters whose default values depend on other parameters.\n  const length = rangeTransport ? rangeTransport.length : src.length ?? NaN;\n  const useSystemFonts =\n    typeof src.useSystemFonts === \"boolean\"\n      ? src.useSystemFonts\n      : !isNodeJS && !disableFontFace;\n  const useWorkerFetch =\n    typeof src.useWorkerFetch === \"boolean\"\n      ? src.useWorkerFetch\n      : (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n        (CMapReaderFactory === DOMCMapReaderFactory &&\n          StandardFontDataFactory === DOMStandardFontDataFactory &&\n          cMapUrl &&\n          standardFontDataUrl &&\n          isValidFetchUrl(cMapUrl, document.baseURI) &&\n          isValidFetchUrl(standardFontDataUrl, document.baseURI));\n  const canvasFactory =\n    src.canvasFactory || new DefaultCanvasFactory({ ownerDocument });\n  const filterFactory =\n    src.filterFactory || new DefaultFilterFactory({ docId, ownerDocument });\n\n  // Parameters only intended for development/testing purposes.\n  const styleElement =\n    typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")\n      ? src.styleElement\n      : null;\n\n  // Set the main-thread verbosity level.\n  setVerbosityLevel(verbosity);\n\n  // Ensure that the various factories can be initialized, when necessary,\n  // since the user may provide *custom* ones.\n  const transportFactory = {\n    canvasFactory,\n    filterFactory,\n  };\n  if (!useWorkerFetch) {\n    transportFactory.cMapReaderFactory = new CMapReaderFactory({\n      baseUrl: cMapUrl,\n      isCompressed: cMapPacked,\n    });\n    transportFactory.standardFontDataFactory = new StandardFontDataFactory({\n      baseUrl: standardFontDataUrl,\n    });\n  }\n\n  if (!worker) {\n    const workerParams = {\n      verbosity,\n      port: GlobalWorkerOptions.workerPort,\n    };\n    // Worker was not provided -- creating and owning our own. If message port\n    // is specified in global worker options, using it.\n    worker = workerParams.port\n      ? PDFWorker.fromPort(workerParams)\n      : new PDFWorker(workerParams);\n    task._worker = worker;\n  }\n\n  const fetchDocParams = {\n    docId,\n    apiVersion:\n      typeof PDFJSDev !== \"undefined\" && !PDFJSDev.test(\"TESTING\")\n        ? PDFJSDev.eval(\"BUNDLE_VERSION\")\n        : null,\n    data,\n    password,\n    disableAutoFetch,\n    rangeChunkSize,\n    length,\n    docBaseUrl,\n    enableXfa,\n    evaluatorOptions: {\n      maxImageSize,\n      disableFontFace,\n      ignoreErrors,\n      isEvalSupported,\n      isOffscreenCanvasSupported,\n      canvasMaxAreaInBytes,\n      fontExtraProperties,\n      useSystemFonts,\n      cMapUrl: useWorkerFetch ? cMapUrl : null,\n      standardFontDataUrl: useWorkerFetch ? standardFontDataUrl : null,\n    },\n  };\n  const transportParams = {\n    ignoreErrors,\n    isEvalSupported,\n    disableFontFace,\n    fontExtraProperties,\n    enableXfa,\n    ownerDocument,\n    disableAutoFetch,\n    pdfBug,\n    styleElement,\n  };\n\n  worker.promise\n    .then(function () {\n      if (task.destroyed) {\n        throw new Error(\"Loading aborted\");\n      }\n\n      const workerIdPromise = _fetchDocument(worker, fetchDocParams);\n      const networkStreamPromise = new Promise(function (resolve) {\n        let networkStream;\n        if (rangeTransport) {\n          networkStream = new PDFDataTransportStream(\n            {\n              length,\n              initialData: rangeTransport.initialData,\n              progressiveDone: rangeTransport.progressiveDone,\n              contentDispositionFilename:\n                rangeTransport.contentDispositionFilename,\n              disableRange,\n              disableStream,\n            },\n            rangeTransport\n          );\n        } else if (!data) {\n          if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n            throw new Error(\"Not implemented: createPDFNetworkStream\");\n          }\n          const createPDFNetworkStream = params => {\n            if (\n              typeof PDFJSDev !== \"undefined\" &&\n              PDFJSDev.test(\"GENERIC\") &&\n              isNodeJS\n            ) {\n              return new PDFNodeStream(params);\n            }\n            return isValidFetchUrl(params.url)\n              ? new PDFFetchStream(params)\n              : new PDFNetworkStream(params);\n          };\n\n          networkStream = createPDFNetworkStream({\n            url,\n            length,\n            httpHeaders,\n            withCredentials,\n            rangeChunkSize,\n            disableRange,\n            disableStream,\n          });\n        }\n        resolve(networkStream);\n      });\n\n      return Promise.all([workerIdPromise, networkStreamPromise]).then(\n        function ([workerId, networkStream]) {\n          if (task.destroyed) {\n            throw new Error(\"Loading aborted\");\n          }\n\n          const messageHandler = new MessageHandler(\n            docId,\n            workerId,\n            worker.port\n          );\n          const transport = new WorkerTransport(\n            messageHandler,\n            task,\n            networkStream,\n            transportParams,\n            transportFactory\n          );\n          task._transport = transport;\n          messageHandler.send(\"Ready\", null);\n        }\n      );\n    })\n    .catch(task._capability.reject);\n\n  return task;\n}\n\n/**\n * Starts fetching of specified PDF document/data.\n *\n * @param {PDFWorker} worker\n * @param {Object} source\n * @returns {Promise<string>} A promise that is resolved when the worker ID of\n *   the `MessageHandler` is known.\n * @private\n */\nasync function _fetchDocument(worker, source) {\n  if (worker.destroyed) {\n    throw new Error(\"Worker was destroyed\");\n  }\n  const workerId = await worker.messageHandler.sendWithPromise(\n    \"GetDocRequest\",\n    source,\n    source.data ? [source.data.buffer] : null\n  );\n\n  if (worker.destroyed) {\n    throw new Error(\"Worker was destroyed\");\n  }\n  return workerId;\n}\n\nfunction getUrlProp(val) {\n  if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n    return null; // The 'url' is unused with `PDFDataRangeTransport`.\n  }\n  if (val instanceof URL) {\n    return val.href;\n  }\n  try {\n    // The full path is required in the 'url' field.\n    return new URL(val, window.location).href;\n  } catch {\n    if (\n      typeof PDFJSDev !== \"undefined\" &&\n      PDFJSDev.test(\"GENERIC\") &&\n      isNodeJS &&\n      typeof val === \"string\"\n    ) {\n      return val; // Use the url as-is in Node.js environments.\n    }\n  }\n  throw new Error(\n    \"Invalid PDF url data: \" +\n      \"either string or URL-object is expected in the url property.\"\n  );\n}\n\nfunction getDataProp(val) {\n  // Converting string or array-like data to Uint8Array.\n  if (\n    typeof PDFJSDev !== \"undefined\" &&\n    PDFJSDev.test(\"GENERIC\") &&\n    isNodeJS &&\n    typeof Buffer !== \"undefined\" && // eslint-disable-line no-undef\n    val instanceof Buffer // eslint-disable-line no-undef\n  ) {\n    throw new Error(\n      \"Please provide binary data as `Uint8Array`, rather than `Buffer`.\"\n    );\n  }\n  if (val instanceof Uint8Array && val.byteLength === val.buffer.byteLength) {\n    // Use the data as-is when it's already a Uint8Array that completely\n    // \"utilizes\" its underlying ArrayBuffer, to prevent any possible\n    // issues when transferring it to the worker-thread.\n    return val;\n  }\n  if (typeof val === \"string\") {\n    return stringToBytes(val);\n  }\n  if ((typeof val === \"object\" && !isNaN(val?.length)) || isArrayBuffer(val)) {\n    return new Uint8Array(val);\n  }\n  throw new Error(\n    \"Invalid PDF binary data: either TypedArray, \" +\n      \"string, or array-like object is expected in the data property.\"\n  );\n}\n\n/**\n * @typedef {Object} OnProgressParameters\n * @property {number} loaded - Currently loaded number of bytes.\n * @property {number} total - Total number of bytes in the PDF file.\n */\n\n/**\n * The loading task controls the operations required to load a PDF document\n * (such as network requests) and provides a way to listen for completion,\n * after which individual pages can be rendered.\n */\nclass PDFDocumentLoadingTask {\n  static #docId = 0;\n\n  constructor() {\n    this._capability = new PromiseCapability();\n    this._transport = null;\n    this._worker = null;\n\n    /**\n     * Unique identifier for the document loading task.\n     * @type {string}\n     */\n    this.docId = `d${PDFDocumentLoadingTask.#docId++}`;\n\n    /**\n     * Whether the loading task is destroyed or not.\n     * @type {boolean}\n     */\n    this.destroyed = false;\n\n    /**\n     * Callback to request a password if a wrong or no password was provided.\n     * The callback receives two parameters: a function that should be called\n     * with the new password, and a reason (see {@link PasswordResponses}).\n     * @type {function}\n     */\n    this.onPassword = null;\n\n    /**\n     * Callback to be able to monitor the loading progress of the PDF file\n     * (necessary to implement e.g. a loading bar).\n     * The callback receives an {@link OnProgressParameters} argument.\n     * @type {function}\n     */\n    this.onProgress = null;\n  }\n\n  /**\n   * Promise for document loading task completion.\n   * @type {Promise<PDFDocumentProxy>}\n   */\n  get promise() {\n    return this._capability.promise;\n  }\n\n  /**\n   * Abort all network requests and destroy the worker.\n   * @returns {Promise<void>} A promise that is resolved when destruction is\n   *   completed.\n   */\n  async destroy() {\n    this.destroyed = true;\n    try {\n      if (this._worker?.port) {\n        this._worker._pendingDestroy = true;\n      }\n      await this._transport?.destroy();\n    } catch (ex) {\n      if (this._worker?.port) {\n        delete this._worker._pendingDestroy;\n      }\n      throw ex;\n    }\n\n    this._transport = null;\n    if (this._worker) {\n      this._worker.destroy();\n      this._worker = null;\n    }\n  }\n}\n\n/**\n * Abstract class to support range requests file loading.\n *\n * NOTE: The TypedArrays passed to the constructor and relevant methods below\n * will generally be transferred to the worker-thread. This will help reduce\n * main-thread memory usage, however it will take ownership of the TypedArrays.\n */\nclass PDFDataRangeTransport {\n  /**\n   * @param {number} length\n   * @param {Uint8Array|null} initialData\n   * @param {boolean} [progressiveDone]\n   * @param {string} [contentDispositionFilename]\n   */\n  constructor(\n    length,\n    initialData,\n    progressiveDone = false,\n    contentDispositionFilename = null\n  ) {\n    this.length = length;\n    this.initialData = initialData;\n    this.progressiveDone = progressiveDone;\n    this.contentDispositionFilename = contentDispositionFilename;\n\n    this._rangeListeners = [];\n    this._progressListeners = [];\n    this._progressiveReadListeners = [];\n    this._progressiveDoneListeners = [];\n    this._readyCapability = new PromiseCapability();\n  }\n\n  /**\n   * @param {function} listener\n   */\n  addRangeListener(listener) {\n    this._rangeListeners.push(listener);\n  }\n\n  /**\n   * @param {function} listener\n   */\n  addProgressListener(listener) {\n    this._progressListeners.push(listener);\n  }\n\n  /**\n   * @param {function} listener\n   */\n  addProgressiveReadListener(listener) {\n    this._progressiveReadListeners.push(listener);\n  }\n\n  /**\n   * @param {function} listener\n   */\n  addProgressiveDoneListener(listener) {\n    this._progressiveDoneListeners.push(listener);\n  }\n\n  /**\n   * @param {number} begin\n   * @param {Uint8Array|null} chunk\n   */\n  onDataRange(begin, chunk) {\n    for (const listener of this._rangeListeners) {\n      listener(begin, chunk);\n    }\n  }\n\n  /**\n   * @param {number} loaded\n   * @param {number|undefined} total\n   */\n  onDataProgress(loaded, total) {\n    this._readyCapability.promise.then(() => {\n      for (const listener of this._progressListeners) {\n        listener(loaded, total);\n      }\n    });\n  }\n\n  /**\n   * @param {Uint8Array|null} chunk\n   */\n  onDataProgressiveRead(chunk) {\n    this._readyCapability.promise.then(() => {\n      for (const listener of this._progressiveReadListeners) {\n        listener(chunk);\n      }\n    });\n  }\n\n  onDataProgressiveDone() {\n    this._readyCapability.promise.then(() => {\n      for (const listener of this._progressiveDoneListeners) {\n        listener();\n      }\n    });\n  }\n\n  transportReady() {\n    this._readyCapability.resolve();\n  }\n\n  /**\n   * @param {number} begin\n   * @param {number} end\n   */\n  requestDataRange(begin, end) {\n    unreachable(\"Abstract method PDFDataRangeTransport.requestDataRange\");\n  }\n\n  abort() {}\n}\n\n/**\n * Proxy to a `PDFDocument` in the worker thread.\n */\nclass PDFDocumentProxy {\n  constructor(pdfInfo, transport) {\n    this._pdfInfo = pdfInfo;\n    this._transport = transport;\n\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      // For testing purposes.\n      Object.defineProperty(this, \"getXFADatasets\", {\n        value: () => {\n          return this._transport.getXFADatasets();\n        },\n      });\n      Object.defineProperty(this, \"getXRefPrevValue\", {\n        value: () => {\n          return this._transport.getXRefPrevValue();\n        },\n      });\n      Object.defineProperty(this, \"getAnnotArray\", {\n        value: pageIndex => {\n          return this._transport.getAnnotArray(pageIndex);\n        },\n      });\n    }\n  }\n\n  /**\n   * @type {AnnotationStorage} Storage for annotation data in forms.\n   */\n  get annotationStorage() {\n    return this._transport.annotationStorage;\n  }\n\n  /**\n   * @type {Object} The filter factory instance.\n   */\n  get filterFactory() {\n    return this._transport.filterFactory;\n  }\n\n  /**\n   * @type {number} Total number of pages in the PDF file.\n   */\n  get numPages() {\n    return this._pdfInfo.numPages;\n  }\n\n  /**\n   * @type {Array<string, string|null>} A (not guaranteed to be) unique ID to\n   *   identify the PDF document.\n   *   NOTE: The first element will always be defined for all PDF documents,\n   *   whereas the second element is only defined for *modified* PDF documents.\n   */\n  get fingerprints() {\n    return this._pdfInfo.fingerprints;\n  }\n\n  /**\n   * @type {boolean} True if only XFA form.\n   */\n  get isPureXfa() {\n    return shadow(this, \"isPureXfa\", !!this._transport._htmlForXfa);\n  }\n\n  /**\n   * NOTE: This is (mostly) intended to support printing of XFA forms.\n   *\n   * @type {Object | null} An object representing a HTML tree structure\n   *   to render the XFA, or `null` when no XFA form exists.\n   */\n  get allXfaHtml() {\n    return this._transport._htmlForXfa;\n  }\n\n  /**\n   * @param {number} pageNumber - The page number to get. The first page is 1.\n   * @returns {Promise<PDFPageProxy>} A promise that is resolved with\n   *   a {@link PDFPageProxy} object.\n   */\n  getPage(pageNumber) {\n    return this._transport.getPage(pageNumber);\n  }\n\n  /**\n   * @param {RefProxy} ref - The page reference.\n   * @returns {Promise<number>} A promise that is resolved with the page index,\n   *   starting from zero, that is associated with the reference.\n   */\n  getPageIndex(ref) {\n    return this._transport.getPageIndex(ref);\n  }\n\n  /**\n   * @returns {Promise<Object<string, Array<any>>>} A promise that is resolved\n   *   with a mapping from named destinations to references.\n   *\n   * This can be slow for large documents. Use `getDestination` instead.\n   */\n  getDestinations() {\n    return this._transport.getDestinations();\n  }\n\n  /**\n   * @param {string} id - The named destination to get.\n   * @returns {Promise<Array<any> | null>} A promise that is resolved with all\n   *   information of the given named destination, or `null` when the named\n   *   destination is not present in the PDF file.\n   */\n  getDestination(id) {\n    return this._transport.getDestination(id);\n  }\n\n  /**\n   * @returns {Promise<Array<string> | null>} A promise that is resolved with\n   *   an {Array} containing the page labels that correspond to the page\n   *   indexes, or `null` when no page labels are present in the PDF file.\n   */\n  getPageLabels() {\n    return this._transport.getPageLabels();\n  }\n\n  /**\n   * @returns {Promise<string>} A promise that is resolved with a {string}\n   *   containing the page layout name.\n   */\n  getPageLayout() {\n    return this._transport.getPageLayout();\n  }\n\n  /**\n   * @returns {Promise<string>} A promise that is resolved with a {string}\n   *   containing the page mode name.\n   */\n  getPageMode() {\n    return this._transport.getPageMode();\n  }\n\n  /**\n   * @returns {Promise<Object | null>} A promise that is resolved with an\n   *   {Object} containing the viewer preferences, or `null` when no viewer\n   *   preferences are present in the PDF file.\n   */\n  getViewerPreferences() {\n    return this._transport.getViewerPreferences();\n  }\n\n  /**\n   * @returns {Promise<any | null>} A promise that is resolved with an {Array}\n   *   containing the destination, or `null` when no open action is present\n   *   in the PDF.\n   */\n  getOpenAction() {\n    return this._transport.getOpenAction();\n  }\n\n  /**\n   * @returns {Promise<any>} A promise that is resolved with a lookup table\n   *   for mapping named attachments to their content.\n   */\n  getAttachments() {\n    return this._transport.getAttachments();\n  }\n\n  /**\n   * @returns {Promise<Object | null>} A promise that is resolved with\n   *   an {Object} with the JavaScript actions:\n   *     - from the name tree.\n   *     - from A or AA entries in the catalog dictionary.\n   *   , or `null` if no JavaScript exists.\n   */\n  getJSActions() {\n    return this._transport.getDocJSActions();\n  }\n\n  /**\n   * @typedef {Object} OutlineNode\n   * @property {string} title\n   * @property {boolean} bold\n   * @property {boolean} italic\n   * @property {Uint8ClampedArray} color - The color in RGB format to use for\n   *   display purposes.\n   * @property {string | Array<any> | null} dest\n   * @property {string | null} url\n   * @property {string | undefined} unsafeUrl\n   * @property {boolean | undefined} newWindow\n   * @property {number | undefined} count\n   * @property {Array<OutlineNode>} items\n   */\n\n  /**\n   * @returns {Promise<Array<OutlineNode>>} A promise that is resolved with an\n   *   {Array} that is a tree outline (if it has one) of the PDF file.\n   */\n  getOutline() {\n    return this._transport.getOutline();\n  }\n\n  /**\n   * @returns {Promise<OptionalContentConfig>} A promise that is resolved with\n   *   an {@link OptionalContentConfig} that contains all the optional content\n   *   groups (assuming that the document has any).\n   */\n  getOptionalContentConfig() {\n    return this._transport.getOptionalContentConfig();\n  }\n\n  /**\n   * @returns {Promise<Array<number> | null>} A promise that is resolved with\n   *   an {Array} that contains the permission flags for the PDF document, or\n   *   `null` when no permissions are present in the PDF file.\n   */\n  getPermissions() {\n    return this._transport.getPermissions();\n  }\n\n  /**\n   * @returns {Promise<{ info: Object, metadata: Metadata }>} A promise that is\n   *   resolved with an {Object} that has `info` and `metadata` properties.\n   *   `info` is an {Object} filled with anything available in the information\n   *   dictionary and similarly `metadata` is a {Metadata} object with\n   *   information from the metadata section of the PDF.\n   */\n  getMetadata() {\n    return this._transport.getMetadata();\n  }\n\n  /**\n   * @typedef {Object} MarkInfo\n   * Properties correspond to Table 321 of the PDF 32000-1:2008 spec.\n   * @property {boolean} Marked\n   * @property {boolean} UserProperties\n   * @property {boolean} Suspects\n   */\n\n  /**\n   * @returns {Promise<MarkInfo | null>} A promise that is resolved with\n   *   a {MarkInfo} object that contains the MarkInfo flags for the PDF\n   *   document, or `null` when no MarkInfo values are present in the PDF file.\n   */\n  getMarkInfo() {\n    return this._transport.getMarkInfo();\n  }\n\n  /**\n   * @returns {Promise<Uint8Array>} A promise that is resolved with a\n   *   {Uint8Array} containing the raw data of the PDF document.\n   */\n  getData() {\n    return this._transport.getData();\n  }\n\n  /**\n   * @returns {Promise<Uint8Array>} A promise that is resolved with a\n   *   {Uint8Array} containing the full data of the saved document.\n   */\n  saveDocument() {\n    return this._transport.saveDocument();\n  }\n\n  /**\n   * @returns {Promise<{ length: number }>} A promise that is resolved when the\n   *   document's data is loaded. It is resolved with an {Object} that contains\n   *   the `length` property that indicates size of the PDF data in bytes.\n   */\n  getDownloadInfo() {\n    return this._transport.downloadInfoCapability.promise;\n  }\n\n  /**\n   * Cleans up resources allocated by the document on both the main and worker\n   * threads.\n   *\n   * NOTE: Do not, under any circumstances, call this method when rendering is\n   * currently ongoing since that may lead to rendering errors.\n   *\n   * @param {boolean} [keepLoadedFonts] - Let fonts remain attached to the DOM.\n   *   NOTE: This will increase persistent memory usage, hence don't use this\n   *   option unless absolutely necessary. The default value is `false`.\n   * @returns {Promise} A promise that is resolved when clean-up has finished.\n   */\n  cleanup(keepLoadedFonts = false) {\n    return this._transport.startCleanup(keepLoadedFonts || this.isPureXfa);\n  }\n\n  /**\n   * Destroys the current document instance and terminates the worker.\n   */\n  destroy() {\n    return this.loadingTask.destroy();\n  }\n\n  /**\n   * @type {DocumentInitParameters} A subset of the current\n   *   {DocumentInitParameters}, which are needed in the viewer.\n   */\n  get loadingParams() {\n    return this._transport.loadingParams;\n  }\n\n  /**\n   * @type {PDFDocumentLoadingTask} The loadingTask for the current document.\n   */\n  get loadingTask() {\n    return this._transport.loadingTask;\n  }\n\n  /**\n   * @returns {Promise<Object<string, Array<Object>> | null>} A promise that is\n   *   resolved with an {Object} containing /AcroForm field data for the JS\n   *   sandbox, or `null` when no field data is present in the PDF file.\n   */\n  getFieldObjects() {\n    return this._transport.getFieldObjects();\n  }\n\n  /**\n   * @returns {Promise<boolean>} A promise that is resolved with `true`\n   *   if some /AcroForm fields have JavaScript actions.\n   */\n  hasJSActions() {\n    return this._transport.hasJSActions();\n  }\n\n  /**\n   * @returns {Promise<Array<string> | null>} A promise that is resolved with an\n   *   {Array<string>} containing IDs of annotations that have a calculation\n   *   action, or `null` when no such annotations are present in the PDF file.\n   */\n  getCalculationOrderIds() {\n    return this._transport.getCalculationOrderIds();\n  }\n}\n\n/**\n * Page getViewport parameters.\n *\n * @typedef {Object} GetViewportParameters\n * @property {number} scale - The desired scale of the viewport.\n * @property {number} [rotation] - The desired rotation, in degrees, of\n *   the viewport. If omitted it defaults to the page rotation.\n * @property {number} [offsetX] - The horizontal, i.e. x-axis, offset.\n *   The default value is `0`.\n * @property {number} [offsetY] - The vertical, i.e. y-axis, offset.\n *   The default value is `0`.\n * @property {boolean} [dontFlip] - If true, the y-axis will not be\n *   flipped. The default value is `false`.\n */\n\n/**\n * Page getTextContent parameters.\n *\n * @typedef {Object} getTextContentParameters\n * @property {boolean} [includeMarkedContent] - When true include marked\n *   content items in the items array of TextContent. The default is `false`.\n * @property {boolean} [disableNormalization] - When true the text is *not*\n *   normalized in the worker-thread. The default is `false`.\n */\n\n/**\n * Page text content.\n *\n * @typedef {Object} TextContent\n * @property {Array<TextItem | TextMarkedContent>} items - Array of\n *   {@link TextItem} and {@link TextMarkedContent} objects. TextMarkedContent\n *   items are included when includeMarkedContent is true.\n * @property {Object<string, TextStyle>} styles - {@link TextStyle} objects,\n *   indexed by font name.\n */\n\n/**\n * Page text content part.\n *\n * @typedef {Object} TextItem\n * @property {string} str - Text content.\n * @property {string} dir - Text direction: 'ttb', 'ltr' or 'rtl'.\n * @property {Array<any>} transform - Transformation matrix.\n * @property {number} width - Width in device space.\n * @property {number} height - Height in device space.\n * @property {string} fontName - Font name used by PDF.js for converted font.\n * @property {boolean} hasEOL - Indicating if the text content is followed by a\n *   line-break.\n */\n\n/**\n * Page text marked content part.\n *\n * @typedef {Object} TextMarkedContent\n * @property {string} type - Either 'beginMarkedContent',\n *   'beginMarkedContentProps', or 'endMarkedContent'.\n * @property {string} id - The marked content identifier. Only used for type\n *   'beginMarkedContentProps'.\n */\n\n/**\n * Text style.\n *\n * @typedef {Object} TextStyle\n * @property {number} ascent - Font ascent.\n * @property {number} descent - Font descent.\n * @property {boolean} vertical - Whether or not the text is in vertical mode.\n * @property {string} fontFamily - The possible font family.\n */\n\n/**\n * Page annotation parameters.\n *\n * @typedef {Object} GetAnnotationsParameters\n * @property {string} [intent] - Determines the annotations that are fetched,\n *   can be 'display' (viewable annotations), 'print' (printable annotations),\n *   or 'any' (all annotations). The default value is 'display'.\n */\n\n/**\n * Page render parameters.\n *\n * @typedef {Object} RenderParameters\n * @property {CanvasRenderingContext2D} canvasContext - A 2D context of a DOM\n *   Canvas object.\n * @property {PageViewport} viewport - Rendering viewport obtained by calling\n *   the `PDFPageProxy.getViewport` method.\n * @property {string} [intent] - Rendering intent, can be 'display', 'print',\n *   or 'any'. The default value is 'display'.\n * @property {number} [annotationMode] Controls which annotations are rendered\n *   onto the canvas, for annotations with appearance-data; the values from\n *   {@link AnnotationMode} should be used. The following values are supported:\n *    - `AnnotationMode.DISABLE`, which disables all annotations.\n *    - `AnnotationMode.ENABLE`, which includes all possible annotations (thus\n *      it also depends on the `intent`-option, see above).\n *    - `AnnotationMode.ENABLE_FORMS`, which excludes annotations that contain\n *      interactive form elements (those will be rendered in the display layer).\n *    - `AnnotationMode.ENABLE_STORAGE`, which includes all possible annotations\n *      (as above) but where interactive form elements are updated with data\n *      from the {@link AnnotationStorage}-instance; useful e.g. for printing.\n *   The default value is `AnnotationMode.ENABLE`.\n * @property {Array<any>} [transform] - Additional transform, applied just\n *   before viewport transform.\n * @property {CanvasGradient | CanvasPattern | string} [background] - Background\n *   to use for the canvas.\n *   Any valid `canvas.fillStyle` can be used: a `DOMString` parsed as CSS\n *   <color> value, a `CanvasGradient` object (a linear or radial gradient) or\n *   a `CanvasPattern` object (a repetitive image). The default value is\n *   'rgb(255,255,255)'.\n *\n *   NOTE: This option may be partially, or completely, ignored when the\n *   `pageColors`-option is used.\n * @property {Object} [pageColors] - Overwrites background and foreground colors\n *   with user defined ones in order to improve readability in high contrast\n *   mode.\n * @property {Promise<OptionalContentConfig>} [optionalContentConfigPromise] -\n *   A promise that should resolve with an {@link OptionalContentConfig}\n *   created from `PDFDocumentProxy.getOptionalContentConfig`. If `null`,\n *   the configuration will be fetched automatically with the default visibility\n *   states set.\n * @property {Map<string, HTMLCanvasElement>} [annotationCanvasMap] - Map some\n *   annotation ids with canvases used to render them.\n * @property {PrintAnnotationStorage} [printAnnotationStorage]\n */\n\n/**\n * Page getOperatorList parameters.\n *\n * @typedef {Object} GetOperatorListParameters\n * @property {string} [intent] - Rendering intent, can be 'display', 'print',\n *   or 'any'. The default value is 'display'.\n * @property {number} [annotationMode] Controls which annotations are included\n *   in the operatorList, for annotations with appearance-data; the values from\n *   {@link AnnotationMode} should be used. The following values are supported:\n *    - `AnnotationMode.DISABLE`, which disables all annotations.\n *    - `AnnotationMode.ENABLE`, which includes all possible annotations (thus\n *      it also depends on the `intent`-option, see above).\n *    - `AnnotationMode.ENABLE_FORMS`, which excludes annotations that contain\n *      interactive form elements (those will be rendered in the display layer).\n *    - `AnnotationMode.ENABLE_STORAGE`, which includes all possible annotations\n *      (as above) but where interactive form elements are updated with data\n *      from the {@link AnnotationStorage}-instance; useful e.g. for printing.\n *   The default value is `AnnotationMode.ENABLE`.\n * @property {PrintAnnotationStorage} [printAnnotationStorage]\n */\n\n/**\n * Structure tree node. The root node will have a role \"Root\".\n *\n * @typedef {Object} StructTreeNode\n * @property {Array<StructTreeNode | StructTreeContent>} children - Array of\n *   {@link StructTreeNode} and {@link StructTreeContent} objects.\n * @property {string} role - element's role, already mapped if a role map exists\n * in the PDF.\n */\n\n/**\n * Structure tree content.\n *\n * @typedef {Object} StructTreeContent\n * @property {string} type - either \"content\" for page and stream structure\n *   elements or \"object\" for object references.\n * @property {string} id - unique id that will map to the text layer.\n */\n\n/**\n * PDF page operator list.\n *\n * @typedef {Object} PDFOperatorList\n * @property {Array<number>} fnArray - Array containing the operator functions.\n * @property {Array<any>} argsArray - Array containing the arguments of the\n *   functions.\n */\n\n/**\n * Proxy to a `PDFPage` in the worker thread.\n */\nclass PDFPageProxy {\n  #delayedCleanupTimeout = null;\n\n  #pendingCleanup = false;\n\n  constructor(pageIndex, pageInfo, transport, pdfBug = false) {\n    this._pageIndex = pageIndex;\n    this._pageInfo = pageInfo;\n    this._transport = transport;\n    this._stats = pdfBug ? new StatTimer() : null;\n    this._pdfBug = pdfBug;\n    /** @type {PDFObjects} */\n    this.commonObjs = transport.commonObjs;\n    this.objs = new PDFObjects();\n\n    this._maybeCleanupAfterRender = false;\n    this._intentStates = new Map();\n    this.destroyed = false;\n  }\n\n  /**\n   * @type {number} Page number of the page. First page is 1.\n   */\n  get pageNumber() {\n    return this._pageIndex + 1;\n  }\n\n  /**\n   * @type {number} The number of degrees the page is rotated clockwise.\n   */\n  get rotate() {\n    return this._pageInfo.rotate;\n  }\n\n  /**\n   * @type {RefProxy | null} The reference that points to this page.\n   */\n  get ref() {\n    return this._pageInfo.ref;\n  }\n\n  /**\n   * @type {number} The default size of units in 1/72nds of an inch.\n   */\n  get userUnit() {\n    return this._pageInfo.userUnit;\n  }\n\n  /**\n   * @type {Array<number>} An array of the visible portion of the PDF page in\n   *   user space units [x1, y1, x2, y2].\n   */\n  get view() {\n    return this._pageInfo.view;\n  }\n\n  /**\n   * @param {GetViewportParameters} params - Viewport parameters.\n   * @returns {PageViewport} Contains 'width' and 'height' properties\n   *   along with transforms required for rendering.\n   */\n  getViewport({\n    scale,\n    rotation = this.rotate,\n    offsetX = 0,\n    offsetY = 0,\n    dontFlip = false,\n  } = {}) {\n    return new PageViewport({\n      viewBox: this.view,\n      scale,\n      rotation,\n      offsetX,\n      offsetY,\n      dontFlip,\n    });\n  }\n\n  /**\n   * @param {GetAnnotationsParameters} params - Annotation parameters.\n   * @returns {Promise<Array<any>>} A promise that is resolved with an\n   *   {Array} of the annotation objects.\n   */\n  getAnnotations({ intent = \"display\" } = {}) {\n    const intentArgs = this._transport.getRenderingIntent(intent);\n\n    return this._transport.getAnnotations(\n      this._pageIndex,\n      intentArgs.renderingIntent\n    );\n  }\n\n  /**\n   * @returns {Promise<Object>} A promise that is resolved with an\n   *   {Object} with JS actions.\n   */\n  getJSActions() {\n    return this._transport.getPageJSActions(this._pageIndex);\n  }\n\n  /**\n   * @type {Object} The filter factory instance.\n   */\n  get filterFactory() {\n    return this._transport.filterFactory;\n  }\n\n  /**\n   * @type {boolean} True if only XFA form.\n   */\n  get isPureXfa() {\n    return shadow(this, \"isPureXfa\", !!this._transport._htmlForXfa);\n  }\n\n  /**\n   * @returns {Promise<Object | null>} A promise that is resolved with\n   *   an {Object} with a fake DOM object (a tree structure where elements\n   *   are {Object} with a name, attributes (class, style, ...), value and\n   *   children, very similar to a HTML DOM tree), or `null` if no XFA exists.\n   */\n  async getXfa() {\n    return this._transport._htmlForXfa?.children[this._pageIndex] || null;\n  }\n\n  /**\n   * Begins the process of rendering a page to the desired context.\n   *\n   * @param {RenderParameters} params - Page render parameters.\n   * @returns {RenderTask} An object that contains a promise that is\n   *   resolved when the page finishes rendering.\n   */\n  render({\n    canvasContext,\n    viewport,\n    intent = \"display\",\n    annotationMode = AnnotationMode.ENABLE,\n    transform = null,\n    background = null,\n    optionalContentConfigPromise = null,\n    annotationCanvasMap = null,\n    pageColors = null,\n    printAnnotationStorage = null,\n  }) {\n    this._stats?.time(\"Overall\");\n\n    const intentArgs = this._transport.getRenderingIntent(\n      intent,\n      annotationMode,\n      printAnnotationStorage\n    );\n    // If there was a pending destroy, cancel it so no cleanup happens during\n    // this call to render...\n    this.#pendingCleanup = false;\n    // ... and ensure that a delayed cleanup is always aborted.\n    this.#abortDelayedCleanup();\n\n    if (!optionalContentConfigPromise) {\n      optionalContentConfigPromise = this._transport.getOptionalContentConfig();\n    }\n\n    let intentState = this._intentStates.get(intentArgs.cacheKey);\n    if (!intentState) {\n      intentState = Object.create(null);\n      this._intentStates.set(intentArgs.cacheKey, intentState);\n    }\n\n    // Ensure that a pending `streamReader` cancel timeout is always aborted.\n    if (intentState.streamReaderCancelTimeout) {\n      clearTimeout(intentState.streamReaderCancelTimeout);\n      intentState.streamReaderCancelTimeout = null;\n    }\n\n    const intentPrint = !!(\n      intentArgs.renderingIntent & RenderingIntentFlag.PRINT\n    );\n\n    // If there's no displayReadyCapability yet, then the operatorList\n    // was never requested before. Make the request and create the promise.\n    if (!intentState.displayReadyCapability) {\n      intentState.displayReadyCapability = new PromiseCapability();\n      intentState.operatorList = {\n        fnArray: [],\n        argsArray: [],\n        lastChunk: false,\n        separateAnnots: null,\n      };\n\n      this._stats?.time(\"Page Request\");\n      this._pumpOperatorList(intentArgs);\n    }\n\n    const complete = error => {\n      intentState.renderTasks.delete(internalRenderTask);\n\n      // Attempt to reduce memory usage during *printing*, by always running\n      // cleanup immediately once rendering has finished.\n      if (this._maybeCleanupAfterRender || intentPrint) {\n        this.#pendingCleanup = true;\n      }\n      this.#tryCleanup(/* delayed = */ !intentPrint);\n\n      if (error) {\n        internalRenderTask.capability.reject(error);\n\n        this._abortOperatorList({\n          intentState,\n          reason: error instanceof Error ? error : new Error(error),\n        });\n      } else {\n        internalRenderTask.capability.resolve();\n      }\n\n      this._stats?.timeEnd(\"Rendering\");\n      this._stats?.timeEnd(\"Overall\");\n    };\n\n    const internalRenderTask = new InternalRenderTask({\n      callback: complete,\n      // Only include the required properties, and *not* the entire object.\n      params: {\n        canvasContext,\n        viewport,\n        transform,\n        background,\n      },\n      objs: this.objs,\n      commonObjs: this.commonObjs,\n      annotationCanvasMap,\n      operatorList: intentState.operatorList,\n      pageIndex: this._pageIndex,\n      canvasFactory: this._transport.canvasFactory,\n      filterFactory: this._transport.filterFactory,\n      useRequestAnimationFrame: !intentPrint,\n      pdfBug: this._pdfBug,\n      pageColors,\n    });\n\n    (intentState.renderTasks ||= new Set()).add(internalRenderTask);\n    const renderTask = internalRenderTask.task;\n\n    Promise.all([\n      intentState.displayReadyCapability.promise,\n      optionalContentConfigPromise,\n    ])\n      .then(([transparency, optionalContentConfig]) => {\n        if (this.destroyed) {\n          complete();\n          return;\n        }\n        this._stats?.time(\"Rendering\");\n\n        internalRenderTask.initializeGraphics({\n          transparency,\n          optionalContentConfig,\n        });\n        internalRenderTask.operatorListChanged();\n      })\n      .catch(complete);\n\n    return renderTask;\n  }\n\n  /**\n   * @param {GetOperatorListParameters} params - Page getOperatorList\n   *   parameters.\n   * @returns {Promise<PDFOperatorList>} A promise resolved with an\n   *   {@link PDFOperatorList} object that represents the page's operator list.\n   */\n  getOperatorList({\n    intent = \"display\",\n    annotationMode = AnnotationMode.ENABLE,\n    printAnnotationStorage = null,\n  } = {}) {\n    if (typeof PDFJSDev !== \"undefined\" && !PDFJSDev.test(\"GENERIC\")) {\n      throw new Error(\"Not implemented: getOperatorList\");\n    }\n    function operatorListChanged() {\n      if (intentState.operatorList.lastChunk) {\n        intentState.opListReadCapability.resolve(intentState.operatorList);\n\n        intentState.renderTasks.delete(opListTask);\n      }\n    }\n\n    const intentArgs = this._transport.getRenderingIntent(\n      intent,\n      annotationMode,\n      printAnnotationStorage,\n      /* isOpList = */ true\n    );\n    let intentState = this._intentStates.get(intentArgs.cacheKey);\n    if (!intentState) {\n      intentState = Object.create(null);\n      this._intentStates.set(intentArgs.cacheKey, intentState);\n    }\n    let opListTask;\n\n    if (!intentState.opListReadCapability) {\n      opListTask = Object.create(null);\n      opListTask.operatorListChanged = operatorListChanged;\n      intentState.opListReadCapability = new PromiseCapability();\n      (intentState.renderTasks ||= new Set()).add(opListTask);\n      intentState.operatorList = {\n        fnArray: [],\n        argsArray: [],\n        lastChunk: false,\n        separateAnnots: null,\n      };\n\n      this._stats?.time(\"Page Request\");\n      this._pumpOperatorList(intentArgs);\n    }\n    return intentState.opListReadCapability.promise;\n  }\n\n  /**\n   * NOTE: All occurrences of whitespace will be replaced by\n   * standard spaces (0x20).\n   *\n   * @param {getTextContentParameters} params - getTextContent parameters.\n   * @returns {ReadableStream} Stream for reading text content chunks.\n   */\n  streamTextContent({\n    includeMarkedContent = false,\n    disableNormalization = false,\n  } = {}) {\n    const TEXT_CONTENT_CHUNK_SIZE = 100;\n\n    return this._transport.messageHandler.sendWithStream(\n      \"GetTextContent\",\n      {\n        pageIndex: this._pageIndex,\n        includeMarkedContent: includeMarkedContent === true,\n        disableNormalization: disableNormalization === true,\n      },\n      {\n        highWaterMark: TEXT_CONTENT_CHUNK_SIZE,\n        size(textContent) {\n          return textContent.items.length;\n        },\n      }\n    );\n  }\n\n  /**\n   * NOTE: All occurrences of whitespace will be replaced by\n   * standard spaces (0x20).\n   *\n   * @param {getTextContentParameters} params - getTextContent parameters.\n   * @returns {Promise<TextContent>} A promise that is resolved with a\n   *   {@link TextContent} object that represents the page's text content.\n   */\n  getTextContent(params = {}) {\n    if (this._transport._htmlForXfa) {\n      // TODO: We need to revisit this once the XFA foreground patch lands and\n      // only do this for non-foreground XFA.\n      return this.getXfa().then(xfa => {\n        return XfaText.textContent(xfa);\n      });\n    }\n    const readableStream = this.streamTextContent(params);\n\n    return new Promise(function (resolve, reject) {\n      function pump() {\n        reader.read().then(function ({ value, done }) {\n          if (done) {\n            resolve(textContent);\n            return;\n          }\n          Object.assign(textContent.styles, value.styles);\n          textContent.items.push(...value.items);\n          pump();\n        }, reject);\n      }\n\n      const reader = readableStream.getReader();\n      const textContent = {\n        items: [],\n        styles: Object.create(null),\n      };\n      pump();\n    });\n  }\n\n  /**\n   * @returns {Promise<StructTreeNode>} A promise that is resolved with a\n   *   {@link StructTreeNode} object that represents the page's structure tree,\n   *   or `null` when no structure tree is present for the current page.\n   */\n  getStructTree() {\n    return this._transport.getStructTree(this._pageIndex);\n  }\n\n  /**\n   * Destroys the page object.\n   * @private\n   */\n  _destroy() {\n    this.destroyed = true;\n\n    const waitOn = [];\n    for (const intentState of this._intentStates.values()) {\n      this._abortOperatorList({\n        intentState,\n        reason: new Error(\"Page was destroyed.\"),\n        force: true,\n      });\n\n      if (intentState.opListReadCapability) {\n        // Avoid errors below, since the renderTasks are just stubs.\n        continue;\n      }\n      for (const internalRenderTask of intentState.renderTasks) {\n        waitOn.push(internalRenderTask.completed);\n        internalRenderTask.cancel();\n      }\n    }\n    this.objs.clear();\n    this.#pendingCleanup = false;\n    this.#abortDelayedCleanup();\n\n    return Promise.all(waitOn);\n  }\n\n  /**\n   * Cleans up resources allocated by the page.\n   *\n   * @param {boolean} [resetStats] - Reset page stats, if enabled.\n   *   The default value is `false`.\n   * @returns {boolean} Indicates if clean-up was successfully run.\n   */\n  cleanup(resetStats = false) {\n    this.#pendingCleanup = true;\n    const success = this.#tryCleanup(/* delayed = */ false);\n\n    if (resetStats && success) {\n      this._stats &&= new StatTimer();\n    }\n    return success;\n  }\n\n  /**\n   * Attempts to clean up if rendering is in a state where that's possible.\n   * @param {boolean} [delayed] - Delay the cleanup, to e.g. improve zooming\n   *   performance in documents with large images.\n   *   The default value is `false`.\n   * @returns {boolean} Indicates if clean-up was successfully run.\n   */\n  #tryCleanup(delayed = false) {\n    this.#abortDelayedCleanup();\n\n    if (!this.#pendingCleanup || this.destroyed) {\n      return false;\n    }\n    if (delayed) {\n      this.#delayedCleanupTimeout = setTimeout(() => {\n        this.#delayedCleanupTimeout = null;\n        this.#tryCleanup(/* delayed = */ false);\n      }, DELAYED_CLEANUP_TIMEOUT);\n\n      return false;\n    }\n    for (const { renderTasks, operatorList } of this._intentStates.values()) {\n      if (renderTasks.size > 0 || !operatorList.lastChunk) {\n        return false;\n      }\n    }\n    this._intentStates.clear();\n    this.objs.clear();\n    this.#pendingCleanup = false;\n    return true;\n  }\n\n  #abortDelayedCleanup() {\n    if (this.#delayedCleanupTimeout) {\n      clearTimeout(this.#delayedCleanupTimeout);\n      this.#delayedCleanupTimeout = null;\n    }\n  }\n\n  /**\n   * @private\n   */\n  _startRenderPage(transparency, cacheKey) {\n    const intentState = this._intentStates.get(cacheKey);\n    if (!intentState) {\n      return; // Rendering was cancelled.\n    }\n    this._stats?.timeEnd(\"Page Request\");\n\n    // TODO Refactor RenderPageRequest to separate rendering\n    // and operator list logic\n    intentState.displayReadyCapability?.resolve(transparency);\n  }\n\n  /**\n   * @private\n   */\n  _renderPageChunk(operatorListChunk, intentState) {\n    // Add the new chunk to the current operator list.\n    for (let i = 0, ii = operatorListChunk.length; i < ii; i++) {\n      intentState.operatorList.fnArray.push(operatorListChunk.fnArray[i]);\n      intentState.operatorList.argsArray.push(operatorListChunk.argsArray[i]);\n    }\n    intentState.operatorList.lastChunk = operatorListChunk.lastChunk;\n    intentState.operatorList.separateAnnots = operatorListChunk.separateAnnots;\n\n    // Notify all the rendering tasks there are more operators to be consumed.\n    for (const internalRenderTask of intentState.renderTasks) {\n      internalRenderTask.operatorListChanged();\n    }\n\n    if (operatorListChunk.lastChunk) {\n      this.#tryCleanup(/* delayed = */ true);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _pumpOperatorList({\n    renderingIntent,\n    cacheKey,\n    annotationStorageSerializable,\n  }) {\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      assert(\n        Number.isInteger(renderingIntent) && renderingIntent > 0,\n        '_pumpOperatorList: Expected valid \"renderingIntent\" argument.'\n      );\n    }\n    const { map, transfer } = annotationStorageSerializable;\n\n    const readableStream = this._transport.messageHandler.sendWithStream(\n      \"GetOperatorList\",\n      {\n        pageIndex: this._pageIndex,\n        intent: renderingIntent,\n        cacheKey,\n        annotationStorage: map,\n      },\n      transfer\n    );\n    const reader = readableStream.getReader();\n\n    const intentState = this._intentStates.get(cacheKey);\n    intentState.streamReader = reader;\n\n    const pump = () => {\n      reader.read().then(\n        ({ value, done }) => {\n          if (done) {\n            intentState.streamReader = null;\n            return;\n          }\n          if (this._transport.destroyed) {\n            return; // Ignore any pending requests if the worker was terminated.\n          }\n          this._renderPageChunk(value, intentState);\n          pump();\n        },\n        reason => {\n          intentState.streamReader = null;\n\n          if (this._transport.destroyed) {\n            return; // Ignore any pending requests if the worker was terminated.\n          }\n          if (intentState.operatorList) {\n            // Mark operator list as complete.\n            intentState.operatorList.lastChunk = true;\n\n            for (const internalRenderTask of intentState.renderTasks) {\n              internalRenderTask.operatorListChanged();\n            }\n            this.#tryCleanup(/* delayed = */ true);\n          }\n\n          if (intentState.displayReadyCapability) {\n            intentState.displayReadyCapability.reject(reason);\n          } else if (intentState.opListReadCapability) {\n            intentState.opListReadCapability.reject(reason);\n          } else {\n            throw reason;\n          }\n        }\n      );\n    };\n    pump();\n  }\n\n  /**\n   * @private\n   */\n  _abortOperatorList({ intentState, reason, force = false }) {\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      assert(\n        reason instanceof Error,\n        '_abortOperatorList: Expected valid \"reason\" argument.'\n      );\n    }\n\n    if (!intentState.streamReader) {\n      return;\n    }\n    // Ensure that a pending `streamReader` cancel timeout is always aborted.\n    if (intentState.streamReaderCancelTimeout) {\n      clearTimeout(intentState.streamReaderCancelTimeout);\n      intentState.streamReaderCancelTimeout = null;\n    }\n\n    if (!force) {\n      // Ensure that an Error occurring in *only* one `InternalRenderTask`, e.g.\n      // multiple render() calls on the same canvas, won't break all rendering.\n      if (intentState.renderTasks.size > 0) {\n        return;\n      }\n      // Don't immediately abort parsing on the worker-thread when rendering is\n      // cancelled, since that will unnecessarily delay re-rendering when (for\n      // partially parsed pages) e.g. zooming/rotation occurs in the viewer.\n      if (reason instanceof RenderingCancelledException) {\n        let delay = RENDERING_CANCELLED_TIMEOUT;\n        if (reason.extraDelay > 0 && reason.extraDelay < /* ms = */ 1000) {\n          // Above, we prevent the total delay from becoming arbitrarily large.\n          delay += reason.extraDelay;\n        }\n\n        intentState.streamReaderCancelTimeout = setTimeout(() => {\n          intentState.streamReaderCancelTimeout = null;\n          this._abortOperatorList({ intentState, reason, force: true });\n        }, delay);\n        return;\n      }\n    }\n    intentState.streamReader\n      .cancel(new AbortException(reason.message))\n      .catch(() => {\n        // Avoid \"Uncaught promise\" messages in the console.\n      });\n    intentState.streamReader = null;\n\n    if (this._transport.destroyed) {\n      return; // Ignore any pending requests if the worker was terminated.\n    }\n    // Remove the current `intentState`, since a cancelled `getOperatorList`\n    // call on the worker-thread cannot be re-started...\n    for (const [curCacheKey, curIntentState] of this._intentStates) {\n      if (curIntentState === intentState) {\n        this._intentStates.delete(curCacheKey);\n        break;\n      }\n    }\n    // ... and force clean-up to ensure that any old state is always removed.\n    this.cleanup();\n  }\n\n  /**\n   * @type {StatTimer | null} Returns page stats, if enabled; returns `null`\n   *   otherwise.\n   */\n  get stats() {\n    return this._stats;\n  }\n}\n\nclass LoopbackPort {\n  #listeners = new Set();\n\n  #deferred = Promise.resolve();\n\n  postMessage(obj, transfer) {\n    const event = {\n      data: structuredClone(obj, transfer ? { transfer } : null),\n    };\n\n    this.#deferred.then(() => {\n      for (const listener of this.#listeners) {\n        listener.call(this, event);\n      }\n    });\n  }\n\n  addEventListener(name, listener) {\n    this.#listeners.add(listener);\n  }\n\n  removeEventListener(name, listener) {\n    this.#listeners.delete(listener);\n  }\n\n  terminate() {\n    this.#listeners.clear();\n  }\n}\n\n/**\n * @typedef {Object} PDFWorkerParameters\n * @property {string} [name] - The name of the worker.\n * @property {Worker} [port] - The `workerPort` object.\n * @property {number} [verbosity] - Controls the logging level;\n *   the constants from {@link VerbosityLevel} should be used.\n */\n\nconst PDFWorkerUtil = {\n  isWorkerDisabled: false,\n  fakeWorkerId: 0,\n};\nif (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n  if (isNodeJS) {\n    // Workers aren't supported in Node.js, force-disabling them there.\n    PDFWorkerUtil.isWorkerDisabled = true;\n\n    GlobalWorkerOptions.workerSrc ||= PDFJSDev.test(\"LIB\")\n      ? \"../pdf.worker.js\"\n      : \"./pdf.worker.mjs\";\n  }\n\n  // Check if URLs have the same origin. For non-HTTP based URLs, returns false.\n  PDFWorkerUtil.isSameOrigin = function (baseUrl, otherUrl) {\n    let base;\n    try {\n      base = new URL(baseUrl);\n      if (!base.origin || base.origin === \"null\") {\n        return false; // non-HTTP url\n      }\n    } catch {\n      return false;\n    }\n\n    const other = new URL(otherUrl, base);\n    return base.origin === other.origin;\n  };\n\n  PDFWorkerUtil.createCDNWrapper = function (url) {\n    // We will rely on blob URL's property to specify origin.\n    // We want this function to fail in case if createObjectURL or Blob do not\n    // exist or fail for some reason -- our Worker creation will fail anyway.\n    const wrapper = `await import(\"${url}\");`;\n    return URL.createObjectURL(\n      new Blob([wrapper], { type: \"text/javascript\" })\n    );\n  };\n}\n\n/**\n * PDF.js web worker abstraction that controls the instantiation of PDF\n * documents. Message handlers are used to pass information from the main\n * thread to the worker thread and vice versa. If the creation of a web\n * worker is not possible, a \"fake\" worker will be used instead.\n *\n * @param {PDFWorkerParameters} params - The worker initialization parameters.\n */\nclass PDFWorker {\n  static #workerPorts;\n\n  constructor({\n    name = null,\n    port = null,\n    verbosity = getVerbosityLevel(),\n  } = {}) {\n    this.name = name;\n    this.destroyed = false;\n    this.verbosity = verbosity;\n\n    this._readyCapability = new PromiseCapability();\n    this._port = null;\n    this._webWorker = null;\n    this._messageHandler = null;\n\n    if (\n      (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"MOZCENTRAL\")) &&\n      port\n    ) {\n      if (PDFWorker.#workerPorts?.has(port)) {\n        throw new Error(\"Cannot use more than one PDFWorker per port.\");\n      }\n      (PDFWorker.#workerPorts ||= new WeakMap()).set(port, this);\n      this._initializeFromPort(port);\n      return;\n    }\n    this._initialize();\n  }\n\n  /**\n   * Promise for worker initialization completion.\n   * @type {Promise<void>}\n   */\n  get promise() {\n    return this._readyCapability.promise;\n  }\n\n  /**\n   * The current `workerPort`, when it exists.\n   * @type {Worker}\n   */\n  get port() {\n    return this._port;\n  }\n\n  /**\n   * The current MessageHandler-instance.\n   * @type {MessageHandler}\n   */\n  get messageHandler() {\n    return this._messageHandler;\n  }\n\n  _initializeFromPort(port) {\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n      throw new Error(\"Not implemented: _initializeFromPort\");\n    }\n    this._port = port;\n    this._messageHandler = new MessageHandler(\"main\", \"worker\", port);\n    this._messageHandler.on(\"ready\", function () {\n      // Ignoring \"ready\" event -- MessageHandler should already be initialized\n      // and ready to accept messages.\n    });\n    this._readyCapability.resolve();\n    // Send global setting, e.g. verbosity level.\n    this._messageHandler.send(\"configure\", {\n      verbosity: this.verbosity,\n    });\n  }\n\n  _initialize() {\n    // If worker support isn't disabled explicit and the browser has worker\n    // support, create a new web worker and test if it/the browser fulfills\n    // all requirements to run parts of pdf.js in a web worker.\n    // Right now, the requirement is, that an Uint8Array is still an\n    // Uint8Array as it arrives on the worker. (Chrome added this with v.15.)\n    if (\n      !PDFWorkerUtil.isWorkerDisabled &&\n      !PDFWorker.#mainThreadWorkerMessageHandler\n    ) {\n      let { workerSrc } = PDFWorker;\n\n      try {\n        // Wraps workerSrc path into blob URL, if the former does not belong\n        // to the same origin.\n        if (\n          typeof PDFJSDev !== \"undefined\" &&\n          PDFJSDev.test(\"GENERIC\") &&\n          !PDFWorkerUtil.isSameOrigin(window.location.href, workerSrc)\n        ) {\n          workerSrc = PDFWorkerUtil.createCDNWrapper(\n            new URL(workerSrc, window.location).href\n          );\n        }\n\n        const worker = new Worker(workerSrc, { type: \"module\" });\n        const messageHandler = new MessageHandler(\"main\", \"worker\", worker);\n        const terminateEarly = () => {\n          worker.removeEventListener(\"error\", onWorkerError);\n          messageHandler.destroy();\n          worker.terminate();\n          if (this.destroyed) {\n            this._readyCapability.reject(new Error(\"Worker was destroyed\"));\n          } else {\n            // Fall back to fake worker if the termination is caused by an\n            // error (e.g. NetworkError / SecurityError).\n            this._setupFakeWorker();\n          }\n        };\n\n        const onWorkerError = () => {\n          if (!this._webWorker) {\n            // Worker failed to initialize due to an error. Clean up and fall\n            // back to the fake worker.\n            terminateEarly();\n          }\n        };\n        worker.addEventListener(\"error\", onWorkerError);\n\n        messageHandler.on(\"test\", data => {\n          worker.removeEventListener(\"error\", onWorkerError);\n          if (this.destroyed) {\n            terminateEarly();\n            return; // worker was destroyed\n          }\n          if (data) {\n            this._messageHandler = messageHandler;\n            this._port = worker;\n            this._webWorker = worker;\n\n            this._readyCapability.resolve();\n            // Send global setting, e.g. verbosity level.\n            messageHandler.send(\"configure\", {\n              verbosity: this.verbosity,\n            });\n          } else {\n            this._setupFakeWorker();\n            messageHandler.destroy();\n            worker.terminate();\n          }\n        });\n\n        messageHandler.on(\"ready\", data => {\n          worker.removeEventListener(\"error\", onWorkerError);\n          if (this.destroyed) {\n            terminateEarly();\n            return; // worker was destroyed\n          }\n          try {\n            sendTest();\n          } catch {\n            // We need fallback to a faked worker.\n            this._setupFakeWorker();\n          }\n        });\n\n        const sendTest = () => {\n          const testObj = new Uint8Array();\n          // Ensure that we can use `postMessage` transfers.\n          messageHandler.send(\"test\", testObj, [testObj.buffer]);\n        };\n\n        // It might take time for the worker to initialize. We will try to send\n        // the \"test\" message immediately, and once the \"ready\" message arrives.\n        // The worker shall process only the first received \"test\" message.\n        sendTest();\n        return;\n      } catch {\n        info(\"The worker has been disabled.\");\n      }\n    }\n    // Either workers are disabled, not supported or have thrown an exception.\n    // Thus, we fallback to a faked worker.\n    this._setupFakeWorker();\n  }\n\n  _setupFakeWorker() {\n    if (!PDFWorkerUtil.isWorkerDisabled) {\n      warn(\"Setting up fake worker.\");\n      PDFWorkerUtil.isWorkerDisabled = true;\n    }\n\n    PDFWorker._setupFakeWorkerGlobal\n      .then(WorkerMessageHandler => {\n        if (this.destroyed) {\n          this._readyCapability.reject(new Error(\"Worker was destroyed\"));\n          return;\n        }\n        const port = new LoopbackPort();\n        this._port = port;\n\n        // All fake workers use the same port, making id unique.\n        const id = `fake${PDFWorkerUtil.fakeWorkerId++}`;\n\n        // If the main thread is our worker, setup the handling for the\n        // messages -- the main thread sends to it self.\n        const workerHandler = new MessageHandler(id + \"_worker\", id, port);\n        WorkerMessageHandler.setup(workerHandler, port);\n\n        const messageHandler = new MessageHandler(id, id + \"_worker\", port);\n        this._messageHandler = messageHandler;\n        this._readyCapability.resolve();\n        // Send global setting, e.g. verbosity level.\n        messageHandler.send(\"configure\", {\n          verbosity: this.verbosity,\n        });\n      })\n      .catch(reason => {\n        this._readyCapability.reject(\n          new Error(`Setting up fake worker failed: \"${reason.message}\".`)\n        );\n      });\n  }\n\n  /**\n   * Destroys the worker instance.\n   */\n  destroy() {\n    this.destroyed = true;\n    if (this._webWorker) {\n      // We need to terminate only web worker created resource.\n      this._webWorker.terminate();\n      this._webWorker = null;\n    }\n    PDFWorker.#workerPorts?.delete(this._port);\n    this._port = null;\n    if (this._messageHandler) {\n      this._messageHandler.destroy();\n      this._messageHandler = null;\n    }\n  }\n\n  /**\n   * @param {PDFWorkerParameters} params - The worker initialization parameters.\n   */\n  static fromPort(params) {\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n      throw new Error(\"Not implemented: fromPort\");\n    }\n    if (!params?.port) {\n      throw new Error(\"PDFWorker.fromPort - invalid method signature.\");\n    }\n    const cachedPort = this.#workerPorts?.get(params.port);\n    if (cachedPort) {\n      if (cachedPort._pendingDestroy) {\n        throw new Error(\n          \"PDFWorker.fromPort - the worker is being destroyed.\\n\" +\n            \"Please remember to await `PDFDocumentLoadingTask.destroy()`-calls.\"\n        );\n      }\n      return cachedPort;\n    }\n    return new PDFWorker(params);\n  }\n\n  /**\n   * The current `workerSrc`, when it exists.\n   * @type {string}\n   */\n  static get workerSrc() {\n    if (GlobalWorkerOptions.workerSrc) {\n      return GlobalWorkerOptions.workerSrc;\n    }\n    throw new Error('No \"GlobalWorkerOptions.workerSrc\" specified.');\n  }\n\n  static get #mainThreadWorkerMessageHandler() {\n    try {\n      return globalThis.pdfjsWorker?.WorkerMessageHandler || null;\n    } catch {\n      return null;\n    }\n  }\n\n  // Loads worker code into the main-thread.\n  static get _setupFakeWorkerGlobal() {\n    const loader = async () => {\n      if (this.#mainThreadWorkerMessageHandler) {\n        // The worker was already loaded using e.g. a `<script>` tag.\n        return this.#mainThreadWorkerMessageHandler;\n      }\n      const worker =\n        typeof PDFJSDev === \"undefined\"\n          ? await import(\"pdfjs/pdf.worker.js\")\n          : await import(/* webpackIgnore: true */ this.workerSrc);\n      return worker.WorkerMessageHandler;\n    };\n\n    return shadow(this, \"_setupFakeWorkerGlobal\", loader());\n  }\n}\n\n/**\n * For internal use only.\n * @ignore\n */\nclass WorkerTransport {\n  #methodPromises = new Map();\n\n  #pageCache = new Map();\n\n  #pagePromises = new Map();\n\n  #passwordCapability = null;\n\n  constructor(messageHandler, loadingTask, networkStream, params, factory) {\n    this.messageHandler = messageHandler;\n    this.loadingTask = loadingTask;\n    this.commonObjs = new PDFObjects();\n    this.fontLoader = new FontLoader({\n      ownerDocument: params.ownerDocument,\n      styleElement: params.styleElement,\n    });\n    this._params = params;\n\n    this.canvasFactory = factory.canvasFactory;\n    this.filterFactory = factory.filterFactory;\n    this.cMapReaderFactory = factory.cMapReaderFactory;\n    this.standardFontDataFactory = factory.standardFontDataFactory;\n\n    this.destroyed = false;\n    this.destroyCapability = null;\n\n    this._networkStream = networkStream;\n    this._fullReader = null;\n    this._lastProgress = null;\n    this.downloadInfoCapability = new PromiseCapability();\n\n    this.setupMessageHandler();\n\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      // For testing purposes.\n      Object.defineProperty(this, \"getXFADatasets\", {\n        value: () => {\n          return this.messageHandler.sendWithPromise(\"GetXFADatasets\", null);\n        },\n      });\n      Object.defineProperty(this, \"getXRefPrevValue\", {\n        value: () => {\n          return this.messageHandler.sendWithPromise(\"GetXRefPrevValue\", null);\n        },\n      });\n      Object.defineProperty(this, \"getAnnotArray\", {\n        value: pageIndex => {\n          return this.messageHandler.sendWithPromise(\"GetAnnotArray\", {\n            pageIndex,\n          });\n        },\n      });\n    }\n  }\n\n  #cacheSimpleMethod(name, data = null) {\n    const cachedPromise = this.#methodPromises.get(name);\n    if (cachedPromise) {\n      return cachedPromise;\n    }\n    const promise = this.messageHandler.sendWithPromise(name, data);\n\n    this.#methodPromises.set(name, promise);\n    return promise;\n  }\n\n  get annotationStorage() {\n    return shadow(this, \"annotationStorage\", new AnnotationStorage());\n  }\n\n  getRenderingIntent(\n    intent,\n    annotationMode = AnnotationMode.ENABLE,\n    printAnnotationStorage = null,\n    isOpList = false\n  ) {\n    let renderingIntent = RenderingIntentFlag.DISPLAY; // Default value.\n    let annotationStorageSerializable = SerializableEmpty;\n\n    switch (intent) {\n      case \"any\":\n        renderingIntent = RenderingIntentFlag.ANY;\n        break;\n      case \"display\":\n        break;\n      case \"print\":\n        renderingIntent = RenderingIntentFlag.PRINT;\n        break;\n      default:\n        warn(`getRenderingIntent - invalid intent: ${intent}`);\n    }\n\n    switch (annotationMode) {\n      case AnnotationMode.DISABLE:\n        renderingIntent += RenderingIntentFlag.ANNOTATIONS_DISABLE;\n        break;\n      case AnnotationMode.ENABLE:\n        break;\n      case AnnotationMode.ENABLE_FORMS:\n        renderingIntent += RenderingIntentFlag.ANNOTATIONS_FORMS;\n        break;\n      case AnnotationMode.ENABLE_STORAGE:\n        renderingIntent += RenderingIntentFlag.ANNOTATIONS_STORAGE;\n\n        const annotationStorage =\n          renderingIntent & RenderingIntentFlag.PRINT &&\n          printAnnotationStorage instanceof PrintAnnotationStorage\n            ? printAnnotationStorage\n            : this.annotationStorage;\n\n        annotationStorageSerializable = annotationStorage.serializable;\n        break;\n      default:\n        warn(`getRenderingIntent - invalid annotationMode: ${annotationMode}`);\n    }\n\n    if (isOpList) {\n      renderingIntent += RenderingIntentFlag.OPLIST;\n    }\n\n    return {\n      renderingIntent,\n      cacheKey: `${renderingIntent}_${annotationStorageSerializable.hash}`,\n      annotationStorageSerializable,\n    };\n  }\n\n  destroy() {\n    if (this.destroyCapability) {\n      return this.destroyCapability.promise;\n    }\n\n    this.destroyed = true;\n    this.destroyCapability = new PromiseCapability();\n\n    this.#passwordCapability?.reject(\n      new Error(\"Worker was destroyed during onPassword callback\")\n    );\n\n    const waitOn = [];\n    // We need to wait for all renderings to be completed, e.g.\n    // timeout/rAF can take a long time.\n    for (const page of this.#pageCache.values()) {\n      waitOn.push(page._destroy());\n    }\n    this.#pageCache.clear();\n    this.#pagePromises.clear();\n    // Allow `AnnotationStorage`-related clean-up when destroying the document.\n    if (this.hasOwnProperty(\"annotationStorage\")) {\n      this.annotationStorage.resetModified();\n    }\n    // We also need to wait for the worker to finish its long running tasks.\n    const terminated = this.messageHandler.sendWithPromise(\"Terminate\", null);\n    waitOn.push(terminated);\n\n    Promise.all(waitOn).then(() => {\n      this.commonObjs.clear();\n      this.fontLoader.clear();\n      this.#methodPromises.clear();\n      this.filterFactory.destroy();\n\n      this._networkStream?.cancelAllRequests(\n        new AbortException(\"Worker was terminated.\")\n      );\n\n      if (this.messageHandler) {\n        this.messageHandler.destroy();\n        this.messageHandler = null;\n      }\n      this.destroyCapability.resolve();\n    }, this.destroyCapability.reject);\n    return this.destroyCapability.promise;\n  }\n\n  setupMessageHandler() {\n    const { messageHandler, loadingTask } = this;\n\n    messageHandler.on(\"GetReader\", (data, sink) => {\n      assert(\n        this._networkStream,\n        \"GetReader - no `IPDFStream` instance available.\"\n      );\n      this._fullReader = this._networkStream.getFullReader();\n      this._fullReader.onProgress = evt => {\n        this._lastProgress = {\n          loaded: evt.loaded,\n          total: evt.total,\n        };\n      };\n      sink.onPull = () => {\n        this._fullReader\n          .read()\n          .then(function ({ value, done }) {\n            if (done) {\n              sink.close();\n              return;\n            }\n            assert(\n              value instanceof ArrayBuffer,\n              \"GetReader - expected an ArrayBuffer.\"\n            );\n            // Enqueue data chunk into sink, and transfer it\n            // to other side as `Transferable` object.\n            sink.enqueue(new Uint8Array(value), 1, [value]);\n          })\n          .catch(reason => {\n            sink.error(reason);\n          });\n      };\n\n      sink.onCancel = reason => {\n        this._fullReader.cancel(reason);\n\n        sink.ready.catch(readyReason => {\n          if (this.destroyed) {\n            return; // Ignore any pending requests if the worker was terminated.\n          }\n          throw readyReason;\n        });\n      };\n    });\n\n    messageHandler.on(\"ReaderHeadersReady\", data => {\n      const headersCapability = new PromiseCapability();\n      const fullReader = this._fullReader;\n      fullReader.headersReady.then(() => {\n        // If stream or range are disabled, it's our only way to report\n        // loading progress.\n        if (!fullReader.isStreamingSupported || !fullReader.isRangeSupported) {\n          if (this._lastProgress) {\n            loadingTask.onProgress?.(this._lastProgress);\n          }\n          fullReader.onProgress = evt => {\n            loadingTask.onProgress?.({\n              loaded: evt.loaded,\n              total: evt.total,\n            });\n          };\n        }\n\n        headersCapability.resolve({\n          isStreamingSupported: fullReader.isStreamingSupported,\n          isRangeSupported: fullReader.isRangeSupported,\n          contentLength: fullReader.contentLength,\n        });\n      }, headersCapability.reject);\n\n      return headersCapability.promise;\n    });\n\n    messageHandler.on(\"GetRangeReader\", (data, sink) => {\n      assert(\n        this._networkStream,\n        \"GetRangeReader - no `IPDFStream` instance available.\"\n      );\n      const rangeReader = this._networkStream.getRangeReader(\n        data.begin,\n        data.end\n      );\n\n      // When streaming is enabled, it's possible that the data requested here\n      // has already been fetched via the `_fullRequestReader` implementation.\n      // However, given that the PDF data is loaded asynchronously on the\n      // main-thread and then sent via `postMessage` to the worker-thread,\n      // it may not have been available during parsing (hence the attempt to\n      // use range requests here).\n      //\n      // To avoid wasting time and resources here, we'll thus *not* dispatch\n      // range requests if the data was already loaded but has not been sent to\n      // the worker-thread yet (which will happen via the `_fullRequestReader`).\n      if (!rangeReader) {\n        sink.close();\n        return;\n      }\n\n      sink.onPull = () => {\n        rangeReader\n          .read()\n          .then(function ({ value, done }) {\n            if (done) {\n              sink.close();\n              return;\n            }\n            assert(\n              value instanceof ArrayBuffer,\n              \"GetRangeReader - expected an ArrayBuffer.\"\n            );\n            sink.enqueue(new Uint8Array(value), 1, [value]);\n          })\n          .catch(reason => {\n            sink.error(reason);\n          });\n      };\n\n      sink.onCancel = reason => {\n        rangeReader.cancel(reason);\n\n        sink.ready.catch(readyReason => {\n          if (this.destroyed) {\n            return; // Ignore any pending requests if the worker was terminated.\n          }\n          throw readyReason;\n        });\n      };\n    });\n\n    messageHandler.on(\"GetDoc\", ({ pdfInfo }) => {\n      this._numPages = pdfInfo.numPages;\n      this._htmlForXfa = pdfInfo.htmlForXfa;\n      delete pdfInfo.htmlForXfa;\n      loadingTask._capability.resolve(new PDFDocumentProxy(pdfInfo, this));\n    });\n\n    messageHandler.on(\"DocException\", function (ex) {\n      let reason;\n      switch (ex.name) {\n        case \"PasswordException\":\n          reason = new PasswordException(ex.message, ex.code);\n          break;\n        case \"InvalidPDFException\":\n          reason = new InvalidPDFException(ex.message);\n          break;\n        case \"MissingPDFException\":\n          reason = new MissingPDFException(ex.message);\n          break;\n        case \"UnexpectedResponseException\":\n          reason = new UnexpectedResponseException(ex.message, ex.status);\n          break;\n        case \"UnknownErrorException\":\n          reason = new UnknownErrorException(ex.message, ex.details);\n          break;\n        default:\n          unreachable(\"DocException - expected a valid Error.\");\n      }\n      loadingTask._capability.reject(reason);\n    });\n\n    messageHandler.on(\"PasswordRequest\", exception => {\n      this.#passwordCapability = new PromiseCapability();\n\n      if (loadingTask.onPassword) {\n        const updatePassword = password => {\n          if (password instanceof Error) {\n            this.#passwordCapability.reject(password);\n          } else {\n            this.#passwordCapability.resolve({ password });\n          }\n        };\n        try {\n          loadingTask.onPassword(updatePassword, exception.code);\n        } catch (ex) {\n          this.#passwordCapability.reject(ex);\n        }\n      } else {\n        this.#passwordCapability.reject(\n          new PasswordException(exception.message, exception.code)\n        );\n      }\n      return this.#passwordCapability.promise;\n    });\n\n    messageHandler.on(\"DataLoaded\", data => {\n      // For consistency: Ensure that progress is always reported when the\n      // entire PDF file has been loaded, regardless of how it was fetched.\n      loadingTask.onProgress?.({\n        loaded: data.length,\n        total: data.length,\n      });\n\n      this.downloadInfoCapability.resolve(data);\n    });\n\n    messageHandler.on(\"StartRenderPage\", data => {\n      if (this.destroyed) {\n        return; // Ignore any pending requests if the worker was terminated.\n      }\n\n      const page = this.#pageCache.get(data.pageIndex);\n      page._startRenderPage(data.transparency, data.cacheKey);\n    });\n\n    messageHandler.on(\"commonobj\", ([id, type, exportedData]) => {\n      if (this.destroyed) {\n        return; // Ignore any pending requests if the worker was terminated.\n      }\n\n      if (this.commonObjs.has(id)) {\n        return;\n      }\n\n      switch (type) {\n        case \"Font\":\n          const params = this._params;\n\n          if (\"error\" in exportedData) {\n            const exportedError = exportedData.error;\n            warn(`Error during font loading: ${exportedError}`);\n            this.commonObjs.resolve(id, exportedError);\n            break;\n          }\n\n          const inspectFont =\n            params.pdfBug && globalThis.FontInspector?.enabled\n              ? (font, url) => globalThis.FontInspector.fontAdded(font, url)\n              : null;\n          const font = new FontFaceObject(exportedData, {\n            isEvalSupported: params.isEvalSupported,\n            disableFontFace: params.disableFontFace,\n            ignoreErrors: params.ignoreErrors,\n            inspectFont,\n          });\n\n          this.fontLoader\n            .bind(font)\n            .catch(reason => {\n              return messageHandler.sendWithPromise(\"FontFallback\", { id });\n            })\n            .finally(() => {\n              if (!params.fontExtraProperties && font.data) {\n                // Immediately release the `font.data` property once the font\n                // has been attached to the DOM, since it's no longer needed,\n                // rather than waiting for a `PDFDocumentProxy.cleanup` call.\n                // Since `font.data` could be very large, e.g. in some cases\n                // multiple megabytes, this will help reduce memory usage.\n                font.data = null;\n              }\n              this.commonObjs.resolve(id, font);\n            });\n          break;\n        case \"FontPath\":\n        case \"Image\":\n        case \"Pattern\":\n          this.commonObjs.resolve(id, exportedData);\n          break;\n        default:\n          throw new Error(`Got unknown common object type ${type}`);\n      }\n    });\n\n    messageHandler.on(\"obj\", ([id, pageIndex, type, imageData]) => {\n      if (this.destroyed) {\n        // Ignore any pending requests if the worker was terminated.\n        return;\n      }\n\n      const pageProxy = this.#pageCache.get(pageIndex);\n      if (pageProxy.objs.has(id)) {\n        return;\n      }\n      // Don't store data *after* cleanup has successfully run, see bug 1854145.\n      if (pageProxy._intentStates.size === 0) {\n        imageData?.bitmap?.close(); // Release any `ImageBitmap` data.\n        return;\n      }\n\n      switch (type) {\n        case \"Image\":\n          pageProxy.objs.resolve(id, imageData);\n\n          // Heuristic that will allow us not to store large data.\n          if (imageData) {\n            let length;\n            if (imageData.bitmap) {\n              const { width, height } = imageData;\n              length = width * height * 4;\n            } else {\n              length = imageData.data?.length || 0;\n            }\n\n            if (length > MAX_IMAGE_SIZE_TO_CACHE) {\n              pageProxy._maybeCleanupAfterRender = true;\n            }\n          }\n          break;\n        case \"Pattern\":\n          pageProxy.objs.resolve(id, imageData);\n          break;\n        default:\n          throw new Error(`Got unknown object type ${type}`);\n      }\n    });\n\n    messageHandler.on(\"DocProgress\", data => {\n      if (this.destroyed) {\n        return; // Ignore any pending requests if the worker was terminated.\n      }\n      loadingTask.onProgress?.({\n        loaded: data.loaded,\n        total: data.total,\n      });\n    });\n\n    messageHandler.on(\"FetchBuiltInCMap\", data => {\n      if (this.destroyed) {\n        return Promise.reject(new Error(\"Worker was destroyed.\"));\n      }\n      if (!this.cMapReaderFactory) {\n        return Promise.reject(\n          new Error(\n            \"CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.\"\n          )\n        );\n      }\n      return this.cMapReaderFactory.fetch(data);\n    });\n\n    messageHandler.on(\"FetchStandardFontData\", data => {\n      if (this.destroyed) {\n        return Promise.reject(new Error(\"Worker was destroyed.\"));\n      }\n      if (!this.standardFontDataFactory) {\n        return Promise.reject(\n          new Error(\n            \"StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.\"\n          )\n        );\n      }\n      return this.standardFontDataFactory.fetch(data);\n    });\n  }\n\n  getData() {\n    return this.messageHandler.sendWithPromise(\"GetData\", null);\n  }\n\n  saveDocument() {\n    if (this.annotationStorage.size <= 0) {\n      warn(\n        \"saveDocument called while `annotationStorage` is empty, \" +\n          \"please use the getData-method instead.\"\n      );\n    }\n    const { map, transfer } = this.annotationStorage.serializable;\n\n    return this.messageHandler\n      .sendWithPromise(\n        \"SaveDocument\",\n        {\n          isPureXfa: !!this._htmlForXfa,\n          numPages: this._numPages,\n          annotationStorage: map,\n          filename: this._fullReader?.filename ?? null,\n        },\n        transfer\n      )\n      .finally(() => {\n        this.annotationStorage.resetModified();\n      });\n  }\n\n  getPage(pageNumber) {\n    if (\n      !Number.isInteger(pageNumber) ||\n      pageNumber <= 0 ||\n      pageNumber > this._numPages\n    ) {\n      return Promise.reject(new Error(\"Invalid page request.\"));\n    }\n\n    const pageIndex = pageNumber - 1,\n      cachedPromise = this.#pagePromises.get(pageIndex);\n    if (cachedPromise) {\n      return cachedPromise;\n    }\n    const promise = this.messageHandler\n      .sendWithPromise(\"GetPage\", {\n        pageIndex,\n      })\n      .then(pageInfo => {\n        if (this.destroyed) {\n          throw new Error(\"Transport destroyed\");\n        }\n        const page = new PDFPageProxy(\n          pageIndex,\n          pageInfo,\n          this,\n          this._params.pdfBug\n        );\n        this.#pageCache.set(pageIndex, page);\n        return page;\n      });\n    this.#pagePromises.set(pageIndex, promise);\n    return promise;\n  }\n\n  getPageIndex(ref) {\n    if (\n      typeof ref !== \"object\" ||\n      ref === null ||\n      !Number.isInteger(ref.num) ||\n      ref.num < 0 ||\n      !Number.isInteger(ref.gen) ||\n      ref.gen < 0\n    ) {\n      return Promise.reject(new Error(\"Invalid pageIndex request.\"));\n    }\n    return this.messageHandler.sendWithPromise(\"GetPageIndex\", {\n      num: ref.num,\n      gen: ref.gen,\n    });\n  }\n\n  getAnnotations(pageIndex, intent) {\n    return this.messageHandler.sendWithPromise(\"GetAnnotations\", {\n      pageIndex,\n      intent,\n    });\n  }\n\n  getFieldObjects() {\n    return this.#cacheSimpleMethod(\"GetFieldObjects\");\n  }\n\n  hasJSActions() {\n    return this.#cacheSimpleMethod(\"HasJSActions\");\n  }\n\n  getCalculationOrderIds() {\n    return this.messageHandler.sendWithPromise(\"GetCalculationOrderIds\", null);\n  }\n\n  getDestinations() {\n    return this.messageHandler.sendWithPromise(\"GetDestinations\", null);\n  }\n\n  getDestination(id) {\n    if (typeof id !== \"string\") {\n      return Promise.reject(new Error(\"Invalid destination request.\"));\n    }\n    return this.messageHandler.sendWithPromise(\"GetDestination\", {\n      id,\n    });\n  }\n\n  getPageLabels() {\n    return this.messageHandler.sendWithPromise(\"GetPageLabels\", null);\n  }\n\n  getPageLayout() {\n    return this.messageHandler.sendWithPromise(\"GetPageLayout\", null);\n  }\n\n  getPageMode() {\n    return this.messageHandler.sendWithPromise(\"GetPageMode\", null);\n  }\n\n  getViewerPreferences() {\n    return this.messageHandler.sendWithPromise(\"GetViewerPreferences\", null);\n  }\n\n  getOpenAction() {\n    return this.messageHandler.sendWithPromise(\"GetOpenAction\", null);\n  }\n\n  getAttachments() {\n    return this.messageHandler.sendWithPromise(\"GetAttachments\", null);\n  }\n\n  getDocJSActions() {\n    return this.#cacheSimpleMethod(\"GetDocJSActions\");\n  }\n\n  getPageJSActions(pageIndex) {\n    return this.messageHandler.sendWithPromise(\"GetPageJSActions\", {\n      pageIndex,\n    });\n  }\n\n  getStructTree(pageIndex) {\n    return this.messageHandler.sendWithPromise(\"GetStructTree\", {\n      pageIndex,\n    });\n  }\n\n  getOutline() {\n    return this.messageHandler.sendWithPromise(\"GetOutline\", null);\n  }\n\n  getOptionalContentConfig() {\n    return this.messageHandler\n      .sendWithPromise(\"GetOptionalContentConfig\", null)\n      .then(results => {\n        return new OptionalContentConfig(results);\n      });\n  }\n\n  getPermissions() {\n    return this.messageHandler.sendWithPromise(\"GetPermissions\", null);\n  }\n\n  getMetadata() {\n    const name = \"GetMetadata\",\n      cachedPromise = this.#methodPromises.get(name);\n    if (cachedPromise) {\n      return cachedPromise;\n    }\n    const promise = this.messageHandler\n      .sendWithPromise(name, null)\n      .then(results => {\n        return {\n          info: results[0],\n          metadata: results[1] ? new Metadata(results[1]) : null,\n          contentDispositionFilename: this._fullReader?.filename ?? null,\n          contentLength: this._fullReader?.contentLength ?? null,\n        };\n      });\n    this.#methodPromises.set(name, promise);\n    return promise;\n  }\n\n  getMarkInfo() {\n    return this.messageHandler.sendWithPromise(\"GetMarkInfo\", null);\n  }\n\n  async startCleanup(keepLoadedFonts = false) {\n    if (this.destroyed) {\n      return; // No need to manually clean-up when destruction has started.\n    }\n    await this.messageHandler.sendWithPromise(\"Cleanup\", null);\n\n    for (const page of this.#pageCache.values()) {\n      const cleanupSuccessful = page.cleanup();\n\n      if (!cleanupSuccessful) {\n        throw new Error(\n          `startCleanup: Page ${page.pageNumber} is currently rendering.`\n        );\n      }\n    }\n    this.commonObjs.clear();\n    if (!keepLoadedFonts) {\n      this.fontLoader.clear();\n    }\n    this.#methodPromises.clear();\n    this.filterFactory.destroy(/* keepHCM = */ true);\n  }\n\n  get loadingParams() {\n    const { disableAutoFetch, enableXfa } = this._params;\n    return shadow(this, \"loadingParams\", {\n      disableAutoFetch,\n      enableXfa,\n    });\n  }\n}\n\n/**\n * A PDF document and page is built of many objects. E.g. there are objects for\n * fonts, images, rendering code, etc. These objects may get processed inside of\n * a worker. This class implements some basic methods to manage these objects.\n */\nclass PDFObjects {\n  #objs = Object.create(null);\n\n  /**\n   * Ensures there is an object defined for `objId`.\n   *\n   * @param {string} objId\n   * @returns {Object}\n   */\n  #ensureObj(objId) {\n    return (this.#objs[objId] ||= {\n      capability: new PromiseCapability(),\n      data: null,\n    });\n  }\n\n  /**\n   * If called *without* callback, this returns the data of `objId` but the\n   * object needs to be resolved. If it isn't, this method throws.\n   *\n   * If called *with* a callback, the callback is called with the data of the\n   * object once the object is resolved. That means, if you call this method\n   * and the object is already resolved, the callback gets called right away.\n   *\n   * @param {string} objId\n   * @param {function} [callback]\n   * @returns {any}\n   */\n  get(objId, callback = null) {\n    // If there is a callback, then the get can be async and the object is\n    // not required to be resolved right now.\n    if (callback) {\n      const obj = this.#ensureObj(objId);\n      obj.capability.promise.then(() => callback(obj.data));\n      return null;\n    }\n    // If there isn't a callback, the user expects to get the resolved data\n    // directly.\n    const obj = this.#objs[objId];\n    // If there isn't an object yet or the object isn't resolved, then the\n    // data isn't ready yet!\n    if (!obj?.capability.settled) {\n      throw new Error(`Requesting object that isn't resolved yet ${objId}.`);\n    }\n    return obj.data;\n  }\n\n  /**\n   * @param {string} objId\n   * @returns {boolean}\n   */\n  has(objId) {\n    const obj = this.#objs[objId];\n    return obj?.capability.settled || false;\n  }\n\n  /**\n   * Resolves the object `objId` with optional `data`.\n   *\n   * @param {string} objId\n   * @param {any} [data]\n   */\n  resolve(objId, data = null) {\n    const obj = this.#ensureObj(objId);\n    obj.data = data;\n    obj.capability.resolve();\n  }\n\n  clear() {\n    for (const objId in this.#objs) {\n      const { data } = this.#objs[objId];\n      data?.bitmap?.close(); // Release any `ImageBitmap` data.\n    }\n    this.#objs = Object.create(null);\n  }\n}\n\n/**\n * Allows controlling of the rendering tasks.\n */\nclass RenderTask {\n  #internalRenderTask = null;\n\n  constructor(internalRenderTask) {\n    this.#internalRenderTask = internalRenderTask;\n\n    /**\n     * Callback for incremental rendering -- a function that will be called\n     * each time the rendering is paused.  To continue rendering call the\n     * function that is the first argument to the callback.\n     * @type {function}\n     */\n    this.onContinue = null;\n  }\n\n  /**\n   * Promise for rendering task completion.\n   * @type {Promise<void>}\n   */\n  get promise() {\n    return this.#internalRenderTask.capability.promise;\n  }\n\n  /**\n   * Cancels the rendering task. If the task is currently rendering it will\n   * not be cancelled until graphics pauses with a timeout. The promise that\n   * this object extends will be rejected when cancelled.\n   *\n   * @param {number} [extraDelay]\n   */\n  cancel(extraDelay = 0) {\n    this.#internalRenderTask.cancel(/* error = */ null, extraDelay);\n  }\n\n  /**\n   * Whether form fields are rendered separately from the main operatorList.\n   * @type {boolean}\n   */\n  get separateAnnots() {\n    const { separateAnnots } = this.#internalRenderTask.operatorList;\n    if (!separateAnnots) {\n      return false;\n    }\n    const { annotationCanvasMap } = this.#internalRenderTask;\n    return (\n      separateAnnots.form ||\n      (separateAnnots.canvas && annotationCanvasMap?.size > 0)\n    );\n  }\n}\n\n/**\n * For internal use only.\n * @ignore\n */\nclass InternalRenderTask {\n  static #canvasInUse = new WeakSet();\n\n  constructor({\n    callback,\n    params,\n    objs,\n    commonObjs,\n    annotationCanvasMap,\n    operatorList,\n    pageIndex,\n    canvasFactory,\n    filterFactory,\n    useRequestAnimationFrame = false,\n    pdfBug = false,\n    pageColors = null,\n  }) {\n    this.callback = callback;\n    this.params = params;\n    this.objs = objs;\n    this.commonObjs = commonObjs;\n    this.annotationCanvasMap = annotationCanvasMap;\n    this.operatorListIdx = null;\n    this.operatorList = operatorList;\n    this._pageIndex = pageIndex;\n    this.canvasFactory = canvasFactory;\n    this.filterFactory = filterFactory;\n    this._pdfBug = pdfBug;\n    this.pageColors = pageColors;\n\n    this.running = false;\n    this.graphicsReadyCallback = null;\n    this.graphicsReady = false;\n    this._useRequestAnimationFrame =\n      useRequestAnimationFrame === true && typeof window !== \"undefined\";\n    this.cancelled = false;\n    this.capability = new PromiseCapability();\n    this.task = new RenderTask(this);\n    // caching this-bound methods\n    this._cancelBound = this.cancel.bind(this);\n    this._continueBound = this._continue.bind(this);\n    this._scheduleNextBound = this._scheduleNext.bind(this);\n    this._nextBound = this._next.bind(this);\n    this._canvas = params.canvasContext.canvas;\n  }\n\n  get completed() {\n    return this.capability.promise.catch(function () {\n      // Ignoring errors, since we only want to know when rendering is\n      // no longer pending.\n    });\n  }\n\n  initializeGraphics({ transparency = false, optionalContentConfig }) {\n    if (this.cancelled) {\n      return;\n    }\n    if (this._canvas) {\n      if (InternalRenderTask.#canvasInUse.has(this._canvas)) {\n        throw new Error(\n          \"Cannot use the same canvas during multiple render() operations. \" +\n            \"Use different canvas or ensure previous operations were \" +\n            \"cancelled or completed.\"\n        );\n      }\n      InternalRenderTask.#canvasInUse.add(this._canvas);\n    }\n\n    if (this._pdfBug && globalThis.StepperManager?.enabled) {\n      this.stepper = globalThis.StepperManager.create(this._pageIndex);\n      this.stepper.init(this.operatorList);\n      this.stepper.nextBreakPoint = this.stepper.getNextBreakPoint();\n    }\n    const { canvasContext, viewport, transform, background } = this.params;\n\n    this.gfx = new CanvasGraphics(\n      canvasContext,\n      this.commonObjs,\n      this.objs,\n      this.canvasFactory,\n      this.filterFactory,\n      { optionalContentConfig },\n      this.annotationCanvasMap,\n      this.pageColors\n    );\n    this.gfx.beginDrawing({\n      transform,\n      viewport,\n      transparency,\n      background,\n    });\n    this.operatorListIdx = 0;\n    this.graphicsReady = true;\n    this.graphicsReadyCallback?.();\n  }\n\n  cancel(error = null, extraDelay = 0) {\n    this.running = false;\n    this.cancelled = true;\n    this.gfx?.endDrawing();\n    InternalRenderTask.#canvasInUse.delete(this._canvas);\n\n    this.callback(\n      error ||\n        new RenderingCancelledException(\n          `Rendering cancelled, page ${this._pageIndex + 1}`,\n          extraDelay\n        )\n    );\n  }\n\n  operatorListChanged() {\n    if (!this.graphicsReady) {\n      this.graphicsReadyCallback ||= this._continueBound;\n      return;\n    }\n    this.stepper?.updateOperatorList(this.operatorList);\n\n    if (this.running) {\n      return;\n    }\n    this._continue();\n  }\n\n  _continue() {\n    this.running = true;\n    if (this.cancelled) {\n      return;\n    }\n    if (this.task.onContinue) {\n      this.task.onContinue(this._scheduleNextBound);\n    } else {\n      this._scheduleNext();\n    }\n  }\n\n  _scheduleNext() {\n    if (this._useRequestAnimationFrame) {\n      window.requestAnimationFrame(() => {\n        this._nextBound().catch(this._cancelBound);\n      });\n    } else {\n      Promise.resolve().then(this._nextBound).catch(this._cancelBound);\n    }\n  }\n\n  async _next() {\n    if (this.cancelled) {\n      return;\n    }\n    this.operatorListIdx = this.gfx.executeOperatorList(\n      this.operatorList,\n      this.operatorListIdx,\n      this._continueBound,\n      this.stepper\n    );\n    if (this.operatorListIdx === this.operatorList.argsArray.length) {\n      this.running = false;\n      if (this.operatorList.lastChunk) {\n        this.gfx.endDrawing();\n        InternalRenderTask.#canvasInUse.delete(this._canvas);\n\n        this.callback();\n      }\n    }\n  }\n}\n\n/** @type {string} */\nconst version =\n  typeof PDFJSDev !== \"undefined\" ? PDFJSDev.eval(\"BUNDLE_VERSION\") : null;\n/** @type {string} */\nconst build =\n  typeof PDFJSDev !== \"undefined\" ? PDFJSDev.eval(\"BUNDLE_BUILD\") : null;\n\nexport {\n  build,\n  DefaultCanvasFactory,\n  DefaultCMapReaderFactory,\n  DefaultFilterFactory,\n  DefaultStandardFontDataFactory,\n  getDocument,\n  LoopbackPort,\n  PDFDataRangeTransport,\n  PDFDocumentLoadingTask,\n  PDFDocumentProxy,\n  PDFPageProxy,\n  PDFWorker,\n  PDFWorkerUtil,\n  RenderTask,\n  version,\n};\n","/* Copyright 2015 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CMapCompressionType, unreachable } from \"../shared/util.js\";\n\nclass BaseFilterFactory {\n  constructor() {\n    if (this.constructor === BaseFilterFactory) {\n      unreachable(\"Cannot initialize BaseFilterFactory.\");\n    }\n  }\n\n  addFilter(maps) {\n    return \"none\";\n  }\n\n  addHCMFilter(fgColor, bgColor) {\n    return \"none\";\n  }\n\n  addHighlightHCMFilter(fgColor, bgColor, newFgColor, newBgColor) {\n    return \"none\";\n  }\n\n  destroy(keepHCM = false) {}\n}\n\nclass BaseCanvasFactory {\n  constructor() {\n    if (this.constructor === BaseCanvasFactory) {\n      unreachable(\"Cannot initialize BaseCanvasFactory.\");\n    }\n  }\n\n  create(width, height) {\n    if (width <= 0 || height <= 0) {\n      throw new Error(\"Invalid canvas size\");\n    }\n    const canvas = this._createCanvas(width, height);\n    return {\n      canvas,\n      context: canvas.getContext(\"2d\"),\n    };\n  }\n\n  reset(canvasAndContext, width, height) {\n    if (!canvasAndContext.canvas) {\n      throw new Error(\"Canvas is not specified\");\n    }\n    if (width <= 0 || height <= 0) {\n      throw new Error(\"Invalid canvas size\");\n    }\n    canvasAndContext.canvas.width = width;\n    canvasAndContext.canvas.height = height;\n  }\n\n  destroy(canvasAndContext) {\n    if (!canvasAndContext.canvas) {\n      throw new Error(\"Canvas is not specified\");\n    }\n    // Zeroing the width and height cause Firefox to release graphics\n    // resources immediately, which can greatly reduce memory consumption.\n    canvasAndContext.canvas.width = 0;\n    canvasAndContext.canvas.height = 0;\n    canvasAndContext.canvas = null;\n    canvasAndContext.context = null;\n  }\n\n  /**\n   * @ignore\n   */\n  _createCanvas(width, height) {\n    unreachable(\"Abstract method `_createCanvas` called.\");\n  }\n}\n\nclass BaseCMapReaderFactory {\n  constructor({ baseUrl = null, isCompressed = true }) {\n    if (this.constructor === BaseCMapReaderFactory) {\n      unreachable(\"Cannot initialize BaseCMapReaderFactory.\");\n    }\n    this.baseUrl = baseUrl;\n    this.isCompressed = isCompressed;\n  }\n\n  async fetch({ name }) {\n    if (!this.baseUrl) {\n      throw new Error(\n        'The CMap \"baseUrl\" parameter must be specified, ensure that ' +\n          'the \"cMapUrl\" and \"cMapPacked\" API parameters are provided.'\n      );\n    }\n    if (!name) {\n      throw new Error(\"CMap name must be specified.\");\n    }\n    const url = this.baseUrl + name + (this.isCompressed ? \".bcmap\" : \"\");\n    const compressionType = this.isCompressed\n      ? CMapCompressionType.BINARY\n      : CMapCompressionType.NONE;\n\n    return this._fetchData(url, compressionType).catch(reason => {\n      throw new Error(\n        `Unable to load ${this.isCompressed ? \"binary \" : \"\"}CMap at: ${url}`\n      );\n    });\n  }\n\n  /**\n   * @ignore\n   */\n  _fetchData(url, compressionType) {\n    unreachable(\"Abstract method `_fetchData` called.\");\n  }\n}\n\nclass BaseStandardFontDataFactory {\n  constructor({ baseUrl = null }) {\n    if (this.constructor === BaseStandardFontDataFactory) {\n      unreachable(\"Cannot initialize BaseStandardFontDataFactory.\");\n    }\n    this.baseUrl = baseUrl;\n  }\n\n  async fetch({ filename }) {\n    if (!this.baseUrl) {\n      throw new Error(\n        'The standard font \"baseUrl\" parameter must be specified, ensure that ' +\n          'the \"standardFontDataUrl\" API parameter is provided.'\n      );\n    }\n    if (!filename) {\n      throw new Error(\"Font filename must be specified.\");\n    }\n    const url = `${this.baseUrl}${filename}`;\n\n    return this._fetchData(url).catch(reason => {\n      throw new Error(`Unable to load font data at: ${url}`);\n    });\n  }\n\n  /**\n   * @ignore\n   */\n  _fetchData(url) {\n    unreachable(\"Abstract method `_fetchData` called.\");\n  }\n}\n\nclass BaseSVGFactory {\n  constructor() {\n    if (this.constructor === BaseSVGFactory) {\n      unreachable(\"Cannot initialize BaseSVGFactory.\");\n    }\n  }\n\n  create(width, height, skipDimensions = false) {\n    if (width <= 0 || height <= 0) {\n      throw new Error(\"Invalid SVG dimensions\");\n    }\n    const svg = this._createSVG(\"svg:svg\");\n    svg.setAttribute(\"version\", \"1.1\");\n\n    if (!skipDimensions) {\n      svg.setAttribute(\"width\", `${width}px`);\n      svg.setAttribute(\"height\", `${height}px`);\n    }\n\n    svg.setAttribute(\"preserveAspectRatio\", \"none\");\n    svg.setAttribute(\"viewBox\", `0 0 ${width} ${height}`);\n\n    return svg;\n  }\n\n  createElement(type) {\n    if (typeof type !== \"string\") {\n      throw new Error(\"Invalid SVG element type\");\n    }\n    return this._createSVG(type);\n  }\n\n  /**\n   * @ignore\n   */\n  _createSVG(type) {\n    unreachable(\"Abstract method `_createSVG` called.\");\n  }\n}\n\nexport {\n  BaseCanvasFactory,\n  BaseCMapReaderFactory,\n  BaseFilterFactory,\n  BaseStandardFontDataFactory,\n  BaseSVGFactory,\n};\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FormatError, info, unreachable, Util } from \"../shared/util.js\";\nimport { getCurrentTransform } from \"./display_utils.js\";\n\nconst PathType = {\n  FILL: \"Fill\",\n  STROKE: \"Stroke\",\n  SHADING: \"Shading\",\n};\n\nfunction applyBoundingBox(ctx, bbox) {\n  if (!bbox) {\n    return;\n  }\n  const width = bbox[2] - bbox[0];\n  const height = bbox[3] - bbox[1];\n  const region = new Path2D();\n  region.rect(bbox[0], bbox[1], width, height);\n  ctx.clip(region);\n}\n\nclass BaseShadingPattern {\n  constructor() {\n    if (this.constructor === BaseShadingPattern) {\n      unreachable(\"Cannot initialize BaseShadingPattern.\");\n    }\n  }\n\n  getPattern() {\n    unreachable(\"Abstract method `getPattern` called.\");\n  }\n}\n\nclass RadialAxialShadingPattern extends BaseShadingPattern {\n  constructor(IR) {\n    super();\n    this._type = IR[1];\n    this._bbox = IR[2];\n    this._colorStops = IR[3];\n    this._p0 = IR[4];\n    this._p1 = IR[5];\n    this._r0 = IR[6];\n    this._r1 = IR[7];\n    this.matrix = null;\n  }\n\n  _createGradient(ctx) {\n    let grad;\n    if (this._type === \"axial\") {\n      grad = ctx.createLinearGradient(\n        this._p0[0],\n        this._p0[1],\n        this._p1[0],\n        this._p1[1]\n      );\n    } else if (this._type === \"radial\") {\n      grad = ctx.createRadialGradient(\n        this._p0[0],\n        this._p0[1],\n        this._r0,\n        this._p1[0],\n        this._p1[1],\n        this._r1\n      );\n    }\n\n    for (const colorStop of this._colorStops) {\n      grad.addColorStop(colorStop[0], colorStop[1]);\n    }\n    return grad;\n  }\n\n  getPattern(ctx, owner, inverse, pathType) {\n    let pattern;\n    if (pathType === PathType.STROKE || pathType === PathType.FILL) {\n      const ownerBBox = owner.current.getClippedPathBoundingBox(\n        pathType,\n        getCurrentTransform(ctx)\n      ) || [0, 0, 0, 0];\n      // Create a canvas that is only as big as the current path. This doesn't\n      // allow us to cache the pattern, but it generally creates much smaller\n      // canvases and saves memory use. See bug 1722807 for an example.\n      const width = Math.ceil(ownerBBox[2] - ownerBBox[0]) || 1;\n      const height = Math.ceil(ownerBBox[3] - ownerBBox[1]) || 1;\n\n      const tmpCanvas = owner.cachedCanvases.getCanvas(\n        \"pattern\",\n        width,\n        height,\n        true\n      );\n\n      const tmpCtx = tmpCanvas.context;\n      tmpCtx.clearRect(0, 0, tmpCtx.canvas.width, tmpCtx.canvas.height);\n      tmpCtx.beginPath();\n      tmpCtx.rect(0, 0, tmpCtx.canvas.width, tmpCtx.canvas.height);\n      // Non shading fill patterns are positioned relative to the base transform\n      // (usually the page's initial transform), but we may have created a\n      // smaller canvas based on the path, so we must account for the shift.\n      tmpCtx.translate(-ownerBBox[0], -ownerBBox[1]);\n      inverse = Util.transform(inverse, [\n        1,\n        0,\n        0,\n        1,\n        ownerBBox[0],\n        ownerBBox[1],\n      ]);\n\n      tmpCtx.transform(...owner.baseTransform);\n      if (this.matrix) {\n        tmpCtx.transform(...this.matrix);\n      }\n      applyBoundingBox(tmpCtx, this._bbox);\n\n      tmpCtx.fillStyle = this._createGradient(tmpCtx);\n      tmpCtx.fill();\n\n      pattern = ctx.createPattern(tmpCanvas.canvas, \"no-repeat\");\n      const domMatrix = new DOMMatrix(inverse);\n      pattern.setTransform(domMatrix);\n    } else {\n      // Shading fills are applied relative to the current matrix which is also\n      // how canvas gradients work, so there's no need to do anything special\n      // here.\n      applyBoundingBox(ctx, this._bbox);\n      pattern = this._createGradient(ctx);\n    }\n    return pattern;\n  }\n}\n\nfunction drawTriangle(data, context, p1, p2, p3, c1, c2, c3) {\n  // Very basic Gouraud-shaded triangle rasterization algorithm.\n  const coords = context.coords,\n    colors = context.colors;\n  const bytes = data.data,\n    rowSize = data.width * 4;\n  let tmp;\n  if (coords[p1 + 1] > coords[p2 + 1]) {\n    tmp = p1;\n    p1 = p2;\n    p2 = tmp;\n    tmp = c1;\n    c1 = c2;\n    c2 = tmp;\n  }\n  if (coords[p2 + 1] > coords[p3 + 1]) {\n    tmp = p2;\n    p2 = p3;\n    p3 = tmp;\n    tmp = c2;\n    c2 = c3;\n    c3 = tmp;\n  }\n  if (coords[p1 + 1] > coords[p2 + 1]) {\n    tmp = p1;\n    p1 = p2;\n    p2 = tmp;\n    tmp = c1;\n    c1 = c2;\n    c2 = tmp;\n  }\n  const x1 = (coords[p1] + context.offsetX) * context.scaleX;\n  const y1 = (coords[p1 + 1] + context.offsetY) * context.scaleY;\n  const x2 = (coords[p2] + context.offsetX) * context.scaleX;\n  const y2 = (coords[p2 + 1] + context.offsetY) * context.scaleY;\n  const x3 = (coords[p3] + context.offsetX) * context.scaleX;\n  const y3 = (coords[p3 + 1] + context.offsetY) * context.scaleY;\n  if (y1 >= y3) {\n    return;\n  }\n  const c1r = colors[c1],\n    c1g = colors[c1 + 1],\n    c1b = colors[c1 + 2];\n  const c2r = colors[c2],\n    c2g = colors[c2 + 1],\n    c2b = colors[c2 + 2];\n  const c3r = colors[c3],\n    c3g = colors[c3 + 1],\n    c3b = colors[c3 + 2];\n\n  const minY = Math.round(y1),\n    maxY = Math.round(y3);\n  let xa, car, cag, cab;\n  let xb, cbr, cbg, cbb;\n  for (let y = minY; y <= maxY; y++) {\n    if (y < y2) {\n      const k = y < y1 ? 0 : (y1 - y) / (y1 - y2);\n      xa = x1 - (x1 - x2) * k;\n      car = c1r - (c1r - c2r) * k;\n      cag = c1g - (c1g - c2g) * k;\n      cab = c1b - (c1b - c2b) * k;\n    } else {\n      let k;\n      if (y > y3) {\n        k = 1;\n      } else if (y2 === y3) {\n        k = 0;\n      } else {\n        k = (y2 - y) / (y2 - y3);\n      }\n      xa = x2 - (x2 - x3) * k;\n      car = c2r - (c2r - c3r) * k;\n      cag = c2g - (c2g - c3g) * k;\n      cab = c2b - (c2b - c3b) * k;\n    }\n\n    let k;\n    if (y < y1) {\n      k = 0;\n    } else if (y > y3) {\n      k = 1;\n    } else {\n      k = (y1 - y) / (y1 - y3);\n    }\n    xb = x1 - (x1 - x3) * k;\n    cbr = c1r - (c1r - c3r) * k;\n    cbg = c1g - (c1g - c3g) * k;\n    cbb = c1b - (c1b - c3b) * k;\n    const x1_ = Math.round(Math.min(xa, xb));\n    const x2_ = Math.round(Math.max(xa, xb));\n    let j = rowSize * y + x1_ * 4;\n    for (let x = x1_; x <= x2_; x++) {\n      k = (xa - x) / (xa - xb);\n      if (k < 0) {\n        k = 0;\n      } else if (k > 1) {\n        k = 1;\n      }\n      bytes[j++] = (car - (car - cbr) * k) | 0;\n      bytes[j++] = (cag - (cag - cbg) * k) | 0;\n      bytes[j++] = (cab - (cab - cbb) * k) | 0;\n      bytes[j++] = 255;\n    }\n  }\n}\n\nfunction drawFigure(data, figure, context) {\n  const ps = figure.coords;\n  const cs = figure.colors;\n  let i, ii;\n  switch (figure.type) {\n    case \"lattice\":\n      const verticesPerRow = figure.verticesPerRow;\n      const rows = Math.floor(ps.length / verticesPerRow) - 1;\n      const cols = verticesPerRow - 1;\n      for (i = 0; i < rows; i++) {\n        let q = i * verticesPerRow;\n        for (let j = 0; j < cols; j++, q++) {\n          drawTriangle(\n            data,\n            context,\n            ps[q],\n            ps[q + 1],\n            ps[q + verticesPerRow],\n            cs[q],\n            cs[q + 1],\n            cs[q + verticesPerRow]\n          );\n          drawTriangle(\n            data,\n            context,\n            ps[q + verticesPerRow + 1],\n            ps[q + 1],\n            ps[q + verticesPerRow],\n            cs[q + verticesPerRow + 1],\n            cs[q + 1],\n            cs[q + verticesPerRow]\n          );\n        }\n      }\n      break;\n    case \"triangles\":\n      for (i = 0, ii = ps.length; i < ii; i += 3) {\n        drawTriangle(\n          data,\n          context,\n          ps[i],\n          ps[i + 1],\n          ps[i + 2],\n          cs[i],\n          cs[i + 1],\n          cs[i + 2]\n        );\n      }\n      break;\n    default:\n      throw new Error(\"illegal figure\");\n  }\n}\n\nclass MeshShadingPattern extends BaseShadingPattern {\n  constructor(IR) {\n    super();\n    this._coords = IR[2];\n    this._colors = IR[3];\n    this._figures = IR[4];\n    this._bounds = IR[5];\n    this._bbox = IR[7];\n    this._background = IR[8];\n    this.matrix = null;\n  }\n\n  _createMeshCanvas(combinedScale, backgroundColor, cachedCanvases) {\n    // we will increase scale on some weird factor to let antialiasing take\n    // care of \"rough\" edges\n    const EXPECTED_SCALE = 1.1;\n    // MAX_PATTERN_SIZE is used to avoid OOM situation.\n    const MAX_PATTERN_SIZE = 3000; // 10in @ 300dpi shall be enough\n    // We need to keep transparent border around our pattern for fill():\n    // createPattern with 'no-repeat' will bleed edges across entire area.\n    const BORDER_SIZE = 2;\n\n    const offsetX = Math.floor(this._bounds[0]);\n    const offsetY = Math.floor(this._bounds[1]);\n    const boundsWidth = Math.ceil(this._bounds[2]) - offsetX;\n    const boundsHeight = Math.ceil(this._bounds[3]) - offsetY;\n\n    const width = Math.min(\n      Math.ceil(Math.abs(boundsWidth * combinedScale[0] * EXPECTED_SCALE)),\n      MAX_PATTERN_SIZE\n    );\n    const height = Math.min(\n      Math.ceil(Math.abs(boundsHeight * combinedScale[1] * EXPECTED_SCALE)),\n      MAX_PATTERN_SIZE\n    );\n    const scaleX = boundsWidth / width;\n    const scaleY = boundsHeight / height;\n\n    const context = {\n      coords: this._coords,\n      colors: this._colors,\n      offsetX: -offsetX,\n      offsetY: -offsetY,\n      scaleX: 1 / scaleX,\n      scaleY: 1 / scaleY,\n    };\n\n    const paddedWidth = width + BORDER_SIZE * 2;\n    const paddedHeight = height + BORDER_SIZE * 2;\n\n    const tmpCanvas = cachedCanvases.getCanvas(\n      \"mesh\",\n      paddedWidth,\n      paddedHeight,\n      false\n    );\n    const tmpCtx = tmpCanvas.context;\n\n    const data = tmpCtx.createImageData(width, height);\n    if (backgroundColor) {\n      const bytes = data.data;\n      for (let i = 0, ii = bytes.length; i < ii; i += 4) {\n        bytes[i] = backgroundColor[0];\n        bytes[i + 1] = backgroundColor[1];\n        bytes[i + 2] = backgroundColor[2];\n        bytes[i + 3] = 255;\n      }\n    }\n    for (const figure of this._figures) {\n      drawFigure(data, figure, context);\n    }\n    tmpCtx.putImageData(data, BORDER_SIZE, BORDER_SIZE);\n    const canvas = tmpCanvas.canvas;\n\n    return {\n      canvas,\n      offsetX: offsetX - BORDER_SIZE * scaleX,\n      offsetY: offsetY - BORDER_SIZE * scaleY,\n      scaleX,\n      scaleY,\n    };\n  }\n\n  getPattern(ctx, owner, inverse, pathType) {\n    applyBoundingBox(ctx, this._bbox);\n    let scale;\n    if (pathType === PathType.SHADING) {\n      scale = Util.singularValueDecompose2dScale(getCurrentTransform(ctx));\n    } else {\n      // Obtain scale from matrix and current transformation matrix.\n      scale = Util.singularValueDecompose2dScale(owner.baseTransform);\n      if (this.matrix) {\n        const matrixScale = Util.singularValueDecompose2dScale(this.matrix);\n        scale = [scale[0] * matrixScale[0], scale[1] * matrixScale[1]];\n      }\n    }\n\n    // Rasterizing on the main thread since sending/queue large canvases\n    // might cause OOM.\n    const temporaryPatternCanvas = this._createMeshCanvas(\n      scale,\n      pathType === PathType.SHADING ? null : this._background,\n      owner.cachedCanvases\n    );\n\n    if (pathType !== PathType.SHADING) {\n      ctx.setTransform(...owner.baseTransform);\n      if (this.matrix) {\n        ctx.transform(...this.matrix);\n      }\n    }\n\n    ctx.translate(\n      temporaryPatternCanvas.offsetX,\n      temporaryPatternCanvas.offsetY\n    );\n    ctx.scale(temporaryPatternCanvas.scaleX, temporaryPatternCanvas.scaleY);\n\n    return ctx.createPattern(temporaryPatternCanvas.canvas, \"no-repeat\");\n  }\n}\n\nclass DummyShadingPattern extends BaseShadingPattern {\n  getPattern() {\n    return \"hotpink\";\n  }\n}\n\nfunction getShadingPattern(IR) {\n  switch (IR[0]) {\n    case \"RadialAxial\":\n      return new RadialAxialShadingPattern(IR);\n    case \"Mesh\":\n      return new MeshShadingPattern(IR);\n    case \"Dummy\":\n      return new DummyShadingPattern();\n  }\n  throw new Error(`Unknown IR type: ${IR[0]}`);\n}\n\nconst PaintType = {\n  COLORED: 1,\n  UNCOLORED: 2,\n};\n\nclass TilingPattern {\n  // 10in @ 300dpi shall be enough.\n  static MAX_PATTERN_SIZE = 3000;\n\n  constructor(IR, color, ctx, canvasGraphicsFactory, baseTransform) {\n    this.operatorList = IR[2];\n    this.matrix = IR[3] || [1, 0, 0, 1, 0, 0];\n    this.bbox = IR[4];\n    this.xstep = IR[5];\n    this.ystep = IR[6];\n    this.paintType = IR[7];\n    this.tilingType = IR[8];\n    this.color = color;\n    this.ctx = ctx;\n    this.canvasGraphicsFactory = canvasGraphicsFactory;\n    this.baseTransform = baseTransform;\n  }\n\n  createPatternCanvas(owner) {\n    const operatorList = this.operatorList;\n    const bbox = this.bbox;\n    const xstep = this.xstep;\n    const ystep = this.ystep;\n    const paintType = this.paintType;\n    const tilingType = this.tilingType;\n    const color = this.color;\n    const canvasGraphicsFactory = this.canvasGraphicsFactory;\n\n    info(\"TilingType: \" + tilingType);\n\n    // A tiling pattern as defined by PDF spec 8.7.2 is a cell whose size is\n    // described by bbox, and may repeat regularly by shifting the cell by\n    // xstep and ystep.\n    // Because the HTML5 canvas API does not support pattern repetition with\n    // gaps in between, we use the xstep/ystep instead of the bbox's size.\n    //\n    // This has the following consequences (similarly for ystep):\n    //\n    // - If xstep is the same as bbox, then there is no observable difference.\n    //\n    // - If xstep is larger than bbox, then the pattern canvas is partially\n    //   empty: the area bounded by bbox is painted, the outside area is void.\n    //\n    // - If xstep is smaller than bbox, then the pixels between xstep and the\n    //   bbox boundary will be missing. This is INCORRECT behavior.\n    //   \"Figures on adjacent tiles should not overlap\" (PDF spec 8.7.3.1),\n    //   but overlapping cells without common pixels are still valid.\n    //   TODO: Fix the implementation, to allow this scenario to be painted\n    //   correctly.\n\n    const x0 = bbox[0],\n      y0 = bbox[1],\n      x1 = bbox[2],\n      y1 = bbox[3];\n\n    // Obtain scale from matrix and current transformation matrix.\n    const matrixScale = Util.singularValueDecompose2dScale(this.matrix);\n    const curMatrixScale = Util.singularValueDecompose2dScale(\n      this.baseTransform\n    );\n    const combinedScale = [\n      matrixScale[0] * curMatrixScale[0],\n      matrixScale[1] * curMatrixScale[1],\n    ];\n\n    // Use width and height values that are as close as possible to the end\n    // result when the pattern is used. Too low value makes the pattern look\n    // blurry. Too large value makes it look too crispy.\n    const dimx = this.getSizeAndScale(\n      xstep,\n      this.ctx.canvas.width,\n      combinedScale[0]\n    );\n    const dimy = this.getSizeAndScale(\n      ystep,\n      this.ctx.canvas.height,\n      combinedScale[1]\n    );\n\n    const tmpCanvas = owner.cachedCanvases.getCanvas(\n      \"pattern\",\n      dimx.size,\n      dimy.size,\n      true\n    );\n    const tmpCtx = tmpCanvas.context;\n    const graphics = canvasGraphicsFactory.createCanvasGraphics(tmpCtx);\n    graphics.groupLevel = owner.groupLevel;\n\n    this.setFillAndStrokeStyleToContext(graphics, paintType, color);\n\n    let adjustedX0 = x0;\n    let adjustedY0 = y0;\n    let adjustedX1 = x1;\n    let adjustedY1 = y1;\n    // Some bounding boxes have negative x0/y0 coordinates which will cause the\n    // some of the drawing to be off of the canvas. To avoid this shift the\n    // bounding box over.\n    if (x0 < 0) {\n      adjustedX0 = 0;\n      adjustedX1 += Math.abs(x0);\n    }\n    if (y0 < 0) {\n      adjustedY0 = 0;\n      adjustedY1 += Math.abs(y0);\n    }\n    tmpCtx.translate(-(dimx.scale * adjustedX0), -(dimy.scale * adjustedY0));\n    graphics.transform(dimx.scale, 0, 0, dimy.scale, 0, 0);\n\n    // To match CanvasGraphics beginDrawing we must save the context here or\n    // else we end up with unbalanced save/restores.\n    tmpCtx.save();\n\n    this.clipBbox(graphics, adjustedX0, adjustedY0, adjustedX1, adjustedY1);\n\n    graphics.baseTransform = getCurrentTransform(graphics.ctx);\n\n    graphics.executeOperatorList(operatorList);\n\n    graphics.endDrawing();\n\n    return {\n      canvas: tmpCanvas.canvas,\n      scaleX: dimx.scale,\n      scaleY: dimy.scale,\n      offsetX: adjustedX0,\n      offsetY: adjustedY0,\n    };\n  }\n\n  getSizeAndScale(step, realOutputSize, scale) {\n    // xstep / ystep may be negative -- normalize.\n    step = Math.abs(step);\n    // MAX_PATTERN_SIZE is used to avoid OOM situation.\n    // Use the destination canvas's size if it is bigger than the hard-coded\n    // limit of MAX_PATTERN_SIZE to avoid clipping patterns that cover the\n    // whole canvas.\n    const maxSize = Math.max(TilingPattern.MAX_PATTERN_SIZE, realOutputSize);\n    let size = Math.ceil(step * scale);\n    if (size >= maxSize) {\n      size = maxSize;\n    } else {\n      scale = size / step;\n    }\n    return { scale, size };\n  }\n\n  clipBbox(graphics, x0, y0, x1, y1) {\n    const bboxWidth = x1 - x0;\n    const bboxHeight = y1 - y0;\n    graphics.ctx.rect(x0, y0, bboxWidth, bboxHeight);\n    graphics.current.updateRectMinMax(getCurrentTransform(graphics.ctx), [\n      x0,\n      y0,\n      x1,\n      y1,\n    ]);\n    graphics.clip();\n    graphics.endPath();\n  }\n\n  setFillAndStrokeStyleToContext(graphics, paintType, color) {\n    const context = graphics.ctx,\n      current = graphics.current;\n    switch (paintType) {\n      case PaintType.COLORED:\n        const ctx = this.ctx;\n        context.fillStyle = ctx.fillStyle;\n        context.strokeStyle = ctx.strokeStyle;\n        current.fillColor = ctx.fillStyle;\n        current.strokeColor = ctx.strokeStyle;\n        break;\n      case PaintType.UNCOLORED:\n        const cssColor = Util.makeHexColor(color[0], color[1], color[2]);\n        context.fillStyle = cssColor;\n        context.strokeStyle = cssColor;\n        // Set color needed by image masks (fixes issues 3226 and 8741).\n        current.fillColor = cssColor;\n        current.strokeColor = cssColor;\n        break;\n      default:\n        throw new FormatError(`Unsupported paint type: ${paintType}`);\n    }\n  }\n\n  getPattern(ctx, owner, inverse, pathType) {\n    // PDF spec 8.7.2 NOTE 1: pattern's matrix is relative to initial matrix.\n    let matrix = inverse;\n    if (pathType !== PathType.SHADING) {\n      matrix = Util.transform(matrix, owner.baseTransform);\n      if (this.matrix) {\n        matrix = Util.transform(matrix, this.matrix);\n      }\n    }\n\n    const temporaryPatternCanvas = this.createPatternCanvas(owner);\n\n    let domMatrix = new DOMMatrix(matrix);\n    // Rescale and so that the ctx.createPattern call generates a pattern with\n    // the desired size.\n    domMatrix = domMatrix.translate(\n      temporaryPatternCanvas.offsetX,\n      temporaryPatternCanvas.offsetY\n    );\n    domMatrix = domMatrix.scale(\n      1 / temporaryPatternCanvas.scaleX,\n      1 / temporaryPatternCanvas.scaleY\n    );\n\n    const pattern = ctx.createPattern(temporaryPatternCanvas.canvas, \"repeat\");\n    pattern.setTransform(domMatrix);\n\n    return pattern;\n  }\n}\n\nexport { getShadingPattern, PathType, TilingPattern };\n","/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FeatureTest, ImageKind } from \"./util.js\";\n\nfunction convertToRGBA(params) {\n  switch (params.kind) {\n    case ImageKind.GRAYSCALE_1BPP:\n      return convertBlackAndWhiteToRGBA(params);\n    case ImageKind.RGB_24BPP:\n      return convertRGBToRGBA(params);\n  }\n\n  return null;\n}\n\nfunction convertBlackAndWhiteToRGBA({\n  src,\n  srcPos = 0,\n  dest,\n  width,\n  height,\n  nonBlackColor = 0xffffffff,\n  inverseDecode = false,\n}) {\n  const black = FeatureTest.isLittleEndian ? 0xff000000 : 0x000000ff;\n  const [zeroMapping, oneMapping] = inverseDecode\n    ? [nonBlackColor, black]\n    : [black, nonBlackColor];\n  const widthInSource = width >> 3;\n  const widthRemainder = width & 7;\n  const srcLength = src.length;\n  dest = new Uint32Array(dest.buffer);\n  let destPos = 0;\n\n  for (let i = 0; i < height; i++) {\n    for (const max = srcPos + widthInSource; srcPos < max; srcPos++) {\n      const elem = srcPos < srcLength ? src[srcPos] : 255;\n      dest[destPos++] = elem & 0b10000000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b1000000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b100000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b10000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b1000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b100 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b10 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b1 ? oneMapping : zeroMapping;\n    }\n    if (widthRemainder === 0) {\n      continue;\n    }\n    const elem = srcPos < srcLength ? src[srcPos++] : 255;\n    for (let j = 0; j < widthRemainder; j++) {\n      dest[destPos++] = elem & (1 << (7 - j)) ? oneMapping : zeroMapping;\n    }\n  }\n  return { srcPos, destPos };\n}\n\nfunction convertRGBToRGBA({\n  src,\n  srcPos = 0,\n  dest,\n  destPos = 0,\n  width,\n  height,\n}) {\n  let i = 0;\n  const len32 = src.length >> 2;\n  const src32 = new Uint32Array(src.buffer, srcPos, len32);\n\n  if (FeatureTest.isLittleEndian) {\n    // It's a way faster to do the shuffle manually instead of working\n    // component by component with some Uint8 arrays.\n    for (; i < len32 - 2; i += 3, destPos += 4) {\n      const s1 = src32[i]; // R2B1G1R1\n      const s2 = src32[i + 1]; // G3R3B2G2\n      const s3 = src32[i + 2]; // B4G4R4B3\n\n      dest[destPos] = s1 | 0xff000000;\n      dest[destPos + 1] = (s1 >>> 24) | (s2 << 8) | 0xff000000;\n      dest[destPos + 2] = (s2 >>> 16) | (s3 << 16) | 0xff000000;\n      dest[destPos + 3] = (s3 >>> 8) | 0xff000000;\n    }\n\n    for (let j = i * 4, jj = src.length; j < jj; j += 3) {\n      dest[destPos++] =\n        src[j] | (src[j + 1] << 8) | (src[j + 2] << 16) | 0xff000000;\n    }\n  } else {\n    for (; i < len32 - 2; i += 3, destPos += 4) {\n      const s1 = src32[i]; // R1G1B1R2\n      const s2 = src32[i + 1]; // G2B2R3G3\n      const s3 = src32[i + 2]; // B3R4G4B4\n\n      dest[destPos] = s1 | 0xff;\n      dest[destPos + 1] = (s1 << 24) | (s2 >>> 8) | 0xff;\n      dest[destPos + 2] = (s2 << 16) | (s3 >>> 16) | 0xff;\n      dest[destPos + 3] = (s3 << 8) | 0xff;\n    }\n\n    for (let j = i * 4, jj = src.length; j < jj; j += 3) {\n      dest[destPos++] =\n        (src[j] << 24) | (src[j + 1] << 16) | (src[j + 2] << 8) | 0xff;\n    }\n  }\n\n  return { srcPos, destPos };\n}\n\nfunction grayToRGBA(src, dest) {\n  if (FeatureTest.isLittleEndian) {\n    for (let i = 0, ii = src.length; i < ii; i++) {\n      dest[i] = (src[i] * 0x10101) | 0xff000000;\n    }\n  } else {\n    for (let i = 0, ii = src.length; i < ii; i++) {\n      dest[i] = (src[i] * 0x1010100) | 0x000000ff;\n    }\n  }\n}\n\nexport { convertBlackAndWhiteToRGBA, convertToRGBA, grayToRGBA };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  FeatureTest,\n  FONT_IDENTITY_MATRIX,\n  IDENTITY_MATRIX,\n  ImageKind,\n  info,\n  isNodeJS,\n  OPS,\n  shadow,\n  TextRenderingMode,\n  unreachable,\n  Util,\n  warn,\n} from \"../shared/util.js\";\nimport {\n  getCurrentTransform,\n  getCurrentTransformInverse,\n  PixelsPerInch,\n} from \"./display_utils.js\";\nimport {\n  getShadingPattern,\n  PathType,\n  TilingPattern,\n} from \"./pattern_helper.js\";\nimport { convertBlackAndWhiteToRGBA } from \"../shared/image_utils.js\";\n\n// <canvas> contexts store most of the state we need natively.\n// However, PDF needs a bit more state, which we store here.\n// Minimal font size that would be used during canvas fillText operations.\nconst MIN_FONT_SIZE = 16;\n// Maximum font size that would be used during canvas fillText operations.\nconst MAX_FONT_SIZE = 100;\nconst MAX_GROUP_SIZE = 4096;\n\n// Defines the time the `executeOperatorList`-method is going to be executing\n// before it stops and schedules a continue of execution.\nconst EXECUTION_TIME = 15; // ms\n// Defines the number of steps before checking the execution time.\nconst EXECUTION_STEPS = 10;\n\n// To disable Type3 compilation, set the value to `-1`.\nconst MAX_SIZE_TO_COMPILE = 1000;\n\nconst FULL_CHUNK_HEIGHT = 16;\n\n/**\n * Overrides certain methods on a 2d ctx so that when they are called they\n * will also call the same method on the destCtx. The methods that are\n * overridden are all the transformation state modifiers, path creation, and\n * save/restore. We only forward these specific methods because they are the\n * only state modifiers that we cannot copy over when we switch contexts.\n *\n * To remove mirroring call `ctx._removeMirroring()`.\n *\n * @param {Object} ctx - The 2d canvas context that will duplicate its calls on\n *   the destCtx.\n * @param {Object} destCtx - The 2d canvas context that will receive the\n *   forwarded calls.\n */\nfunction mirrorContextOperations(ctx, destCtx) {\n  if (ctx._removeMirroring) {\n    throw new Error(\"Context is already forwarding operations.\");\n  }\n  ctx.__originalSave = ctx.save;\n  ctx.__originalRestore = ctx.restore;\n  ctx.__originalRotate = ctx.rotate;\n  ctx.__originalScale = ctx.scale;\n  ctx.__originalTranslate = ctx.translate;\n  ctx.__originalTransform = ctx.transform;\n  ctx.__originalSetTransform = ctx.setTransform;\n  ctx.__originalResetTransform = ctx.resetTransform;\n  ctx.__originalClip = ctx.clip;\n  ctx.__originalMoveTo = ctx.moveTo;\n  ctx.__originalLineTo = ctx.lineTo;\n  ctx.__originalBezierCurveTo = ctx.bezierCurveTo;\n  ctx.__originalRect = ctx.rect;\n  ctx.__originalClosePath = ctx.closePath;\n  ctx.__originalBeginPath = ctx.beginPath;\n\n  ctx._removeMirroring = () => {\n    ctx.save = ctx.__originalSave;\n    ctx.restore = ctx.__originalRestore;\n    ctx.rotate = ctx.__originalRotate;\n    ctx.scale = ctx.__originalScale;\n    ctx.translate = ctx.__originalTranslate;\n    ctx.transform = ctx.__originalTransform;\n    ctx.setTransform = ctx.__originalSetTransform;\n    ctx.resetTransform = ctx.__originalResetTransform;\n\n    ctx.clip = ctx.__originalClip;\n    ctx.moveTo = ctx.__originalMoveTo;\n    ctx.lineTo = ctx.__originalLineTo;\n    ctx.bezierCurveTo = ctx.__originalBezierCurveTo;\n    ctx.rect = ctx.__originalRect;\n    ctx.closePath = ctx.__originalClosePath;\n    ctx.beginPath = ctx.__originalBeginPath;\n    delete ctx._removeMirroring;\n  };\n\n  ctx.save = function ctxSave() {\n    destCtx.save();\n    this.__originalSave();\n  };\n\n  ctx.restore = function ctxRestore() {\n    destCtx.restore();\n    this.__originalRestore();\n  };\n\n  ctx.translate = function ctxTranslate(x, y) {\n    destCtx.translate(x, y);\n    this.__originalTranslate(x, y);\n  };\n\n  ctx.scale = function ctxScale(x, y) {\n    destCtx.scale(x, y);\n    this.__originalScale(x, y);\n  };\n\n  ctx.transform = function ctxTransform(a, b, c, d, e, f) {\n    destCtx.transform(a, b, c, d, e, f);\n    this.__originalTransform(a, b, c, d, e, f);\n  };\n\n  ctx.setTransform = function ctxSetTransform(a, b, c, d, e, f) {\n    destCtx.setTransform(a, b, c, d, e, f);\n    this.__originalSetTransform(a, b, c, d, e, f);\n  };\n\n  ctx.resetTransform = function ctxResetTransform() {\n    destCtx.resetTransform();\n    this.__originalResetTransform();\n  };\n\n  ctx.rotate = function ctxRotate(angle) {\n    destCtx.rotate(angle);\n    this.__originalRotate(angle);\n  };\n\n  ctx.clip = function ctxRotate(rule) {\n    destCtx.clip(rule);\n    this.__originalClip(rule);\n  };\n\n  ctx.moveTo = function (x, y) {\n    destCtx.moveTo(x, y);\n    this.__originalMoveTo(x, y);\n  };\n\n  ctx.lineTo = function (x, y) {\n    destCtx.lineTo(x, y);\n    this.__originalLineTo(x, y);\n  };\n\n  ctx.bezierCurveTo = function (cp1x, cp1y, cp2x, cp2y, x, y) {\n    destCtx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\n    this.__originalBezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\n  };\n\n  ctx.rect = function (x, y, width, height) {\n    destCtx.rect(x, y, width, height);\n    this.__originalRect(x, y, width, height);\n  };\n\n  ctx.closePath = function () {\n    destCtx.closePath();\n    this.__originalClosePath();\n  };\n\n  ctx.beginPath = function () {\n    destCtx.beginPath();\n    this.__originalBeginPath();\n  };\n}\n\nclass CachedCanvases {\n  constructor(canvasFactory) {\n    this.canvasFactory = canvasFactory;\n    this.cache = Object.create(null);\n  }\n\n  getCanvas(id, width, height) {\n    let canvasEntry;\n    if (this.cache[id] !== undefined) {\n      canvasEntry = this.cache[id];\n      this.canvasFactory.reset(canvasEntry, width, height);\n    } else {\n      canvasEntry = this.canvasFactory.create(width, height);\n      this.cache[id] = canvasEntry;\n    }\n    return canvasEntry;\n  }\n\n  delete(id) {\n    delete this.cache[id];\n  }\n\n  clear() {\n    for (const id in this.cache) {\n      const canvasEntry = this.cache[id];\n      this.canvasFactory.destroy(canvasEntry);\n      delete this.cache[id];\n    }\n  }\n}\n\nfunction drawImageAtIntegerCoords(\n  ctx,\n  srcImg,\n  srcX,\n  srcY,\n  srcW,\n  srcH,\n  destX,\n  destY,\n  destW,\n  destH\n) {\n  const [a, b, c, d, tx, ty] = getCurrentTransform(ctx);\n  if (b === 0 && c === 0) {\n    // top-left corner is at (X, Y) and\n    // bottom-right one is at (X + width, Y + height).\n\n    // If leftX is 4.321 then it's rounded to 4.\n    // If width is 10.432 then it's rounded to 11 because\n    // rightX = leftX + width = 14.753 which is rounded to 15\n    // so after rounding the total width is 11 (15 - 4).\n    // It's why we can't just floor/ceil uniformly, it just depends\n    // on the values we've.\n\n    const tlX = destX * a + tx;\n    const rTlX = Math.round(tlX);\n    const tlY = destY * d + ty;\n    const rTlY = Math.round(tlY);\n    const brX = (destX + destW) * a + tx;\n\n    // Some pdf contains images with 1x1 images so in case of 0-width after\n    // scaling we must fallback on 1 to be sure there is something.\n    const rWidth = Math.abs(Math.round(brX) - rTlX) || 1;\n    const brY = (destY + destH) * d + ty;\n    const rHeight = Math.abs(Math.round(brY) - rTlY) || 1;\n\n    // We must apply a transformation in order to apply it on the image itself.\n    // For example if a == 1 && d == -1, it means that the image itself is\n    // mirrored w.r.t. the x-axis.\n    ctx.setTransform(Math.sign(a), 0, 0, Math.sign(d), rTlX, rTlY);\n    ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, 0, 0, rWidth, rHeight);\n    ctx.setTransform(a, b, c, d, tx, ty);\n\n    return [rWidth, rHeight];\n  }\n\n  if (a === 0 && d === 0) {\n    // This path is taken in issue9462.pdf (page 3).\n    const tlX = destY * c + tx;\n    const rTlX = Math.round(tlX);\n    const tlY = destX * b + ty;\n    const rTlY = Math.round(tlY);\n    const brX = (destY + destH) * c + tx;\n    const rWidth = Math.abs(Math.round(brX) - rTlX) || 1;\n    const brY = (destX + destW) * b + ty;\n    const rHeight = Math.abs(Math.round(brY) - rTlY) || 1;\n\n    ctx.setTransform(0, Math.sign(b), Math.sign(c), 0, rTlX, rTlY);\n    ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, 0, 0, rHeight, rWidth);\n    ctx.setTransform(a, b, c, d, tx, ty);\n\n    return [rHeight, rWidth];\n  }\n\n  // Not a scale matrix so let the render handle the case without rounding.\n  ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, destX, destY, destW, destH);\n\n  const scaleX = Math.hypot(a, b);\n  const scaleY = Math.hypot(c, d);\n  return [scaleX * destW, scaleY * destH];\n}\n\nfunction compileType3Glyph(imgData) {\n  const { width, height } = imgData;\n  if (width > MAX_SIZE_TO_COMPILE || height > MAX_SIZE_TO_COMPILE) {\n    return null;\n  }\n\n  const POINT_TO_PROCESS_LIMIT = 1000;\n  const POINT_TYPES = new Uint8Array([\n    0, 2, 4, 0, 1, 0, 5, 4, 8, 10, 0, 8, 0, 2, 1, 0,\n  ]);\n\n  const width1 = width + 1;\n  let points = new Uint8Array(width1 * (height + 1));\n  let i, j, j0;\n\n  // decodes bit-packed mask data\n  const lineSize = (width + 7) & ~7;\n  let data = new Uint8Array(lineSize * height),\n    pos = 0;\n  for (const elem of imgData.data) {\n    let mask = 128;\n    while (mask > 0) {\n      data[pos++] = elem & mask ? 0 : 255;\n      mask >>= 1;\n    }\n  }\n\n  // finding interesting points: every point is located between mask pixels,\n  // so there will be points of the (width + 1)x(height + 1) grid. Every point\n  // will have flags assigned based on neighboring mask pixels:\n  //   4 | 8\n  //   --P--\n  //   2 | 1\n  // We are interested only in points with the flags:\n  //   - outside corners: 1, 2, 4, 8;\n  //   - inside corners: 7, 11, 13, 14;\n  //   - and, intersections: 5, 10.\n  let count = 0;\n  pos = 0;\n  if (data[pos] !== 0) {\n    points[0] = 1;\n    ++count;\n  }\n  for (j = 1; j < width; j++) {\n    if (data[pos] !== data[pos + 1]) {\n      points[j] = data[pos] ? 2 : 1;\n      ++count;\n    }\n    pos++;\n  }\n  if (data[pos] !== 0) {\n    points[j] = 2;\n    ++count;\n  }\n  for (i = 1; i < height; i++) {\n    pos = i * lineSize;\n    j0 = i * width1;\n    if (data[pos - lineSize] !== data[pos]) {\n      points[j0] = data[pos] ? 1 : 8;\n      ++count;\n    }\n    // 'sum' is the position of the current pixel configuration in the 'TYPES'\n    // array (in order 8-1-2-4, so we can use '>>2' to shift the column).\n    let sum = (data[pos] ? 4 : 0) + (data[pos - lineSize] ? 8 : 0);\n    for (j = 1; j < width; j++) {\n      sum =\n        (sum >> 2) +\n        (data[pos + 1] ? 4 : 0) +\n        (data[pos - lineSize + 1] ? 8 : 0);\n      if (POINT_TYPES[sum]) {\n        points[j0 + j] = POINT_TYPES[sum];\n        ++count;\n      }\n      pos++;\n    }\n    if (data[pos - lineSize] !== data[pos]) {\n      points[j0 + j] = data[pos] ? 2 : 4;\n      ++count;\n    }\n\n    if (count > POINT_TO_PROCESS_LIMIT) {\n      return null;\n    }\n  }\n\n  pos = lineSize * (height - 1);\n  j0 = i * width1;\n  if (data[pos] !== 0) {\n    points[j0] = 8;\n    ++count;\n  }\n  for (j = 1; j < width; j++) {\n    if (data[pos] !== data[pos + 1]) {\n      points[j0 + j] = data[pos] ? 4 : 8;\n      ++count;\n    }\n    pos++;\n  }\n  if (data[pos] !== 0) {\n    points[j0 + j] = 4;\n    ++count;\n  }\n  if (count > POINT_TO_PROCESS_LIMIT) {\n    return null;\n  }\n\n  // building outlines\n  const steps = new Int32Array([0, width1, -1, 0, -width1, 0, 0, 0, 1]);\n  const path = new Path2D();\n\n  for (i = 0; count && i <= height; i++) {\n    let p = i * width1;\n    const end = p + width;\n    while (p < end && !points[p]) {\n      p++;\n    }\n    if (p === end) {\n      continue;\n    }\n    path.moveTo(p % width1, i);\n\n    const p0 = p;\n    let type = points[p];\n    do {\n      const step = steps[type];\n      do {\n        p += step;\n      } while (!points[p]);\n\n      const pp = points[p];\n      if (pp !== 5 && pp !== 10) {\n        // set new direction\n        type = pp;\n        // delete mark\n        points[p] = 0;\n      } else {\n        // type is 5 or 10, ie, a crossing\n        // set new direction\n        type = pp & ((0x33 * type) >> 4);\n        // set new type for \"future hit\"\n        points[p] &= (type >> 2) | (type << 2);\n      }\n      path.lineTo(p % width1, (p / width1) | 0);\n\n      if (!points[p]) {\n        --count;\n      }\n    } while (p0 !== p);\n    --i;\n  }\n\n  // Immediately release the, potentially large, `Uint8Array`s after parsing.\n  data = null;\n  points = null;\n\n  const drawOutline = function (c) {\n    c.save();\n    // the path shall be painted in [0..1]x[0..1] space\n    c.scale(1 / width, -1 / height);\n    c.translate(0, -height);\n    c.fill(path);\n    c.beginPath();\n    c.restore();\n  };\n\n  return drawOutline;\n}\n\nclass CanvasExtraState {\n  constructor(width, height) {\n    // Are soft masks and alpha values shapes or opacities?\n    this.alphaIsShape = false;\n    this.fontSize = 0;\n    this.fontSizeScale = 1;\n    this.textMatrix = IDENTITY_MATRIX;\n    this.textMatrixScale = 1;\n    this.fontMatrix = FONT_IDENTITY_MATRIX;\n    this.leading = 0;\n    // Current point (in user coordinates)\n    this.x = 0;\n    this.y = 0;\n    // Start of text line (in text coordinates)\n    this.lineX = 0;\n    this.lineY = 0;\n    // Character and word spacing\n    this.charSpacing = 0;\n    this.wordSpacing = 0;\n    this.textHScale = 1;\n    this.textRenderingMode = TextRenderingMode.FILL;\n    this.textRise = 0;\n    // Default fore and background colors\n    this.fillColor = \"#000000\";\n    this.strokeColor = \"#000000\";\n    this.patternFill = false;\n    // Note: fill alpha applies to all non-stroking operations\n    this.fillAlpha = 1;\n    this.strokeAlpha = 1;\n    this.lineWidth = 1;\n    this.activeSMask = null;\n    this.transferMaps = \"none\";\n\n    this.startNewPathAndClipBox([0, 0, width, height]);\n  }\n\n  clone() {\n    const clone = Object.create(this);\n    clone.clipBox = this.clipBox.slice();\n    return clone;\n  }\n\n  setCurrentPoint(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  updatePathMinMax(transform, x, y) {\n    [x, y] = Util.applyTransform([x, y], transform);\n    this.minX = Math.min(this.minX, x);\n    this.minY = Math.min(this.minY, y);\n    this.maxX = Math.max(this.maxX, x);\n    this.maxY = Math.max(this.maxY, y);\n  }\n\n  updateRectMinMax(transform, rect) {\n    const p1 = Util.applyTransform(rect, transform);\n    const p2 = Util.applyTransform(rect.slice(2), transform);\n    const p3 = Util.applyTransform([rect[0], rect[3]], transform);\n    const p4 = Util.applyTransform([rect[2], rect[1]], transform);\n\n    this.minX = Math.min(this.minX, p1[0], p2[0], p3[0], p4[0]);\n    this.minY = Math.min(this.minY, p1[1], p2[1], p3[1], p4[1]);\n    this.maxX = Math.max(this.maxX, p1[0], p2[0], p3[0], p4[0]);\n    this.maxY = Math.max(this.maxY, p1[1], p2[1], p3[1], p4[1]);\n  }\n\n  updateScalingPathMinMax(transform, minMax) {\n    Util.scaleMinMax(transform, minMax);\n    this.minX = Math.min(this.minX, minMax[0]);\n    this.maxX = Math.max(this.maxX, minMax[1]);\n    this.minY = Math.min(this.minY, minMax[2]);\n    this.maxY = Math.max(this.maxY, minMax[3]);\n  }\n\n  updateCurvePathMinMax(transform, x0, y0, x1, y1, x2, y2, x3, y3, minMax) {\n    const box = Util.bezierBoundingBox(x0, y0, x1, y1, x2, y2, x3, y3);\n    if (minMax) {\n      minMax[0] = Math.min(minMax[0], box[0], box[2]);\n      minMax[1] = Math.max(minMax[1], box[0], box[2]);\n      minMax[2] = Math.min(minMax[2], box[1], box[3]);\n      minMax[3] = Math.max(minMax[3], box[1], box[3]);\n      return;\n    }\n    this.updateRectMinMax(transform, box);\n  }\n\n  getPathBoundingBox(pathType = PathType.FILL, transform = null) {\n    const box = [this.minX, this.minY, this.maxX, this.maxY];\n    if (pathType === PathType.STROKE) {\n      if (!transform) {\n        unreachable(\"Stroke bounding box must include transform.\");\n      }\n      // Stroked paths can be outside of the path bounding box by 1/2 the line\n      // width.\n      const scale = Util.singularValueDecompose2dScale(transform);\n      const xStrokePad = (scale[0] * this.lineWidth) / 2;\n      const yStrokePad = (scale[1] * this.lineWidth) / 2;\n      box[0] -= xStrokePad;\n      box[1] -= yStrokePad;\n      box[2] += xStrokePad;\n      box[3] += yStrokePad;\n    }\n    return box;\n  }\n\n  updateClipFromPath() {\n    const intersect = Util.intersect(this.clipBox, this.getPathBoundingBox());\n    this.startNewPathAndClipBox(intersect || [0, 0, 0, 0]);\n  }\n\n  isEmptyClip() {\n    return this.minX === Infinity;\n  }\n\n  startNewPathAndClipBox(box) {\n    this.clipBox = box;\n    this.minX = Infinity;\n    this.minY = Infinity;\n    this.maxX = 0;\n    this.maxY = 0;\n  }\n\n  getClippedPathBoundingBox(pathType = PathType.FILL, transform = null) {\n    return Util.intersect(\n      this.clipBox,\n      this.getPathBoundingBox(pathType, transform)\n    );\n  }\n}\n\nfunction putBinaryImageData(ctx, imgData) {\n  if (typeof ImageData !== \"undefined\" && imgData instanceof ImageData) {\n    ctx.putImageData(imgData, 0, 0);\n    return;\n  }\n\n  // Put the image data to the canvas in chunks, rather than putting the\n  // whole image at once.  This saves JS memory, because the ImageData object\n  // is smaller. It also possibly saves C++ memory within the implementation\n  // of putImageData(). (E.g. in Firefox we make two short-lived copies of\n  // the data passed to putImageData()). |n| shouldn't be too small, however,\n  // because too many putImageData() calls will slow things down.\n  //\n  // Note: as written, if the last chunk is partial, the putImageData() call\n  // will (conceptually) put pixels past the bounds of the canvas.  But\n  // that's ok; any such pixels are ignored.\n\n  const height = imgData.height,\n    width = imgData.width;\n  const partialChunkHeight = height % FULL_CHUNK_HEIGHT;\n  const fullChunks = (height - partialChunkHeight) / FULL_CHUNK_HEIGHT;\n  const totalChunks = partialChunkHeight === 0 ? fullChunks : fullChunks + 1;\n\n  const chunkImgData = ctx.createImageData(width, FULL_CHUNK_HEIGHT);\n  let srcPos = 0,\n    destPos;\n  const src = imgData.data;\n  const dest = chunkImgData.data;\n  let i, j, thisChunkHeight, elemsInThisChunk;\n\n  // There are multiple forms in which the pixel data can be passed, and\n  // imgData.kind tells us which one this is.\n  if (imgData.kind === ImageKind.GRAYSCALE_1BPP) {\n    // Grayscale, 1 bit per pixel (i.e. black-and-white).\n    const srcLength = src.byteLength;\n    const dest32 = new Uint32Array(dest.buffer, 0, dest.byteLength >> 2);\n    const dest32DataLength = dest32.length;\n    const fullSrcDiff = (width + 7) >> 3;\n    const white = 0xffffffff;\n    const black = FeatureTest.isLittleEndian ? 0xff000000 : 0x000000ff;\n\n    for (i = 0; i < totalChunks; i++) {\n      thisChunkHeight = i < fullChunks ? FULL_CHUNK_HEIGHT : partialChunkHeight;\n      destPos = 0;\n      for (j = 0; j < thisChunkHeight; j++) {\n        const srcDiff = srcLength - srcPos;\n        let k = 0;\n        const kEnd = srcDiff > fullSrcDiff ? width : srcDiff * 8 - 7;\n        const kEndUnrolled = kEnd & ~7;\n        let mask = 0;\n        let srcByte = 0;\n        for (; k < kEndUnrolled; k += 8) {\n          srcByte = src[srcPos++];\n          dest32[destPos++] = srcByte & 128 ? white : black;\n          dest32[destPos++] = srcByte & 64 ? white : black;\n          dest32[destPos++] = srcByte & 32 ? white : black;\n          dest32[destPos++] = srcByte & 16 ? white : black;\n          dest32[destPos++] = srcByte & 8 ? white : black;\n          dest32[destPos++] = srcByte & 4 ? white : black;\n          dest32[destPos++] = srcByte & 2 ? white : black;\n          dest32[destPos++] = srcByte & 1 ? white : black;\n        }\n        for (; k < kEnd; k++) {\n          if (mask === 0) {\n            srcByte = src[srcPos++];\n            mask = 128;\n          }\n\n          dest32[destPos++] = srcByte & mask ? white : black;\n          mask >>= 1;\n        }\n      }\n      // We ran out of input. Make all remaining pixels transparent.\n      while (destPos < dest32DataLength) {\n        dest32[destPos++] = 0;\n      }\n\n      ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n    }\n  } else if (imgData.kind === ImageKind.RGBA_32BPP) {\n    // RGBA, 32-bits per pixel.\n    j = 0;\n    elemsInThisChunk = width * FULL_CHUNK_HEIGHT * 4;\n    for (i = 0; i < fullChunks; i++) {\n      dest.set(src.subarray(srcPos, srcPos + elemsInThisChunk));\n      srcPos += elemsInThisChunk;\n\n      ctx.putImageData(chunkImgData, 0, j);\n      j += FULL_CHUNK_HEIGHT;\n    }\n    if (i < totalChunks) {\n      elemsInThisChunk = width * partialChunkHeight * 4;\n      dest.set(src.subarray(srcPos, srcPos + elemsInThisChunk));\n\n      ctx.putImageData(chunkImgData, 0, j);\n    }\n  } else if (imgData.kind === ImageKind.RGB_24BPP) {\n    // RGB, 24-bits per pixel.\n    thisChunkHeight = FULL_CHUNK_HEIGHT;\n    elemsInThisChunk = width * thisChunkHeight;\n    for (i = 0; i < totalChunks; i++) {\n      if (i >= fullChunks) {\n        thisChunkHeight = partialChunkHeight;\n        elemsInThisChunk = width * thisChunkHeight;\n      }\n\n      destPos = 0;\n      for (j = elemsInThisChunk; j--; ) {\n        dest[destPos++] = src[srcPos++];\n        dest[destPos++] = src[srcPos++];\n        dest[destPos++] = src[srcPos++];\n        dest[destPos++] = 255;\n      }\n\n      ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n    }\n  } else {\n    throw new Error(`bad image kind: ${imgData.kind}`);\n  }\n}\n\nfunction putBinaryImageMask(ctx, imgData) {\n  if (imgData.bitmap) {\n    // The bitmap has been created in the worker.\n    ctx.drawImage(imgData.bitmap, 0, 0);\n    return;\n  }\n\n  // Slow path: OffscreenCanvas isn't available in the worker.\n  const height = imgData.height,\n    width = imgData.width;\n  const partialChunkHeight = height % FULL_CHUNK_HEIGHT;\n  const fullChunks = (height - partialChunkHeight) / FULL_CHUNK_HEIGHT;\n  const totalChunks = partialChunkHeight === 0 ? fullChunks : fullChunks + 1;\n\n  const chunkImgData = ctx.createImageData(width, FULL_CHUNK_HEIGHT);\n  let srcPos = 0;\n  const src = imgData.data;\n  const dest = chunkImgData.data;\n\n  for (let i = 0; i < totalChunks; i++) {\n    const thisChunkHeight =\n      i < fullChunks ? FULL_CHUNK_HEIGHT : partialChunkHeight;\n\n    // Expand the mask so it can be used by the canvas.  Any required\n    // inversion has already been handled.\n\n    ({ srcPos } = convertBlackAndWhiteToRGBA({\n      src,\n      srcPos,\n      dest,\n      width,\n      height: thisChunkHeight,\n      nonBlackColor: 0,\n    }));\n\n    ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n  }\n}\n\nfunction copyCtxState(sourceCtx, destCtx) {\n  const properties = [\n    \"strokeStyle\",\n    \"fillStyle\",\n    \"fillRule\",\n    \"globalAlpha\",\n    \"lineWidth\",\n    \"lineCap\",\n    \"lineJoin\",\n    \"miterLimit\",\n    \"globalCompositeOperation\",\n    \"font\",\n    \"filter\",\n  ];\n  for (const property of properties) {\n    if (sourceCtx[property] !== undefined) {\n      destCtx[property] = sourceCtx[property];\n    }\n  }\n  if (sourceCtx.setLineDash !== undefined) {\n    destCtx.setLineDash(sourceCtx.getLineDash());\n    destCtx.lineDashOffset = sourceCtx.lineDashOffset;\n  }\n}\n\nfunction resetCtxToDefault(ctx) {\n  ctx.strokeStyle = ctx.fillStyle = \"#000000\";\n  ctx.fillRule = \"nonzero\";\n  ctx.globalAlpha = 1;\n  ctx.lineWidth = 1;\n  ctx.lineCap = \"butt\";\n  ctx.lineJoin = \"miter\";\n  ctx.miterLimit = 10;\n  ctx.globalCompositeOperation = \"source-over\";\n  ctx.font = \"10px sans-serif\";\n  if (ctx.setLineDash !== undefined) {\n    ctx.setLineDash([]);\n    ctx.lineDashOffset = 0;\n  }\n  if (\n    (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n    !isNodeJS\n  ) {\n    const { filter } = ctx;\n    if (filter !== \"none\" && filter !== \"\") {\n      ctx.filter = \"none\";\n    }\n  }\n}\n\nfunction composeSMaskBackdrop(bytes, r0, g0, b0) {\n  const length = bytes.length;\n  for (let i = 3; i < length; i += 4) {\n    const alpha = bytes[i];\n    if (alpha === 0) {\n      bytes[i - 3] = r0;\n      bytes[i - 2] = g0;\n      bytes[i - 1] = b0;\n    } else if (alpha < 255) {\n      const alpha_ = 255 - alpha;\n      bytes[i - 3] = (bytes[i - 3] * alpha + r0 * alpha_) >> 8;\n      bytes[i - 2] = (bytes[i - 2] * alpha + g0 * alpha_) >> 8;\n      bytes[i - 1] = (bytes[i - 1] * alpha + b0 * alpha_) >> 8;\n    }\n  }\n}\n\nfunction composeSMaskAlpha(maskData, layerData, transferMap) {\n  const length = maskData.length;\n  const scale = 1 / 255;\n  for (let i = 3; i < length; i += 4) {\n    const alpha = transferMap ? transferMap[maskData[i]] : maskData[i];\n    layerData[i] = (layerData[i] * alpha * scale) | 0;\n  }\n}\n\nfunction composeSMaskLuminosity(maskData, layerData, transferMap) {\n  const length = maskData.length;\n  for (let i = 3; i < length; i += 4) {\n    const y =\n      maskData[i - 3] * 77 + // * 0.3 / 255 * 0x10000\n      maskData[i - 2] * 152 + // * 0.59 ....\n      maskData[i - 1] * 28; // * 0.11 ....\n    layerData[i] = transferMap\n      ? (layerData[i] * transferMap[y >> 8]) >> 8\n      : (layerData[i] * y) >> 16;\n  }\n}\n\nfunction genericComposeSMask(\n  maskCtx,\n  layerCtx,\n  width,\n  height,\n  subtype,\n  backdrop,\n  transferMap,\n  layerOffsetX,\n  layerOffsetY,\n  maskOffsetX,\n  maskOffsetY\n) {\n  const hasBackdrop = !!backdrop;\n  const r0 = hasBackdrop ? backdrop[0] : 0;\n  const g0 = hasBackdrop ? backdrop[1] : 0;\n  const b0 = hasBackdrop ? backdrop[2] : 0;\n\n  const composeFn =\n    subtype === \"Luminosity\" ? composeSMaskLuminosity : composeSMaskAlpha;\n\n  // processing image in chunks to save memory\n  const PIXELS_TO_PROCESS = 1048576;\n  const chunkSize = Math.min(height, Math.ceil(PIXELS_TO_PROCESS / width));\n  for (let row = 0; row < height; row += chunkSize) {\n    const chunkHeight = Math.min(chunkSize, height - row);\n    const maskData = maskCtx.getImageData(\n      layerOffsetX - maskOffsetX,\n      row + (layerOffsetY - maskOffsetY),\n      width,\n      chunkHeight\n    );\n    const layerData = layerCtx.getImageData(\n      layerOffsetX,\n      row + layerOffsetY,\n      width,\n      chunkHeight\n    );\n\n    if (hasBackdrop) {\n      composeSMaskBackdrop(maskData.data, r0, g0, b0);\n    }\n    composeFn(maskData.data, layerData.data, transferMap);\n\n    layerCtx.putImageData(layerData, layerOffsetX, row + layerOffsetY);\n  }\n}\n\nfunction composeSMask(ctx, smask, layerCtx, layerBox) {\n  const layerOffsetX = layerBox[0];\n  const layerOffsetY = layerBox[1];\n  const layerWidth = layerBox[2] - layerOffsetX;\n  const layerHeight = layerBox[3] - layerOffsetY;\n  if (layerWidth === 0 || layerHeight === 0) {\n    return;\n  }\n  genericComposeSMask(\n    smask.context,\n    layerCtx,\n    layerWidth,\n    layerHeight,\n    smask.subtype,\n    smask.backdrop,\n    smask.transferMap,\n    layerOffsetX,\n    layerOffsetY,\n    smask.offsetX,\n    smask.offsetY\n  );\n  ctx.save();\n  ctx.globalAlpha = 1;\n  ctx.globalCompositeOperation = \"source-over\";\n  ctx.setTransform(1, 0, 0, 1, 0, 0);\n  ctx.drawImage(layerCtx.canvas, 0, 0);\n  ctx.restore();\n}\n\nfunction getImageSmoothingEnabled(transform, interpolate) {\n  const scale = Util.singularValueDecompose2dScale(transform);\n  // Round to a 32bit float so that `<=` check below will pass for numbers that\n  // are very close, but not exactly the same 64bit floats.\n  scale[0] = Math.fround(scale[0]);\n  scale[1] = Math.fround(scale[1]);\n  const actualScale = Math.fround(\n    (globalThis.devicePixelRatio || 1) * PixelsPerInch.PDF_TO_CSS_UNITS\n  );\n  if (interpolate !== undefined) {\n    // If the value is explicitly set use it.\n    return interpolate;\n  } else if (scale[0] <= actualScale || scale[1] <= actualScale) {\n    // Smooth when downscaling.\n    return true;\n  }\n  // Don't smooth when upscaling.\n  return false;\n}\n\nconst LINE_CAP_STYLES = [\"butt\", \"round\", \"square\"];\nconst LINE_JOIN_STYLES = [\"miter\", \"round\", \"bevel\"];\nconst NORMAL_CLIP = {};\nconst EO_CLIP = {};\n\nclass CanvasGraphics {\n  constructor(\n    canvasCtx,\n    commonObjs,\n    objs,\n    canvasFactory,\n    filterFactory,\n    { optionalContentConfig, markedContentStack = null },\n    annotationCanvasMap,\n    pageColors\n  ) {\n    this.ctx = canvasCtx;\n    this.current = new CanvasExtraState(\n      this.ctx.canvas.width,\n      this.ctx.canvas.height\n    );\n    this.stateStack = [];\n    this.pendingClip = null;\n    this.pendingEOFill = false;\n    this.res = null;\n    this.xobjs = null;\n    this.commonObjs = commonObjs;\n    this.objs = objs;\n    this.canvasFactory = canvasFactory;\n    this.filterFactory = filterFactory;\n    this.groupStack = [];\n    this.processingType3 = null;\n    // Patterns are painted relative to the initial page/form transform, see\n    // PDF spec 8.7.2 NOTE 1.\n    this.baseTransform = null;\n    this.baseTransformStack = [];\n    this.groupLevel = 0;\n    this.smaskStack = [];\n    this.smaskCounter = 0;\n    this.tempSMask = null;\n    this.suspendedCtx = null;\n    this.contentVisible = true;\n    this.markedContentStack = markedContentStack || [];\n    this.optionalContentConfig = optionalContentConfig;\n    this.cachedCanvases = new CachedCanvases(this.canvasFactory);\n    this.cachedPatterns = new Map();\n    this.annotationCanvasMap = annotationCanvasMap;\n    this.viewportScale = 1;\n    this.outputScaleX = 1;\n    this.outputScaleY = 1;\n    this.pageColors = pageColors;\n\n    this._cachedScaleForStroking = [-1, 0];\n    this._cachedGetSinglePixelWidth = null;\n    this._cachedBitmapsMap = new Map();\n  }\n\n  getObject(data, fallback = null) {\n    if (typeof data === \"string\") {\n      return data.startsWith(\"g_\")\n        ? this.commonObjs.get(data)\n        : this.objs.get(data);\n    }\n    return fallback;\n  }\n\n  beginDrawing({\n    transform,\n    viewport,\n    transparency = false,\n    background = null,\n  }) {\n    // For pdfs that use blend modes we have to clear the canvas else certain\n    // blend modes can look wrong since we'd be blending with a white\n    // backdrop. The problem with a transparent backdrop though is we then\n    // don't get sub pixel anti aliasing on text, creating temporary\n    // transparent canvas when we have blend modes.\n    const width = this.ctx.canvas.width;\n    const height = this.ctx.canvas.height;\n\n    const savedFillStyle = this.ctx.fillStyle;\n    this.ctx.fillStyle = background || \"#ffffff\";\n    this.ctx.fillRect(0, 0, width, height);\n    this.ctx.fillStyle = savedFillStyle;\n\n    if (transparency) {\n      const transparentCanvas = this.cachedCanvases.getCanvas(\n        \"transparent\",\n        width,\n        height\n      );\n      this.compositeCtx = this.ctx;\n      this.transparentCanvas = transparentCanvas.canvas;\n      this.ctx = transparentCanvas.context;\n      this.ctx.save();\n      // The transform can be applied before rendering, transferring it to\n      // the new canvas.\n      this.ctx.transform(...getCurrentTransform(this.compositeCtx));\n    }\n\n    this.ctx.save();\n    resetCtxToDefault(this.ctx);\n    if (transform) {\n      this.ctx.transform(...transform);\n      this.outputScaleX = transform[0];\n      this.outputScaleY = transform[0];\n    }\n    this.ctx.transform(...viewport.transform);\n    this.viewportScale = viewport.scale;\n\n    this.baseTransform = getCurrentTransform(this.ctx);\n  }\n\n  executeOperatorList(\n    operatorList,\n    executionStartIdx,\n    continueCallback,\n    stepper\n  ) {\n    const argsArray = operatorList.argsArray;\n    const fnArray = operatorList.fnArray;\n    let i = executionStartIdx || 0;\n    const argsArrayLen = argsArray.length;\n\n    // Sometimes the OperatorList to execute is empty.\n    if (argsArrayLen === i) {\n      return i;\n    }\n\n    const chunkOperations =\n      argsArrayLen - i > EXECUTION_STEPS &&\n      typeof continueCallback === \"function\";\n    const endTime = chunkOperations ? Date.now() + EXECUTION_TIME : 0;\n    let steps = 0;\n\n    const commonObjs = this.commonObjs;\n    const objs = this.objs;\n    let fnId;\n\n    while (true) {\n      if (stepper !== undefined && i === stepper.nextBreakPoint) {\n        stepper.breakIt(i, continueCallback);\n        return i;\n      }\n\n      fnId = fnArray[i];\n\n      if (fnId !== OPS.dependency) {\n        // eslint-disable-next-line prefer-spread\n        this[fnId].apply(this, argsArray[i]);\n      } else {\n        for (const depObjId of argsArray[i]) {\n          const objsPool = depObjId.startsWith(\"g_\") ? commonObjs : objs;\n\n          // If the promise isn't resolved yet, add the continueCallback\n          // to the promise and bail out.\n          if (!objsPool.has(depObjId)) {\n            objsPool.get(depObjId, continueCallback);\n            return i;\n          }\n        }\n      }\n\n      i++;\n\n      // If the entire operatorList was executed, stop as were done.\n      if (i === argsArrayLen) {\n        return i;\n      }\n\n      // If the execution took longer then a certain amount of time and\n      // `continueCallback` is specified, interrupt the execution.\n      if (chunkOperations && ++steps > EXECUTION_STEPS) {\n        if (Date.now() > endTime) {\n          continueCallback();\n          return i;\n        }\n        steps = 0;\n      }\n\n      // If the operatorList isn't executed completely yet OR the execution\n      // time was short enough, do another execution round.\n    }\n  }\n\n  #restoreInitialState() {\n    // Finishing all opened operations such as SMask group painting.\n    while (this.stateStack.length || this.inSMaskMode) {\n      this.restore();\n    }\n\n    this.ctx.restore();\n\n    if (this.transparentCanvas) {\n      this.ctx = this.compositeCtx;\n      this.ctx.save();\n      this.ctx.setTransform(1, 0, 0, 1, 0, 0); // Avoid apply transform twice\n      this.ctx.drawImage(this.transparentCanvas, 0, 0);\n      this.ctx.restore();\n      this.transparentCanvas = null;\n    }\n  }\n\n  endDrawing() {\n    this.#restoreInitialState();\n\n    this.cachedCanvases.clear();\n    this.cachedPatterns.clear();\n\n    for (const cache of this._cachedBitmapsMap.values()) {\n      for (const canvas of cache.values()) {\n        if (\n          typeof HTMLCanvasElement !== \"undefined\" &&\n          canvas instanceof HTMLCanvasElement\n        ) {\n          canvas.width = canvas.height = 0;\n        }\n      }\n      cache.clear();\n    }\n    this._cachedBitmapsMap.clear();\n    this.#drawFilter();\n  }\n\n  #drawFilter() {\n    if (this.pageColors) {\n      const hcmFilterId = this.filterFactory.addHCMFilter(\n        this.pageColors.foreground,\n        this.pageColors.background\n      );\n      if (hcmFilterId !== \"none\") {\n        const savedFilter = this.ctx.filter;\n        this.ctx.filter = hcmFilterId;\n        this.ctx.drawImage(this.ctx.canvas, 0, 0);\n        this.ctx.filter = savedFilter;\n      }\n    }\n  }\n\n  _scaleImage(img, inverseTransform) {\n    // Vertical or horizontal scaling shall not be more than 2 to not lose the\n    // pixels during drawImage operation, painting on the temporary canvas(es)\n    // that are twice smaller in size.\n    const width = img.width;\n    const height = img.height;\n    let widthScale = Math.max(\n      Math.hypot(inverseTransform[0], inverseTransform[1]),\n      1\n    );\n    let heightScale = Math.max(\n      Math.hypot(inverseTransform[2], inverseTransform[3]),\n      1\n    );\n\n    let paintWidth = width,\n      paintHeight = height;\n    let tmpCanvasId = \"prescale1\";\n    let tmpCanvas, tmpCtx;\n    while (\n      (widthScale > 2 && paintWidth > 1) ||\n      (heightScale > 2 && paintHeight > 1)\n    ) {\n      let newWidth = paintWidth,\n        newHeight = paintHeight;\n      if (widthScale > 2 && paintWidth > 1) {\n        // See bug 1820511 (Windows specific bug).\n        // TODO: once the above bug is fixed we could revert to:\n        // newWidth = Math.ceil(paintWidth / 2);\n        newWidth =\n          paintWidth >= 16384\n            ? Math.floor(paintWidth / 2) - 1 || 1\n            : Math.ceil(paintWidth / 2);\n        widthScale /= paintWidth / newWidth;\n      }\n      if (heightScale > 2 && paintHeight > 1) {\n        // TODO: see the comment above.\n        newHeight =\n          paintHeight >= 16384\n            ? Math.floor(paintHeight / 2) - 1 || 1\n            : Math.ceil(paintHeight) / 2;\n        heightScale /= paintHeight / newHeight;\n      }\n      tmpCanvas = this.cachedCanvases.getCanvas(\n        tmpCanvasId,\n        newWidth,\n        newHeight\n      );\n      tmpCtx = tmpCanvas.context;\n      tmpCtx.clearRect(0, 0, newWidth, newHeight);\n      tmpCtx.drawImage(\n        img,\n        0,\n        0,\n        paintWidth,\n        paintHeight,\n        0,\n        0,\n        newWidth,\n        newHeight\n      );\n      img = tmpCanvas.canvas;\n      paintWidth = newWidth;\n      paintHeight = newHeight;\n      tmpCanvasId = tmpCanvasId === \"prescale1\" ? \"prescale2\" : \"prescale1\";\n    }\n    return {\n      img,\n      paintWidth,\n      paintHeight,\n    };\n  }\n\n  _createMaskCanvas(img) {\n    const ctx = this.ctx;\n    const { width, height } = img;\n    const fillColor = this.current.fillColor;\n    const isPatternFill = this.current.patternFill;\n    const currentTransform = getCurrentTransform(ctx);\n\n    let cache, cacheKey, scaled, maskCanvas;\n    if ((img.bitmap || img.data) && img.count > 1) {\n      const mainKey = img.bitmap || img.data.buffer;\n      // We're reusing the same image several times, so we can cache it.\n      // In case we've a pattern fill we just keep the scaled version of\n      // the image.\n      // Only the scaling part matters, the translation part is just used\n      // to compute offsets (but not when filling patterns see #15573).\n      // TODO: handle the case of a pattern fill if it's possible.\n      cacheKey = JSON.stringify(\n        isPatternFill\n          ? currentTransform\n          : [currentTransform.slice(0, 4), fillColor]\n      );\n\n      cache = this._cachedBitmapsMap.get(mainKey);\n      if (!cache) {\n        cache = new Map();\n        this._cachedBitmapsMap.set(mainKey, cache);\n      }\n      const cachedImage = cache.get(cacheKey);\n      if (cachedImage && !isPatternFill) {\n        const offsetX = Math.round(\n          Math.min(currentTransform[0], currentTransform[2]) +\n            currentTransform[4]\n        );\n        const offsetY = Math.round(\n          Math.min(currentTransform[1], currentTransform[3]) +\n            currentTransform[5]\n        );\n        return {\n          canvas: cachedImage,\n          offsetX,\n          offsetY,\n        };\n      }\n      scaled = cachedImage;\n    }\n\n    if (!scaled) {\n      maskCanvas = this.cachedCanvases.getCanvas(\"maskCanvas\", width, height);\n      putBinaryImageMask(maskCanvas.context, img);\n    }\n\n    // Create the mask canvas at the size it will be drawn at and also set\n    // its transform to match the current transform so if there are any\n    // patterns applied they will be applied relative to the correct\n    // transform.\n\n    let maskToCanvas = Util.transform(currentTransform, [\n      1 / width,\n      0,\n      0,\n      -1 / height,\n      0,\n      0,\n    ]);\n    maskToCanvas = Util.transform(maskToCanvas, [1, 0, 0, 1, 0, -height]);\n    const [minX, minY, maxX, maxY] = Util.getAxialAlignedBoundingBox(\n      [0, 0, width, height],\n      maskToCanvas\n    );\n    const drawnWidth = Math.round(maxX - minX) || 1;\n    const drawnHeight = Math.round(maxY - minY) || 1;\n    const fillCanvas = this.cachedCanvases.getCanvas(\n      \"fillCanvas\",\n      drawnWidth,\n      drawnHeight\n    );\n    const fillCtx = fillCanvas.context;\n\n    // The offset will be the top-left cordinate mask.\n    // If objToCanvas is [a,b,c,d,e,f] then:\n    //   - offsetX = min(a, c) + e\n    //   - offsetY = min(b, d) + f\n    const offsetX = minX;\n    const offsetY = minY;\n    fillCtx.translate(-offsetX, -offsetY);\n    fillCtx.transform(...maskToCanvas);\n\n    if (!scaled) {\n      // Pre-scale if needed to improve image smoothing.\n      scaled = this._scaleImage(\n        maskCanvas.canvas,\n        getCurrentTransformInverse(fillCtx)\n      );\n      scaled = scaled.img;\n      if (cache && isPatternFill) {\n        cache.set(cacheKey, scaled);\n      }\n    }\n\n    fillCtx.imageSmoothingEnabled = getImageSmoothingEnabled(\n      getCurrentTransform(fillCtx),\n      img.interpolate\n    );\n\n    drawImageAtIntegerCoords(\n      fillCtx,\n      scaled,\n      0,\n      0,\n      scaled.width,\n      scaled.height,\n      0,\n      0,\n      width,\n      height\n    );\n    fillCtx.globalCompositeOperation = \"source-in\";\n\n    const inverse = Util.transform(getCurrentTransformInverse(fillCtx), [\n      1,\n      0,\n      0,\n      1,\n      -offsetX,\n      -offsetY,\n    ]);\n    fillCtx.fillStyle = isPatternFill\n      ? fillColor.getPattern(ctx, this, inverse, PathType.FILL)\n      : fillColor;\n\n    fillCtx.fillRect(0, 0, width, height);\n\n    if (cache && !isPatternFill) {\n      // The fill canvas is put in the cache associated to the mask image\n      // so we must remove from the cached canvas: it mustn't be used again.\n      this.cachedCanvases.delete(\"fillCanvas\");\n      cache.set(cacheKey, fillCanvas.canvas);\n    }\n\n    // Round the offsets to avoid drawing fractional pixels.\n    return {\n      canvas: fillCanvas.canvas,\n      offsetX: Math.round(offsetX),\n      offsetY: Math.round(offsetY),\n    };\n  }\n\n  // Graphics state\n  setLineWidth(width) {\n    if (width !== this.current.lineWidth) {\n      this._cachedScaleForStroking[0] = -1;\n    }\n    this.current.lineWidth = width;\n    this.ctx.lineWidth = width;\n  }\n\n  setLineCap(style) {\n    this.ctx.lineCap = LINE_CAP_STYLES[style];\n  }\n\n  setLineJoin(style) {\n    this.ctx.lineJoin = LINE_JOIN_STYLES[style];\n  }\n\n  setMiterLimit(limit) {\n    this.ctx.miterLimit = limit;\n  }\n\n  setDash(dashArray, dashPhase) {\n    const ctx = this.ctx;\n    if (ctx.setLineDash !== undefined) {\n      ctx.setLineDash(dashArray);\n      ctx.lineDashOffset = dashPhase;\n    }\n  }\n\n  setRenderingIntent(intent) {\n    // This operation is ignored since we haven't found a use case for it yet.\n  }\n\n  setFlatness(flatness) {\n    // This operation is ignored since we haven't found a use case for it yet.\n  }\n\n  setGState(states) {\n    for (const [key, value] of states) {\n      switch (key) {\n        case \"LW\":\n          this.setLineWidth(value);\n          break;\n        case \"LC\":\n          this.setLineCap(value);\n          break;\n        case \"LJ\":\n          this.setLineJoin(value);\n          break;\n        case \"ML\":\n          this.setMiterLimit(value);\n          break;\n        case \"D\":\n          this.setDash(value[0], value[1]);\n          break;\n        case \"RI\":\n          this.setRenderingIntent(value);\n          break;\n        case \"FL\":\n          this.setFlatness(value);\n          break;\n        case \"Font\":\n          this.setFont(value[0], value[1]);\n          break;\n        case \"CA\":\n          this.current.strokeAlpha = value;\n          break;\n        case \"ca\":\n          this.current.fillAlpha = value;\n          this.ctx.globalAlpha = value;\n          break;\n        case \"BM\":\n          this.ctx.globalCompositeOperation = value;\n          break;\n        case \"SMask\":\n          this.current.activeSMask = value ? this.tempSMask : null;\n          this.tempSMask = null;\n          this.checkSMaskState();\n          break;\n        case \"TR\":\n          this.ctx.filter = this.current.transferMaps =\n            this.filterFactory.addFilter(value);\n          break;\n      }\n    }\n  }\n\n  get inSMaskMode() {\n    return !!this.suspendedCtx;\n  }\n\n  checkSMaskState() {\n    const inSMaskMode = this.inSMaskMode;\n    if (this.current.activeSMask && !inSMaskMode) {\n      this.beginSMaskMode();\n    } else if (!this.current.activeSMask && inSMaskMode) {\n      this.endSMaskMode();\n    }\n    // Else, the state is okay and nothing needs to be done.\n  }\n\n  /**\n   * Soft mask mode takes the current main drawing canvas and replaces it with\n   * a temporary canvas. Any drawing operations that happen on the temporary\n   * canvas need to be composed with the main canvas that was suspended (see\n   * `compose()`). The temporary canvas also duplicates many of its operations\n   * on the suspended canvas to keep them in sync, so that when the soft mask\n   * mode ends any clipping paths or transformations will still be active and in\n   * the right order on the canvas' graphics state stack.\n   */\n  beginSMaskMode() {\n    if (this.inSMaskMode) {\n      throw new Error(\"beginSMaskMode called while already in smask mode\");\n    }\n    const drawnWidth = this.ctx.canvas.width;\n    const drawnHeight = this.ctx.canvas.height;\n    const cacheId = \"smaskGroupAt\" + this.groupLevel;\n    const scratchCanvas = this.cachedCanvases.getCanvas(\n      cacheId,\n      drawnWidth,\n      drawnHeight\n    );\n    this.suspendedCtx = this.ctx;\n    this.ctx = scratchCanvas.context;\n    const ctx = this.ctx;\n    ctx.setTransform(...getCurrentTransform(this.suspendedCtx));\n    copyCtxState(this.suspendedCtx, ctx);\n    mirrorContextOperations(ctx, this.suspendedCtx);\n\n    this.setGState([\n      [\"BM\", \"source-over\"],\n      [\"ca\", 1],\n      [\"CA\", 1],\n    ]);\n  }\n\n  endSMaskMode() {\n    if (!this.inSMaskMode) {\n      throw new Error(\"endSMaskMode called while not in smask mode\");\n    }\n    // The soft mask is done, now restore the suspended canvas as the main\n    // drawing canvas.\n    this.ctx._removeMirroring();\n    copyCtxState(this.ctx, this.suspendedCtx);\n    this.ctx = this.suspendedCtx;\n\n    this.suspendedCtx = null;\n  }\n\n  compose(dirtyBox) {\n    if (!this.current.activeSMask) {\n      return;\n    }\n\n    if (!dirtyBox) {\n      dirtyBox = [0, 0, this.ctx.canvas.width, this.ctx.canvas.height];\n    } else {\n      dirtyBox[0] = Math.floor(dirtyBox[0]);\n      dirtyBox[1] = Math.floor(dirtyBox[1]);\n      dirtyBox[2] = Math.ceil(dirtyBox[2]);\n      dirtyBox[3] = Math.ceil(dirtyBox[3]);\n    }\n    const smask = this.current.activeSMask;\n    const suspendedCtx = this.suspendedCtx;\n\n    composeSMask(suspendedCtx, smask, this.ctx, dirtyBox);\n    // Whatever was drawn has been moved to the suspended canvas, now clear it\n    // out of the current canvas.\n    this.ctx.save();\n    this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n    this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\n    this.ctx.restore();\n  }\n\n  save() {\n    if (this.inSMaskMode) {\n      // SMask mode may be turned on/off causing us to lose graphics state.\n      // Copy the temporary canvas state to the main(suspended) canvas to keep\n      // it in sync.\n      copyCtxState(this.ctx, this.suspendedCtx);\n      // Don't bother calling save on the temporary canvas since state is not\n      // saved there.\n      this.suspendedCtx.save();\n    } else {\n      this.ctx.save();\n    }\n    const old = this.current;\n    this.stateStack.push(old);\n    this.current = old.clone();\n  }\n\n  restore() {\n    if (this.stateStack.length === 0 && this.inSMaskMode) {\n      this.endSMaskMode();\n    }\n    if (this.stateStack.length !== 0) {\n      this.current = this.stateStack.pop();\n      if (this.inSMaskMode) {\n        // Graphics state is stored on the main(suspended) canvas. Restore its\n        // state then copy it over to the temporary canvas.\n        this.suspendedCtx.restore();\n        copyCtxState(this.suspendedCtx, this.ctx);\n      } else {\n        this.ctx.restore();\n      }\n      this.checkSMaskState();\n\n      // Ensure that the clipping path is reset (fixes issue6413.pdf).\n      this.pendingClip = null;\n\n      this._cachedScaleForStroking[0] = -1;\n      this._cachedGetSinglePixelWidth = null;\n    }\n  }\n\n  transform(a, b, c, d, e, f) {\n    this.ctx.transform(a, b, c, d, e, f);\n\n    this._cachedScaleForStroking[0] = -1;\n    this._cachedGetSinglePixelWidth = null;\n  }\n\n  // Path\n  constructPath(ops, args, minMax) {\n    const ctx = this.ctx;\n    const current = this.current;\n    let x = current.x,\n      y = current.y;\n    let startX, startY;\n    const currentTransform = getCurrentTransform(ctx);\n\n    // Most of the time the current transform is a scaling matrix\n    // so we don't need to transform points before computing min/max:\n    // we can compute min/max first and then smartly \"apply\" the\n    // transform (see Util.scaleMinMax).\n    // For rectangle, moveTo and lineTo, min/max are computed in the\n    // worker (see evaluator.js).\n    const isScalingMatrix =\n      (currentTransform[0] === 0 && currentTransform[3] === 0) ||\n      (currentTransform[1] === 0 && currentTransform[2] === 0);\n    const minMaxForBezier = isScalingMatrix ? minMax.slice(0) : null;\n\n    for (let i = 0, j = 0, ii = ops.length; i < ii; i++) {\n      switch (ops[i] | 0) {\n        case OPS.rectangle:\n          x = args[j++];\n          y = args[j++];\n          const width = args[j++];\n          const height = args[j++];\n\n          const xw = x + width;\n          const yh = y + height;\n          ctx.moveTo(x, y);\n          if (width === 0 || height === 0) {\n            ctx.lineTo(xw, yh);\n          } else {\n            ctx.lineTo(xw, y);\n            ctx.lineTo(xw, yh);\n            ctx.lineTo(x, yh);\n          }\n          if (!isScalingMatrix) {\n            current.updateRectMinMax(currentTransform, [x, y, xw, yh]);\n          }\n          ctx.closePath();\n          break;\n        case OPS.moveTo:\n          x = args[j++];\n          y = args[j++];\n          ctx.moveTo(x, y);\n          if (!isScalingMatrix) {\n            current.updatePathMinMax(currentTransform, x, y);\n          }\n          break;\n        case OPS.lineTo:\n          x = args[j++];\n          y = args[j++];\n          ctx.lineTo(x, y);\n          if (!isScalingMatrix) {\n            current.updatePathMinMax(currentTransform, x, y);\n          }\n          break;\n        case OPS.curveTo:\n          startX = x;\n          startY = y;\n          x = args[j + 4];\n          y = args[j + 5];\n          ctx.bezierCurveTo(\n            args[j],\n            args[j + 1],\n            args[j + 2],\n            args[j + 3],\n            x,\n            y\n          );\n          current.updateCurvePathMinMax(\n            currentTransform,\n            startX,\n            startY,\n            args[j],\n            args[j + 1],\n            args[j + 2],\n            args[j + 3],\n            x,\n            y,\n            minMaxForBezier\n          );\n          j += 6;\n          break;\n        case OPS.curveTo2:\n          startX = x;\n          startY = y;\n          ctx.bezierCurveTo(\n            x,\n            y,\n            args[j],\n            args[j + 1],\n            args[j + 2],\n            args[j + 3]\n          );\n          current.updateCurvePathMinMax(\n            currentTransform,\n            startX,\n            startY,\n            x,\n            y,\n            args[j],\n            args[j + 1],\n            args[j + 2],\n            args[j + 3],\n            minMaxForBezier\n          );\n          x = args[j + 2];\n          y = args[j + 3];\n          j += 4;\n          break;\n        case OPS.curveTo3:\n          startX = x;\n          startY = y;\n          x = args[j + 2];\n          y = args[j + 3];\n          ctx.bezierCurveTo(args[j], args[j + 1], x, y, x, y);\n          current.updateCurvePathMinMax(\n            currentTransform,\n            startX,\n            startY,\n            args[j],\n            args[j + 1],\n            x,\n            y,\n            x,\n            y,\n            minMaxForBezier\n          );\n          j += 4;\n          break;\n        case OPS.closePath:\n          ctx.closePath();\n          break;\n      }\n    }\n\n    if (isScalingMatrix) {\n      current.updateScalingPathMinMax(currentTransform, minMaxForBezier);\n    }\n\n    current.setCurrentPoint(x, y);\n  }\n\n  closePath() {\n    this.ctx.closePath();\n  }\n\n  stroke(consumePath = true) {\n    const ctx = this.ctx;\n    const strokeColor = this.current.strokeColor;\n    // For stroke we want to temporarily change the global alpha to the\n    // stroking alpha.\n    ctx.globalAlpha = this.current.strokeAlpha;\n    if (this.contentVisible) {\n      if (typeof strokeColor === \"object\" && strokeColor?.getPattern) {\n        ctx.save();\n        ctx.strokeStyle = strokeColor.getPattern(\n          ctx,\n          this,\n          getCurrentTransformInverse(ctx),\n          PathType.STROKE\n        );\n        this.rescaleAndStroke(/* saveRestore */ false);\n        ctx.restore();\n      } else {\n        this.rescaleAndStroke(/* saveRestore */ true);\n      }\n    }\n    if (consumePath) {\n      this.consumePath(this.current.getClippedPathBoundingBox());\n    }\n    // Restore the global alpha to the fill alpha\n    ctx.globalAlpha = this.current.fillAlpha;\n  }\n\n  closeStroke() {\n    this.closePath();\n    this.stroke();\n  }\n\n  fill(consumePath = true) {\n    const ctx = this.ctx;\n    const fillColor = this.current.fillColor;\n    const isPatternFill = this.current.patternFill;\n    let needRestore = false;\n\n    if (isPatternFill) {\n      ctx.save();\n      ctx.fillStyle = fillColor.getPattern(\n        ctx,\n        this,\n        getCurrentTransformInverse(ctx),\n        PathType.FILL\n      );\n      needRestore = true;\n    }\n\n    const intersect = this.current.getClippedPathBoundingBox();\n    if (this.contentVisible && intersect !== null) {\n      if (this.pendingEOFill) {\n        ctx.fill(\"evenodd\");\n        this.pendingEOFill = false;\n      } else {\n        ctx.fill();\n      }\n    }\n\n    if (needRestore) {\n      ctx.restore();\n    }\n    if (consumePath) {\n      this.consumePath(intersect);\n    }\n  }\n\n  eoFill() {\n    this.pendingEOFill = true;\n    this.fill();\n  }\n\n  fillStroke() {\n    this.fill(false);\n    this.stroke(false);\n\n    this.consumePath();\n  }\n\n  eoFillStroke() {\n    this.pendingEOFill = true;\n    this.fillStroke();\n  }\n\n  closeFillStroke() {\n    this.closePath();\n    this.fillStroke();\n  }\n\n  closeEOFillStroke() {\n    this.pendingEOFill = true;\n    this.closePath();\n    this.fillStroke();\n  }\n\n  endPath() {\n    this.consumePath();\n  }\n\n  // Clipping\n  clip() {\n    this.pendingClip = NORMAL_CLIP;\n  }\n\n  eoClip() {\n    this.pendingClip = EO_CLIP;\n  }\n\n  // Text\n  beginText() {\n    this.current.textMatrix = IDENTITY_MATRIX;\n    this.current.textMatrixScale = 1;\n    this.current.x = this.current.lineX = 0;\n    this.current.y = this.current.lineY = 0;\n  }\n\n  endText() {\n    const paths = this.pendingTextPaths;\n    const ctx = this.ctx;\n    if (paths === undefined) {\n      ctx.beginPath();\n      return;\n    }\n\n    ctx.save();\n    ctx.beginPath();\n    for (const path of paths) {\n      ctx.setTransform(...path.transform);\n      ctx.translate(path.x, path.y);\n      path.addToPath(ctx, path.fontSize);\n    }\n    ctx.restore();\n    ctx.clip();\n    ctx.beginPath();\n    delete this.pendingTextPaths;\n  }\n\n  setCharSpacing(spacing) {\n    this.current.charSpacing = spacing;\n  }\n\n  setWordSpacing(spacing) {\n    this.current.wordSpacing = spacing;\n  }\n\n  setHScale(scale) {\n    this.current.textHScale = scale / 100;\n  }\n\n  setLeading(leading) {\n    this.current.leading = -leading;\n  }\n\n  setFont(fontRefName, size) {\n    const fontObj = this.commonObjs.get(fontRefName);\n    const current = this.current;\n\n    if (!fontObj) {\n      throw new Error(`Can't find font for ${fontRefName}`);\n    }\n    current.fontMatrix = fontObj.fontMatrix || FONT_IDENTITY_MATRIX;\n\n    // A valid matrix needs all main diagonal elements to be non-zero\n    // This also ensures we bypass FF bugzilla bug #719844.\n    if (current.fontMatrix[0] === 0 || current.fontMatrix[3] === 0) {\n      warn(\"Invalid font matrix for font \" + fontRefName);\n    }\n\n    // The spec for Tf (setFont) says that 'size' specifies the font 'scale',\n    // and in some docs this can be negative (inverted x-y axes).\n    if (size < 0) {\n      size = -size;\n      current.fontDirection = -1;\n    } else {\n      current.fontDirection = 1;\n    }\n\n    this.current.font = fontObj;\n    this.current.fontSize = size;\n\n    if (fontObj.isType3Font) {\n      return; // we don't need ctx.font for Type3 fonts\n    }\n\n    const name = fontObj.loadedName || \"sans-serif\";\n    const typeface =\n      fontObj.systemFontInfo?.css || `\"${name}\", ${fontObj.fallbackName}`;\n\n    let bold = \"normal\";\n    if (fontObj.black) {\n      bold = \"900\";\n    } else if (fontObj.bold) {\n      bold = \"bold\";\n    }\n    const italic = fontObj.italic ? \"italic\" : \"normal\";\n\n    // Some font backends cannot handle fonts below certain size.\n    // Keeping the font at minimal size and using the fontSizeScale to change\n    // the current transformation matrix before the fillText/strokeText.\n    // See https://bugzilla.mozilla.org/show_bug.cgi?id=726227\n    let browserFontSize = size;\n    if (size < MIN_FONT_SIZE) {\n      browserFontSize = MIN_FONT_SIZE;\n    } else if (size > MAX_FONT_SIZE) {\n      browserFontSize = MAX_FONT_SIZE;\n    }\n    this.current.fontSizeScale = size / browserFontSize;\n\n    this.ctx.font = `${italic} ${bold} ${browserFontSize}px ${typeface}`;\n  }\n\n  setTextRenderingMode(mode) {\n    this.current.textRenderingMode = mode;\n  }\n\n  setTextRise(rise) {\n    this.current.textRise = rise;\n  }\n\n  moveText(x, y) {\n    this.current.x = this.current.lineX += x;\n    this.current.y = this.current.lineY += y;\n  }\n\n  setLeadingMoveText(x, y) {\n    this.setLeading(-y);\n    this.moveText(x, y);\n  }\n\n  setTextMatrix(a, b, c, d, e, f) {\n    this.current.textMatrix = [a, b, c, d, e, f];\n    this.current.textMatrixScale = Math.hypot(a, b);\n\n    this.current.x = this.current.lineX = 0;\n    this.current.y = this.current.lineY = 0;\n  }\n\n  nextLine() {\n    this.moveText(0, this.current.leading);\n  }\n\n  paintChar(character, x, y, patternTransform) {\n    const ctx = this.ctx;\n    const current = this.current;\n    const font = current.font;\n    const textRenderingMode = current.textRenderingMode;\n    const fontSize = current.fontSize / current.fontSizeScale;\n    const fillStrokeMode =\n      textRenderingMode & TextRenderingMode.FILL_STROKE_MASK;\n    const isAddToPathSet = !!(\n      textRenderingMode & TextRenderingMode.ADD_TO_PATH_FLAG\n    );\n    const patternFill = current.patternFill && !font.missingFile;\n\n    let addToPath;\n    if (font.disableFontFace || isAddToPathSet || patternFill) {\n      addToPath = font.getPathGenerator(this.commonObjs, character);\n    }\n\n    if (font.disableFontFace || patternFill) {\n      ctx.save();\n      ctx.translate(x, y);\n      ctx.beginPath();\n      addToPath(ctx, fontSize);\n      if (patternTransform) {\n        ctx.setTransform(...patternTransform);\n      }\n      if (\n        fillStrokeMode === TextRenderingMode.FILL ||\n        fillStrokeMode === TextRenderingMode.FILL_STROKE\n      ) {\n        ctx.fill();\n      }\n      if (\n        fillStrokeMode === TextRenderingMode.STROKE ||\n        fillStrokeMode === TextRenderingMode.FILL_STROKE\n      ) {\n        ctx.stroke();\n      }\n      ctx.restore();\n    } else {\n      if (\n        fillStrokeMode === TextRenderingMode.FILL ||\n        fillStrokeMode === TextRenderingMode.FILL_STROKE\n      ) {\n        ctx.fillText(character, x, y);\n      }\n      if (\n        fillStrokeMode === TextRenderingMode.STROKE ||\n        fillStrokeMode === TextRenderingMode.FILL_STROKE\n      ) {\n        ctx.strokeText(character, x, y);\n      }\n    }\n\n    if (isAddToPathSet) {\n      const paths = (this.pendingTextPaths ||= []);\n      paths.push({\n        transform: getCurrentTransform(ctx),\n        x,\n        y,\n        fontSize,\n        addToPath,\n      });\n    }\n  }\n\n  get isFontSubpixelAAEnabled() {\n    // Checks if anti-aliasing is enabled when scaled text is painted.\n    // On Windows GDI scaled fonts looks bad.\n    const { context: ctx } = this.cachedCanvases.getCanvas(\n      \"isFontSubpixelAAEnabled\",\n      10,\n      10\n    );\n    ctx.scale(1.5, 1);\n    ctx.fillText(\"I\", 0, 10);\n    const data = ctx.getImageData(0, 0, 10, 10).data;\n    let enabled = false;\n    for (let i = 3; i < data.length; i += 4) {\n      if (data[i] > 0 && data[i] < 255) {\n        enabled = true;\n        break;\n      }\n    }\n    return shadow(this, \"isFontSubpixelAAEnabled\", enabled);\n  }\n\n  showText(glyphs) {\n    const current = this.current;\n    const font = current.font;\n    if (font.isType3Font) {\n      return this.showType3Text(glyphs);\n    }\n\n    const fontSize = current.fontSize;\n    if (fontSize === 0) {\n      return undefined;\n    }\n\n    const ctx = this.ctx;\n    const fontSizeScale = current.fontSizeScale;\n    const charSpacing = current.charSpacing;\n    const wordSpacing = current.wordSpacing;\n    const fontDirection = current.fontDirection;\n    const textHScale = current.textHScale * fontDirection;\n    const glyphsLength = glyphs.length;\n    const vertical = font.vertical;\n    const spacingDir = vertical ? 1 : -1;\n    const defaultVMetrics = font.defaultVMetrics;\n    const widthAdvanceScale = fontSize * current.fontMatrix[0];\n\n    const simpleFillText =\n      current.textRenderingMode === TextRenderingMode.FILL &&\n      !font.disableFontFace &&\n      !current.patternFill;\n\n    ctx.save();\n    ctx.transform(...current.textMatrix);\n    ctx.translate(current.x, current.y + current.textRise);\n\n    if (fontDirection > 0) {\n      ctx.scale(textHScale, -1);\n    } else {\n      ctx.scale(textHScale, 1);\n    }\n\n    let patternTransform;\n    if (current.patternFill) {\n      ctx.save();\n      const pattern = current.fillColor.getPattern(\n        ctx,\n        this,\n        getCurrentTransformInverse(ctx),\n        PathType.FILL\n      );\n      patternTransform = getCurrentTransform(ctx);\n      ctx.restore();\n      ctx.fillStyle = pattern;\n    }\n\n    let lineWidth = current.lineWidth;\n    const scale = current.textMatrixScale;\n    if (scale === 0 || lineWidth === 0) {\n      const fillStrokeMode =\n        current.textRenderingMode & TextRenderingMode.FILL_STROKE_MASK;\n      if (\n        fillStrokeMode === TextRenderingMode.STROKE ||\n        fillStrokeMode === TextRenderingMode.FILL_STROKE\n      ) {\n        lineWidth = this.getSinglePixelWidth();\n      }\n    } else {\n      lineWidth /= scale;\n    }\n\n    if (fontSizeScale !== 1.0) {\n      ctx.scale(fontSizeScale, fontSizeScale);\n      lineWidth /= fontSizeScale;\n    }\n\n    ctx.lineWidth = lineWidth;\n\n    if (font.isInvalidPDFjsFont) {\n      const chars = [];\n      let width = 0;\n      for (const glyph of glyphs) {\n        chars.push(glyph.unicode);\n        width += glyph.width;\n      }\n      ctx.fillText(chars.join(\"\"), 0, 0);\n      current.x += width * widthAdvanceScale * textHScale;\n      ctx.restore();\n      this.compose();\n\n      return undefined;\n    }\n\n    let x = 0,\n      i;\n    for (i = 0; i < glyphsLength; ++i) {\n      const glyph = glyphs[i];\n      if (typeof glyph === \"number\") {\n        x += (spacingDir * glyph * fontSize) / 1000;\n        continue;\n      }\n\n      let restoreNeeded = false;\n      const spacing = (glyph.isSpace ? wordSpacing : 0) + charSpacing;\n      const character = glyph.fontChar;\n      const accent = glyph.accent;\n      let scaledX, scaledY;\n      let width = glyph.width;\n      if (vertical) {\n        const vmetric = glyph.vmetric || defaultVMetrics;\n        const vx =\n          -(glyph.vmetric ? vmetric[1] : width * 0.5) * widthAdvanceScale;\n        const vy = vmetric[2] * widthAdvanceScale;\n\n        width = vmetric ? -vmetric[0] : width;\n        scaledX = vx / fontSizeScale;\n        scaledY = (x + vy) / fontSizeScale;\n      } else {\n        scaledX = x / fontSizeScale;\n        scaledY = 0;\n      }\n\n      if (font.remeasure && width > 0) {\n        // Some standard fonts may not have the exact width: rescale per\n        // character if measured width is greater than expected glyph width\n        // and subpixel-aa is enabled, otherwise just center the glyph.\n        const measuredWidth =\n          ((ctx.measureText(character).width * 1000) / fontSize) *\n          fontSizeScale;\n        if (width < measuredWidth && this.isFontSubpixelAAEnabled) {\n          const characterScaleX = width / measuredWidth;\n          restoreNeeded = true;\n          ctx.save();\n          ctx.scale(characterScaleX, 1);\n          scaledX /= characterScaleX;\n        } else if (width !== measuredWidth) {\n          scaledX +=\n            (((width - measuredWidth) / 2000) * fontSize) / fontSizeScale;\n        }\n      }\n\n      // Only attempt to draw the glyph if it is actually in the embedded font\n      // file or if there isn't a font file so the fallback font is shown.\n      if (this.contentVisible && (glyph.isInFont || font.missingFile)) {\n        if (simpleFillText && !accent) {\n          // common case\n          ctx.fillText(character, scaledX, scaledY);\n        } else {\n          this.paintChar(character, scaledX, scaledY, patternTransform);\n          if (accent) {\n            const scaledAccentX =\n              scaledX + (fontSize * accent.offset.x) / fontSizeScale;\n            const scaledAccentY =\n              scaledY - (fontSize * accent.offset.y) / fontSizeScale;\n            this.paintChar(\n              accent.fontChar,\n              scaledAccentX,\n              scaledAccentY,\n              patternTransform\n            );\n          }\n        }\n      }\n\n      const charWidth = vertical\n        ? width * widthAdvanceScale - spacing * fontDirection\n        : width * widthAdvanceScale + spacing * fontDirection;\n      x += charWidth;\n\n      if (restoreNeeded) {\n        ctx.restore();\n      }\n    }\n    if (vertical) {\n      current.y -= x;\n    } else {\n      current.x += x * textHScale;\n    }\n    ctx.restore();\n    this.compose();\n\n    return undefined;\n  }\n\n  showType3Text(glyphs) {\n    // Type3 fonts - each glyph is a \"mini-PDF\"\n    const ctx = this.ctx;\n    const current = this.current;\n    const font = current.font;\n    const fontSize = current.fontSize;\n    const fontDirection = current.fontDirection;\n    const spacingDir = font.vertical ? 1 : -1;\n    const charSpacing = current.charSpacing;\n    const wordSpacing = current.wordSpacing;\n    const textHScale = current.textHScale * fontDirection;\n    const fontMatrix = current.fontMatrix || FONT_IDENTITY_MATRIX;\n    const glyphsLength = glyphs.length;\n    const isTextInvisible =\n      current.textRenderingMode === TextRenderingMode.INVISIBLE;\n    let i, glyph, width, spacingLength;\n\n    if (isTextInvisible || fontSize === 0) {\n      return;\n    }\n    this._cachedScaleForStroking[0] = -1;\n    this._cachedGetSinglePixelWidth = null;\n\n    ctx.save();\n    ctx.transform(...current.textMatrix);\n    ctx.translate(current.x, current.y);\n\n    ctx.scale(textHScale, fontDirection);\n\n    for (i = 0; i < glyphsLength; ++i) {\n      glyph = glyphs[i];\n      if (typeof glyph === \"number\") {\n        spacingLength = (spacingDir * glyph * fontSize) / 1000;\n        this.ctx.translate(spacingLength, 0);\n        current.x += spacingLength * textHScale;\n        continue;\n      }\n\n      const spacing = (glyph.isSpace ? wordSpacing : 0) + charSpacing;\n      const operatorList = font.charProcOperatorList[glyph.operatorListId];\n      if (!operatorList) {\n        warn(`Type3 character \"${glyph.operatorListId}\" is not available.`);\n        continue;\n      }\n      if (this.contentVisible) {\n        this.processingType3 = glyph;\n        this.save();\n        ctx.scale(fontSize, fontSize);\n        ctx.transform(...fontMatrix);\n        this.executeOperatorList(operatorList);\n        this.restore();\n      }\n\n      const transformed = Util.applyTransform([glyph.width, 0], fontMatrix);\n      width = transformed[0] * fontSize + spacing;\n\n      ctx.translate(width, 0);\n      current.x += width * textHScale;\n    }\n    ctx.restore();\n    this.processingType3 = null;\n  }\n\n  // Type3 fonts\n  setCharWidth(xWidth, yWidth) {\n    // We can safely ignore this since the width should be the same\n    // as the width in the Widths array.\n  }\n\n  setCharWidthAndBounds(xWidth, yWidth, llx, lly, urx, ury) {\n    this.ctx.rect(llx, lly, urx - llx, ury - lly);\n    this.ctx.clip();\n    this.endPath();\n  }\n\n  // Color\n  getColorN_Pattern(IR) {\n    let pattern;\n    if (IR[0] === \"TilingPattern\") {\n      const color = IR[1];\n      const baseTransform = this.baseTransform || getCurrentTransform(this.ctx);\n      const canvasGraphicsFactory = {\n        createCanvasGraphics: ctx => {\n          return new CanvasGraphics(\n            ctx,\n            this.commonObjs,\n            this.objs,\n            this.canvasFactory,\n            this.filterFactory,\n            {\n              optionalContentConfig: this.optionalContentConfig,\n              markedContentStack: this.markedContentStack,\n            }\n          );\n        },\n      };\n      pattern = new TilingPattern(\n        IR,\n        color,\n        this.ctx,\n        canvasGraphicsFactory,\n        baseTransform\n      );\n    } else {\n      pattern = this._getPattern(IR[1], IR[2]);\n    }\n    return pattern;\n  }\n\n  setStrokeColorN() {\n    this.current.strokeColor = this.getColorN_Pattern(arguments);\n  }\n\n  setFillColorN() {\n    this.current.fillColor = this.getColorN_Pattern(arguments);\n    this.current.patternFill = true;\n  }\n\n  setStrokeRGBColor(r, g, b) {\n    const color = Util.makeHexColor(r, g, b);\n    this.ctx.strokeStyle = color;\n    this.current.strokeColor = color;\n  }\n\n  setFillRGBColor(r, g, b) {\n    const color = Util.makeHexColor(r, g, b);\n    this.ctx.fillStyle = color;\n    this.current.fillColor = color;\n    this.current.patternFill = false;\n  }\n\n  _getPattern(objId, matrix = null) {\n    let pattern;\n    if (this.cachedPatterns.has(objId)) {\n      pattern = this.cachedPatterns.get(objId);\n    } else {\n      pattern = getShadingPattern(this.getObject(objId));\n      this.cachedPatterns.set(objId, pattern);\n    }\n    if (matrix) {\n      pattern.matrix = matrix;\n    }\n    return pattern;\n  }\n\n  shadingFill(objId) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const ctx = this.ctx;\n\n    this.save();\n    const pattern = this._getPattern(objId);\n    ctx.fillStyle = pattern.getPattern(\n      ctx,\n      this,\n      getCurrentTransformInverse(ctx),\n      PathType.SHADING\n    );\n\n    const inv = getCurrentTransformInverse(ctx);\n    if (inv) {\n      const { width, height } = ctx.canvas;\n      const [x0, y0, x1, y1] = Util.getAxialAlignedBoundingBox(\n        [0, 0, width, height],\n        inv\n      );\n\n      this.ctx.fillRect(x0, y0, x1 - x0, y1 - y0);\n    } else {\n      // HACK to draw the gradient onto an infinite rectangle.\n      // PDF gradients are drawn across the entire image while\n      // Canvas only allows gradients to be drawn in a rectangle\n      // The following bug should allow us to remove this.\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=664884\n\n      this.ctx.fillRect(-1e10, -1e10, 2e10, 2e10);\n    }\n\n    this.compose(this.current.getClippedPathBoundingBox());\n    this.restore();\n  }\n\n  // Images\n  beginInlineImage() {\n    unreachable(\"Should not call beginInlineImage\");\n  }\n\n  beginImageData() {\n    unreachable(\"Should not call beginImageData\");\n  }\n\n  paintFormXObjectBegin(matrix, bbox) {\n    if (!this.contentVisible) {\n      return;\n    }\n    this.save();\n    this.baseTransformStack.push(this.baseTransform);\n\n    if (Array.isArray(matrix) && matrix.length === 6) {\n      this.transform(...matrix);\n    }\n\n    this.baseTransform = getCurrentTransform(this.ctx);\n\n    if (bbox) {\n      const width = bbox[2] - bbox[0];\n      const height = bbox[3] - bbox[1];\n      this.ctx.rect(bbox[0], bbox[1], width, height);\n      this.current.updateRectMinMax(getCurrentTransform(this.ctx), bbox);\n      this.clip();\n      this.endPath();\n    }\n  }\n\n  paintFormXObjectEnd() {\n    if (!this.contentVisible) {\n      return;\n    }\n    this.restore();\n    this.baseTransform = this.baseTransformStack.pop();\n  }\n\n  beginGroup(group) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    this.save();\n    // If there's an active soft mask we don't want it enabled for the group, so\n    // clear it out. The mask and suspended canvas will be restored in endGroup.\n    if (this.inSMaskMode) {\n      this.endSMaskMode();\n      this.current.activeSMask = null;\n    }\n\n    const currentCtx = this.ctx;\n    // TODO non-isolated groups - according to Rik at adobe non-isolated\n    // group results aren't usually that different and they even have tools\n    // that ignore this setting. Notes from Rik on implementing:\n    // - When you encounter an transparency group, create a new canvas with\n    // the dimensions of the bbox\n    // - copy the content from the previous canvas to the new canvas\n    // - draw as usual\n    // - remove the backdrop alpha:\n    // alphaNew = 1 - (1 - alpha)/(1 - alphaBackdrop) with 'alpha' the alpha\n    // value of your transparency group and 'alphaBackdrop' the alpha of the\n    // backdrop\n    // - remove background color:\n    // colorNew = color - alphaNew *colorBackdrop /(1 - alphaNew)\n    if (!group.isolated) {\n      info(\"TODO: Support non-isolated groups.\");\n    }\n\n    // TODO knockout - supposedly possible with the clever use of compositing\n    // modes.\n    if (group.knockout) {\n      warn(\"Knockout groups not supported.\");\n    }\n\n    const currentTransform = getCurrentTransform(currentCtx);\n    if (group.matrix) {\n      currentCtx.transform(...group.matrix);\n    }\n    if (!group.bbox) {\n      throw new Error(\"Bounding box is required.\");\n    }\n\n    // Based on the current transform figure out how big the bounding box\n    // will actually be.\n    let bounds = Util.getAxialAlignedBoundingBox(\n      group.bbox,\n      getCurrentTransform(currentCtx)\n    );\n    // Clip the bounding box to the current canvas.\n    const canvasBounds = [\n      0,\n      0,\n      currentCtx.canvas.width,\n      currentCtx.canvas.height,\n    ];\n    bounds = Util.intersect(bounds, canvasBounds) || [0, 0, 0, 0];\n    // Use ceil in case we're between sizes so we don't create canvas that is\n    // too small and make the canvas at least 1x1 pixels.\n    const offsetX = Math.floor(bounds[0]);\n    const offsetY = Math.floor(bounds[1]);\n    let drawnWidth = Math.max(Math.ceil(bounds[2]) - offsetX, 1);\n    let drawnHeight = Math.max(Math.ceil(bounds[3]) - offsetY, 1);\n    let scaleX = 1,\n      scaleY = 1;\n    if (drawnWidth > MAX_GROUP_SIZE) {\n      scaleX = drawnWidth / MAX_GROUP_SIZE;\n      drawnWidth = MAX_GROUP_SIZE;\n    }\n    if (drawnHeight > MAX_GROUP_SIZE) {\n      scaleY = drawnHeight / MAX_GROUP_SIZE;\n      drawnHeight = MAX_GROUP_SIZE;\n    }\n\n    this.current.startNewPathAndClipBox([0, 0, drawnWidth, drawnHeight]);\n\n    let cacheId = \"groupAt\" + this.groupLevel;\n    if (group.smask) {\n      // Using two cache entries is case if masks are used one after another.\n      cacheId += \"_smask_\" + (this.smaskCounter++ % 2);\n    }\n    const scratchCanvas = this.cachedCanvases.getCanvas(\n      cacheId,\n      drawnWidth,\n      drawnHeight\n    );\n    const groupCtx = scratchCanvas.context;\n\n    // Since we created a new canvas that is just the size of the bounding box\n    // we have to translate the group ctx.\n    groupCtx.scale(1 / scaleX, 1 / scaleY);\n    groupCtx.translate(-offsetX, -offsetY);\n    groupCtx.transform(...currentTransform);\n\n    if (group.smask) {\n      // Saving state and cached mask to be used in setGState.\n      this.smaskStack.push({\n        canvas: scratchCanvas.canvas,\n        context: groupCtx,\n        offsetX,\n        offsetY,\n        scaleX,\n        scaleY,\n        subtype: group.smask.subtype,\n        backdrop: group.smask.backdrop,\n        transferMap: group.smask.transferMap || null,\n        startTransformInverse: null, // used during suspend operation\n      });\n    } else {\n      // Setup the current ctx so when the group is popped we draw it at the\n      // right location.\n      currentCtx.setTransform(1, 0, 0, 1, 0, 0);\n      currentCtx.translate(offsetX, offsetY);\n      currentCtx.scale(scaleX, scaleY);\n      currentCtx.save();\n    }\n    // The transparency group inherits all off the current graphics state\n    // except the blend mode, soft mask, and alpha constants.\n    copyCtxState(currentCtx, groupCtx);\n    this.ctx = groupCtx;\n    this.setGState([\n      [\"BM\", \"source-over\"],\n      [\"ca\", 1],\n      [\"CA\", 1],\n    ]);\n    this.groupStack.push(currentCtx);\n    this.groupLevel++;\n  }\n\n  endGroup(group) {\n    if (!this.contentVisible) {\n      return;\n    }\n    this.groupLevel--;\n    const groupCtx = this.ctx;\n    const ctx = this.groupStack.pop();\n    this.ctx = ctx;\n    // Turn off image smoothing to avoid sub pixel interpolation which can\n    // look kind of blurry for some pdfs.\n    this.ctx.imageSmoothingEnabled = false;\n\n    if (group.smask) {\n      this.tempSMask = this.smaskStack.pop();\n      this.restore();\n    } else {\n      this.ctx.restore();\n      const currentMtx = getCurrentTransform(this.ctx);\n      this.restore();\n      this.ctx.save();\n      this.ctx.setTransform(...currentMtx);\n      const dirtyBox = Util.getAxialAlignedBoundingBox(\n        [0, 0, groupCtx.canvas.width, groupCtx.canvas.height],\n        currentMtx\n      );\n      this.ctx.drawImage(groupCtx.canvas, 0, 0);\n      this.ctx.restore();\n      this.compose(dirtyBox);\n    }\n  }\n\n  beginAnnotation(id, rect, transform, matrix, hasOwnCanvas) {\n    // The annotations are drawn just after the page content.\n    // The page content drawing can potentially have set a transform,\n    // a clipping path, whatever...\n    // So in order to have something clean, we restore the initial state.\n    this.#restoreInitialState();\n    resetCtxToDefault(this.ctx);\n\n    this.ctx.save();\n    this.save();\n\n    if (this.baseTransform) {\n      this.ctx.setTransform(...this.baseTransform);\n    }\n\n    if (Array.isArray(rect) && rect.length === 4) {\n      const width = rect[2] - rect[0];\n      const height = rect[3] - rect[1];\n\n      if (hasOwnCanvas && this.annotationCanvasMap) {\n        transform = transform.slice();\n        transform[4] -= rect[0];\n        transform[5] -= rect[1];\n\n        rect = rect.slice();\n        rect[0] = rect[1] = 0;\n        rect[2] = width;\n        rect[3] = height;\n\n        const [scaleX, scaleY] = Util.singularValueDecompose2dScale(\n          getCurrentTransform(this.ctx)\n        );\n        const { viewportScale } = this;\n        const canvasWidth = Math.ceil(\n          width * this.outputScaleX * viewportScale\n        );\n        const canvasHeight = Math.ceil(\n          height * this.outputScaleY * viewportScale\n        );\n\n        this.annotationCanvas = this.canvasFactory.create(\n          canvasWidth,\n          canvasHeight\n        );\n        const { canvas, context } = this.annotationCanvas;\n        this.annotationCanvasMap.set(id, canvas);\n        this.annotationCanvas.savedCtx = this.ctx;\n        this.ctx = context;\n        this.ctx.save();\n        this.ctx.setTransform(scaleX, 0, 0, -scaleY, 0, height * scaleY);\n\n        resetCtxToDefault(this.ctx);\n      } else {\n        resetCtxToDefault(this.ctx);\n\n        this.ctx.rect(rect[0], rect[1], width, height);\n        this.ctx.clip();\n        this.endPath();\n      }\n    }\n\n    this.current = new CanvasExtraState(\n      this.ctx.canvas.width,\n      this.ctx.canvas.height\n    );\n\n    this.transform(...transform);\n    this.transform(...matrix);\n  }\n\n  endAnnotation() {\n    if (this.annotationCanvas) {\n      this.ctx.restore();\n      this.#drawFilter();\n\n      this.ctx = this.annotationCanvas.savedCtx;\n      delete this.annotationCanvas.savedCtx;\n      delete this.annotationCanvas;\n    }\n  }\n\n  paintImageMaskXObject(img) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const count = img.count;\n    img = this.getObject(img.data, img);\n    img.count = count;\n\n    const ctx = this.ctx;\n    const glyph = this.processingType3;\n\n    if (glyph) {\n      if (glyph.compiled === undefined) {\n        glyph.compiled = compileType3Glyph(img);\n      }\n\n      if (glyph.compiled) {\n        glyph.compiled(ctx);\n        return;\n      }\n    }\n    const mask = this._createMaskCanvas(img);\n    const maskCanvas = mask.canvas;\n\n    ctx.save();\n    // The mask is drawn with the transform applied. Reset the current\n    // transform to draw to the identity.\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    ctx.drawImage(maskCanvas, mask.offsetX, mask.offsetY);\n    ctx.restore();\n    this.compose();\n  }\n\n  paintImageMaskXObjectRepeat(\n    img,\n    scaleX,\n    skewX = 0,\n    skewY = 0,\n    scaleY,\n    positions\n  ) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    img = this.getObject(img.data, img);\n\n    const ctx = this.ctx;\n    ctx.save();\n    const currentTransform = getCurrentTransform(ctx);\n    ctx.transform(scaleX, skewX, skewY, scaleY, 0, 0);\n    const mask = this._createMaskCanvas(img);\n\n    ctx.setTransform(\n      1,\n      0,\n      0,\n      1,\n      mask.offsetX - currentTransform[4],\n      mask.offsetY - currentTransform[5]\n    );\n    for (let i = 0, ii = positions.length; i < ii; i += 2) {\n      const trans = Util.transform(currentTransform, [\n        scaleX,\n        skewX,\n        skewY,\n        scaleY,\n        positions[i],\n        positions[i + 1],\n      ]);\n\n      const [x, y] = Util.applyTransform([0, 0], trans);\n      ctx.drawImage(mask.canvas, x, y);\n    }\n    ctx.restore();\n    this.compose();\n  }\n\n  paintImageMaskXObjectGroup(images) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const ctx = this.ctx;\n\n    const fillColor = this.current.fillColor;\n    const isPatternFill = this.current.patternFill;\n\n    for (const image of images) {\n      const { data, width, height, transform } = image;\n\n      const maskCanvas = this.cachedCanvases.getCanvas(\n        \"maskCanvas\",\n        width,\n        height\n      );\n      const maskCtx = maskCanvas.context;\n      maskCtx.save();\n\n      const img = this.getObject(data, image);\n      putBinaryImageMask(maskCtx, img);\n\n      maskCtx.globalCompositeOperation = \"source-in\";\n\n      maskCtx.fillStyle = isPatternFill\n        ? fillColor.getPattern(\n            maskCtx,\n            this,\n            getCurrentTransformInverse(ctx),\n            PathType.FILL\n          )\n        : fillColor;\n      maskCtx.fillRect(0, 0, width, height);\n\n      maskCtx.restore();\n\n      ctx.save();\n      ctx.transform(...transform);\n      ctx.scale(1, -1);\n      drawImageAtIntegerCoords(\n        ctx,\n        maskCanvas.canvas,\n        0,\n        0,\n        width,\n        height,\n        0,\n        -1,\n        1,\n        1\n      );\n      ctx.restore();\n    }\n    this.compose();\n  }\n\n  paintImageXObject(objId) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const imgData = this.getObject(objId);\n    if (!imgData) {\n      warn(\"Dependent image isn't ready yet\");\n      return;\n    }\n\n    this.paintInlineImageXObject(imgData);\n  }\n\n  paintImageXObjectRepeat(objId, scaleX, scaleY, positions) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const imgData = this.getObject(objId);\n    if (!imgData) {\n      warn(\"Dependent image isn't ready yet\");\n      return;\n    }\n\n    const width = imgData.width;\n    const height = imgData.height;\n    const map = [];\n    for (let i = 0, ii = positions.length; i < ii; i += 2) {\n      map.push({\n        transform: [scaleX, 0, 0, scaleY, positions[i], positions[i + 1]],\n        x: 0,\n        y: 0,\n        w: width,\n        h: height,\n      });\n    }\n    this.paintInlineImageXObjectGroup(imgData, map);\n  }\n\n  applyTransferMapsToCanvas(ctx) {\n    if (this.current.transferMaps !== \"none\") {\n      ctx.filter = this.current.transferMaps;\n      ctx.drawImage(ctx.canvas, 0, 0);\n      ctx.filter = \"none\";\n    }\n    return ctx.canvas;\n  }\n\n  applyTransferMapsToBitmap(imgData) {\n    if (this.current.transferMaps === \"none\") {\n      return imgData.bitmap;\n    }\n    const { bitmap, width, height } = imgData;\n    const tmpCanvas = this.cachedCanvases.getCanvas(\n      \"inlineImage\",\n      width,\n      height\n    );\n    const tmpCtx = tmpCanvas.context;\n    tmpCtx.filter = this.current.transferMaps;\n    tmpCtx.drawImage(bitmap, 0, 0);\n    tmpCtx.filter = \"none\";\n\n    return tmpCanvas.canvas;\n  }\n\n  paintInlineImageXObject(imgData) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const width = imgData.width;\n    const height = imgData.height;\n    const ctx = this.ctx;\n\n    this.save();\n\n    if (\n      (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n      !isNodeJS\n    ) {\n      // The filter, if any, will be applied in applyTransferMapsToBitmap.\n      // It must be applied to the image before rescaling else some artifacts\n      // could appear.\n      // The final restore will reset it to its value.\n      const { filter } = ctx;\n      if (filter !== \"none\" && filter !== \"\") {\n        ctx.filter = \"none\";\n      }\n    }\n\n    // scale the image to the unit square\n    ctx.scale(1 / width, -1 / height);\n\n    let imgToPaint;\n    if (imgData.bitmap) {\n      imgToPaint = this.applyTransferMapsToBitmap(imgData);\n    } else if (\n      (typeof HTMLElement === \"function\" && imgData instanceof HTMLElement) ||\n      !imgData.data\n    ) {\n      // typeof check is needed due to node.js support, see issue #8489\n      imgToPaint = imgData;\n    } else {\n      const tmpCanvas = this.cachedCanvases.getCanvas(\n        \"inlineImage\",\n        width,\n        height\n      );\n      const tmpCtx = tmpCanvas.context;\n      putBinaryImageData(tmpCtx, imgData);\n      imgToPaint = this.applyTransferMapsToCanvas(tmpCtx);\n    }\n\n    const scaled = this._scaleImage(\n      imgToPaint,\n      getCurrentTransformInverse(ctx)\n    );\n    ctx.imageSmoothingEnabled = getImageSmoothingEnabled(\n      getCurrentTransform(ctx),\n      imgData.interpolate\n    );\n\n    drawImageAtIntegerCoords(\n      ctx,\n      scaled.img,\n      0,\n      0,\n      scaled.paintWidth,\n      scaled.paintHeight,\n      0,\n      -height,\n      width,\n      height\n    );\n    this.compose();\n    this.restore();\n  }\n\n  paintInlineImageXObjectGroup(imgData, map) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const ctx = this.ctx;\n    let imgToPaint;\n    if (imgData.bitmap) {\n      imgToPaint = imgData.bitmap;\n    } else {\n      const w = imgData.width;\n      const h = imgData.height;\n\n      const tmpCanvas = this.cachedCanvases.getCanvas(\"inlineImage\", w, h);\n      const tmpCtx = tmpCanvas.context;\n      putBinaryImageData(tmpCtx, imgData);\n      imgToPaint = this.applyTransferMapsToCanvas(tmpCtx);\n    }\n\n    for (const entry of map) {\n      ctx.save();\n      ctx.transform(...entry.transform);\n      ctx.scale(1, -1);\n      drawImageAtIntegerCoords(\n        ctx,\n        imgToPaint,\n        entry.x,\n        entry.y,\n        entry.w,\n        entry.h,\n        0,\n        -1,\n        1,\n        1\n      );\n      ctx.restore();\n    }\n    this.compose();\n  }\n\n  paintSolidColorImageMask() {\n    if (!this.contentVisible) {\n      return;\n    }\n    this.ctx.fillRect(0, 0, 1, 1);\n    this.compose();\n  }\n\n  // Marked content\n\n  markPoint(tag) {\n    // TODO Marked content.\n  }\n\n  markPointProps(tag, properties) {\n    // TODO Marked content.\n  }\n\n  beginMarkedContent(tag) {\n    this.markedContentStack.push({\n      visible: true,\n    });\n  }\n\n  beginMarkedContentProps(tag, properties) {\n    if (tag === \"OC\") {\n      this.markedContentStack.push({\n        visible: this.optionalContentConfig.isVisible(properties),\n      });\n    } else {\n      this.markedContentStack.push({\n        visible: true,\n      });\n    }\n    this.contentVisible = this.isContentVisible();\n  }\n\n  endMarkedContent() {\n    this.markedContentStack.pop();\n    this.contentVisible = this.isContentVisible();\n  }\n\n  // Compatibility\n\n  beginCompat() {\n    // TODO ignore undefined operators (should we do that anyway?)\n  }\n\n  endCompat() {\n    // TODO stop ignoring undefined operators\n  }\n\n  // Helper functions\n\n  consumePath(clipBox) {\n    const isEmpty = this.current.isEmptyClip();\n    if (this.pendingClip) {\n      this.current.updateClipFromPath();\n    }\n    if (!this.pendingClip) {\n      this.compose(clipBox);\n    }\n    const ctx = this.ctx;\n    if (this.pendingClip) {\n      if (!isEmpty) {\n        if (this.pendingClip === EO_CLIP) {\n          ctx.clip(\"evenodd\");\n        } else {\n          ctx.clip();\n        }\n      }\n      this.pendingClip = null;\n    }\n    this.current.startNewPathAndClipBox(this.current.clipBox);\n    ctx.beginPath();\n  }\n\n  getSinglePixelWidth() {\n    if (!this._cachedGetSinglePixelWidth) {\n      const m = getCurrentTransform(this.ctx);\n      if (m[1] === 0 && m[2] === 0) {\n        // Fast path\n        this._cachedGetSinglePixelWidth =\n          1 / Math.min(Math.abs(m[0]), Math.abs(m[3]));\n      } else {\n        const absDet = Math.abs(m[0] * m[3] - m[2] * m[1]);\n        const normX = Math.hypot(m[0], m[2]);\n        const normY = Math.hypot(m[1], m[3]);\n        this._cachedGetSinglePixelWidth = Math.max(normX, normY) / absDet;\n      }\n    }\n    return this._cachedGetSinglePixelWidth;\n  }\n\n  getScaleForStroking() {\n    // A pixel has thicknessX = thicknessY = 1;\n    // A transformed pixel is a parallelogram and the thicknesses\n    // corresponds to the heights.\n    // The goal of this function is to rescale before setting the\n    // lineWidth in order to have both thicknesses greater or equal\n    // to 1 after transform.\n    if (this._cachedScaleForStroking[0] === -1) {\n      const { lineWidth } = this.current;\n      const { a, b, c, d } = this.ctx.getTransform();\n      let scaleX, scaleY;\n\n      if (b === 0 && c === 0) {\n        // Fast path\n        const normX = Math.abs(a);\n        const normY = Math.abs(d);\n        if (normX === normY) {\n          if (lineWidth === 0) {\n            scaleX = scaleY = 1 / normX;\n          } else {\n            const scaledLineWidth = normX * lineWidth;\n            scaleX = scaleY = scaledLineWidth < 1 ? 1 / scaledLineWidth : 1;\n          }\n        } else if (lineWidth === 0) {\n          scaleX = 1 / normX;\n          scaleY = 1 / normY;\n        } else {\n          const scaledXLineWidth = normX * lineWidth;\n          const scaledYLineWidth = normY * lineWidth;\n          scaleX = scaledXLineWidth < 1 ? 1 / scaledXLineWidth : 1;\n          scaleY = scaledYLineWidth < 1 ? 1 / scaledYLineWidth : 1;\n        }\n      } else {\n        // A pixel (base (x, y)) is transformed by M into a parallelogram:\n        //  - its area is |det(M)|;\n        //  - heightY (orthogonal to Mx) has a length: |det(M)| / norm(Mx);\n        //  - heightX (orthogonal to My) has a length: |det(M)| / norm(My).\n        // heightX and heightY are the thicknesses of the transformed pixel\n        // and they must be both greater or equal to 1.\n        const absDet = Math.abs(a * d - b * c);\n        const normX = Math.hypot(a, b);\n        const normY = Math.hypot(c, d);\n        if (lineWidth === 0) {\n          scaleX = normY / absDet;\n          scaleY = normX / absDet;\n        } else {\n          const baseArea = lineWidth * absDet;\n          scaleX = normY > baseArea ? normY / baseArea : 1;\n          scaleY = normX > baseArea ? normX / baseArea : 1;\n        }\n      }\n      this._cachedScaleForStroking[0] = scaleX;\n      this._cachedScaleForStroking[1] = scaleY;\n    }\n    return this._cachedScaleForStroking;\n  }\n\n  // Rescale before stroking in order to have a final lineWidth\n  // with both thicknesses greater or equal to 1.\n  rescaleAndStroke(saveRestore) {\n    const { ctx } = this;\n    const { lineWidth } = this.current;\n    const [scaleX, scaleY] = this.getScaleForStroking();\n\n    ctx.lineWidth = lineWidth || 1;\n\n    if (scaleX === 1 && scaleY === 1) {\n      ctx.stroke();\n      return;\n    }\n\n    const dashes = ctx.getLineDash();\n    if (saveRestore) {\n      ctx.save();\n    }\n\n    ctx.scale(scaleX, scaleY);\n\n    // How the dashed line is rendered depends on the current transform...\n    // so we added a rescale to handle too thin lines and consequently\n    // the way the line is dashed will be modified.\n    // If scaleX === scaleY, the dashed lines will be rendered correctly\n    // else we'll have some bugs (but only with too thin lines).\n    // Here we take the max... why not taking the min... or something else.\n    // Anyway, as said it's buggy when scaleX !== scaleY.\n    if (dashes.length > 0) {\n      const scale = Math.max(scaleX, scaleY);\n      ctx.setLineDash(dashes.map(x => x / scale));\n      ctx.lineDashOffset /= scale;\n    }\n\n    ctx.stroke();\n\n    if (saveRestore) {\n      ctx.restore();\n    }\n  }\n\n  isContentVisible() {\n    for (let i = this.markedContentStack.length - 1; i >= 0; i--) {\n      if (!this.markedContentStack[i].visible) {\n        return false;\n      }\n    }\n    return true;\n  }\n}\n\nfor (const op in OPS) {\n  if (CanvasGraphics.prototype[op] !== undefined) {\n    CanvasGraphics.prototype[OPS[op]] = CanvasGraphics.prototype[op];\n  }\n}\n\nexport { CanvasGraphics };\n","/* Copyright 2015 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  BaseCanvasFactory,\n  BaseCMapReaderFactory,\n  BaseFilterFactory,\n  BaseStandardFontDataFactory,\n  BaseSVGFactory,\n} from \"./base_factory.js\";\nimport {\n  BaseException,\n  FeatureTest,\n  shadow,\n  stringToBytes,\n  Util,\n  warn,\n} from \"../shared/util.js\";\n\nconst SVG_NS = \"http://www.w3.org/2000/svg\";\n\nclass PixelsPerInch {\n  static CSS = 96.0;\n\n  static PDF = 72.0;\n\n  static PDF_TO_CSS_UNITS = this.CSS / this.PDF;\n}\n\n/**\n * FilterFactory aims to create some SVG filters we can use when drawing an\n * image (or whatever) on a canvas.\n * Filters aren't applied with ctx.putImageData because it just overwrites the\n * underlying pixels.\n * With these filters, it's possible for example to apply some transfer maps on\n * an image without the need to apply them on the pixel arrays: the renderer\n * does the magic for us.\n */\nclass DOMFilterFactory extends BaseFilterFactory {\n  #_cache;\n\n  #_defs;\n\n  #docId;\n\n  #document;\n\n  #hcmFilter;\n\n  #hcmKey;\n\n  #hcmUrl;\n\n  #hcmHighlightFilter;\n\n  #hcmHighlightKey;\n\n  #hcmHighlightUrl;\n\n  #id = 0;\n\n  constructor({ docId, ownerDocument = globalThis.document } = {}) {\n    super();\n    this.#docId = docId;\n    this.#document = ownerDocument;\n  }\n\n  get #cache() {\n    return (this.#_cache ||= new Map());\n  }\n\n  get #defs() {\n    if (!this.#_defs) {\n      const div = this.#document.createElement(\"div\");\n      const { style } = div;\n      style.visibility = \"hidden\";\n      style.contain = \"strict\";\n      style.width = style.height = 0;\n      style.position = \"absolute\";\n      style.top = style.left = 0;\n      style.zIndex = -1;\n\n      const svg = this.#document.createElementNS(SVG_NS, \"svg\");\n      svg.setAttribute(\"width\", 0);\n      svg.setAttribute(\"height\", 0);\n      this.#_defs = this.#document.createElementNS(SVG_NS, \"defs\");\n      div.append(svg);\n      svg.append(this.#_defs);\n      this.#document.body.append(div);\n    }\n    return this.#_defs;\n  }\n\n  addFilter(maps) {\n    if (!maps) {\n      return \"none\";\n    }\n\n    // When a page is zoomed the page is re-drawn but the maps are likely\n    // the same.\n    let value = this.#cache.get(maps);\n    if (value) {\n      return value;\n    }\n\n    let tableR, tableG, tableB, key;\n    if (maps.length === 1) {\n      const mapR = maps[0];\n      const buffer = new Array(256);\n      for (let i = 0; i < 256; i++) {\n        buffer[i] = mapR[i] / 255;\n      }\n      key = tableR = tableG = tableB = buffer.join(\",\");\n    } else {\n      const [mapR, mapG, mapB] = maps;\n      const bufferR = new Array(256);\n      const bufferG = new Array(256);\n      const bufferB = new Array(256);\n      for (let i = 0; i < 256; i++) {\n        bufferR[i] = mapR[i] / 255;\n        bufferG[i] = mapG[i] / 255;\n        bufferB[i] = mapB[i] / 255;\n      }\n      tableR = bufferR.join(\",\");\n      tableG = bufferG.join(\",\");\n      tableB = bufferB.join(\",\");\n      key = `${tableR}${tableG}${tableB}`;\n    }\n\n    value = this.#cache.get(key);\n    if (value) {\n      this.#cache.set(maps, value);\n      return value;\n    }\n\n    // We create a SVG filter: feComponentTransferElement\n    //  https://www.w3.org/TR/SVG11/filters.html#feComponentTransferElement\n\n    const id = `g_${this.#docId}_transfer_map_${this.#id++}`;\n    const url = `url(#${id})`;\n    this.#cache.set(maps, url);\n    this.#cache.set(key, url);\n\n    const filter = this.#createFilter(id);\n    this.#addTransferMapConversion(tableR, tableG, tableB, filter);\n\n    return url;\n  }\n\n  addHCMFilter(fgColor, bgColor) {\n    const key = `${fgColor}-${bgColor}`;\n    if (this.#hcmKey === key) {\n      return this.#hcmUrl;\n    }\n\n    this.#hcmKey = key;\n    this.#hcmUrl = \"none\";\n    this.#hcmFilter?.remove();\n\n    if (!fgColor || !bgColor) {\n      return this.#hcmUrl;\n    }\n\n    const fgRGB = this.#getRGB(fgColor);\n    fgColor = Util.makeHexColor(...fgRGB);\n    const bgRGB = this.#getRGB(bgColor);\n    bgColor = Util.makeHexColor(...bgRGB);\n    this.#defs.style.color = \"\";\n\n    if (\n      (fgColor === \"#000000\" && bgColor === \"#ffffff\") ||\n      fgColor === bgColor\n    ) {\n      return this.#hcmUrl;\n    }\n\n    // https://developer.mozilla.org/en-US/docs/Web/Accessibility/Understanding_Colors_and_Luminance\n    //\n    // Relative luminance:\n    // https://www.w3.org/TR/WCAG20/#relativeluminancedef\n    //\n    // We compute the rounded luminance of the default background color.\n    // Then for every color in the pdf, if its rounded luminance is the\n    // same as the background one then it's replaced by the new\n    // background color else by the foreground one.\n    const map = new Array(256);\n    for (let i = 0; i <= 255; i++) {\n      const x = i / 255;\n      map[i] = x <= 0.03928 ? x / 12.92 : ((x + 0.055) / 1.055) ** 2.4;\n    }\n    const table = map.join(\",\");\n\n    const id = `g_${this.#docId}_hcm_filter`;\n    const filter = (this.#hcmHighlightFilter = this.#createFilter(id));\n    this.#addTransferMapConversion(table, table, table, filter);\n    this.#addGrayConversion(filter);\n\n    const getSteps = (c, n) => {\n      const start = fgRGB[c] / 255;\n      const end = bgRGB[c] / 255;\n      const arr = new Array(n + 1);\n      for (let i = 0; i <= n; i++) {\n        arr[i] = start + (i / n) * (end - start);\n      }\n      return arr.join(\",\");\n    };\n    this.#addTransferMapConversion(\n      getSteps(0, 5),\n      getSteps(1, 5),\n      getSteps(2, 5),\n      filter\n    );\n\n    this.#hcmUrl = `url(#${id})`;\n    return this.#hcmUrl;\n  }\n\n  addHighlightHCMFilter(fgColor, bgColor, newFgColor, newBgColor) {\n    const key = `${fgColor}-${bgColor}-${newFgColor}-${newBgColor}`;\n    if (this.#hcmHighlightKey === key) {\n      return this.#hcmHighlightUrl;\n    }\n\n    this.#hcmHighlightKey = key;\n    this.#hcmHighlightUrl = \"none\";\n    this.#hcmHighlightFilter?.remove();\n\n    if (!fgColor || !bgColor) {\n      return this.#hcmHighlightUrl;\n    }\n\n    const [fgRGB, bgRGB] = [fgColor, bgColor].map(this.#getRGB.bind(this));\n    let fgGray = Math.round(\n      0.2126 * fgRGB[0] + 0.7152 * fgRGB[1] + 0.0722 * fgRGB[2]\n    );\n    let bgGray = Math.round(\n      0.2126 * bgRGB[0] + 0.7152 * bgRGB[1] + 0.0722 * bgRGB[2]\n    );\n    let [newFgRGB, newBgRGB] = [newFgColor, newBgColor].map(\n      this.#getRGB.bind(this)\n    );\n    if (bgGray < fgGray) {\n      [fgGray, bgGray, newFgRGB, newBgRGB] = [\n        bgGray,\n        fgGray,\n        newBgRGB,\n        newFgRGB,\n      ];\n    }\n    this.#defs.style.color = \"\";\n\n    // Now we can create the filters to highlight some canvas parts.\n    // The colors in the pdf will almost be Canvas and CanvasText, hence we\n    // want to filter them to finally get Highlight and HighlightText.\n    // Since we're in HCM the background color and the foreground color should\n    // be really different when converted to grayscale (if they're not then it\n    // means that we've a poor contrast). Once the canvas colors are converted\n    // to grayscale we can easily map them on their new colors.\n    // The grayscale step is important because if we've something like:\n    //   fgColor = #FF....\n    //   bgColor = #FF....\n    //   then we are enable to map the red component on the new red components\n    //   which can be different.\n\n    const getSteps = (fg, bg, n) => {\n      const arr = new Array(256);\n      const step = (bgGray - fgGray) / n;\n      const newStart = fg / 255;\n      const newStep = (bg - fg) / (255 * n);\n      let prev = 0;\n      for (let i = 0; i <= n; i++) {\n        const k = Math.round(fgGray + i * step);\n        const value = newStart + i * newStep;\n        for (let j = prev; j <= k; j++) {\n          arr[j] = value;\n        }\n        prev = k + 1;\n      }\n      for (let i = prev; i < 256; i++) {\n        arr[i] = arr[prev - 1];\n      }\n      return arr.join(\",\");\n    };\n\n    const id = `g_${this.#docId}_hcm_highlight_filter`;\n    const filter = (this.#hcmHighlightFilter = this.#createFilter(id));\n\n    this.#addGrayConversion(filter);\n    this.#addTransferMapConversion(\n      getSteps(newFgRGB[0], newBgRGB[0], 5),\n      getSteps(newFgRGB[1], newBgRGB[1], 5),\n      getSteps(newFgRGB[2], newBgRGB[2], 5),\n      filter\n    );\n\n    this.#hcmHighlightUrl = `url(#${id})`;\n    return this.#hcmHighlightUrl;\n  }\n\n  destroy(keepHCM = false) {\n    if (keepHCM && (this.#hcmUrl || this.#hcmHighlightUrl)) {\n      return;\n    }\n    if (this.#_defs) {\n      this.#_defs.parentNode.parentNode.remove();\n      this.#_defs = null;\n    }\n    if (this.#_cache) {\n      this.#_cache.clear();\n      this.#_cache = null;\n    }\n    this.#id = 0;\n  }\n\n  #addGrayConversion(filter) {\n    const feColorMatrix = this.#document.createElementNS(\n      SVG_NS,\n      \"feColorMatrix\"\n    );\n    feColorMatrix.setAttribute(\"type\", \"matrix\");\n    feColorMatrix.setAttribute(\n      \"values\",\n      \"0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0\"\n    );\n    filter.append(feColorMatrix);\n  }\n\n  #createFilter(id) {\n    const filter = this.#document.createElementNS(SVG_NS, \"filter\");\n    filter.setAttribute(\"color-interpolation-filters\", \"sRGB\");\n    filter.setAttribute(\"id\", id);\n    this.#defs.append(filter);\n\n    return filter;\n  }\n\n  #appendFeFunc(feComponentTransfer, func, table) {\n    const feFunc = this.#document.createElementNS(SVG_NS, func);\n    feFunc.setAttribute(\"type\", \"discrete\");\n    feFunc.setAttribute(\"tableValues\", table);\n    feComponentTransfer.append(feFunc);\n  }\n\n  #addTransferMapConversion(rTable, gTable, bTable, filter) {\n    const feComponentTransfer = this.#document.createElementNS(\n      SVG_NS,\n      \"feComponentTransfer\"\n    );\n    filter.append(feComponentTransfer);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncR\", rTable);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncG\", gTable);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncB\", bTable);\n  }\n\n  #getRGB(color) {\n    this.#defs.style.color = color;\n    return getRGB(getComputedStyle(this.#defs).getPropertyValue(\"color\"));\n  }\n}\n\nclass DOMCanvasFactory extends BaseCanvasFactory {\n  constructor({ ownerDocument = globalThis.document } = {}) {\n    super();\n    this._document = ownerDocument;\n  }\n\n  /**\n   * @ignore\n   */\n  _createCanvas(width, height) {\n    const canvas = this._document.createElement(\"canvas\");\n    canvas.width = width;\n    canvas.height = height;\n    return canvas;\n  }\n}\n\nasync function fetchData(url, type = \"text\") {\n  if (\n    (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n    isValidFetchUrl(url, document.baseURI)\n  ) {\n    const response = await fetch(url);\n    if (!response.ok) {\n      throw new Error(response.statusText);\n    }\n    switch (type) {\n      case \"arraybuffer\":\n        return response.arrayBuffer();\n      case \"blob\":\n        return response.blob();\n      case \"json\":\n        return response.json();\n    }\n    return response.text();\n  }\n\n  // The Fetch API is not supported.\n  return new Promise((resolve, reject) => {\n    const request = new XMLHttpRequest();\n    request.open(\"GET\", url, /* async = */ true);\n    request.responseType = type;\n\n    request.onreadystatechange = () => {\n      if (request.readyState !== XMLHttpRequest.DONE) {\n        return;\n      }\n      if (request.status === 200 || request.status === 0) {\n        let data;\n        switch (type) {\n          case \"arraybuffer\":\n          case \"blob\":\n          case \"json\":\n            data = request.response;\n            break;\n          default:\n            data = request.responseText;\n            break;\n        }\n        if (data) {\n          resolve(data);\n          return;\n        }\n      }\n      reject(new Error(request.statusText));\n    };\n\n    request.send(null);\n  });\n}\n\nclass DOMCMapReaderFactory extends BaseCMapReaderFactory {\n  /**\n   * @ignore\n   */\n  _fetchData(url, compressionType) {\n    return fetchData(\n      url,\n      /* type = */ this.isCompressed ? \"arraybuffer\" : \"text\"\n    ).then(data => {\n      return {\n        cMapData:\n          data instanceof ArrayBuffer\n            ? new Uint8Array(data)\n            : stringToBytes(data),\n        compressionType,\n      };\n    });\n  }\n}\n\nclass DOMStandardFontDataFactory extends BaseStandardFontDataFactory {\n  /**\n   * @ignore\n   */\n  _fetchData(url) {\n    return fetchData(url, /* type = */ \"arraybuffer\").then(data => {\n      return new Uint8Array(data);\n    });\n  }\n}\n\nclass DOMSVGFactory extends BaseSVGFactory {\n  /**\n   * @ignore\n   */\n  _createSVG(type) {\n    return document.createElementNS(SVG_NS, type);\n  }\n}\n\n/**\n * @typedef {Object} PageViewportParameters\n * @property {Array<number>} viewBox - The xMin, yMin, xMax and\n *   yMax coordinates.\n * @property {number} scale - The scale of the viewport.\n * @property {number} rotation - The rotation, in degrees, of the viewport.\n * @property {number} [offsetX] - The horizontal, i.e. x-axis, offset. The\n *   default value is `0`.\n * @property {number} [offsetY] - The vertical, i.e. y-axis, offset. The\n *   default value is `0`.\n * @property {boolean} [dontFlip] - If true, the y-axis will not be flipped.\n *   The default value is `false`.\n */\n\n/**\n * @typedef {Object} PageViewportCloneParameters\n * @property {number} [scale] - The scale, overriding the one in the cloned\n *   viewport. The default value is `this.scale`.\n * @property {number} [rotation] - The rotation, in degrees, overriding the one\n *   in the cloned viewport. The default value is `this.rotation`.\n * @property {number} [offsetX] - The horizontal, i.e. x-axis, offset.\n *   The default value is `this.offsetX`.\n * @property {number} [offsetY] - The vertical, i.e. y-axis, offset.\n *   The default value is `this.offsetY`.\n * @property {boolean} [dontFlip] - If true, the x-axis will not be flipped.\n *   The default value is `false`.\n */\n\n/**\n * PDF page viewport created based on scale, rotation and offset.\n */\nclass PageViewport {\n  /**\n   * @param {PageViewportParameters}\n   */\n  constructor({\n    viewBox,\n    scale,\n    rotation,\n    offsetX = 0,\n    offsetY = 0,\n    dontFlip = false,\n  }) {\n    this.viewBox = viewBox;\n    this.scale = scale;\n    this.rotation = rotation;\n    this.offsetX = offsetX;\n    this.offsetY = offsetY;\n\n    // creating transform to convert pdf coordinate system to the normal\n    // canvas like coordinates taking in account scale and rotation\n    const centerX = (viewBox[2] + viewBox[0]) / 2;\n    const centerY = (viewBox[3] + viewBox[1]) / 2;\n    let rotateA, rotateB, rotateC, rotateD;\n    // Normalize the rotation, by clamping it to the [0, 360) range.\n    rotation %= 360;\n    if (rotation < 0) {\n      rotation += 360;\n    }\n    switch (rotation) {\n      case 180:\n        rotateA = -1;\n        rotateB = 0;\n        rotateC = 0;\n        rotateD = 1;\n        break;\n      case 90:\n        rotateA = 0;\n        rotateB = 1;\n        rotateC = 1;\n        rotateD = 0;\n        break;\n      case 270:\n        rotateA = 0;\n        rotateB = -1;\n        rotateC = -1;\n        rotateD = 0;\n        break;\n      case 0:\n        rotateA = 1;\n        rotateB = 0;\n        rotateC = 0;\n        rotateD = -1;\n        break;\n      default:\n        throw new Error(\n          \"PageViewport: Invalid rotation, must be a multiple of 90 degrees.\"\n        );\n    }\n\n    if (dontFlip) {\n      rotateC = -rotateC;\n      rotateD = -rotateD;\n    }\n\n    let offsetCanvasX, offsetCanvasY;\n    let width, height;\n    if (rotateA === 0) {\n      offsetCanvasX = Math.abs(centerY - viewBox[1]) * scale + offsetX;\n      offsetCanvasY = Math.abs(centerX - viewBox[0]) * scale + offsetY;\n      width = (viewBox[3] - viewBox[1]) * scale;\n      height = (viewBox[2] - viewBox[0]) * scale;\n    } else {\n      offsetCanvasX = Math.abs(centerX - viewBox[0]) * scale + offsetX;\n      offsetCanvasY = Math.abs(centerY - viewBox[1]) * scale + offsetY;\n      width = (viewBox[2] - viewBox[0]) * scale;\n      height = (viewBox[3] - viewBox[1]) * scale;\n    }\n    // creating transform for the following operations:\n    // translate(-centerX, -centerY), rotate and flip vertically,\n    // scale, and translate(offsetCanvasX, offsetCanvasY)\n    this.transform = [\n      rotateA * scale,\n      rotateB * scale,\n      rotateC * scale,\n      rotateD * scale,\n      offsetCanvasX - rotateA * scale * centerX - rotateC * scale * centerY,\n      offsetCanvasY - rotateB * scale * centerX - rotateD * scale * centerY,\n    ];\n\n    this.width = width;\n    this.height = height;\n  }\n\n  /**\n   * The original, un-scaled, viewport dimensions.\n   * @type {Object}\n   */\n  get rawDims() {\n    const { viewBox } = this;\n    return shadow(this, \"rawDims\", {\n      pageWidth: viewBox[2] - viewBox[0],\n      pageHeight: viewBox[3] - viewBox[1],\n      pageX: viewBox[0],\n      pageY: viewBox[1],\n    });\n  }\n\n  /**\n   * Clones viewport, with optional additional properties.\n   * @param {PageViewportCloneParameters} [params]\n   * @returns {PageViewport} Cloned viewport.\n   */\n  clone({\n    scale = this.scale,\n    rotation = this.rotation,\n    offsetX = this.offsetX,\n    offsetY = this.offsetY,\n    dontFlip = false,\n  } = {}) {\n    return new PageViewport({\n      viewBox: this.viewBox.slice(),\n      scale,\n      rotation,\n      offsetX,\n      offsetY,\n      dontFlip,\n    });\n  }\n\n  /**\n   * Converts PDF point to the viewport coordinates. For examples, useful for\n   * converting PDF location into canvas pixel coordinates.\n   * @param {number} x - The x-coordinate.\n   * @param {number} y - The y-coordinate.\n   * @returns {Array} Array containing `x`- and `y`-coordinates of the\n   *   point in the viewport coordinate space.\n   * @see {@link convertToPdfPoint}\n   * @see {@link convertToViewportRectangle}\n   */\n  convertToViewportPoint(x, y) {\n    return Util.applyTransform([x, y], this.transform);\n  }\n\n  /**\n   * Converts PDF rectangle to the viewport coordinates.\n   * @param {Array} rect - The xMin, yMin, xMax and yMax coordinates.\n   * @returns {Array} Array containing corresponding coordinates of the\n   *   rectangle in the viewport coordinate space.\n   * @see {@link convertToViewportPoint}\n   */\n  convertToViewportRectangle(rect) {\n    const topLeft = Util.applyTransform([rect[0], rect[1]], this.transform);\n    const bottomRight = Util.applyTransform([rect[2], rect[3]], this.transform);\n    return [topLeft[0], topLeft[1], bottomRight[0], bottomRight[1]];\n  }\n\n  /**\n   * Converts viewport coordinates to the PDF location. For examples, useful\n   * for converting canvas pixel location into PDF one.\n   * @param {number} x - The x-coordinate.\n   * @param {number} y - The y-coordinate.\n   * @returns {Array} Array containing `x`- and `y`-coordinates of the\n   *   point in the PDF coordinate space.\n   * @see {@link convertToViewportPoint}\n   */\n  convertToPdfPoint(x, y) {\n    return Util.applyInverseTransform([x, y], this.transform);\n  }\n}\n\nclass RenderingCancelledException extends BaseException {\n  constructor(msg, extraDelay = 0) {\n    super(msg, \"RenderingCancelledException\");\n    this.extraDelay = extraDelay;\n  }\n}\n\nfunction isDataScheme(url) {\n  const ii = url.length;\n  let i = 0;\n  while (i < ii && url[i].trim() === \"\") {\n    i++;\n  }\n  return url.substring(i, i + 5).toLowerCase() === \"data:\";\n}\n\nfunction isPdfFile(filename) {\n  return typeof filename === \"string\" && /\\.pdf$/i.test(filename);\n}\n\n/**\n * Gets the filename from a given URL.\n * @param {string} url\n * @param {boolean} [onlyStripPath]\n * @returns {string}\n */\nfunction getFilenameFromUrl(url, onlyStripPath = false) {\n  if (!onlyStripPath) {\n    [url] = url.split(/[#?]/, 1);\n  }\n  return url.substring(url.lastIndexOf(\"/\") + 1);\n}\n\n/**\n * Returns the filename or guessed filename from the url (see issue 3455).\n * @param {string} url - The original PDF location.\n * @param {string} defaultFilename - The value returned if the filename is\n *   unknown, or the protocol is unsupported.\n * @returns {string} Guessed PDF filename.\n */\nfunction getPdfFilenameFromUrl(url, defaultFilename = \"document.pdf\") {\n  if (typeof url !== \"string\") {\n    return defaultFilename;\n  }\n  if (isDataScheme(url)) {\n    warn('getPdfFilenameFromUrl: ignore \"data:\"-URL for performance reasons.');\n    return defaultFilename;\n  }\n  const reURI = /^(?:(?:[^:]+:)?\\/\\/[^/]+)?([^?#]*)(\\?[^#]*)?(#.*)?$/;\n  //              SCHEME        HOST        1.PATH  2.QUERY   3.REF\n  // Pattern to get last matching NAME.pdf\n  const reFilename = /[^/?#=]+\\.pdf\\b(?!.*\\.pdf\\b)/i;\n  const splitURI = reURI.exec(url);\n  let suggestedFilename =\n    reFilename.exec(splitURI[1]) ||\n    reFilename.exec(splitURI[2]) ||\n    reFilename.exec(splitURI[3]);\n  if (suggestedFilename) {\n    suggestedFilename = suggestedFilename[0];\n    if (suggestedFilename.includes(\"%\")) {\n      // URL-encoded %2Fpath%2Fto%2Ffile.pdf should be file.pdf\n      try {\n        suggestedFilename = reFilename.exec(\n          decodeURIComponent(suggestedFilename)\n        )[0];\n      } catch {\n        // Possible (extremely rare) errors:\n        // URIError \"Malformed URI\", e.g. for \"%AA.pdf\"\n        // TypeError \"null has no properties\", e.g. for \"%2F.pdf\"\n      }\n    }\n  }\n  return suggestedFilename || defaultFilename;\n}\n\nclass StatTimer {\n  started = Object.create(null);\n\n  times = [];\n\n  time(name) {\n    if (name in this.started) {\n      warn(`Timer is already running for ${name}`);\n    }\n    this.started[name] = Date.now();\n  }\n\n  timeEnd(name) {\n    if (!(name in this.started)) {\n      warn(`Timer has not been started for ${name}`);\n    }\n    this.times.push({\n      name,\n      start: this.started[name],\n      end: Date.now(),\n    });\n    // Remove timer from started so it can be called again.\n    delete this.started[name];\n  }\n\n  toString() {\n    // Find the longest name for padding purposes.\n    const outBuf = [];\n    let longest = 0;\n    for (const { name } of this.times) {\n      longest = Math.max(name.length, longest);\n    }\n    for (const { name, start, end } of this.times) {\n      outBuf.push(`${name.padEnd(longest)} ${end - start}ms\\n`);\n    }\n    return outBuf.join(\"\");\n  }\n}\n\nfunction isValidFetchUrl(url, baseUrl) {\n  if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n    throw new Error(\"Not implemented: isValidFetchUrl\");\n  }\n  try {\n    const { protocol } = baseUrl ? new URL(url, baseUrl) : new URL(url);\n    // The Fetch API only supports the http/https protocols, and not file/ftp.\n    return protocol === \"http:\" || protocol === \"https:\";\n  } catch {\n    return false; // `new URL()` will throw on incorrect data.\n  }\n}\n\n/**\n * Event handler to suppress context menu.\n */\nfunction noContextMenu(e) {\n  e.preventDefault();\n}\n\n// Deprecated API function -- display regardless of the `verbosity` setting.\nfunction deprecated(details) {\n  console.log(\"Deprecated API usage: \" + details);\n}\n\nlet pdfDateStringRegex;\n\nclass PDFDateString {\n  /**\n   * Convert a PDF date string to a JavaScript `Date` object.\n   *\n   * The PDF date string format is described in section 7.9.4 of the official\n   * PDF 32000-1:2008 specification. However, in the PDF 1.7 reference (sixth\n   * edition) Adobe describes the same format including a trailing apostrophe.\n   * This syntax in incorrect, but Adobe Acrobat creates PDF files that contain\n   * them. We ignore all apostrophes as they are not necessary for date parsing.\n   *\n   * Moreover, Adobe Acrobat doesn't handle changing the date to universal time\n   * and doesn't use the user's time zone (effectively ignoring the HH' and mm'\n   * parts of the date string).\n   *\n   * @param {string} input\n   * @returns {Date|null}\n   */\n  static toDateObject(input) {\n    if (!input || typeof input !== \"string\") {\n      return null;\n    }\n\n    // Lazily initialize the regular expression.\n    pdfDateStringRegex ||= new RegExp(\n      \"^D:\" + // Prefix (required)\n        \"(\\\\d{4})\" + // Year (required)\n        \"(\\\\d{2})?\" + // Month (optional)\n        \"(\\\\d{2})?\" + // Day (optional)\n        \"(\\\\d{2})?\" + // Hour (optional)\n        \"(\\\\d{2})?\" + // Minute (optional)\n        \"(\\\\d{2})?\" + // Second (optional)\n        \"([Z|+|-])?\" + // Universal time relation (optional)\n        \"(\\\\d{2})?\" + // Offset hour (optional)\n        \"'?\" + // Splitting apostrophe (optional)\n        \"(\\\\d{2})?\" + // Offset minute (optional)\n        \"'?\" // Trailing apostrophe (optional)\n    );\n\n    // Optional fields that don't satisfy the requirements from the regular\n    // expression (such as incorrect digit counts or numbers that are out of\n    // range) will fall back the defaults from the specification.\n    const matches = pdfDateStringRegex.exec(input);\n    if (!matches) {\n      return null;\n    }\n\n    // JavaScript's `Date` object expects the month to be between 0 and 11\n    // instead of 1 and 12, so we have to correct for that.\n    const year = parseInt(matches[1], 10);\n    let month = parseInt(matches[2], 10);\n    month = month >= 1 && month <= 12 ? month - 1 : 0;\n    let day = parseInt(matches[3], 10);\n    day = day >= 1 && day <= 31 ? day : 1;\n    let hour = parseInt(matches[4], 10);\n    hour = hour >= 0 && hour <= 23 ? hour : 0;\n    let minute = parseInt(matches[5], 10);\n    minute = minute >= 0 && minute <= 59 ? minute : 0;\n    let second = parseInt(matches[6], 10);\n    second = second >= 0 && second <= 59 ? second : 0;\n    const universalTimeRelation = matches[7] || \"Z\";\n    let offsetHour = parseInt(matches[8], 10);\n    offsetHour = offsetHour >= 0 && offsetHour <= 23 ? offsetHour : 0;\n    let offsetMinute = parseInt(matches[9], 10) || 0;\n    offsetMinute = offsetMinute >= 0 && offsetMinute <= 59 ? offsetMinute : 0;\n\n    // Universal time relation 'Z' means that the local time is equal to the\n    // universal time, whereas the relations '+'/'-' indicate that the local\n    // time is later respectively earlier than the universal time. Every date\n    // is normalized to universal time.\n    if (universalTimeRelation === \"-\") {\n      hour += offsetHour;\n      minute += offsetMinute;\n    } else if (universalTimeRelation === \"+\") {\n      hour -= offsetHour;\n      minute -= offsetMinute;\n    }\n\n    return new Date(Date.UTC(year, month, day, hour, minute, second));\n  }\n}\n\n/**\n * NOTE: This is (mostly) intended to support printing of XFA forms.\n */\nfunction getXfaPageViewport(xfaPage, { scale = 1, rotation = 0 }) {\n  const { width, height } = xfaPage.attributes.style;\n  const viewBox = [0, 0, parseInt(width), parseInt(height)];\n\n  return new PageViewport({\n    viewBox,\n    scale,\n    rotation,\n  });\n}\n\nfunction getRGB(color) {\n  if (color.startsWith(\"#\")) {\n    const colorRGB = parseInt(color.slice(1), 16);\n    return [\n      (colorRGB & 0xff0000) >> 16,\n      (colorRGB & 0x00ff00) >> 8,\n      colorRGB & 0x0000ff,\n    ];\n  }\n\n  if (color.startsWith(\"rgb(\")) {\n    // getComputedStyle(...).color returns a `rgb(R, G, B)` color.\n    return color\n      .slice(/* \"rgb(\".length */ 4, -1) // Strip out \"rgb(\" and \")\".\n      .split(\",\")\n      .map(x => parseInt(x));\n  }\n\n  if (color.startsWith(\"rgba(\")) {\n    return color\n      .slice(/* \"rgba(\".length */ 5, -1) // Strip out \"rgba(\" and \")\".\n      .split(\",\")\n      .map(x => parseInt(x))\n      .slice(0, 3);\n  }\n\n  warn(`Not a valid color format: \"${color}\"`);\n  return [0, 0, 0];\n}\n\nfunction getColorValues(colors) {\n  const span = document.createElement(\"span\");\n  span.style.visibility = \"hidden\";\n  document.body.append(span);\n  for (const name of colors.keys()) {\n    span.style.color = name;\n    const computedColor = window.getComputedStyle(span).color;\n    colors.set(name, getRGB(computedColor));\n  }\n  span.remove();\n}\n\nfunction getCurrentTransform(ctx) {\n  const { a, b, c, d, e, f } = ctx.getTransform();\n  return [a, b, c, d, e, f];\n}\n\nfunction getCurrentTransformInverse(ctx) {\n  const { a, b, c, d, e, f } = ctx.getTransform().invertSelf();\n  return [a, b, c, d, e, f];\n}\n\n/**\n * @param {HTMLDivElement} div\n * @param {PageViewport} viewport\n * @param {boolean} mustFlip\n * @param {boolean} mustRotate\n */\nfunction setLayerDimensions(\n  div,\n  viewport,\n  mustFlip = false,\n  mustRotate = true\n) {\n  if (viewport instanceof PageViewport) {\n    const { pageWidth, pageHeight } = viewport.rawDims;\n    const { style } = div;\n    const useRound = FeatureTest.isCSSRoundSupported;\n\n    const w = `var(--scale-factor) * ${pageWidth}px`,\n      h = `var(--scale-factor) * ${pageHeight}px`;\n    const widthStr = useRound ? `round(${w}, 1px)` : `calc(${w})`,\n      heightStr = useRound ? `round(${h}, 1px)` : `calc(${h})`;\n\n    if (!mustFlip || viewport.rotation % 180 === 0) {\n      style.width = widthStr;\n      style.height = heightStr;\n    } else {\n      style.width = heightStr;\n      style.height = widthStr;\n    }\n  }\n\n  if (mustRotate) {\n    div.setAttribute(\"data-main-rotation\", viewport.rotation);\n  }\n}\n\nexport {\n  deprecated,\n  DOMCanvasFactory,\n  DOMCMapReaderFactory,\n  DOMFilterFactory,\n  DOMStandardFontDataFactory,\n  DOMSVGFactory,\n  fetchData,\n  getColorValues,\n  getCurrentTransform,\n  getCurrentTransformInverse,\n  getFilenameFromUrl,\n  getPdfFilenameFromUrl,\n  getRGB,\n  getXfaPageViewport,\n  isDataScheme,\n  isPdfFile,\n  isValidFetchUrl,\n  noContextMenu,\n  PageViewport,\n  PDFDateString,\n  PixelsPerInch,\n  RenderingCancelledException,\n  setLayerDimensions,\n  StatTimer,\n};\n","/* Copyright 2023 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DOMSVGFactory } from \"./display_utils.js\";\nimport { shadow } from \"../shared/util.js\";\n\n/**\n * Manage the SVGs drawn on top of the page canvas.\n * It's important to have them directly on top of the canvas because we want to\n * be able to use mix-blend-mode for some of them.\n */\nclass DrawLayer {\n  #parent = null;\n\n  #id = 0;\n\n  #mapping = new Map();\n\n  constructor({ pageIndex }) {\n    this.pageIndex = pageIndex;\n  }\n\n  setParent(parent) {\n    if (!this.#parent) {\n      this.#parent = parent;\n      return;\n    }\n\n    if (this.#parent !== parent) {\n      if (this.#mapping.size > 0) {\n        for (const root of this.#mapping.values()) {\n          root.remove();\n          parent.append(root);\n        }\n      }\n      this.#parent = parent;\n    }\n  }\n\n  static get _svgFactory() {\n    return shadow(this, \"_svgFactory\", new DOMSVGFactory());\n  }\n\n  static #setBox(element, { x, y, width, height }) {\n    const { style } = element;\n    style.top = `${100 * y}%`;\n    style.left = `${100 * x}%`;\n    style.width = `${100 * width}%`;\n    style.height = `${100 * height}%`;\n  }\n\n  #createSVG(box) {\n    const svg = DrawLayer._svgFactory.create(1, 1, /* skipDimensions = */ true);\n    this.#parent.append(svg);\n    DrawLayer.#setBox(svg, box);\n\n    return svg;\n  }\n\n  highlight({ outlines, box }, color, opacity) {\n    const id = this.#id++;\n    const root = this.#createSVG(box);\n    root.classList.add(\"highlight\");\n    const defs = DrawLayer._svgFactory.createElement(\"defs\");\n    root.append(defs);\n    const path = DrawLayer._svgFactory.createElement(\"path\");\n    defs.append(path);\n    const pathId = `path_p${this.pageIndex}_${id}`;\n    path.setAttribute(\"id\", pathId);\n    path.setAttribute(\n      \"d\",\n      DrawLayer.#extractPathFromHighlightOutlines(outlines)\n    );\n\n    // Create the clipping path for the editor div.\n    const clipPath = DrawLayer._svgFactory.createElement(\"clipPath\");\n    defs.append(clipPath);\n    const clipPathId = `clip_${pathId}`;\n    clipPath.setAttribute(\"id\", clipPathId);\n    clipPath.setAttribute(\"clipPathUnits\", \"objectBoundingBox\");\n    const clipPathUse = DrawLayer._svgFactory.createElement(\"use\");\n    clipPath.append(clipPathUse);\n    clipPathUse.setAttribute(\"href\", `#${pathId}`);\n    clipPathUse.classList.add(\"clip\");\n\n    const use = DrawLayer._svgFactory.createElement(\"use\");\n    root.append(use);\n    root.setAttribute(\"fill\", color);\n    root.setAttribute(\"fill-opacity\", opacity);\n    use.setAttribute(\"href\", `#${pathId}`);\n\n    this.#mapping.set(id, root);\n\n    return { id, clipPathId: `url(#${clipPathId})` };\n  }\n\n  highlightOutline({ outlines, box }) {\n    // We cannot draw the outline directly in the SVG for highlights because\n    // it composes with its parent with mix-blend-mode: multiply.\n    // But the outline has a different mix-blend-mode, so we need to draw it in\n    // its own SVG.\n    const id = this.#id++;\n    const root = this.#createSVG(box);\n    root.classList.add(\"highlightOutline\");\n    const defs = DrawLayer._svgFactory.createElement(\"defs\");\n    root.append(defs);\n    const path = DrawLayer._svgFactory.createElement(\"path\");\n    defs.append(path);\n    const pathId = `path_p${this.pageIndex}_${id}`;\n    path.setAttribute(\"id\", pathId);\n    path.setAttribute(\n      \"d\",\n      DrawLayer.#extractPathFromHighlightOutlines(outlines)\n    );\n    path.setAttribute(\"vector-effect\", \"non-scaling-stroke\");\n\n    const use1 = DrawLayer._svgFactory.createElement(\"use\");\n    root.append(use1);\n    use1.setAttribute(\"href\", `#${pathId}`);\n    const use2 = use1.cloneNode();\n    root.append(use2);\n    use1.classList.add(\"mainOutline\");\n    use2.classList.add(\"secondaryOutline\");\n\n    this.#mapping.set(id, root);\n\n    return id;\n  }\n\n  static #extractPathFromHighlightOutlines(polygons) {\n    const buffer = [];\n    for (const polygon of polygons) {\n      let [prevX, prevY] = polygon;\n      buffer.push(`M${prevX} ${prevY}`);\n      for (let i = 2; i < polygon.length; i += 2) {\n        const x = polygon[i];\n        const y = polygon[i + 1];\n        if (x === prevX) {\n          buffer.push(`V${y}`);\n          prevY = y;\n        } else if (y === prevY) {\n          buffer.push(`H${x}`);\n          prevX = x;\n        }\n      }\n      buffer.push(\"Z\");\n    }\n    return buffer.join(\" \");\n  }\n\n  updateBox(id, box) {\n    DrawLayer.#setBox(this.#mapping.get(id), box);\n  }\n\n  rotate(id, angle) {\n    this.#mapping.get(id).setAttribute(\"data-main-rotation\", angle);\n  }\n\n  changeColor(id, color) {\n    this.#mapping.get(id).setAttribute(\"fill\", color);\n  }\n\n  changeOpacity(id, opacity) {\n    this.#mapping.get(id).setAttribute(\"fill-opacity\", opacity);\n  }\n\n  addClass(id, className) {\n    this.#mapping.get(id).classList.add(className);\n  }\n\n  removeClass(id, className) {\n    this.#mapping.get(id).classList.remove(className);\n  }\n\n  remove(id) {\n    this.#mapping.get(id).remove();\n    this.#mapping.delete(id);\n  }\n\n  destroy() {\n    this.#parent = null;\n    for (const root of this.#mapping.values()) {\n      root.remove();\n    }\n    this.#mapping.clear();\n  }\n}\n\nexport { DrawLayer };\n","/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./annotation_editor_layer.js\").AnnotationEditorLayer} AnnotationEditorLayer */\n\nimport {\n  AnnotationEditorParamsType,\n  AnnotationEditorType,\n  assert,\n  LINE_FACTOR,\n  shadow,\n  Util,\n} from \"../../shared/util.js\";\nimport {\n  AnnotationEditorUIManager,\n  bindEvents,\n  KeyboardManager,\n} from \"./tools.js\";\nimport { AnnotationEditor } from \"./editor.js\";\nimport { FreeTextAnnotationElement } from \"../annotation_layer.js\";\n\n/**\n * Basic text editor in order to create a FreeTex annotation.\n */\nclass FreeTextEditor extends AnnotationEditor {\n  #boundEditorDivBlur = this.editorDivBlur.bind(this);\n\n  #boundEditorDivFocus = this.editorDivFocus.bind(this);\n\n  #boundEditorDivInput = this.editorDivInput.bind(this);\n\n  #boundEditorDivKeydown = this.editorDivKeydown.bind(this);\n\n  #color;\n\n  #content = \"\";\n\n  #editorDivId = `${this.id}-editor`;\n\n  #fontSize;\n\n  #initialData = null;\n\n  static _freeTextDefaultContent = \"\";\n\n  static _internalPadding = 0;\n\n  static _defaultColor = null;\n\n  static _defaultFontSize = 10;\n\n  static get _keyboardManager() {\n    const proto = FreeTextEditor.prototype;\n\n    const arrowChecker = self => self.isEmpty();\n\n    const small = AnnotationEditorUIManager.TRANSLATE_SMALL;\n    const big = AnnotationEditorUIManager.TRANSLATE_BIG;\n\n    return shadow(\n      this,\n      \"_keyboardManager\",\n      new KeyboardManager([\n        [\n          // Commit the text in case the user use ctrl+s to save the document.\n          // The event must bubble in order to be caught by the viewer.\n          // See bug 1831574.\n          [\"ctrl+s\", \"mac+meta+s\", \"ctrl+p\", \"mac+meta+p\"],\n          proto.commitOrRemove,\n          { bubbles: true },\n        ],\n        [\n          [\"ctrl+Enter\", \"mac+meta+Enter\", \"Escape\", \"mac+Escape\"],\n          proto.commitOrRemove,\n        ],\n        [\n          [\"ArrowLeft\", \"mac+ArrowLeft\"],\n          proto._translateEmpty,\n          { args: [-small, 0], checker: arrowChecker },\n        ],\n        [\n          [\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"],\n          proto._translateEmpty,\n          { args: [-big, 0], checker: arrowChecker },\n        ],\n        [\n          [\"ArrowRight\", \"mac+ArrowRight\"],\n          proto._translateEmpty,\n          { args: [small, 0], checker: arrowChecker },\n        ],\n        [\n          [\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"],\n          proto._translateEmpty,\n          { args: [big, 0], checker: arrowChecker },\n        ],\n        [\n          [\"ArrowUp\", \"mac+ArrowUp\"],\n          proto._translateEmpty,\n          { args: [0, -small], checker: arrowChecker },\n        ],\n        [\n          [\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"],\n          proto._translateEmpty,\n          { args: [0, -big], checker: arrowChecker },\n        ],\n        [\n          [\"ArrowDown\", \"mac+ArrowDown\"],\n          proto._translateEmpty,\n          { args: [0, small], checker: arrowChecker },\n        ],\n        [\n          [\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"],\n          proto._translateEmpty,\n          { args: [0, big], checker: arrowChecker },\n        ],\n      ])\n    );\n  }\n\n  static _type = \"freetext\";\n\n  static _editorType = AnnotationEditorType.FREETEXT;\n\n  constructor(params) {\n    super({ ...params, name: \"freeTextEditor\" });\n    this.#color =\n      params.color ||\n      FreeTextEditor._defaultColor ||\n      AnnotationEditor._defaultLineColor;\n    this.#fontSize = params.fontSize || FreeTextEditor._defaultFontSize;\n  }\n\n  /** @inheritdoc */\n  static initialize(l10n) {\n    AnnotationEditor.initialize(l10n, {\n      strings: [\"pdfjs-free-text-default-content\"],\n    });\n    const style = getComputedStyle(document.documentElement);\n\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      const lineHeight = parseFloat(\n        style.getPropertyValue(\"--freetext-line-height\")\n      );\n      assert(\n        lineHeight === LINE_FACTOR,\n        \"Update the CSS variable to agree with the constant.\"\n      );\n    }\n\n    this._internalPadding = parseFloat(\n      style.getPropertyValue(\"--freetext-padding\")\n    );\n  }\n\n  /** @inheritdoc */\n  static updateDefaultParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.FREETEXT_SIZE:\n        FreeTextEditor._defaultFontSize = value;\n        break;\n      case AnnotationEditorParamsType.FREETEXT_COLOR:\n        FreeTextEditor._defaultColor = value;\n        break;\n    }\n  }\n\n  /** @inheritdoc */\n  updateParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.FREETEXT_SIZE:\n        this.#updateFontSize(value);\n        break;\n      case AnnotationEditorParamsType.FREETEXT_COLOR:\n        this.#updateColor(value);\n        break;\n    }\n  }\n\n  /** @inheritdoc */\n  static get defaultPropertiesToUpdate() {\n    return [\n      [\n        AnnotationEditorParamsType.FREETEXT_SIZE,\n        FreeTextEditor._defaultFontSize,\n      ],\n      [\n        AnnotationEditorParamsType.FREETEXT_COLOR,\n        FreeTextEditor._defaultColor || AnnotationEditor._defaultLineColor,\n      ],\n    ];\n  }\n\n  /** @inheritdoc */\n  get propertiesToUpdate() {\n    return [\n      [AnnotationEditorParamsType.FREETEXT_SIZE, this.#fontSize],\n      [AnnotationEditorParamsType.FREETEXT_COLOR, this.#color],\n    ];\n  }\n\n  /**\n   * Update the font size and make this action as undoable.\n   * @param {number} fontSize\n   */\n  #updateFontSize(fontSize) {\n    const setFontsize = size => {\n      this.editorDiv.style.fontSize = `calc(${size}px * var(--scale-factor))`;\n      this.translate(0, -(size - this.#fontSize) * this.parentScale);\n      this.#fontSize = size;\n      this.#setEditorDimensions();\n    };\n    const savedFontsize = this.#fontSize;\n    this.addCommands({\n      cmd: () => {\n        setFontsize(fontSize);\n      },\n      undo: () => {\n        setFontsize(savedFontsize);\n      },\n      mustExec: true,\n      type: AnnotationEditorParamsType.FREETEXT_SIZE,\n      overwriteIfSameType: true,\n      keepUndo: true,\n    });\n  }\n\n  /**\n   * Update the color and make this action undoable.\n   * @param {string} color\n   */\n  #updateColor(color) {\n    const savedColor = this.#color;\n    this.addCommands({\n      cmd: () => {\n        this.#color = this.editorDiv.style.color = color;\n      },\n      undo: () => {\n        this.#color = this.editorDiv.style.color = savedColor;\n      },\n      mustExec: true,\n      type: AnnotationEditorParamsType.FREETEXT_COLOR,\n      overwriteIfSameType: true,\n      keepUndo: true,\n    });\n  }\n\n  /**\n   * Helper to translate the editor with the keyboard when it's empty.\n   * @param {number} x in page units.\n   * @param {number} y in page units.\n   */\n  _translateEmpty(x, y) {\n    this._uiManager.translateSelectedEditors(x, y, /* noCommit = */ true);\n  }\n\n  /** @inheritdoc */\n  getInitialTranslation() {\n    // The start of the base line is where the user clicked.\n    const scale = this.parentScale;\n    return [\n      -FreeTextEditor._internalPadding * scale,\n      -(FreeTextEditor._internalPadding + this.#fontSize) * scale,\n    ];\n  }\n\n  /** @inheritdoc */\n  rebuild() {\n    if (!this.parent) {\n      return;\n    }\n    super.rebuild();\n    if (this.div === null) {\n      return;\n    }\n\n    if (!this.isAttachedToDOM) {\n      // At some point this editor was removed and we're rebuilting it,\n      // hence we must add it to its parent.\n      this.parent.add(this);\n    }\n  }\n\n  /** @inheritdoc */\n  enableEditMode() {\n    if (this.isInEditMode()) {\n      return;\n    }\n\n    this.parent.setEditingState(false);\n    this.parent.updateToolbar(AnnotationEditorType.FREETEXT);\n    super.enableEditMode();\n    this.overlayDiv.classList.remove(\"enabled\");\n    this.editorDiv.contentEditable = true;\n    this._isDraggable = false;\n    this.div.removeAttribute(\"aria-activedescendant\");\n    this.editorDiv.addEventListener(\"keydown\", this.#boundEditorDivKeydown);\n    this.editorDiv.addEventListener(\"focus\", this.#boundEditorDivFocus);\n    this.editorDiv.addEventListener(\"blur\", this.#boundEditorDivBlur);\n    this.editorDiv.addEventListener(\"input\", this.#boundEditorDivInput);\n  }\n\n  /** @inheritdoc */\n  disableEditMode() {\n    if (!this.isInEditMode()) {\n      return;\n    }\n\n    this.parent.setEditingState(true);\n    super.disableEditMode();\n    this.overlayDiv.classList.add(\"enabled\");\n    this.editorDiv.contentEditable = false;\n    this.div.setAttribute(\"aria-activedescendant\", this.#editorDivId);\n    this._isDraggable = true;\n    this.editorDiv.removeEventListener(\"keydown\", this.#boundEditorDivKeydown);\n    this.editorDiv.removeEventListener(\"focus\", this.#boundEditorDivFocus);\n    this.editorDiv.removeEventListener(\"blur\", this.#boundEditorDivBlur);\n    this.editorDiv.removeEventListener(\"input\", this.#boundEditorDivInput);\n\n    // On Chrome, the focus is given to <body> when contentEditable is set to\n    // false, hence we focus the div.\n    this.div.focus({\n      preventScroll: true /* See issue #15744 */,\n    });\n\n    // In case the blur callback hasn't been called.\n    this.isEditing = false;\n    this.parent.div.classList.add(\"freetextEditing\");\n  }\n\n  /** @inheritdoc */\n  focusin(event) {\n    if (!this._focusEventsAllowed) {\n      return;\n    }\n    super.focusin(event);\n    if (event.target !== this.editorDiv) {\n      this.editorDiv.focus();\n    }\n  }\n\n  /** @inheritdoc */\n  onceAdded() {\n    if (this.width) {\n      this.#cheatInitialRect();\n      // The editor was created in using ctrl+c.\n      return;\n    }\n    this.enableEditMode();\n    this.editorDiv.focus();\n    if (this._initialOptions?.isCentered) {\n      this.center();\n    }\n    this._initialOptions = null;\n  }\n\n  /** @inheritdoc */\n  isEmpty() {\n    return !this.editorDiv || this.editorDiv.innerText.trim() === \"\";\n  }\n\n  /** @inheritdoc */\n  remove() {\n    this.isEditing = false;\n    if (this.parent) {\n      this.parent.setEditingState(true);\n      this.parent.div.classList.add(\"freetextEditing\");\n    }\n    super.remove();\n  }\n\n  /**\n   * Extract the text from this editor.\n   * @returns {string}\n   */\n  #extractText() {\n    const divs = this.editorDiv.getElementsByTagName(\"div\");\n    if (divs.length === 0) {\n      return this.editorDiv.innerText;\n    }\n    const buffer = [];\n    for (const div of divs) {\n      buffer.push(div.innerText.replace(/\\r\\n?|\\n/, \"\"));\n    }\n    return buffer.join(\"\\n\");\n  }\n\n  #setEditorDimensions() {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n\n    let rect;\n    if (this.isAttachedToDOM) {\n      rect = this.div.getBoundingClientRect();\n    } else {\n      // This editor isn't on screen but we need to get its dimensions, so\n      // we just insert it in the DOM, get its bounding box and then remove it.\n      const { currentLayer, div } = this;\n      const savedDisplay = div.style.display;\n      div.style.display = \"hidden\";\n      currentLayer.div.append(this.div);\n      rect = div.getBoundingClientRect();\n      div.remove();\n      div.style.display = savedDisplay;\n    }\n\n    // The dimensions are relative to the rotation of the page, hence we need to\n    // take that into account (see issue #16636).\n    if (this.rotation % 180 === this.parentRotation % 180) {\n      this.width = rect.width / parentWidth;\n      this.height = rect.height / parentHeight;\n    } else {\n      this.width = rect.height / parentWidth;\n      this.height = rect.width / parentHeight;\n    }\n    this.fixAndSetPosition();\n  }\n\n  /**\n   * Commit the content we have in this editor.\n   * @returns {undefined}\n   */\n  commit() {\n    if (!this.isInEditMode()) {\n      return;\n    }\n\n    super.commit();\n    this.disableEditMode();\n    const savedText = this.#content;\n    const newText = (this.#content = this.#extractText().trimEnd());\n    if (savedText === newText) {\n      return;\n    }\n\n    const setText = text => {\n      this.#content = text;\n      if (!text) {\n        this.remove();\n        return;\n      }\n      this.#setContent();\n      this._uiManager.rebuild(this);\n      this.#setEditorDimensions();\n    };\n    this.addCommands({\n      cmd: () => {\n        setText(newText);\n      },\n      undo: () => {\n        setText(savedText);\n      },\n      mustExec: false,\n    });\n    this.#setEditorDimensions();\n  }\n\n  /** @inheritdoc */\n  shouldGetKeyboardEvents() {\n    return this.isInEditMode();\n  }\n\n  /** @inheritdoc */\n  enterInEditMode() {\n    this.enableEditMode();\n    this.editorDiv.focus();\n  }\n\n  /**\n   * ondblclick callback.\n   * @param {MouseEvent} event\n   */\n  dblclick(event) {\n    this.enterInEditMode();\n  }\n\n  /**\n   * onkeydown callback.\n   * @param {KeyboardEvent} event\n   */\n  keydown(event) {\n    if (event.target === this.div && event.key === \"Enter\") {\n      this.enterInEditMode();\n      // Avoid to add an unwanted new line.\n      event.preventDefault();\n    }\n  }\n\n  editorDivKeydown(event) {\n    FreeTextEditor._keyboardManager.exec(this, event);\n  }\n\n  editorDivFocus(event) {\n    this.isEditing = true;\n  }\n\n  editorDivBlur(event) {\n    this.isEditing = false;\n  }\n\n  editorDivInput(event) {\n    this.parent.div.classList.toggle(\"freetextEditing\", this.isEmpty());\n  }\n\n  /** @inheritdoc */\n  disableEditing() {\n    this.editorDiv.setAttribute(\"role\", \"comment\");\n    this.editorDiv.removeAttribute(\"aria-multiline\");\n  }\n\n  /** @inheritdoc */\n  enableEditing() {\n    this.editorDiv.setAttribute(\"role\", \"textbox\");\n    this.editorDiv.setAttribute(\"aria-multiline\", true);\n  }\n\n  /** @inheritdoc */\n  render() {\n    if (this.div) {\n      return this.div;\n    }\n\n    let baseX, baseY;\n    if (this.width) {\n      baseX = this.x;\n      baseY = this.y;\n    }\n\n    super.render();\n    this.editorDiv = document.createElement(\"div\");\n    this.editorDiv.className = \"internal\";\n\n    this.editorDiv.setAttribute(\"id\", this.#editorDivId);\n    this.editorDiv.setAttribute(\"data-l10n-id\", \"pdfjs-free-text\");\n    this.enableEditing();\n\n    AnnotationEditor._l10nPromise\n      .get(\"pdfjs-free-text-default-content\")\n      .then(msg => this.editorDiv?.setAttribute(\"default-content\", msg));\n    this.editorDiv.contentEditable = true;\n\n    const { style } = this.editorDiv;\n    style.fontSize = `calc(${this.#fontSize}px * var(--scale-factor))`;\n    style.color = this.#color;\n\n    this.div.append(this.editorDiv);\n\n    this.overlayDiv = document.createElement(\"div\");\n    this.overlayDiv.classList.add(\"overlay\", \"enabled\");\n    this.div.append(this.overlayDiv);\n\n    // TODO: implement paste callback.\n    // The goal is to sanitize and have something suitable for this\n    // editor.\n    bindEvents(this, this.div, [\"dblclick\", \"keydown\"]);\n\n    if (this.width) {\n      // This editor was created in using copy (ctrl+c).\n      const [parentWidth, parentHeight] = this.parentDimensions;\n      if (this.annotationElementId) {\n        // This stuff is hard to test: if something is changed here, please\n        // test with the following PDF file:\n        //  - freetexts.pdf\n        //  - rotated_freetexts.pdf\n        // Only small variations between the original annotation and its editor\n        // are allowed.\n\n        // position is the position of the first glyph in the annotation\n        // and it's relative to its container.\n        const { position } = this.#initialData;\n        let [tx, ty] = this.getInitialTranslation();\n        [tx, ty] = this.pageTranslationToScreen(tx, ty);\n        const [pageWidth, pageHeight] = this.pageDimensions;\n        const [pageX, pageY] = this.pageTranslation;\n        let posX, posY;\n        switch (this.rotation) {\n          case 0:\n            posX = baseX + (position[0] - pageX) / pageWidth;\n            posY = baseY + this.height - (position[1] - pageY) / pageHeight;\n            break;\n          case 90:\n            posX = baseX + (position[0] - pageX) / pageWidth;\n            posY = baseY - (position[1] - pageY) / pageHeight;\n            [tx, ty] = [ty, -tx];\n            break;\n          case 180:\n            posX = baseX - this.width + (position[0] - pageX) / pageWidth;\n            posY = baseY - (position[1] - pageY) / pageHeight;\n            [tx, ty] = [-tx, -ty];\n            break;\n          case 270:\n            posX =\n              baseX +\n              (position[0] - pageX - this.height * pageHeight) / pageWidth;\n            posY =\n              baseY +\n              (position[1] - pageY - this.width * pageWidth) / pageHeight;\n            [tx, ty] = [-ty, tx];\n            break;\n        }\n        this.setAt(posX * parentWidth, posY * parentHeight, tx, ty);\n      } else {\n        this.setAt(\n          baseX * parentWidth,\n          baseY * parentHeight,\n          this.width * parentWidth,\n          this.height * parentHeight\n        );\n      }\n\n      this.#setContent();\n      this._isDraggable = true;\n      this.editorDiv.contentEditable = false;\n    } else {\n      this._isDraggable = false;\n      this.editorDiv.contentEditable = true;\n    }\n\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n      this.div.setAttribute(\"annotation-id\", this.annotationElementId);\n    }\n\n    return this.div;\n  }\n\n  #setContent() {\n    this.editorDiv.replaceChildren();\n    if (!this.#content) {\n      return;\n    }\n    for (const line of this.#content.split(\"\\n\")) {\n      const div = document.createElement(\"div\");\n      div.append(\n        line ? document.createTextNode(line) : document.createElement(\"br\")\n      );\n      this.editorDiv.append(div);\n    }\n  }\n\n  /** @inheritdoc */\n  get contentDiv() {\n    return this.editorDiv;\n  }\n\n  /** @inheritdoc */\n  static deserialize(data, parent, uiManager) {\n    let initialData = null;\n    if (data instanceof FreeTextAnnotationElement) {\n      const {\n        data: {\n          defaultAppearanceData: { fontSize, fontColor },\n          rect,\n          rotation,\n          id,\n        },\n        textContent,\n        textPosition,\n        parent: {\n          page: { pageNumber },\n        },\n      } = data;\n      // textContent is supposed to be an array of strings containing each line\n      // of text. However, it can be null or empty.\n      if (!textContent || textContent.length === 0) {\n        // Empty annotation.\n        return null;\n      }\n      initialData = data = {\n        annotationType: AnnotationEditorType.FREETEXT,\n        color: Array.from(fontColor),\n        fontSize,\n        value: textContent.join(\"\\n\"),\n        position: textPosition,\n        pageIndex: pageNumber - 1,\n        rect,\n        rotation,\n        id,\n        deleted: false,\n      };\n    }\n    const editor = super.deserialize(data, parent, uiManager);\n\n    editor.#fontSize = data.fontSize;\n    editor.#color = Util.makeHexColor(...data.color);\n    editor.#content = data.value;\n    editor.annotationElementId = data.id || null;\n    editor.#initialData = initialData;\n\n    return editor;\n  }\n\n  /** @inheritdoc */\n  serialize(isForCopying = false) {\n    if (this.isEmpty()) {\n      return null;\n    }\n\n    if (this.deleted) {\n      return {\n        pageIndex: this.pageIndex,\n        id: this.annotationElementId,\n        deleted: true,\n      };\n    }\n\n    const padding = FreeTextEditor._internalPadding * this.parentScale;\n    const rect = this.getRect(padding, padding);\n    const color = AnnotationEditor._colorManager.convert(\n      this.isAttachedToDOM\n        ? getComputedStyle(this.editorDiv).color\n        : this.#color\n    );\n\n    const serialized = {\n      annotationType: AnnotationEditorType.FREETEXT,\n      color,\n      fontSize: this.#fontSize,\n      value: this.#content,\n      pageIndex: this.pageIndex,\n      rect,\n      rotation: this.rotation,\n      structTreeParentId: this._structTreeParentId,\n    };\n\n    if (isForCopying) {\n      // Don't add the id when copying because the pasted editor mustn't be\n      // linked to an existing annotation.\n      return serialized;\n    }\n\n    if (this.annotationElementId && !this.#hasElementChanged(serialized)) {\n      return null;\n    }\n\n    serialized.id = this.annotationElementId;\n\n    return serialized;\n  }\n\n  #hasElementChanged(serialized) {\n    const { value, fontSize, color, rect, pageIndex } = this.#initialData;\n\n    return (\n      serialized.value !== value ||\n      serialized.fontSize !== fontSize ||\n      serialized.rect.some((x, i) => Math.abs(x - rect[i]) >= 1) ||\n      serialized.color.some((c, i) => c !== color[i]) ||\n      serialized.pageIndex !== pageIndex\n    );\n  }\n\n  #cheatInitialRect(delayed = false) {\n    // The annotation has a rect but the editor has an other one.\n    // When we want to know if the annotation has changed (e.g. has been moved)\n    // we must compare the editor initial rect with the current one.\n    // So this method is a hack to have a way to compare the real rects.\n    if (!this.annotationElementId) {\n      return;\n    }\n\n    this.#setEditorDimensions();\n    if (!delayed && (this.width === 0 || this.height === 0)) {\n      setTimeout(() => this.#cheatInitialRect(/* delayed = */ true), 0);\n      return;\n    }\n\n    const padding = FreeTextEditor._internalPadding * this.parentScale;\n    this.#initialData.rect = this.getRect(padding, padding);\n  }\n}\n\nexport { FreeTextEditor };\n","/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  AnnotationEditorParamsType,\n  AnnotationEditorType,\n  Util,\n} from \"../../shared/util.js\";\nimport { AnnotationEditor } from \"./editor.js\";\nimport { InkAnnotationElement } from \"../annotation_layer.js\";\nimport { noContextMenu } from \"../display_utils.js\";\nimport { opacityToHex } from \"./tools.js\";\n\n/**\n * Basic draw editor in order to generate an Ink annotation.\n */\nclass InkEditor extends AnnotationEditor {\n  #baseHeight = 0;\n\n  #baseWidth = 0;\n\n  #boundCanvasPointermove = this.canvasPointermove.bind(this);\n\n  #boundCanvasPointerleave = this.canvasPointerleave.bind(this);\n\n  #boundCanvasPointerup = this.canvasPointerup.bind(this);\n\n  #boundCanvasPointerdown = this.canvasPointerdown.bind(this);\n\n  #canvasContextMenuTimeoutId = null;\n\n  #currentPath2D = new Path2D();\n\n  #disableEditing = false;\n\n  #hasSomethingToDraw = false;\n\n  #isCanvasInitialized = false;\n\n  #observer = null;\n\n  #realWidth = 0;\n\n  #realHeight = 0;\n\n  #requestFrameCallback = null;\n\n  static _defaultColor = null;\n\n  static _defaultOpacity = 1;\n\n  static _defaultThickness = 1;\n\n  static _type = \"ink\";\n\n  static _editorType = AnnotationEditorType.INK;\n\n  constructor(params) {\n    super({ ...params, name: \"inkEditor\" });\n    this.color = params.color || null;\n    this.thickness = params.thickness || null;\n    this.opacity = params.opacity || null;\n    this.paths = [];\n    this.bezierPath2D = [];\n    this.allRawPaths = [];\n    this.currentPath = [];\n    this.scaleFactor = 1;\n    this.translationX = this.translationY = 0;\n    this.x = 0;\n    this.y = 0;\n    this._willKeepAspectRatio = true;\n  }\n\n  /** @inheritdoc */\n  static initialize(l10n) {\n    AnnotationEditor.initialize(l10n);\n  }\n\n  /** @inheritdoc */\n  static updateDefaultParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.INK_THICKNESS:\n        InkEditor._defaultThickness = value;\n        break;\n      case AnnotationEditorParamsType.INK_COLOR:\n        InkEditor._defaultColor = value;\n        break;\n      case AnnotationEditorParamsType.INK_OPACITY:\n        InkEditor._defaultOpacity = value / 100;\n        break;\n    }\n  }\n\n  /** @inheritdoc */\n  updateParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.INK_THICKNESS:\n        this.#updateThickness(value);\n        break;\n      case AnnotationEditorParamsType.INK_COLOR:\n        this.#updateColor(value);\n        break;\n      case AnnotationEditorParamsType.INK_OPACITY:\n        this.#updateOpacity(value);\n        break;\n    }\n  }\n\n  /** @inheritdoc */\n  static get defaultPropertiesToUpdate() {\n    return [\n      [AnnotationEditorParamsType.INK_THICKNESS, InkEditor._defaultThickness],\n      [\n        AnnotationEditorParamsType.INK_COLOR,\n        InkEditor._defaultColor || AnnotationEditor._defaultLineColor,\n      ],\n      [\n        AnnotationEditorParamsType.INK_OPACITY,\n        Math.round(InkEditor._defaultOpacity * 100),\n      ],\n    ];\n  }\n\n  /** @inheritdoc */\n  get propertiesToUpdate() {\n    return [\n      [\n        AnnotationEditorParamsType.INK_THICKNESS,\n        this.thickness || InkEditor._defaultThickness,\n      ],\n      [\n        AnnotationEditorParamsType.INK_COLOR,\n        this.color ||\n          InkEditor._defaultColor ||\n          AnnotationEditor._defaultLineColor,\n      ],\n      [\n        AnnotationEditorParamsType.INK_OPACITY,\n        Math.round(100 * (this.opacity ?? InkEditor._defaultOpacity)),\n      ],\n    ];\n  }\n\n  /**\n   * Update the thickness and make this action undoable.\n   * @param {number} thickness\n   */\n  #updateThickness(thickness) {\n    const savedThickness = this.thickness;\n    this.addCommands({\n      cmd: () => {\n        this.thickness = thickness;\n        this.#fitToContent();\n      },\n      undo: () => {\n        this.thickness = savedThickness;\n        this.#fitToContent();\n      },\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_THICKNESS,\n      overwriteIfSameType: true,\n      keepUndo: true,\n    });\n  }\n\n  /**\n   * Update the color and make this action undoable.\n   * @param {string} color\n   */\n  #updateColor(color) {\n    const savedColor = this.color;\n    this.addCommands({\n      cmd: () => {\n        this.color = color;\n        this.#redraw();\n      },\n      undo: () => {\n        this.color = savedColor;\n        this.#redraw();\n      },\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_COLOR,\n      overwriteIfSameType: true,\n      keepUndo: true,\n    });\n  }\n\n  /**\n   * Update the opacity and make this action undoable.\n   * @param {number} opacity\n   */\n  #updateOpacity(opacity) {\n    opacity /= 100;\n    const savedOpacity = this.opacity;\n    this.addCommands({\n      cmd: () => {\n        this.opacity = opacity;\n        this.#redraw();\n      },\n      undo: () => {\n        this.opacity = savedOpacity;\n        this.#redraw();\n      },\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_OPACITY,\n      overwriteIfSameType: true,\n      keepUndo: true,\n    });\n  }\n\n  /** @inheritdoc */\n  rebuild() {\n    if (!this.parent) {\n      return;\n    }\n    super.rebuild();\n    if (this.div === null) {\n      return;\n    }\n\n    if (!this.canvas) {\n      this.#createCanvas();\n      this.#createObserver();\n    }\n\n    if (!this.isAttachedToDOM) {\n      // At some point this editor was removed and we're rebuilding it,\n      // hence we must add it to its parent.\n      this.parent.add(this);\n      this.#setCanvasDims();\n    }\n    this.#fitToContent();\n  }\n\n  /** @inheritdoc */\n  remove() {\n    if (this.canvas === null) {\n      return;\n    }\n\n    if (!this.isEmpty()) {\n      this.commit();\n    }\n\n    // Destroy the canvas.\n    this.canvas.width = this.canvas.height = 0;\n    this.canvas.remove();\n    this.canvas = null;\n\n    if (this.#canvasContextMenuTimeoutId) {\n      clearTimeout(this.#canvasContextMenuTimeoutId);\n      this.#canvasContextMenuTimeoutId = null;\n    }\n\n    this.#observer.disconnect();\n    this.#observer = null;\n\n    super.remove();\n  }\n\n  setParent(parent) {\n    if (!this.parent && parent) {\n      // We've a parent hence the rescale will be handled thanks to the\n      // ResizeObserver.\n      this._uiManager.removeShouldRescale(this);\n    } else if (this.parent && parent === null) {\n      // The editor is removed from the DOM, hence we handle the rescale thanks\n      // to the onScaleChanging callback.\n      // This way, it'll be saved/printed correctly.\n      this._uiManager.addShouldRescale(this);\n    }\n    super.setParent(parent);\n  }\n\n  onScaleChanging() {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    const width = this.width * parentWidth;\n    const height = this.height * parentHeight;\n    this.setDimensions(width, height);\n  }\n\n  /** @inheritdoc */\n  enableEditMode() {\n    if (this.#disableEditing || this.canvas === null) {\n      return;\n    }\n\n    super.enableEditMode();\n    this._isDraggable = false;\n    this.canvas.addEventListener(\"pointerdown\", this.#boundCanvasPointerdown);\n  }\n\n  /** @inheritdoc */\n  disableEditMode() {\n    if (!this.isInEditMode() || this.canvas === null) {\n      return;\n    }\n\n    super.disableEditMode();\n    this._isDraggable = !this.isEmpty();\n    this.div.classList.remove(\"editing\");\n\n    this.canvas.removeEventListener(\n      \"pointerdown\",\n      this.#boundCanvasPointerdown\n    );\n  }\n\n  /** @inheritdoc */\n  onceAdded() {\n    this._isDraggable = !this.isEmpty();\n  }\n\n  /** @inheritdoc */\n  isEmpty() {\n    return (\n      this.paths.length === 0 ||\n      (this.paths.length === 1 && this.paths[0].length === 0)\n    );\n  }\n\n  #getInitialBBox() {\n    const {\n      parentRotation,\n      parentDimensions: [width, height],\n    } = this;\n    switch (parentRotation) {\n      case 90:\n        return [0, height, height, width];\n      case 180:\n        return [width, height, width, height];\n      case 270:\n        return [width, 0, height, width];\n      default:\n        return [0, 0, width, height];\n    }\n  }\n\n  /**\n   * Set line styles.\n   */\n  #setStroke() {\n    const { ctx, color, opacity, thickness, parentScale, scaleFactor } = this;\n    ctx.lineWidth = (thickness * parentScale) / scaleFactor;\n    ctx.lineCap = \"round\";\n    ctx.lineJoin = \"round\";\n    ctx.miterLimit = 10;\n    ctx.strokeStyle = `${color}${opacityToHex(opacity)}`;\n  }\n\n  /**\n   * Start to draw on the canvas.\n   * @param {number} x\n   * @param {number} y\n   */\n  #startDrawing(x, y) {\n    this.canvas.addEventListener(\"contextmenu\", noContextMenu);\n    this.canvas.addEventListener(\"pointerleave\", this.#boundCanvasPointerleave);\n    this.canvas.addEventListener(\"pointermove\", this.#boundCanvasPointermove);\n    this.canvas.addEventListener(\"pointerup\", this.#boundCanvasPointerup);\n    this.canvas.removeEventListener(\n      \"pointerdown\",\n      this.#boundCanvasPointerdown\n    );\n\n    this.isEditing = true;\n    if (!this.#isCanvasInitialized) {\n      this.#isCanvasInitialized = true;\n      this.#setCanvasDims();\n      this.thickness ||= InkEditor._defaultThickness;\n      this.color ||=\n        InkEditor._defaultColor || AnnotationEditor._defaultLineColor;\n      this.opacity ??= InkEditor._defaultOpacity;\n    }\n    this.currentPath.push([x, y]);\n    this.#hasSomethingToDraw = false;\n    this.#setStroke();\n\n    this.#requestFrameCallback = () => {\n      this.#drawPoints();\n      if (this.#requestFrameCallback) {\n        window.requestAnimationFrame(this.#requestFrameCallback);\n      }\n    };\n    window.requestAnimationFrame(this.#requestFrameCallback);\n  }\n\n  /**\n   * Draw on the canvas.\n   * @param {number} x\n   * @param {number} y\n   */\n  #draw(x, y) {\n    const [lastX, lastY] = this.currentPath.at(-1);\n    if (this.currentPath.length > 1 && x === lastX && y === lastY) {\n      return;\n    }\n    const currentPath = this.currentPath;\n    let path2D = this.#currentPath2D;\n    currentPath.push([x, y]);\n    this.#hasSomethingToDraw = true;\n\n    if (currentPath.length <= 2) {\n      path2D.moveTo(...currentPath[0]);\n      path2D.lineTo(x, y);\n      return;\n    }\n\n    if (currentPath.length === 3) {\n      this.#currentPath2D = path2D = new Path2D();\n      path2D.moveTo(...currentPath[0]);\n    }\n\n    this.#makeBezierCurve(\n      path2D,\n      ...currentPath.at(-3),\n      ...currentPath.at(-2),\n      x,\n      y\n    );\n  }\n\n  #endPath() {\n    if (this.currentPath.length === 0) {\n      return;\n    }\n    const lastPoint = this.currentPath.at(-1);\n    this.#currentPath2D.lineTo(...lastPoint);\n  }\n\n  /**\n   * Stop to draw on the canvas.\n   * @param {number} x\n   * @param {number} y\n   */\n  #stopDrawing(x, y) {\n    this.#requestFrameCallback = null;\n\n    x = Math.min(Math.max(x, 0), this.canvas.width);\n    y = Math.min(Math.max(y, 0), this.canvas.height);\n\n    this.#draw(x, y);\n    this.#endPath();\n\n    // Interpolate the path entered by the user with some\n    // Bezier's curves in order to have a smoother path and\n    // to reduce the data size used to draw it in the PDF.\n    let bezier;\n    if (this.currentPath.length !== 1) {\n      bezier = this.#generateBezierPoints();\n    } else {\n      // We have only one point finally.\n      const xy = [x, y];\n      bezier = [[xy, xy.slice(), xy.slice(), xy]];\n    }\n    const path2D = this.#currentPath2D;\n    const currentPath = this.currentPath;\n    this.currentPath = [];\n    this.#currentPath2D = new Path2D();\n\n    const cmd = () => {\n      this.allRawPaths.push(currentPath);\n      this.paths.push(bezier);\n      this.bezierPath2D.push(path2D);\n      this.rebuild();\n    };\n\n    const undo = () => {\n      this.allRawPaths.pop();\n      this.paths.pop();\n      this.bezierPath2D.pop();\n      if (this.paths.length === 0) {\n        this.remove();\n      } else {\n        if (!this.canvas) {\n          this.#createCanvas();\n          this.#createObserver();\n        }\n        this.#fitToContent();\n      }\n    };\n\n    this.addCommands({ cmd, undo, mustExec: true });\n  }\n\n  #drawPoints() {\n    if (!this.#hasSomethingToDraw) {\n      return;\n    }\n    this.#hasSomethingToDraw = false;\n\n    const thickness = Math.ceil(this.thickness * this.parentScale);\n    const lastPoints = this.currentPath.slice(-3);\n    const x = lastPoints.map(xy => xy[0]);\n    const y = lastPoints.map(xy => xy[1]);\n    const xMin = Math.min(...x) - thickness;\n    const xMax = Math.max(...x) + thickness;\n    const yMin = Math.min(...y) - thickness;\n    const yMax = Math.max(...y) + thickness;\n\n    const { ctx } = this;\n    ctx.save();\n\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n      // In Chrome, the clip() method doesn't work as expected.\n      ctx.clearRect(xMin, yMin, xMax - xMin, yMax - yMin);\n      ctx.beginPath();\n      ctx.rect(xMin, yMin, xMax - xMin, yMax - yMin);\n      ctx.clip();\n    } else {\n      ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    }\n\n    for (const path of this.bezierPath2D) {\n      ctx.stroke(path);\n    }\n    ctx.stroke(this.#currentPath2D);\n\n    ctx.restore();\n  }\n\n  #makeBezierCurve(path2D, x0, y0, x1, y1, x2, y2) {\n    const prevX = (x0 + x1) / 2;\n    const prevY = (y0 + y1) / 2;\n    const x3 = (x1 + x2) / 2;\n    const y3 = (y1 + y2) / 2;\n\n    path2D.bezierCurveTo(\n      prevX + (2 * (x1 - prevX)) / 3,\n      prevY + (2 * (y1 - prevY)) / 3,\n      x3 + (2 * (x1 - x3)) / 3,\n      y3 + (2 * (y1 - y3)) / 3,\n      x3,\n      y3\n    );\n  }\n\n  #generateBezierPoints() {\n    const path = this.currentPath;\n    if (path.length <= 2) {\n      return [[path[0], path[0], path.at(-1), path.at(-1)]];\n    }\n\n    const bezierPoints = [];\n    let i;\n    let [x0, y0] = path[0];\n    for (i = 1; i < path.length - 2; i++) {\n      const [x1, y1] = path[i];\n      const [x2, y2] = path[i + 1];\n      const x3 = (x1 + x2) / 2;\n      const y3 = (y1 + y2) / 2;\n\n      // The quadratic is: [[x0, y0], [x1, y1], [x3, y3]].\n      // Convert the quadratic to a cubic\n      // (see https://fontforge.org/docs/techref/bezier.html#converting-truetype-to-postscript)\n      const control1 = [x0 + (2 * (x1 - x0)) / 3, y0 + (2 * (y1 - y0)) / 3];\n      const control2 = [x3 + (2 * (x1 - x3)) / 3, y3 + (2 * (y1 - y3)) / 3];\n\n      bezierPoints.push([[x0, y0], control1, control2, [x3, y3]]);\n\n      [x0, y0] = [x3, y3];\n    }\n\n    const [x1, y1] = path[i];\n    const [x2, y2] = path[i + 1];\n\n    // The quadratic is: [[x0, y0], [x1, y1], [x2, y2]].\n    const control1 = [x0 + (2 * (x1 - x0)) / 3, y0 + (2 * (y1 - y0)) / 3];\n    const control2 = [x2 + (2 * (x1 - x2)) / 3, y2 + (2 * (y1 - y2)) / 3];\n\n    bezierPoints.push([[x0, y0], control1, control2, [x2, y2]]);\n    return bezierPoints;\n  }\n\n  /**\n   * Redraw all the paths.\n   */\n  #redraw() {\n    if (this.isEmpty()) {\n      this.#updateTransform();\n      return;\n    }\n    this.#setStroke();\n\n    const { canvas, ctx } = this;\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    this.#updateTransform();\n\n    for (const path of this.bezierPath2D) {\n      ctx.stroke(path);\n    }\n  }\n\n  /**\n   * Commit the curves we have in this editor.\n   */\n  commit() {\n    if (this.#disableEditing) {\n      return;\n    }\n\n    super.commit();\n\n    this.isEditing = false;\n    this.disableEditMode();\n\n    // This editor must be on top of the main ink editor.\n    this.setInForeground();\n\n    this.#disableEditing = true;\n    this.div.classList.add(\"disabled\");\n\n    this.#fitToContent(/* firstTime = */ true);\n    this.select();\n\n    this.parent.addInkEditorIfNeeded(/* isCommitting = */ true);\n\n    // When commiting, the position of this editor is changed, hence we must\n    // move it to the right position in the DOM.\n    this.moveInDOM();\n    this.div.focus({\n      preventScroll: true /* See issue #15744 */,\n    });\n  }\n\n  /** @inheritdoc */\n  focusin(event) {\n    if (!this._focusEventsAllowed) {\n      return;\n    }\n    super.focusin(event);\n    this.enableEditMode();\n  }\n\n  /**\n   * onpointerdown callback for the canvas we're drawing on.\n   * @param {PointerEvent} event\n   */\n  canvasPointerdown(event) {\n    if (event.button !== 0 || !this.isInEditMode() || this.#disableEditing) {\n      return;\n    }\n\n    // We want to draw on top of any other editors.\n    // Since it's the last child, there's no need to give it a higher z-index.\n    this.setInForeground();\n\n    event.preventDefault();\n\n    if (\n      event.pointerType !== \"mouse\" &&\n      !this.div.contains(document.activeElement)\n    ) {\n      this.div.focus({\n        preventScroll: true /* See issue #17327 */,\n      });\n    }\n\n    this.#startDrawing(event.offsetX, event.offsetY);\n  }\n\n  /**\n   * onpointermove callback for the canvas we're drawing on.\n   * @param {PointerEvent} event\n   */\n  canvasPointermove(event) {\n    event.preventDefault();\n    this.#draw(event.offsetX, event.offsetY);\n  }\n\n  /**\n   * onpointerup callback for the canvas we're drawing on.\n   * @param {PointerEvent} event\n   */\n  canvasPointerup(event) {\n    event.preventDefault();\n    this.#endDrawing(event);\n  }\n\n  /**\n   * onpointerleave callback for the canvas we're drawing on.\n   * @param {PointerEvent} event\n   */\n  canvasPointerleave(event) {\n    this.#endDrawing(event);\n  }\n\n  /**\n   * End the drawing.\n   * @param {PointerEvent} event\n   */\n  #endDrawing(event) {\n    this.canvas.removeEventListener(\n      \"pointerleave\",\n      this.#boundCanvasPointerleave\n    );\n    this.canvas.removeEventListener(\n      \"pointermove\",\n      this.#boundCanvasPointermove\n    );\n    this.canvas.removeEventListener(\"pointerup\", this.#boundCanvasPointerup);\n    this.canvas.addEventListener(\"pointerdown\", this.#boundCanvasPointerdown);\n\n    // Slight delay to avoid the context menu to appear (it can happen on a long\n    // tap with a pen).\n    if (this.#canvasContextMenuTimeoutId) {\n      clearTimeout(this.#canvasContextMenuTimeoutId);\n    }\n    this.#canvasContextMenuTimeoutId = setTimeout(() => {\n      this.#canvasContextMenuTimeoutId = null;\n      this.canvas.removeEventListener(\"contextmenu\", noContextMenu);\n    }, 10);\n\n    this.#stopDrawing(event.offsetX, event.offsetY);\n\n    this.addToAnnotationStorage();\n\n    // Since the ink editor covers all of the page and we want to be able\n    // to select another editor, we just put this one in the background.\n    this.setInBackground();\n  }\n\n  /**\n   * Create the canvas element.\n   */\n  #createCanvas() {\n    this.canvas = document.createElement(\"canvas\");\n    this.canvas.width = this.canvas.height = 0;\n    this.canvas.className = \"inkEditorCanvas\";\n    this.canvas.setAttribute(\"data-l10n-id\", \"pdfjs-ink-canvas\");\n\n    this.div.append(this.canvas);\n    this.ctx = this.canvas.getContext(\"2d\");\n  }\n\n  /**\n   * Create the resize observer.\n   */\n  #createObserver() {\n    this.#observer = new ResizeObserver(entries => {\n      const rect = entries[0].contentRect;\n      if (rect.width && rect.height) {\n        this.setDimensions(rect.width, rect.height);\n      }\n    });\n    this.#observer.observe(this.div);\n  }\n\n  /** @inheritdoc */\n  get isResizable() {\n    return !this.isEmpty() && this.#disableEditing;\n  }\n\n  /** @inheritdoc */\n  render() {\n    if (this.div) {\n      return this.div;\n    }\n\n    let baseX, baseY;\n    if (this.width) {\n      baseX = this.x;\n      baseY = this.y;\n    }\n\n    super.render();\n\n    this.div.setAttribute(\"data-l10n-id\", \"pdfjs-ink\");\n\n    const [x, y, w, h] = this.#getInitialBBox();\n    this.setAt(x, y, 0, 0);\n    this.setDims(w, h);\n\n    this.#createCanvas();\n\n    if (this.width) {\n      // This editor was created in using copy (ctrl+c).\n      const [parentWidth, parentHeight] = this.parentDimensions;\n      this.setAspectRatio(this.width * parentWidth, this.height * parentHeight);\n      this.setAt(\n        baseX * parentWidth,\n        baseY * parentHeight,\n        this.width * parentWidth,\n        this.height * parentHeight\n      );\n      this.#isCanvasInitialized = true;\n      this.#setCanvasDims();\n      this.setDims(this.width * parentWidth, this.height * parentHeight);\n      this.#redraw();\n      this.div.classList.add(\"disabled\");\n    } else {\n      this.div.classList.add(\"editing\");\n      this.enableEditMode();\n    }\n\n    this.#createObserver();\n\n    return this.div;\n  }\n\n  #setCanvasDims() {\n    if (!this.#isCanvasInitialized) {\n      return;\n    }\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.canvas.width = Math.ceil(this.width * parentWidth);\n    this.canvas.height = Math.ceil(this.height * parentHeight);\n    this.#updateTransform();\n  }\n\n  /**\n   * When the dimensions of the div change the inner canvas must\n   * renew its dimensions, hence it must redraw its own contents.\n   * @param {number} width - the new width of the div\n   * @param {number} height - the new height of the div\n   * @returns\n   */\n  setDimensions(width, height) {\n    const roundedWidth = Math.round(width);\n    const roundedHeight = Math.round(height);\n    if (\n      this.#realWidth === roundedWidth &&\n      this.#realHeight === roundedHeight\n    ) {\n      return;\n    }\n\n    this.#realWidth = roundedWidth;\n    this.#realHeight = roundedHeight;\n\n    this.canvas.style.visibility = \"hidden\";\n\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.width = width / parentWidth;\n    this.height = height / parentHeight;\n    this.fixAndSetPosition();\n\n    if (this.#disableEditing) {\n      this.#setScaleFactor(width, height);\n    }\n\n    this.#setCanvasDims();\n    this.#redraw();\n\n    this.canvas.style.visibility = \"visible\";\n\n    // For any reason the dimensions couldn't be in percent but in pixels, hence\n    // we must fix them.\n    this.fixDims();\n  }\n\n  #setScaleFactor(width, height) {\n    const padding = this.#getPadding();\n    const scaleFactorW = (width - padding) / this.#baseWidth;\n    const scaleFactorH = (height - padding) / this.#baseHeight;\n    this.scaleFactor = Math.min(scaleFactorW, scaleFactorH);\n  }\n\n  /**\n   * Update the canvas transform.\n   */\n  #updateTransform() {\n    const padding = this.#getPadding() / 2;\n    this.ctx.setTransform(\n      this.scaleFactor,\n      0,\n      0,\n      this.scaleFactor,\n      this.translationX * this.scaleFactor + padding,\n      this.translationY * this.scaleFactor + padding\n    );\n  }\n\n  /**\n   * Convert into a Path2D.\n   * @param {Array<Array<number>>} bezier\n   * @returns {Path2D}\n   */\n  static #buildPath2D(bezier) {\n    const path2D = new Path2D();\n    for (let i = 0, ii = bezier.length; i < ii; i++) {\n      const [first, control1, control2, second] = bezier[i];\n      if (i === 0) {\n        path2D.moveTo(...first);\n      }\n      path2D.bezierCurveTo(\n        control1[0],\n        control1[1],\n        control2[0],\n        control2[1],\n        second[0],\n        second[1]\n      );\n    }\n    return path2D;\n  }\n\n  static #toPDFCoordinates(points, rect, rotation) {\n    const [blX, blY, trX, trY] = rect;\n\n    switch (rotation) {\n      case 0:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] += blX;\n          points[i + 1] = trY - points[i + 1];\n        }\n        break;\n      case 90:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = points[i + 1] + blX;\n          points[i + 1] = x + blY;\n        }\n        break;\n      case 180:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] = trX - points[i];\n          points[i + 1] += blY;\n        }\n        break;\n      case 270:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = trX - points[i + 1];\n          points[i + 1] = trY - x;\n        }\n        break;\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n    return points;\n  }\n\n  static #fromPDFCoordinates(points, rect, rotation) {\n    const [blX, blY, trX, trY] = rect;\n\n    switch (rotation) {\n      case 0:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] -= blX;\n          points[i + 1] = trY - points[i + 1];\n        }\n        break;\n      case 90:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = points[i + 1] - blY;\n          points[i + 1] = x - blX;\n        }\n        break;\n      case 180:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] = trX - points[i];\n          points[i + 1] -= blY;\n        }\n        break;\n      case 270:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = trY - points[i + 1];\n          points[i + 1] = trX - x;\n        }\n        break;\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n    return points;\n  }\n\n  /**\n   * Transform and serialize the paths.\n   * @param {number} s - scale factor\n   * @param {number} tx - abscissa of the translation\n   * @param {number} ty - ordinate of the translation\n   * @param {Array<number>} rect - the bounding box of the annotation\n   */\n  #serializePaths(s, tx, ty, rect) {\n    const paths = [];\n    const padding = this.thickness / 2;\n    const shiftX = s * tx + padding;\n    const shiftY = s * ty + padding;\n    for (const bezier of this.paths) {\n      const buffer = [];\n      const points = [];\n      for (let j = 0, jj = bezier.length; j < jj; j++) {\n        const [first, control1, control2, second] = bezier[j];\n        const p10 = s * first[0] + shiftX;\n        const p11 = s * first[1] + shiftY;\n        const p20 = s * control1[0] + shiftX;\n        const p21 = s * control1[1] + shiftY;\n        const p30 = s * control2[0] + shiftX;\n        const p31 = s * control2[1] + shiftY;\n        const p40 = s * second[0] + shiftX;\n        const p41 = s * second[1] + shiftY;\n\n        if (j === 0) {\n          buffer.push(p10, p11);\n          points.push(p10, p11);\n        }\n        buffer.push(p20, p21, p30, p31, p40, p41);\n        points.push(p20, p21);\n        if (j === jj - 1) {\n          points.push(p40, p41);\n        }\n      }\n      paths.push({\n        bezier: InkEditor.#toPDFCoordinates(buffer, rect, this.rotation),\n        points: InkEditor.#toPDFCoordinates(points, rect, this.rotation),\n      });\n    }\n\n    return paths;\n  }\n\n  /**\n   * Get the bounding box containing all the paths.\n   * @returns {Array<number>}\n   */\n  #getBbox() {\n    let xMin = Infinity;\n    let xMax = -Infinity;\n    let yMin = Infinity;\n    let yMax = -Infinity;\n\n    for (const path of this.paths) {\n      for (const [first, control1, control2, second] of path) {\n        const bbox = Util.bezierBoundingBox(\n          ...first,\n          ...control1,\n          ...control2,\n          ...second\n        );\n        xMin = Math.min(xMin, bbox[0]);\n        yMin = Math.min(yMin, bbox[1]);\n        xMax = Math.max(xMax, bbox[2]);\n        yMax = Math.max(yMax, bbox[3]);\n      }\n    }\n\n    return [xMin, yMin, xMax, yMax];\n  }\n\n  /**\n   * The bounding box is computed with null thickness, so we must take\n   * it into account for the display.\n   * It corresponds to the total padding, hence it should be divided by 2\n   * in order to have left/right paddings.\n   * @returns {number}\n   */\n  #getPadding() {\n    return this.#disableEditing\n      ? Math.ceil(this.thickness * this.parentScale)\n      : 0;\n  }\n\n  /**\n   * Set the div position and dimensions in order to fit to\n   * the bounding box of the contents.\n   * @returns {undefined}\n   */\n  #fitToContent(firstTime = false) {\n    if (this.isEmpty()) {\n      return;\n    }\n\n    if (!this.#disableEditing) {\n      this.#redraw();\n      return;\n    }\n\n    const bbox = this.#getBbox();\n    const padding = this.#getPadding();\n    this.#baseWidth = Math.max(AnnotationEditor.MIN_SIZE, bbox[2] - bbox[0]);\n    this.#baseHeight = Math.max(AnnotationEditor.MIN_SIZE, bbox[3] - bbox[1]);\n\n    const width = Math.ceil(padding + this.#baseWidth * this.scaleFactor);\n    const height = Math.ceil(padding + this.#baseHeight * this.scaleFactor);\n\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.width = width / parentWidth;\n    this.height = height / parentHeight;\n\n    this.setAspectRatio(width, height);\n\n    const prevTranslationX = this.translationX;\n    const prevTranslationY = this.translationY;\n\n    this.translationX = -bbox[0];\n    this.translationY = -bbox[1];\n    this.#setCanvasDims();\n    this.#redraw();\n\n    this.#realWidth = width;\n    this.#realHeight = height;\n\n    this.setDims(width, height);\n    const unscaledPadding = firstTime ? padding / this.scaleFactor / 2 : 0;\n    this.translate(\n      prevTranslationX - this.translationX - unscaledPadding,\n      prevTranslationY - this.translationY - unscaledPadding\n    );\n  }\n\n  /** @inheritdoc */\n  static deserialize(data, parent, uiManager) {\n    if (data instanceof InkAnnotationElement) {\n      return null;\n    }\n    const editor = super.deserialize(data, parent, uiManager);\n\n    editor.thickness = data.thickness;\n    editor.color = Util.makeHexColor(...data.color);\n    editor.opacity = data.opacity;\n\n    const [pageWidth, pageHeight] = editor.pageDimensions;\n    const width = editor.width * pageWidth;\n    const height = editor.height * pageHeight;\n    const scaleFactor = editor.parentScale;\n    const padding = data.thickness / 2;\n\n    editor.#disableEditing = true;\n    editor.#realWidth = Math.round(width);\n    editor.#realHeight = Math.round(height);\n\n    const { paths, rect, rotation } = data;\n\n    for (let { bezier } of paths) {\n      bezier = InkEditor.#fromPDFCoordinates(bezier, rect, rotation);\n      const path = [];\n      editor.paths.push(path);\n      let p0 = scaleFactor * (bezier[0] - padding);\n      let p1 = scaleFactor * (bezier[1] - padding);\n      for (let i = 2, ii = bezier.length; i < ii; i += 6) {\n        const p10 = scaleFactor * (bezier[i] - padding);\n        const p11 = scaleFactor * (bezier[i + 1] - padding);\n        const p20 = scaleFactor * (bezier[i + 2] - padding);\n        const p21 = scaleFactor * (bezier[i + 3] - padding);\n        const p30 = scaleFactor * (bezier[i + 4] - padding);\n        const p31 = scaleFactor * (bezier[i + 5] - padding);\n        path.push([\n          [p0, p1],\n          [p10, p11],\n          [p20, p21],\n          [p30, p31],\n        ]);\n        p0 = p30;\n        p1 = p31;\n      }\n      const path2D = this.#buildPath2D(path);\n      editor.bezierPath2D.push(path2D);\n    }\n\n    const bbox = editor.#getBbox();\n    editor.#baseWidth = Math.max(AnnotationEditor.MIN_SIZE, bbox[2] - bbox[0]);\n    editor.#baseHeight = Math.max(AnnotationEditor.MIN_SIZE, bbox[3] - bbox[1]);\n    editor.#setScaleFactor(width, height);\n\n    return editor;\n  }\n\n  /** @inheritdoc */\n  serialize() {\n    if (this.isEmpty()) {\n      return null;\n    }\n\n    const rect = this.getRect(0, 0);\n    const color = AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);\n\n    return {\n      annotationType: AnnotationEditorType.INK,\n      color,\n      thickness: this.thickness,\n      opacity: this.opacity,\n      paths: this.#serializePaths(\n        this.scaleFactor / this.parentScale,\n        this.translationX,\n        this.translationY,\n        rect\n      ),\n      pageIndex: this.pageIndex,\n      rect,\n      rotation: this.rotation,\n      structTreeParentId: this._structTreeParentId,\n    };\n  }\n}\n\nexport { InkEditor };\n","/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AnnotationEditorType, shadow } from \"../../shared/util.js\";\nimport { AnnotationEditor } from \"./editor.js\";\nimport { PixelsPerInch } from \"../display_utils.js\";\nimport { StampAnnotationElement } from \"../annotation_layer.js\";\n\n/**\n * Basic text editor in order to create a FreeTex annotation.\n */\nclass StampEditor extends AnnotationEditor {\n  #bitmap = null;\n\n  #bitmapId = null;\n\n  #bitmapPromise = null;\n\n  #bitmapUrl = null;\n\n  #bitmapFile = null;\n\n  #bitmapFileName = \"\";\n\n  #canvas = null;\n\n  #observer = null;\n\n  #resizeTimeoutId = null;\n\n  #isSvg = false;\n\n  #hasBeenAddedInUndoStack = false;\n\n  static _type = \"stamp\";\n\n  static _editorType = AnnotationEditorType.STAMP;\n\n  constructor(params) {\n    super({ ...params, name: \"stampEditor\" });\n    this.#bitmapUrl = params.bitmapUrl;\n    this.#bitmapFile = params.bitmapFile;\n  }\n\n  /** @inheritdoc */\n  static initialize(l10n) {\n    AnnotationEditor.initialize(l10n);\n  }\n\n  static get supportedTypes() {\n    // See https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Image_types\n    // to know which types are supported by the browser.\n    const types = [\n      \"apng\",\n      \"avif\",\n      \"bmp\",\n      \"gif\",\n      \"jpeg\",\n      \"png\",\n      \"svg+xml\",\n      \"webp\",\n      \"x-icon\",\n    ];\n    return shadow(\n      this,\n      \"supportedTypes\",\n      types.map(type => `image/${type}`)\n    );\n  }\n\n  static get supportedTypesStr() {\n    return shadow(this, \"supportedTypesStr\", this.supportedTypes.join(\",\"));\n  }\n\n  /** @inheritdoc */\n  static isHandlingMimeForPasting(mime) {\n    return this.supportedTypes.includes(mime);\n  }\n\n  /** @inheritdoc */\n  static paste(item, parent) {\n    parent.pasteEditor(AnnotationEditorType.STAMP, {\n      bitmapFile: item.getAsFile(),\n    });\n  }\n\n  #getBitmapFetched(data, fromId = false) {\n    if (!data) {\n      this.remove();\n      return;\n    }\n    this.#bitmap = data.bitmap;\n    if (!fromId) {\n      this.#bitmapId = data.id;\n      this.#isSvg = data.isSvg;\n    }\n    if (data.file) {\n      this.#bitmapFileName = data.file.name;\n    }\n    this.#createCanvas();\n  }\n\n  #getBitmapDone() {\n    this.#bitmapPromise = null;\n    this._uiManager.enableWaiting(false);\n    if (this.#canvas) {\n      this.div.focus();\n    }\n  }\n\n  #getBitmap() {\n    if (this.#bitmapId) {\n      this._uiManager.enableWaiting(true);\n      this._uiManager.imageManager\n        .getFromId(this.#bitmapId)\n        .then(data => this.#getBitmapFetched(data, /* fromId = */ true))\n        .finally(() => this.#getBitmapDone());\n      return;\n    }\n\n    if (this.#bitmapUrl) {\n      const url = this.#bitmapUrl;\n      this.#bitmapUrl = null;\n      this._uiManager.enableWaiting(true);\n      this.#bitmapPromise = this._uiManager.imageManager\n        .getFromUrl(url)\n        .then(data => this.#getBitmapFetched(data))\n        .finally(() => this.#getBitmapDone());\n      return;\n    }\n\n    if (this.#bitmapFile) {\n      const file = this.#bitmapFile;\n      this.#bitmapFile = null;\n      this._uiManager.enableWaiting(true);\n      this.#bitmapPromise = this._uiManager.imageManager\n        .getFromFile(file)\n        .then(data => this.#getBitmapFetched(data))\n        .finally(() => this.#getBitmapDone());\n      return;\n    }\n\n    const input = document.createElement(\"input\");\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n      input.hidden = true;\n      input.id = \"stampEditorFileInput\";\n      document.body.append(input);\n    }\n    input.type = \"file\";\n    input.accept = StampEditor.supportedTypesStr;\n    this.#bitmapPromise = new Promise(resolve => {\n      input.addEventListener(\"change\", async () => {\n        if (!input.files || input.files.length === 0) {\n          this.remove();\n        } else {\n          this._uiManager.enableWaiting(true);\n          const data = await this._uiManager.imageManager.getFromFile(\n            input.files[0]\n          );\n          this.#getBitmapFetched(data);\n        }\n        if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n          input.remove();\n        }\n        resolve();\n      });\n      input.addEventListener(\"cancel\", () => {\n        this.remove();\n        resolve();\n      });\n    }).finally(() => this.#getBitmapDone());\n    if (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"TESTING\")) {\n      input.click();\n    }\n  }\n\n  /** @inheritdoc */\n  remove() {\n    if (this.#bitmapId) {\n      this.#bitmap = null;\n      this._uiManager.imageManager.deleteId(this.#bitmapId);\n      this.#canvas?.remove();\n      this.#canvas = null;\n      this.#observer?.disconnect();\n      this.#observer = null;\n      if (this.#resizeTimeoutId) {\n        clearTimeout(this.#resizeTimeoutId);\n        this.#resizeTimeoutId = null;\n      }\n    }\n    super.remove();\n  }\n\n  /** @inheritdoc */\n  rebuild() {\n    if (!this.parent) {\n      // It's possible to have to rebuild an editor which is not on a visible\n      // page.\n      if (this.#bitmapId) {\n        this.#getBitmap();\n      }\n      return;\n    }\n    super.rebuild();\n    if (this.div === null) {\n      return;\n    }\n\n    if (this.#bitmapId) {\n      this.#getBitmap();\n    }\n\n    if (!this.isAttachedToDOM) {\n      // At some point this editor was removed and we're rebuilting it,\n      // hence we must add it to its parent.\n      this.parent.add(this);\n    }\n  }\n\n  /** @inheritdoc */\n  onceAdded() {\n    this._isDraggable = true;\n    this.div.focus();\n  }\n\n  /** @inheritdoc */\n  isEmpty() {\n    return !(\n      this.#bitmapPromise ||\n      this.#bitmap ||\n      this.#bitmapUrl ||\n      this.#bitmapFile\n    );\n  }\n\n  /** @inheritdoc */\n  get isResizable() {\n    return true;\n  }\n\n  /** @inheritdoc */\n  render() {\n    if (this.div) {\n      return this.div;\n    }\n\n    let baseX, baseY;\n    if (this.width) {\n      baseX = this.x;\n      baseY = this.y;\n    }\n\n    super.render();\n    this.div.hidden = true;\n\n    if (this.#bitmap) {\n      this.#createCanvas();\n    } else {\n      this.#getBitmap();\n    }\n\n    if (this.width) {\n      // This editor was created in using copy (ctrl+c).\n      const [parentWidth, parentHeight] = this.parentDimensions;\n      this.setAt(\n        baseX * parentWidth,\n        baseY * parentHeight,\n        this.width * parentWidth,\n        this.height * parentHeight\n      );\n    }\n\n    return this.div;\n  }\n\n  #createCanvas() {\n    const { div } = this;\n    let { width, height } = this.#bitmap;\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    const MAX_RATIO = 0.75;\n    if (this.width) {\n      width = this.width * pageWidth;\n      height = this.height * pageHeight;\n    } else if (\n      width > MAX_RATIO * pageWidth ||\n      height > MAX_RATIO * pageHeight\n    ) {\n      // If the the image is too big compared to the page dimensions\n      // (more than MAX_RATIO) then we scale it down.\n      const factor = Math.min(\n        (MAX_RATIO * pageWidth) / width,\n        (MAX_RATIO * pageHeight) / height\n      );\n      width *= factor;\n      height *= factor;\n    }\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.setDims(\n      (width * parentWidth) / pageWidth,\n      (height * parentHeight) / pageHeight\n    );\n\n    this._uiManager.enableWaiting(false);\n    const canvas = (this.#canvas = document.createElement(\"canvas\"));\n    div.append(canvas);\n    div.hidden = false;\n    this.#drawBitmap(width, height);\n    this.#createObserver();\n    if (!this.#hasBeenAddedInUndoStack) {\n      this.parent.addUndoableEditor(this);\n      this.#hasBeenAddedInUndoStack = true;\n    }\n\n    // There are multiple ways to add an image to the page, so here we just\n    // count the number of times an image is added to the page whatever the way\n    // is.\n    this._uiManager._eventBus.dispatch(\"reporttelemetry\", {\n      source: this,\n      details: {\n        type: \"editing\",\n        subtype: this.editorType,\n        data: {\n          action: \"inserted_image\",\n        },\n      },\n    });\n    this.addAltTextButton();\n    if (this.#bitmapFileName) {\n      canvas.setAttribute(\"aria-label\", this.#bitmapFileName);\n    }\n  }\n\n  /**\n   * When the dimensions of the div change the inner canvas must\n   * renew its dimensions, hence it must redraw its own contents.\n   * @param {number} width - the new width of the div\n   * @param {number} height - the new height of the div\n   * @returns\n   */\n  #setDimensions(width, height) {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.width = width / parentWidth;\n    this.height = height / parentHeight;\n    this.setDims(width, height);\n    if (this._initialOptions?.isCentered) {\n      this.center();\n    } else {\n      this.fixAndSetPosition();\n    }\n    this._initialOptions = null;\n    if (this.#resizeTimeoutId !== null) {\n      clearTimeout(this.#resizeTimeoutId);\n    }\n    // When the user is resizing the editor we just use CSS to scale the image\n    // to avoid redrawing it too often.\n    // And once the user stops resizing the editor we redraw the image in\n    // rescaling it correctly (see this.#scaleBitmap).\n    const TIME_TO_WAIT = 200;\n    this.#resizeTimeoutId = setTimeout(() => {\n      this.#resizeTimeoutId = null;\n      this.#drawBitmap(width, height);\n    }, TIME_TO_WAIT);\n  }\n\n  #scaleBitmap(width, height) {\n    const { width: bitmapWidth, height: bitmapHeight } = this.#bitmap;\n\n    let newWidth = bitmapWidth;\n    let newHeight = bitmapHeight;\n    let bitmap = this.#bitmap;\n    while (newWidth > 2 * width || newHeight > 2 * height) {\n      const prevWidth = newWidth;\n      const prevHeight = newHeight;\n\n      if (newWidth > 2 * width) {\n        // See bug 1820511 (Windows specific bug).\n        // TODO: once the above bug is fixed we could revert to:\n        // newWidth = Math.ceil(newWidth / 2);\n        newWidth =\n          newWidth >= 16384\n            ? Math.floor(newWidth / 2) - 1\n            : Math.ceil(newWidth / 2);\n      }\n      if (newHeight > 2 * height) {\n        newHeight =\n          newHeight >= 16384\n            ? Math.floor(newHeight / 2) - 1\n            : Math.ceil(newHeight / 2);\n      }\n\n      const offscreen = new OffscreenCanvas(newWidth, newHeight);\n      const ctx = offscreen.getContext(\"2d\");\n      ctx.drawImage(\n        bitmap,\n        0,\n        0,\n        prevWidth,\n        prevHeight,\n        0,\n        0,\n        newWidth,\n        newHeight\n      );\n      bitmap = offscreen.transferToImageBitmap();\n    }\n\n    return bitmap;\n  }\n\n  #drawBitmap(width, height) {\n    width = Math.ceil(width);\n    height = Math.ceil(height);\n    const canvas = this.#canvas;\n    if (!canvas || (canvas.width === width && canvas.height === height)) {\n      return;\n    }\n    canvas.width = width;\n    canvas.height = height;\n    const bitmap = this.#isSvg\n      ? this.#bitmap\n      : this.#scaleBitmap(width, height);\n    const ctx = canvas.getContext(\"2d\");\n    ctx.filter = this._uiManager.hcmFilter;\n    ctx.drawImage(\n      bitmap,\n      0,\n      0,\n      bitmap.width,\n      bitmap.height,\n      0,\n      0,\n      width,\n      height\n    );\n  }\n\n  /** @inheritdoc */\n  getImageForAltText() {\n    return this.#canvas;\n  }\n\n  #serializeBitmap(toUrl) {\n    if (toUrl) {\n      if (this.#isSvg) {\n        const url = this._uiManager.imageManager.getSvgUrl(this.#bitmapId);\n        if (url) {\n          return url;\n        }\n      }\n      // We convert to a data url because it's sync and the url can live in the\n      // clipboard.\n      const canvas = document.createElement(\"canvas\");\n      ({ width: canvas.width, height: canvas.height } = this.#bitmap);\n      const ctx = canvas.getContext(\"2d\");\n      ctx.drawImage(this.#bitmap, 0, 0);\n\n      return canvas.toDataURL();\n    }\n\n    if (this.#isSvg) {\n      const [pageWidth, pageHeight] = this.pageDimensions;\n      // Multiply by PixelsPerInch.PDF_TO_CSS_UNITS in order to increase the\n      // image resolution when rasterizing it.\n      const width = Math.round(\n        this.width * pageWidth * PixelsPerInch.PDF_TO_CSS_UNITS\n      );\n      const height = Math.round(\n        this.height * pageHeight * PixelsPerInch.PDF_TO_CSS_UNITS\n      );\n      const offscreen = new OffscreenCanvas(width, height);\n      const ctx = offscreen.getContext(\"2d\");\n      ctx.drawImage(\n        this.#bitmap,\n        0,\n        0,\n        this.#bitmap.width,\n        this.#bitmap.height,\n        0,\n        0,\n        width,\n        height\n      );\n      return offscreen.transferToImageBitmap();\n    }\n\n    return structuredClone(this.#bitmap);\n  }\n\n  /**\n   * Create the resize observer.\n   */\n  #createObserver() {\n    this.#observer = new ResizeObserver(entries => {\n      const rect = entries[0].contentRect;\n      if (rect.width && rect.height) {\n        this.#setDimensions(rect.width, rect.height);\n      }\n    });\n    this.#observer.observe(this.div);\n  }\n\n  /** @inheritdoc */\n  static deserialize(data, parent, uiManager) {\n    if (data instanceof StampAnnotationElement) {\n      return null;\n    }\n    const editor = super.deserialize(data, parent, uiManager);\n    const { rect, bitmapUrl, bitmapId, isSvg, accessibilityData } = data;\n    if (bitmapId && uiManager.imageManager.isValidId(bitmapId)) {\n      editor.#bitmapId = bitmapId;\n    } else {\n      editor.#bitmapUrl = bitmapUrl;\n    }\n    editor.#isSvg = isSvg;\n\n    const [parentWidth, parentHeight] = editor.pageDimensions;\n    editor.width = (rect[2] - rect[0]) / parentWidth;\n    editor.height = (rect[3] - rect[1]) / parentHeight;\n\n    if (accessibilityData) {\n      editor.altTextData = accessibilityData;\n    }\n\n    return editor;\n  }\n\n  /** @inheritdoc */\n  serialize(isForCopying = false, context = null) {\n    if (this.isEmpty()) {\n      return null;\n    }\n\n    const serialized = {\n      annotationType: AnnotationEditorType.STAMP,\n      bitmapId: this.#bitmapId,\n      pageIndex: this.pageIndex,\n      rect: this.getRect(0, 0),\n      rotation: this.rotation,\n      isSvg: this.#isSvg,\n      structTreeParentId: this._structTreeParentId,\n    };\n\n    if (isForCopying) {\n      // We don't know what's the final destination (this pdf or another one)\n      // of this annotation and the clipboard doesn't support ImageBitmaps,\n      // hence we serialize the bitmap to a data url.\n      serialized.bitmapUrl = this.#serializeBitmap(/* toUrl = */ true);\n      serialized.accessibilityData = this.altTextData;\n      return serialized;\n    }\n\n    const { decorative, altText } = this.altTextData;\n    if (!decorative && altText) {\n      serialized.accessibilityData = { type: \"Figure\", alt: altText };\n    }\n\n    if (context === null) {\n      return serialized;\n    }\n\n    context.stamps ||= new Map();\n    const area = this.#isSvg\n      ? (serialized.rect[2] - serialized.rect[0]) *\n        (serialized.rect[3] - serialized.rect[1])\n      : null;\n    if (!context.stamps.has(this.#bitmapId)) {\n      // We don't want to have multiple copies of the same bitmap in the\n      // annotationMap, hence we only add the bitmap the first time we meet it.\n      context.stamps.set(this.#bitmapId, { area, serialized });\n      serialized.bitmap = this.#serializeBitmap(/* toUrl = */ false);\n    } else if (this.#isSvg) {\n      // If we have multiple copies of the same svg but with different sizes,\n      // then we want to keep the biggest one.\n      const prevData = context.stamps.get(this.#bitmapId);\n      if (area > prevData.area) {\n        prevData.area = area;\n        prevData.serialized.bitmap.close();\n        prevData.serialized.bitmap = this.#serializeBitmap(/* toUrl = */ false);\n      }\n    }\n    return serialized;\n  }\n}\n\nexport { StampEditor };\n","/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./tools.js\").AnnotationEditorUIManager} AnnotationEditorUIManager */\n/** @typedef {import(\"../display_utils.js\").PageViewport} PageViewport */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../../../web/text_accessibility.js\").TextAccessibilityManager} TextAccessibilityManager */\n/** @typedef {import(\"../../../web/interfaces\").IL10n} IL10n */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../annotation_layer.js\").AnnotationLayer} AnnotationLayer */\n\nimport { AnnotationEditorType, FeatureTest } from \"../../shared/util.js\";\nimport { AnnotationEditor } from \"./editor.js\";\nimport { FreeTextEditor } from \"./freetext.js\";\nimport { InkEditor } from \"./ink.js\";\nimport { setLayerDimensions } from \"../display_utils.js\";\nimport { StampEditor } from \"./stamp.js\";\n\n/**\n * @typedef {Object} AnnotationEditorLayerOptions\n * @property {Object} mode\n * @property {HTMLDivElement} div\n * @property {AnnotationEditorUIManager} uiManager\n * @property {boolean} enabled\n * @property {TextAccessibilityManager} [accessibilityManager]\n * @property {number} pageIndex\n * @property {IL10n} l10n\n * @property {AnnotationLayer} [annotationLayer]\n * @property {PageViewport} viewport\n */\n\n/**\n * @typedef {Object} RenderEditorLayerOptions\n * @property {PageViewport} viewport\n */\n\n/**\n * Manage all the different editors on a page.\n */\nclass AnnotationEditorLayer {\n  #accessibilityManager;\n\n  #allowClick = false;\n\n  #annotationLayer = null;\n\n  #boundPointerup = this.pointerup.bind(this);\n\n  #boundPointerdown = this.pointerdown.bind(this);\n\n  #editorFocusTimeoutId = null;\n\n  #editors = new Map();\n\n  #hadPointerDown = false;\n\n  #isCleaningUp = false;\n\n  #isDisabling = false;\n\n  #uiManager;\n\n  static _initialized = false;\n\n  static #editorTypes = new Map(\n    [FreeTextEditor, InkEditor, StampEditor].map(type => [\n      type._editorType,\n      type,\n    ])\n  );\n\n  /**\n   * @param {AnnotationEditorLayerOptions} options\n   */\n  constructor({\n    uiManager,\n    pageIndex,\n    div,\n    accessibilityManager,\n    annotationLayer,\n    viewport,\n    l10n,\n  }) {\n    const editorTypes = [...AnnotationEditorLayer.#editorTypes.values()];\n    if (!AnnotationEditorLayer._initialized) {\n      AnnotationEditorLayer._initialized = true;\n      for (const editorType of editorTypes) {\n        editorType.initialize(l10n);\n      }\n    }\n    uiManager.registerEditorTypes(editorTypes);\n\n    this.#uiManager = uiManager;\n    this.pageIndex = pageIndex;\n    this.div = div;\n    this.#accessibilityManager = accessibilityManager;\n    this.#annotationLayer = annotationLayer;\n    this.viewport = viewport;\n\n    this.#uiManager.addLayer(this);\n  }\n\n  get isEmpty() {\n    return this.#editors.size === 0;\n  }\n\n  /**\n   * Update the toolbar if it's required to reflect the tool currently used.\n   * @param {number} mode\n   */\n  updateToolbar(mode) {\n    this.#uiManager.updateToolbar(mode);\n  }\n\n  /**\n   * The mode has changed: it must be updated.\n   * @param {number} mode\n   */\n  updateMode(mode = this.#uiManager.getMode()) {\n    this.#cleanup();\n    if (mode === AnnotationEditorType.INK) {\n      // We always want to an ink editor ready to draw in.\n      this.addInkEditorIfNeeded(false);\n      this.disableClick();\n    } else {\n      this.enableClick();\n    }\n\n    if (mode !== AnnotationEditorType.NONE) {\n      const { classList } = this.div;\n      for (const editorType of AnnotationEditorLayer.#editorTypes.values()) {\n        classList.toggle(\n          `${editorType._type}Editing`,\n          mode === editorType._editorType\n        );\n      }\n      this.div.hidden = false;\n    }\n  }\n\n  addInkEditorIfNeeded(isCommitting) {\n    if (\n      !isCommitting &&\n      this.#uiManager.getMode() !== AnnotationEditorType.INK\n    ) {\n      return;\n    }\n\n    if (!isCommitting) {\n      // We're removing an editor but an empty one can already exist so in this\n      // case we don't need to create a new one.\n      for (const editor of this.#editors.values()) {\n        if (editor.isEmpty()) {\n          editor.setInBackground();\n          return;\n        }\n      }\n    }\n\n    const editor = this.#createAndAddNewEditor(\n      { offsetX: 0, offsetY: 0 },\n      /* isCentered = */ false\n    );\n    editor.setInBackground();\n  }\n\n  /**\n   * Set the editing state.\n   * @param {boolean} isEditing\n   */\n  setEditingState(isEditing) {\n    this.#uiManager.setEditingState(isEditing);\n  }\n\n  /**\n   * Add some commands into the CommandManager (undo/redo stuff).\n   * @param {Object} params\n   */\n  addCommands(params) {\n    this.#uiManager.addCommands(params);\n  }\n\n  togglePointerEvents(enabled = false) {\n    this.div.classList.toggle(\"disabled\", !enabled);\n  }\n\n  /**\n   * Enable pointer events on the main div in order to enable\n   * editor creation.\n   */\n  enable() {\n    this.togglePointerEvents(true);\n    const annotationElementIds = new Set();\n    for (const editor of this.#editors.values()) {\n      editor.enableEditing();\n      if (editor.annotationElementId) {\n        annotationElementIds.add(editor.annotationElementId);\n      }\n    }\n\n    if (!this.#annotationLayer) {\n      return;\n    }\n\n    const editables = this.#annotationLayer.getEditableAnnotations();\n    for (const editable of editables) {\n      // The element must be hidden whatever its state is.\n      editable.hide();\n      if (this.#uiManager.isDeletedAnnotationElement(editable.data.id)) {\n        continue;\n      }\n      if (annotationElementIds.has(editable.data.id)) {\n        continue;\n      }\n      const editor = this.deserialize(editable);\n      if (!editor) {\n        continue;\n      }\n      this.addOrRebuild(editor);\n      editor.enableEditing();\n    }\n  }\n\n  /**\n   * Disable editor creation.\n   */\n  disable() {\n    this.#isDisabling = true;\n    this.togglePointerEvents(false);\n    const hiddenAnnotationIds = new Set();\n    for (const editor of this.#editors.values()) {\n      editor.disableEditing();\n      if (!editor.annotationElementId || editor.serialize() !== null) {\n        hiddenAnnotationIds.add(editor.annotationElementId);\n        continue;\n      }\n      this.getEditableAnnotation(editor.annotationElementId)?.show();\n      editor.remove();\n    }\n\n    if (this.#annotationLayer) {\n      // Show the annotations that were hidden in enable().\n      const editables = this.#annotationLayer.getEditableAnnotations();\n      for (const editable of editables) {\n        const { id } = editable.data;\n        if (\n          hiddenAnnotationIds.has(id) ||\n          this.#uiManager.isDeletedAnnotationElement(id)\n        ) {\n          continue;\n        }\n        editable.show();\n      }\n    }\n\n    this.#cleanup();\n    if (this.isEmpty) {\n      this.div.hidden = true;\n    }\n    const { classList } = this.div;\n    for (const editorType of AnnotationEditorLayer.#editorTypes.values()) {\n      classList.remove(`${editorType._type}Editing`);\n    }\n\n    this.#isDisabling = false;\n  }\n\n  getEditableAnnotation(id) {\n    return this.#annotationLayer?.getEditableAnnotation(id) || null;\n  }\n\n  /**\n   * Set the current editor.\n   * @param {AnnotationEditor} editor\n   */\n  setActiveEditor(editor) {\n    const currentActive = this.#uiManager.getActive();\n    if (currentActive === editor) {\n      return;\n    }\n\n    this.#uiManager.setActiveEditor(editor);\n  }\n\n  enableClick() {\n    this.div.addEventListener(\"pointerdown\", this.#boundPointerdown);\n    this.div.addEventListener(\"pointerup\", this.#boundPointerup);\n  }\n\n  disableClick() {\n    this.div.removeEventListener(\"pointerdown\", this.#boundPointerdown);\n    this.div.removeEventListener(\"pointerup\", this.#boundPointerup);\n  }\n\n  attach(editor) {\n    this.#editors.set(editor.id, editor);\n    const { annotationElementId } = editor;\n    if (\n      annotationElementId &&\n      this.#uiManager.isDeletedAnnotationElement(annotationElementId)\n    ) {\n      this.#uiManager.removeDeletedAnnotationElement(editor);\n    }\n  }\n\n  detach(editor) {\n    this.#editors.delete(editor.id);\n    this.#accessibilityManager?.removePointerInTextLayer(editor.contentDiv);\n\n    if (!this.#isDisabling && editor.annotationElementId) {\n      this.#uiManager.addDeletedAnnotationElement(editor);\n    }\n  }\n\n  /**\n   * Remove an editor.\n   * @param {AnnotationEditor} editor\n   */\n  remove(editor) {\n    // Since we can undo a removal we need to keep the\n    // parent property as it is, so don't null it!\n\n    this.detach(editor);\n    this.#uiManager.removeEditor(editor);\n    editor.div.remove();\n    editor.isAttachedToDOM = false;\n\n    if (!this.#isCleaningUp) {\n      this.addInkEditorIfNeeded(/* isCommitting = */ false);\n    }\n  }\n\n  /**\n   * An editor can have a different parent, for example after having\n   * being dragged and droped from a page to another.\n   * @param {AnnotationEditor} editor\n   */\n  changeParent(editor) {\n    if (editor.parent === this) {\n      return;\n    }\n\n    if (editor.annotationElementId) {\n      this.#uiManager.addDeletedAnnotationElement(editor.annotationElementId);\n      AnnotationEditor.deleteAnnotationElement(editor);\n      editor.annotationElementId = null;\n    }\n\n    this.attach(editor);\n    editor.parent?.detach(editor);\n    editor.setParent(this);\n    if (editor.div && editor.isAttachedToDOM) {\n      editor.div.remove();\n      this.div.append(editor.div);\n    }\n  }\n\n  /**\n   * Add a new editor in the current view.\n   * @param {AnnotationEditor} editor\n   */\n  add(editor) {\n    this.changeParent(editor);\n    this.#uiManager.addEditor(editor);\n    this.attach(editor);\n\n    if (!editor.isAttachedToDOM) {\n      const div = editor.render();\n      this.div.append(div);\n      editor.isAttachedToDOM = true;\n    }\n\n    // The editor will be correctly moved into the DOM (see fixAndSetPosition).\n    editor.fixAndSetPosition();\n    editor.onceAdded();\n    this.#uiManager.addToAnnotationStorage(editor);\n  }\n\n  moveEditorInDOM(editor) {\n    if (!editor.isAttachedToDOM) {\n      return;\n    }\n\n    const { activeElement } = document;\n    if (editor.div.contains(activeElement) && !this.#editorFocusTimeoutId) {\n      // When the div is moved in the DOM the focus can move somewhere else,\n      // so we want to be sure that the focus will stay on the editor but we\n      // don't want to call any focus callbacks, hence we disable them and only\n      // re-enable them when the editor has the focus.\n      editor._focusEventsAllowed = false;\n      this.#editorFocusTimeoutId = setTimeout(() => {\n        this.#editorFocusTimeoutId = null;\n        if (!editor.div.contains(document.activeElement)) {\n          editor.div.addEventListener(\n            \"focusin\",\n            () => {\n              editor._focusEventsAllowed = true;\n            },\n            { once: true }\n          );\n          activeElement.focus();\n        } else {\n          editor._focusEventsAllowed = true;\n        }\n      }, 0);\n    }\n\n    editor._structTreeParentId = this.#accessibilityManager?.moveElementInDOM(\n      this.div,\n      editor.div,\n      editor.contentDiv,\n      /* isRemovable = */ true\n    );\n  }\n\n  /**\n   * Add or rebuild depending if it has been removed or not.\n   * @param {AnnotationEditor} editor\n   */\n  addOrRebuild(editor) {\n    if (editor.needsToBeRebuilt()) {\n      editor.parent ||= this;\n      editor.rebuild();\n    } else {\n      this.add(editor);\n    }\n  }\n\n  /**\n   * Add a new editor and make this addition undoable.\n   * @param {AnnotationEditor} editor\n   */\n  addUndoableEditor(editor) {\n    const cmd = () => editor._uiManager.rebuild(editor);\n    const undo = () => {\n      editor.remove();\n    };\n\n    this.addCommands({ cmd, undo, mustExec: false });\n  }\n\n  /**\n   * Get an id for an editor.\n   * @returns {string}\n   */\n  getNextId() {\n    return this.#uiManager.getId();\n  }\n\n  /**\n   * Create a new editor\n   * @param {Object} params\n   * @returns {AnnotationEditor}\n   */\n  #createNewEditor(params) {\n    const editorType = AnnotationEditorLayer.#editorTypes.get(\n      this.#uiManager.getMode()\n    );\n    return editorType ? new editorType.prototype.constructor(params) : null;\n  }\n\n  /**\n   * Paste some content into a new editor.\n   * @param {number} mode\n   * @param {Object} params\n   */\n  pasteEditor(mode, params) {\n    this.#uiManager.updateToolbar(mode);\n    this.#uiManager.updateMode(mode);\n\n    const { offsetX, offsetY } = this.#getCenterPoint();\n    const id = this.getNextId();\n    const editor = this.#createNewEditor({\n      parent: this,\n      id,\n      x: offsetX,\n      y: offsetY,\n      uiManager: this.#uiManager,\n      isCentered: true,\n      ...params,\n    });\n    if (editor) {\n      this.add(editor);\n    }\n  }\n\n  /**\n   * Create a new editor\n   * @param {Object} data\n   * @returns {AnnotationEditor | null}\n   */\n  deserialize(data) {\n    return (\n      AnnotationEditorLayer.#editorTypes\n        .get(data.annotationType ?? data.annotationEditorType)\n        ?.deserialize(data, this, this.#uiManager) || null\n    );\n  }\n\n  /**\n   * Create and add a new editor.\n   * @param {PointerEvent} event\n   * @param {boolean} isCentered\n   * @returns {AnnotationEditor}\n   */\n  #createAndAddNewEditor(event, isCentered) {\n    const id = this.getNextId();\n    const editor = this.#createNewEditor({\n      parent: this,\n      id,\n      x: event.offsetX,\n      y: event.offsetY,\n      uiManager: this.#uiManager,\n      isCentered,\n    });\n    if (editor) {\n      this.add(editor);\n    }\n\n    return editor;\n  }\n\n  #getCenterPoint() {\n    const { x, y, width, height } = this.div.getBoundingClientRect();\n    const tlX = Math.max(0, x);\n    const tlY = Math.max(0, y);\n    const brX = Math.min(window.innerWidth, x + width);\n    const brY = Math.min(window.innerHeight, y + height);\n    const centerX = (tlX + brX) / 2 - x;\n    const centerY = (tlY + brY) / 2 - y;\n    const [offsetX, offsetY] =\n      this.viewport.rotation % 180 === 0\n        ? [centerX, centerY]\n        : [centerY, centerX];\n\n    return { offsetX, offsetY };\n  }\n\n  /**\n   * Create and add a new editor.\n   */\n  addNewEditor() {\n    this.#createAndAddNewEditor(\n      this.#getCenterPoint(),\n      /* isCentered = */ true\n    );\n  }\n\n  /**\n   * Set the last selected editor.\n   * @param {AnnotationEditor} editor\n   */\n  setSelected(editor) {\n    this.#uiManager.setSelected(editor);\n  }\n\n  /**\n   * Add or remove an editor the current selection.\n   * @param {AnnotationEditor} editor\n   */\n  toggleSelected(editor) {\n    this.#uiManager.toggleSelected(editor);\n  }\n\n  /**\n   * Check if the editor is selected.\n   * @param {AnnotationEditor} editor\n   */\n  isSelected(editor) {\n    return this.#uiManager.isSelected(editor);\n  }\n\n  /**\n   * Unselect an editor.\n   * @param {AnnotationEditor} editor\n   */\n  unselect(editor) {\n    this.#uiManager.unselect(editor);\n  }\n\n  /**\n   * Pointerup callback.\n   * @param {PointerEvent} event\n   */\n  pointerup(event) {\n    const { isMac } = FeatureTest.platform;\n    if (event.button !== 0 || (event.ctrlKey && isMac)) {\n      // Don't create an editor on right click.\n      return;\n    }\n\n    if (event.target !== this.div) {\n      return;\n    }\n\n    if (!this.#hadPointerDown) {\n      // It can happen when the user starts a drag inside a text editor\n      // and then releases the mouse button outside of it. In such a case\n      // we don't want to create a new editor, hence we check that a pointerdown\n      // occurred on this div previously.\n      return;\n    }\n    this.#hadPointerDown = false;\n\n    if (!this.#allowClick) {\n      this.#allowClick = true;\n      return;\n    }\n\n    if (this.#uiManager.getMode() === AnnotationEditorType.STAMP) {\n      this.#uiManager.unselectAll();\n      return;\n    }\n\n    this.#createAndAddNewEditor(event, /* isCentered = */ false);\n  }\n\n  /**\n   * Pointerdown callback.\n   * @param {PointerEvent} event\n   */\n  pointerdown(event) {\n    if (this.#hadPointerDown) {\n      // It's possible to have a second pointerdown event before a pointerup one\n      // when the user puts a finger on a touchscreen and then add a second one\n      // to start a pinch-to-zoom gesture.\n      // That said, in case it's possible to have two pointerdown events with\n      // a mouse, we don't want to create a new editor in such a case either.\n      this.#hadPointerDown = false;\n      return;\n    }\n    const { isMac } = FeatureTest.platform;\n    if (event.button !== 0 || (event.ctrlKey && isMac)) {\n      // Do nothing on right click.\n      return;\n    }\n\n    if (event.target !== this.div) {\n      return;\n    }\n\n    this.#hadPointerDown = true;\n\n    const editor = this.#uiManager.getActive();\n    this.#allowClick = !editor || editor.isEmpty();\n  }\n\n  /**\n   *\n   * @param {AnnotationEditor} editor\n   * @param {number} x\n   * @param {number} y\n   * @returns\n   */\n  findNewParent(editor, x, y) {\n    const layer = this.#uiManager.findParent(x, y);\n    if (layer === null || layer === this) {\n      return false;\n    }\n    layer.changeParent(editor);\n    return true;\n  }\n\n  /**\n   * Destroy the main editor.\n   */\n  destroy() {\n    if (this.#uiManager.getActive()?.parent === this) {\n      // We need to commit the current editor before destroying the layer.\n      this.#uiManager.commitOrRemove();\n      this.#uiManager.setActiveEditor(null);\n    }\n\n    if (this.#editorFocusTimeoutId) {\n      clearTimeout(this.#editorFocusTimeoutId);\n      this.#editorFocusTimeoutId = null;\n    }\n\n    for (const editor of this.#editors.values()) {\n      this.#accessibilityManager?.removePointerInTextLayer(editor.contentDiv);\n      editor.setParent(null);\n      editor.isAttachedToDOM = false;\n      editor.div.remove();\n    }\n    this.div = null;\n    this.#editors.clear();\n    this.#uiManager.removeLayer(this);\n  }\n\n  #cleanup() {\n    // When we're cleaning up, some editors are removed but we don't want\n    // to add a new one which will induce an addition in this.#editors, hence\n    // an infinite loop.\n    this.#isCleaningUp = true;\n    for (const editor of this.#editors.values()) {\n      if (editor.isEmpty()) {\n        editor.remove();\n      }\n    }\n    this.#isCleaningUp = false;\n  }\n\n  /**\n   * Render the main editor.\n   * @param {RenderEditorLayerOptions} parameters\n   */\n  render({ viewport }) {\n    this.viewport = viewport;\n    setLayerDimensions(this.div, viewport);\n    for (const editor of this.#uiManager.getEditors(this.pageIndex)) {\n      this.add(editor);\n    }\n    this.updateMode();\n  }\n\n  /**\n   * Update the main editor.\n   * @param {RenderEditorLayerOptions} parameters\n   */\n  update({ viewport }) {\n    // Editors have their dimensions/positions in percent so to avoid any\n    // issues (see #15582), we must commit the current one before changing\n    // the viewport.\n    this.#uiManager.commitOrRemove();\n\n    this.viewport = viewport;\n    setLayerDimensions(this.div, { rotation: viewport.rotation });\n    this.updateMode();\n  }\n\n  /**\n   * Get page dimensions.\n   * @returns {Object} dimensions.\n   */\n  get pageDimensions() {\n    const { pageWidth, pageHeight } = this.viewport.rawDims;\n    return [pageWidth, pageHeight];\n  }\n}\n\nexport { AnnotationEditorLayer };\n","/* Copyright 2023 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { noContextMenu } from \"../display_utils.js\";\n\nclass EditorToolbar {\n  #toolbar = null;\n\n  #editor;\n\n  #buttons = null;\n\n  constructor(editor) {\n    this.#editor = editor;\n  }\n\n  render() {\n    const editToolbar = (this.#toolbar = document.createElement(\"div\"));\n    editToolbar.className = \"editToolbar\";\n    editToolbar.addEventListener(\"contextmenu\", noContextMenu);\n    editToolbar.addEventListener(\"pointerdown\", EditorToolbar.#pointerDown);\n\n    const buttons = (this.#buttons = document.createElement(\"div\"));\n    buttons.className = \"buttons\";\n    editToolbar.append(buttons);\n\n    this.#addDeleteButton();\n\n    return editToolbar;\n  }\n\n  static #pointerDown(e) {\n    e.stopPropagation();\n  }\n\n  #focusIn(e) {\n    this.#editor._focusEventsAllowed = false;\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  #focusOut(e) {\n    this.#editor._focusEventsAllowed = true;\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  #addListenersToElement(element) {\n    // If we're clicking on a button with the keyboard or with\n    // the mouse, we don't want to trigger any focus events on\n    // the editor.\n    element.addEventListener(\"focusin\", this.#focusIn.bind(this), {\n      capture: true,\n    });\n    element.addEventListener(\"focusout\", this.#focusOut.bind(this), {\n      capture: true,\n    });\n    element.addEventListener(\"contextmenu\", noContextMenu);\n  }\n\n  hide() {\n    this.#toolbar.classList.add(\"hidden\");\n  }\n\n  show() {\n    this.#toolbar.classList.remove(\"hidden\");\n  }\n\n  #addDeleteButton() {\n    const button = document.createElement(\"button\");\n    button.className = \"delete\";\n    button.tabIndex = 0;\n    button.setAttribute(\"data-l10n-id\", \"pdfjs-editor-remove-button\");\n    this.#addListenersToElement(button);\n    button.addEventListener(\"click\", e => {\n      this.#editor._uiManager.delete();\n    });\n    this.#buttons.append(button);\n  }\n\n  remove() {\n    this.#toolbar.remove();\n  }\n}\n\nexport { EditorToolbar };\n","/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./annotation_editor_layer.js\").AnnotationEditorLayer} AnnotationEditorLayer */\n\nimport {\n  AnnotationEditorUIManager,\n  bindEvents,\n  ColorManager,\n  KeyboardManager,\n} from \"./tools.js\";\nimport { FeatureTest, shadow, unreachable } from \"../../shared/util.js\";\nimport { EditorToolbar } from \"./toolbar.js\";\nimport { noContextMenu } from \"../display_utils.js\";\n\n/**\n * @typedef {Object} AnnotationEditorParameters\n * @property {AnnotationEditorUIManager} uiManager - the global manager\n * @property {AnnotationEditorLayer} parent - the layer containing this editor\n * @property {string} id - editor id\n * @property {number} x - x-coordinate\n * @property {number} y - y-coordinate\n */\n\n/**\n * Base class for editors.\n */\nclass AnnotationEditor {\n  #allResizerDivs = null;\n\n  #altText = \"\";\n\n  #altTextDecorative = false;\n\n  #altTextButton = null;\n\n  #altTextTooltip = null;\n\n  #altTextTooltipTimeout = null;\n\n  #altTextWasFromKeyBoard = false;\n\n  #keepAspectRatio = false;\n\n  #resizersDiv = null;\n\n  #savedDimensions = null;\n\n  #boundFocusin = this.focusin.bind(this);\n\n  #boundFocusout = this.focusout.bind(this);\n\n  #editToolbar = null;\n\n  #focusedResizerName = \"\";\n\n  #hasBeenClicked = false;\n\n  #isEditing = false;\n\n  #isInEditMode = false;\n\n  #isResizerEnabledForKeyboard = false;\n\n  #moveInDOMTimeout = null;\n\n  _initialOptions = Object.create(null);\n\n  _uiManager = null;\n\n  _focusEventsAllowed = true;\n\n  _l10nPromise = null;\n\n  #isDraggable = false;\n\n  #zIndex = AnnotationEditor._zIndex++;\n\n  static _borderLineWidth = -1;\n\n  static _colorManager = new ColorManager();\n\n  static _zIndex = 1;\n\n  // When one of the dimensions of an editor is smaller than this value, the\n  // button to edit the alt text is visually moved outside of the editor.\n  static SMALL_EDITOR_SIZE = 0;\n\n  static get _resizerKeyboardManager() {\n    const resize = AnnotationEditor.prototype._resizeWithKeyboard;\n    const small = AnnotationEditorUIManager.TRANSLATE_SMALL;\n    const big = AnnotationEditorUIManager.TRANSLATE_BIG;\n\n    return shadow(\n      this,\n      \"_resizerKeyboardManager\",\n      new KeyboardManager([\n        [[\"ArrowLeft\", \"mac+ArrowLeft\"], resize, { args: [-small, 0] }],\n        [\n          [\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"],\n          resize,\n          { args: [-big, 0] },\n        ],\n        [[\"ArrowRight\", \"mac+ArrowRight\"], resize, { args: [small, 0] }],\n        [\n          [\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"],\n          resize,\n          { args: [big, 0] },\n        ],\n        [[\"ArrowUp\", \"mac+ArrowUp\"], resize, { args: [0, -small] }],\n        [[\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"], resize, { args: [0, -big] }],\n        [[\"ArrowDown\", \"mac+ArrowDown\"], resize, { args: [0, small] }],\n        [[\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"], resize, { args: [0, big] }],\n        [\n          [\"Escape\", \"mac+Escape\"],\n          AnnotationEditor.prototype._stopResizingWithKeyboard,\n        ],\n      ])\n    );\n  }\n\n  /**\n   * @param {AnnotationEditorParameters} parameters\n   */\n  constructor(parameters) {\n    if (this.constructor === AnnotationEditor) {\n      unreachable(\"Cannot initialize AnnotationEditor.\");\n    }\n\n    this.parent = parameters.parent;\n    this.id = parameters.id;\n    this.width = this.height = null;\n    this.pageIndex = parameters.parent.pageIndex;\n    this.name = parameters.name;\n    this.div = null;\n    this._uiManager = parameters.uiManager;\n    this.annotationElementId = null;\n    this._willKeepAspectRatio = false;\n    this._initialOptions.isCentered = parameters.isCentered;\n    this._structTreeParentId = null;\n\n    const {\n      rotation,\n      rawDims: { pageWidth, pageHeight, pageX, pageY },\n    } = this.parent.viewport;\n\n    this.rotation = rotation;\n    this.pageRotation =\n      (360 + rotation - this._uiManager.viewParameters.rotation) % 360;\n    this.pageDimensions = [pageWidth, pageHeight];\n    this.pageTranslation = [pageX, pageY];\n\n    const [width, height] = this.parentDimensions;\n    this.x = parameters.x / width;\n    this.y = parameters.y / height;\n\n    this.isAttachedToDOM = false;\n    this.deleted = false;\n  }\n\n  get editorType() {\n    return Object.getPrototypeOf(this).constructor._type;\n  }\n\n  static get _defaultLineColor() {\n    return shadow(\n      this,\n      \"_defaultLineColor\",\n      this._colorManager.getHexCode(\"CanvasText\")\n    );\n  }\n\n  static deleteAnnotationElement(editor) {\n    const fakeEditor = new FakeEditor({\n      id: editor.parent.getNextId(),\n      parent: editor.parent,\n      uiManager: editor._uiManager,\n    });\n    fakeEditor.annotationElementId = editor.annotationElementId;\n    fakeEditor.deleted = true;\n    fakeEditor._uiManager.addToAnnotationStorage(fakeEditor);\n  }\n\n  /**\n   * Initialize the l10n stuff for this type of editor.\n   * @param {Object} l10n\n   */\n  static initialize(l10n, options = null) {\n    AnnotationEditor._l10nPromise ||= new Map(\n      [\n        \"pdfjs-editor-alt-text-button-label\",\n        \"pdfjs-editor-alt-text-edit-button-label\",\n        \"pdfjs-editor-alt-text-decorative-tooltip\",\n        \"pdfjs-editor-resizer-label-topLeft\",\n        \"pdfjs-editor-resizer-label-topMiddle\",\n        \"pdfjs-editor-resizer-label-topRight\",\n        \"pdfjs-editor-resizer-label-middleRight\",\n        \"pdfjs-editor-resizer-label-bottomRight\",\n        \"pdfjs-editor-resizer-label-bottomMiddle\",\n        \"pdfjs-editor-resizer-label-bottomLeft\",\n        \"pdfjs-editor-resizer-label-middleLeft\",\n      ].map(str => [\n        str,\n        l10n.get(str.replaceAll(/([A-Z])/g, c => `-${c.toLowerCase()}`)),\n      ])\n    );\n    if (options?.strings) {\n      for (const str of options.strings) {\n        AnnotationEditor._l10nPromise.set(str, l10n.get(str));\n      }\n    }\n    if (AnnotationEditor._borderLineWidth !== -1) {\n      return;\n    }\n    const style = getComputedStyle(document.documentElement);\n    AnnotationEditor._borderLineWidth =\n      parseFloat(style.getPropertyValue(\"--outline-width\")) || 0;\n  }\n\n  /**\n   * Update the default parameters for this type of editor.\n   * @param {number} _type\n   * @param {*} _value\n   */\n  static updateDefaultParams(_type, _value) {}\n\n  /**\n   * Get the default properties to set in the UI for this type of editor.\n   * @returns {Array}\n   */\n  static get defaultPropertiesToUpdate() {\n    return [];\n  }\n\n  /**\n   * Check if this kind of editor is able to handle the given mime type for\n   * pasting.\n   * @param {string} mime\n   * @returns {boolean}\n   */\n  static isHandlingMimeForPasting(mime) {\n    return false;\n  }\n\n  /**\n   * Extract the data from the clipboard item and delegate the creation of the\n   * editor to the parent.\n   * @param {DataTransferItem} item\n   * @param {AnnotationEditorLayer} parent\n   */\n  static paste(item, parent) {\n    unreachable(\"Not implemented\");\n  }\n\n  /**\n   * Get the properties to update in the UI for this editor.\n   * @returns {Array}\n   */\n  get propertiesToUpdate() {\n    return [];\n  }\n\n  get _isDraggable() {\n    return this.#isDraggable;\n  }\n\n  set _isDraggable(value) {\n    this.#isDraggable = value;\n    this.div?.classList.toggle(\"draggable\", value);\n  }\n\n  /**\n   * @returns {boolean} true if the editor handles the Enter key itself.\n   */\n  get isEnterHandled() {\n    return true;\n  }\n\n  center() {\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    switch (this.parentRotation) {\n      case 90:\n        this.x -= (this.height * pageHeight) / (pageWidth * 2);\n        this.y += (this.width * pageWidth) / (pageHeight * 2);\n        break;\n      case 180:\n        this.x += this.width / 2;\n        this.y += this.height / 2;\n        break;\n      case 270:\n        this.x += (this.height * pageHeight) / (pageWidth * 2);\n        this.y -= (this.width * pageWidth) / (pageHeight * 2);\n        break;\n      default:\n        this.x -= this.width / 2;\n        this.y -= this.height / 2;\n        break;\n    }\n    this.fixAndSetPosition();\n  }\n\n  /**\n   * Add some commands into the CommandManager (undo/redo stuff).\n   * @param {Object} params\n   */\n  addCommands(params) {\n    this._uiManager.addCommands(params);\n  }\n\n  get currentLayer() {\n    return this._uiManager.currentLayer;\n  }\n\n  /**\n   * This editor will be behind the others.\n   */\n  setInBackground() {\n    this.div.style.zIndex = 0;\n  }\n\n  /**\n   * This editor will be in the foreground.\n   */\n  setInForeground() {\n    this.div.style.zIndex = this.#zIndex;\n  }\n\n  setParent(parent) {\n    if (parent !== null) {\n      this.pageIndex = parent.pageIndex;\n      this.pageDimensions = parent.pageDimensions;\n    } else {\n      // The editor is being removed from the DOM, so we need to stop resizing.\n      this.#stopResizing();\n    }\n    this.parent = parent;\n  }\n\n  /**\n   * onfocus callback.\n   */\n  focusin(event) {\n    if (!this._focusEventsAllowed) {\n      return;\n    }\n    if (!this.#hasBeenClicked) {\n      this.parent.setSelected(this);\n    } else {\n      this.#hasBeenClicked = false;\n    }\n  }\n\n  /**\n   * onblur callback.\n   * @param {FocusEvent} event\n   */\n  focusout(event) {\n    if (!this._focusEventsAllowed) {\n      return;\n    }\n\n    if (!this.isAttachedToDOM) {\n      return;\n    }\n\n    // In case of focusout, the relatedTarget is the element which\n    // is grabbing the focus.\n    // So if the related target is an element under the div for this\n    // editor, then the editor isn't unactive.\n    const target = event.relatedTarget;\n    if (target?.closest(`#${this.id}`)) {\n      return;\n    }\n\n    event.preventDefault();\n\n    if (!this.parent?.isMultipleSelection) {\n      this.commitOrRemove();\n    }\n  }\n\n  commitOrRemove() {\n    if (this.isEmpty()) {\n      this.remove();\n    } else {\n      this.commit();\n    }\n  }\n\n  /**\n   * Commit the data contained in this editor.\n   */\n  commit() {\n    this.addToAnnotationStorage();\n  }\n\n  addToAnnotationStorage() {\n    this._uiManager.addToAnnotationStorage(this);\n  }\n\n  /**\n   * Set the editor position within its parent.\n   * @param {number} x\n   * @param {number} y\n   * @param {number} tx - x-translation in screen coordinates.\n   * @param {number} ty - y-translation in screen coordinates.\n   */\n  setAt(x, y, tx, ty) {\n    const [width, height] = this.parentDimensions;\n    [tx, ty] = this.screenToPageTranslation(tx, ty);\n\n    this.x = (x + tx) / width;\n    this.y = (y + ty) / height;\n\n    this.fixAndSetPosition();\n  }\n\n  #translate([width, height], x, y) {\n    [x, y] = this.screenToPageTranslation(x, y);\n\n    this.x += x / width;\n    this.y += y / height;\n\n    this.fixAndSetPosition();\n  }\n\n  /**\n   * Translate the editor position within its parent.\n   * @param {number} x - x-translation in screen coordinates.\n   * @param {number} y - y-translation in screen coordinates.\n   */\n  translate(x, y) {\n    this.#translate(this.parentDimensions, x, y);\n  }\n\n  /**\n   * Translate the editor position within its page and adjust the scroll\n   * in order to have the editor in the view.\n   * @param {number} x - x-translation in page coordinates.\n   * @param {number} y - y-translation in page coordinates.\n   */\n  translateInPage(x, y) {\n    this.#translate(this.pageDimensions, x, y);\n    this.div.scrollIntoView({ block: \"nearest\" });\n  }\n\n  drag(tx, ty) {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.x += tx / parentWidth;\n    this.y += ty / parentHeight;\n    if (this.parent && (this.x < 0 || this.x > 1 || this.y < 0 || this.y > 1)) {\n      // It's possible to not have a parent: for example, when the user is\n      // dragging all the selected editors but this one on a page which has been\n      // destroyed.\n      // It's why we need to check for it. In such a situation, it isn't really\n      // a problem to not find a new parent: it's something which is related to\n      // what the user is seeing, hence it depends on how pages are layed out.\n\n      // The element will be outside of its parent so change the parent.\n      const { x, y } = this.div.getBoundingClientRect();\n      if (this.parent.findNewParent(this, x, y)) {\n        this.x -= Math.floor(this.x);\n        this.y -= Math.floor(this.y);\n      }\n    }\n\n    // The editor can be moved wherever the user wants, so we don't need to fix\n    // the position: it'll be done when the user will release the mouse button.\n\n    let { x, y } = this;\n    const [bx, by] = this.#getBaseTranslation();\n    x += bx;\n    y += by;\n\n    this.div.style.left = `${(100 * x).toFixed(2)}%`;\n    this.div.style.top = `${(100 * y).toFixed(2)}%`;\n    this.div.scrollIntoView({ block: \"nearest\" });\n  }\n\n  #getBaseTranslation() {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    const { _borderLineWidth } = AnnotationEditor;\n    const x = _borderLineWidth / parentWidth;\n    const y = _borderLineWidth / parentHeight;\n    switch (this.rotation) {\n      case 90:\n        return [-x, y];\n      case 180:\n        return [x, y];\n      case 270:\n        return [x, -y];\n      default:\n        return [-x, -y];\n    }\n  }\n\n  fixAndSetPosition() {\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    let { x, y, width, height } = this;\n    width *= pageWidth;\n    height *= pageHeight;\n    x *= pageWidth;\n    y *= pageHeight;\n\n    switch (this.rotation) {\n      case 0:\n        x = Math.max(0, Math.min(pageWidth - width, x));\n        y = Math.max(0, Math.min(pageHeight - height, y));\n        break;\n      case 90:\n        x = Math.max(0, Math.min(pageWidth - height, x));\n        y = Math.min(pageHeight, Math.max(width, y));\n        break;\n      case 180:\n        x = Math.min(pageWidth, Math.max(width, x));\n        y = Math.min(pageHeight, Math.max(height, y));\n        break;\n      case 270:\n        x = Math.min(pageWidth, Math.max(height, x));\n        y = Math.max(0, Math.min(pageHeight - width, y));\n        break;\n    }\n\n    this.x = x /= pageWidth;\n    this.y = y /= pageHeight;\n\n    const [bx, by] = this.#getBaseTranslation();\n    x += bx;\n    y += by;\n\n    const { style } = this.div;\n    style.left = `${(100 * x).toFixed(2)}%`;\n    style.top = `${(100 * y).toFixed(2)}%`;\n\n    this.moveInDOM();\n  }\n\n  static #rotatePoint(x, y, angle) {\n    switch (angle) {\n      case 90:\n        return [y, -x];\n      case 180:\n        return [-x, -y];\n      case 270:\n        return [-y, x];\n      default:\n        return [x, y];\n    }\n  }\n\n  /**\n   * Convert a screen translation into a page one.\n   * @param {number} x\n   * @param {number} y\n   */\n  screenToPageTranslation(x, y) {\n    return AnnotationEditor.#rotatePoint(x, y, this.parentRotation);\n  }\n\n  /**\n   * Convert a page translation into a screen one.\n   * @param {number} x\n   * @param {number} y\n   */\n  pageTranslationToScreen(x, y) {\n    return AnnotationEditor.#rotatePoint(x, y, 360 - this.parentRotation);\n  }\n\n  #getRotationMatrix(rotation) {\n    switch (rotation) {\n      case 90: {\n        const [pageWidth, pageHeight] = this.pageDimensions;\n        return [0, -pageWidth / pageHeight, pageHeight / pageWidth, 0];\n      }\n      case 180:\n        return [-1, 0, 0, -1];\n      case 270: {\n        const [pageWidth, pageHeight] = this.pageDimensions;\n        return [0, pageWidth / pageHeight, -pageHeight / pageWidth, 0];\n      }\n      default:\n        return [1, 0, 0, 1];\n    }\n  }\n\n  get parentScale() {\n    return this._uiManager.viewParameters.realScale;\n  }\n\n  get parentRotation() {\n    return (this._uiManager.viewParameters.rotation + this.pageRotation) % 360;\n  }\n\n  get parentDimensions() {\n    const {\n      parentScale,\n      pageDimensions: [pageWidth, pageHeight],\n    } = this;\n    const scaledWidth = pageWidth * parentScale;\n    const scaledHeight = pageHeight * parentScale;\n    return FeatureTest.isCSSRoundSupported\n      ? [Math.round(scaledWidth), Math.round(scaledHeight)]\n      : [scaledWidth, scaledHeight];\n  }\n\n  /**\n   * Set the dimensions of this editor.\n   * @param {number} width\n   * @param {number} height\n   */\n  setDims(width, height) {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.div.style.width = `${((100 * width) / parentWidth).toFixed(2)}%`;\n    if (!this.#keepAspectRatio) {\n      this.div.style.height = `${((100 * height) / parentHeight).toFixed(2)}%`;\n    }\n    this.#altTextButton?.classList.toggle(\n      \"small\",\n      width < AnnotationEditor.SMALL_EDITOR_SIZE ||\n        height < AnnotationEditor.SMALL_EDITOR_SIZE\n    );\n  }\n\n  fixDims() {\n    const { style } = this.div;\n    const { height, width } = style;\n    const widthPercent = width.endsWith(\"%\");\n    const heightPercent = !this.#keepAspectRatio && height.endsWith(\"%\");\n    if (widthPercent && heightPercent) {\n      return;\n    }\n\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    if (!widthPercent) {\n      style.width = `${((100 * parseFloat(width)) / parentWidth).toFixed(2)}%`;\n    }\n    if (!this.#keepAspectRatio && !heightPercent) {\n      style.height = `${((100 * parseFloat(height)) / parentHeight).toFixed(\n        2\n      )}%`;\n    }\n  }\n\n  /**\n   * Get the translation used to position this editor when it's created.\n   * @returns {Array<number>}\n   */\n  getInitialTranslation() {\n    return [0, 0];\n  }\n\n  #createResizers() {\n    if (this.#resizersDiv) {\n      return;\n    }\n    this.#resizersDiv = document.createElement(\"div\");\n    this.#resizersDiv.classList.add(\"resizers\");\n    // When the resizers are used with the keyboard, they're focusable, hence\n    // we want to have them in this order (top left, top middle, top right, ...)\n    // in the DOM to have the focus order correct.\n    const classes = this._willKeepAspectRatio\n      ? [\"topLeft\", \"topRight\", \"bottomRight\", \"bottomLeft\"]\n      : [\n          \"topLeft\",\n          \"topMiddle\",\n          \"topRight\",\n          \"middleRight\",\n          \"bottomRight\",\n          \"bottomMiddle\",\n          \"bottomLeft\",\n          \"middleLeft\",\n        ];\n    for (const name of classes) {\n      const div = document.createElement(\"div\");\n      this.#resizersDiv.append(div);\n      div.classList.add(\"resizer\", name);\n      div.setAttribute(\"data-resizer-name\", name);\n      div.addEventListener(\n        \"pointerdown\",\n        this.#resizerPointerdown.bind(this, name)\n      );\n      div.addEventListener(\"contextmenu\", noContextMenu);\n      div.tabIndex = -1;\n    }\n    this.div.prepend(this.#resizersDiv);\n  }\n\n  #resizerPointerdown(name, event) {\n    event.preventDefault();\n    const { isMac } = FeatureTest.platform;\n    if (event.button !== 0 || (event.ctrlKey && isMac)) {\n      return;\n    }\n\n    this.#toggleAltTextButton(false);\n\n    const boundResizerPointermove = this.#resizerPointermove.bind(this, name);\n    const savedDraggable = this._isDraggable;\n    this._isDraggable = false;\n    const pointerMoveOptions = { passive: true, capture: true };\n    this.parent.togglePointerEvents(false);\n    window.addEventListener(\n      \"pointermove\",\n      boundResizerPointermove,\n      pointerMoveOptions\n    );\n    const savedX = this.x;\n    const savedY = this.y;\n    const savedWidth = this.width;\n    const savedHeight = this.height;\n    const savedParentCursor = this.parent.div.style.cursor;\n    const savedCursor = this.div.style.cursor;\n    this.div.style.cursor = this.parent.div.style.cursor =\n      window.getComputedStyle(event.target).cursor;\n\n    const pointerUpCallback = () => {\n      this.parent.togglePointerEvents(true);\n      this.#toggleAltTextButton(true);\n      this._isDraggable = savedDraggable;\n      window.removeEventListener(\"pointerup\", pointerUpCallback);\n      window.removeEventListener(\"blur\", pointerUpCallback);\n      window.removeEventListener(\n        \"pointermove\",\n        boundResizerPointermove,\n        pointerMoveOptions\n      );\n      this.parent.div.style.cursor = savedParentCursor;\n      this.div.style.cursor = savedCursor;\n\n      this.#addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight);\n    };\n    window.addEventListener(\"pointerup\", pointerUpCallback);\n    // If the user switches to another window (with alt+tab), then we end the\n    // resize session.\n    window.addEventListener(\"blur\", pointerUpCallback);\n  }\n\n  #addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight) {\n    const newX = this.x;\n    const newY = this.y;\n    const newWidth = this.width;\n    const newHeight = this.height;\n    if (\n      newX === savedX &&\n      newY === savedY &&\n      newWidth === savedWidth &&\n      newHeight === savedHeight\n    ) {\n      return;\n    }\n\n    this.addCommands({\n      cmd: () => {\n        this.width = newWidth;\n        this.height = newHeight;\n        this.x = newX;\n        this.y = newY;\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        this.setDims(parentWidth * newWidth, parentHeight * newHeight);\n        this.fixAndSetPosition();\n      },\n      undo: () => {\n        this.width = savedWidth;\n        this.height = savedHeight;\n        this.x = savedX;\n        this.y = savedY;\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        this.setDims(parentWidth * savedWidth, parentHeight * savedHeight);\n        this.fixAndSetPosition();\n      },\n      mustExec: true,\n    });\n  }\n\n  #resizerPointermove(name, event) {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    const savedX = this.x;\n    const savedY = this.y;\n    const savedWidth = this.width;\n    const savedHeight = this.height;\n    const minWidth = AnnotationEditor.MIN_SIZE / parentWidth;\n    const minHeight = AnnotationEditor.MIN_SIZE / parentHeight;\n\n    // 10000 because we multiply by 100 and use toFixed(2) in fixAndSetPosition.\n    // Without rounding, the positions of the corners other than the top left\n    // one can be slightly wrong.\n    const round = x => Math.round(x * 10000) / 10000;\n    const rotationMatrix = this.#getRotationMatrix(this.rotation);\n    const transf = (x, y) => [\n      rotationMatrix[0] * x + rotationMatrix[2] * y,\n      rotationMatrix[1] * x + rotationMatrix[3] * y,\n    ];\n    const invRotationMatrix = this.#getRotationMatrix(360 - this.rotation);\n    const invTransf = (x, y) => [\n      invRotationMatrix[0] * x + invRotationMatrix[2] * y,\n      invRotationMatrix[1] * x + invRotationMatrix[3] * y,\n    ];\n    let getPoint;\n    let getOpposite;\n    let isDiagonal = false;\n    let isHorizontal = false;\n\n    switch (name) {\n      case \"topLeft\":\n        isDiagonal = true;\n        getPoint = (w, h) => [0, 0];\n        getOpposite = (w, h) => [w, h];\n        break;\n      case \"topMiddle\":\n        getPoint = (w, h) => [w / 2, 0];\n        getOpposite = (w, h) => [w / 2, h];\n        break;\n      case \"topRight\":\n        isDiagonal = true;\n        getPoint = (w, h) => [w, 0];\n        getOpposite = (w, h) => [0, h];\n        break;\n      case \"middleRight\":\n        isHorizontal = true;\n        getPoint = (w, h) => [w, h / 2];\n        getOpposite = (w, h) => [0, h / 2];\n        break;\n      case \"bottomRight\":\n        isDiagonal = true;\n        getPoint = (w, h) => [w, h];\n        getOpposite = (w, h) => [0, 0];\n        break;\n      case \"bottomMiddle\":\n        getPoint = (w, h) => [w / 2, h];\n        getOpposite = (w, h) => [w / 2, 0];\n        break;\n      case \"bottomLeft\":\n        isDiagonal = true;\n        getPoint = (w, h) => [0, h];\n        getOpposite = (w, h) => [w, 0];\n        break;\n      case \"middleLeft\":\n        isHorizontal = true;\n        getPoint = (w, h) => [0, h / 2];\n        getOpposite = (w, h) => [w, h / 2];\n        break;\n    }\n\n    const point = getPoint(savedWidth, savedHeight);\n    const oppositePoint = getOpposite(savedWidth, savedHeight);\n    let transfOppositePoint = transf(...oppositePoint);\n    const oppositeX = round(savedX + transfOppositePoint[0]);\n    const oppositeY = round(savedY + transfOppositePoint[1]);\n    let ratioX = 1;\n    let ratioY = 1;\n\n    let [deltaX, deltaY] = this.screenToPageTranslation(\n      event.movementX,\n      event.movementY\n    );\n    [deltaX, deltaY] = invTransf(deltaX / parentWidth, deltaY / parentHeight);\n\n    if (isDiagonal) {\n      const oldDiag = Math.hypot(savedWidth, savedHeight);\n      ratioX = ratioY = Math.max(\n        Math.min(\n          Math.hypot(\n            oppositePoint[0] - point[0] - deltaX,\n            oppositePoint[1] - point[1] - deltaY\n          ) / oldDiag,\n          // Avoid the editor to be larger than the page.\n          1 / savedWidth,\n          1 / savedHeight\n        ),\n        // Avoid the editor to be smaller than the minimum size.\n        minWidth / savedWidth,\n        minHeight / savedHeight\n      );\n    } else if (isHorizontal) {\n      ratioX =\n        Math.max(\n          minWidth,\n          Math.min(1, Math.abs(oppositePoint[0] - point[0] - deltaX))\n        ) / savedWidth;\n    } else {\n      ratioY =\n        Math.max(\n          minHeight,\n          Math.min(1, Math.abs(oppositePoint[1] - point[1] - deltaY))\n        ) / savedHeight;\n    }\n\n    const newWidth = round(savedWidth * ratioX);\n    const newHeight = round(savedHeight * ratioY);\n    transfOppositePoint = transf(...getOpposite(newWidth, newHeight));\n    const newX = oppositeX - transfOppositePoint[0];\n    const newY = oppositeY - transfOppositePoint[1];\n\n    this.width = newWidth;\n    this.height = newHeight;\n    this.x = newX;\n    this.y = newY;\n\n    this.setDims(parentWidth * newWidth, parentHeight * newHeight);\n    this.fixAndSetPosition();\n  }\n\n  async addAltTextButton() {\n    if (this.#altTextButton) {\n      return;\n    }\n    const altText = (this.#altTextButton = document.createElement(\"button\"));\n    altText.className = \"altText\";\n    const msg = await AnnotationEditor._l10nPromise.get(\n      \"pdfjs-editor-alt-text-button-label\"\n    );\n    altText.textContent = msg;\n    altText.setAttribute(\"aria-label\", msg);\n    altText.tabIndex = \"0\";\n    altText.addEventListener(\"contextmenu\", noContextMenu);\n    altText.addEventListener(\"pointerdown\", event => event.stopPropagation());\n\n    const onClick = event => {\n      this.#altTextButton.hidden = true;\n      event.preventDefault();\n      this._uiManager.editAltText(this);\n    };\n    altText.addEventListener(\"click\", onClick, { capture: true });\n    altText.addEventListener(\"keydown\", event => {\n      if (event.target === altText && event.key === \"Enter\") {\n        this.#altTextWasFromKeyBoard = true;\n        onClick(event);\n      }\n    });\n    this.#setAltTextButtonState();\n    this.div.append(altText);\n    if (!AnnotationEditor.SMALL_EDITOR_SIZE) {\n      // We take the width of the alt text button and we add 40% to it to be\n      // sure to have enough space for it.\n      const PERCENT = 40;\n      AnnotationEditor.SMALL_EDITOR_SIZE = Math.min(\n        128,\n        Math.round(altText.getBoundingClientRect().width * (1 + PERCENT / 100))\n      );\n    }\n  }\n\n  async #setAltTextButtonState() {\n    const button = this.#altTextButton;\n    if (!button) {\n      return;\n    }\n    if (!this.#altText && !this.#altTextDecorative) {\n      button.classList.remove(\"done\");\n      this.#altTextTooltip?.remove();\n      return;\n    }\n    button.classList.add(\"done\");\n\n    AnnotationEditor._l10nPromise\n      .get(\"pdfjs-editor-alt-text-edit-button-label\")\n      .then(msg => {\n        button.setAttribute(\"aria-label\", msg);\n      });\n    let tooltip = this.#altTextTooltip;\n    if (!tooltip) {\n      this.#altTextTooltip = tooltip = document.createElement(\"span\");\n      tooltip.className = \"tooltip\";\n      tooltip.setAttribute(\"role\", \"tooltip\");\n      const id = (tooltip.id = `alt-text-tooltip-${this.id}`);\n      button.setAttribute(\"aria-describedby\", id);\n\n      const DELAY_TO_SHOW_TOOLTIP = 100;\n      button.addEventListener(\"mouseenter\", () => {\n        this.#altTextTooltipTimeout = setTimeout(() => {\n          this.#altTextTooltipTimeout = null;\n          this.#altTextTooltip.classList.add(\"show\");\n          this._uiManager._eventBus.dispatch(\"reporttelemetry\", {\n            source: this,\n            details: {\n              type: \"editing\",\n              subtype: this.editorType,\n              data: {\n                action: \"alt_text_tooltip\",\n              },\n            },\n          });\n        }, DELAY_TO_SHOW_TOOLTIP);\n      });\n      button.addEventListener(\"mouseleave\", () => {\n        if (this.#altTextTooltipTimeout) {\n          clearTimeout(this.#altTextTooltipTimeout);\n          this.#altTextTooltipTimeout = null;\n        }\n        this.#altTextTooltip?.classList.remove(\"show\");\n      });\n    }\n    tooltip.innerText = this.#altTextDecorative\n      ? await AnnotationEditor._l10nPromise.get(\n          \"pdfjs-editor-alt-text-decorative-tooltip\"\n        )\n      : this.#altText;\n\n    if (!tooltip.parentNode) {\n      button.append(tooltip);\n    }\n\n    const element = this.getImageForAltText();\n    element?.setAttribute(\"aria-describedby\", tooltip.id);\n  }\n\n  #toggleAltTextButton(enabled = false) {\n    if (!this.#altTextButton) {\n      return;\n    }\n    if (!enabled && this.#altTextTooltipTimeout) {\n      clearTimeout(this.#altTextTooltipTimeout);\n      this.#altTextTooltipTimeout = null;\n    }\n    this.#altTextButton.disabled = !enabled;\n  }\n\n  altTextFinish() {\n    if (!this.#altTextButton) {\n      return;\n    }\n    this.#altTextButton.hidden = false;\n    this.#altTextButton.focus({ focusVisible: this.#altTextWasFromKeyBoard });\n    this.#altTextWasFromKeyBoard = false;\n  }\n\n  addEditToolbar() {\n    if (this.#editToolbar || this.#isInEditMode) {\n      return;\n    }\n    this.#editToolbar = new EditorToolbar(this);\n    this.div.append(this.#editToolbar.render());\n  }\n\n  removeEditToolbar() {\n    if (!this.#editToolbar) {\n      return;\n    }\n    this.#editToolbar.remove();\n    this.#editToolbar = null;\n  }\n\n  getClientDimensions() {\n    return this.div.getBoundingClientRect();\n  }\n\n  get altTextData() {\n    return {\n      altText: this.#altText,\n      decorative: this.#altTextDecorative,\n    };\n  }\n\n  /**\n   * Set the alt text data.\n   */\n  set altTextData({ altText, decorative }) {\n    if (this.#altText === altText && this.#altTextDecorative === decorative) {\n      return;\n    }\n    this.#altText = altText;\n    this.#altTextDecorative = decorative;\n    this.#setAltTextButtonState();\n  }\n\n  /**\n   * Render this editor in a div.\n   * @returns {HTMLDivElement | null}\n   */\n  render() {\n    this.div = document.createElement(\"div\");\n    this.div.setAttribute(\"data-editor-rotation\", (360 - this.rotation) % 360);\n    this.div.className = this.name;\n    this.div.setAttribute(\"id\", this.id);\n    this.div.setAttribute(\"tabIndex\", 0);\n\n    this.setInForeground();\n\n    this.div.addEventListener(\"focusin\", this.#boundFocusin);\n    this.div.addEventListener(\"focusout\", this.#boundFocusout);\n\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    if (this.parentRotation % 180 !== 0) {\n      this.div.style.maxWidth = `${((100 * parentHeight) / parentWidth).toFixed(\n        2\n      )}%`;\n      this.div.style.maxHeight = `${(\n        (100 * parentWidth) /\n        parentHeight\n      ).toFixed(2)}%`;\n    }\n\n    const [tx, ty] = this.getInitialTranslation();\n    this.translate(tx, ty);\n\n    bindEvents(this, this.div, [\"pointerdown\"]);\n\n    return this.div;\n  }\n\n  /**\n   * Onpointerdown callback.\n   * @param {PointerEvent} event\n   */\n  pointerdown(event) {\n    const { isMac } = FeatureTest.platform;\n    if (event.button !== 0 || (event.ctrlKey && isMac)) {\n      // Avoid to focus this editor because of a non-left click.\n      event.preventDefault();\n      return;\n    }\n\n    this.#hasBeenClicked = true;\n\n    this.#setUpDragSession(event);\n  }\n\n  #setUpDragSession(event) {\n    if (!this._isDraggable) {\n      return;\n    }\n\n    const isSelected = this._uiManager.isSelected(this);\n    this._uiManager.setUpDragSession();\n\n    let pointerMoveOptions, pointerMoveCallback;\n    if (isSelected) {\n      pointerMoveOptions = { passive: true, capture: true };\n      pointerMoveCallback = e => {\n        const [tx, ty] = this.screenToPageTranslation(e.movementX, e.movementY);\n        this._uiManager.dragSelectedEditors(tx, ty);\n      };\n      window.addEventListener(\n        \"pointermove\",\n        pointerMoveCallback,\n        pointerMoveOptions\n      );\n    }\n\n    const pointerUpCallback = () => {\n      window.removeEventListener(\"pointerup\", pointerUpCallback);\n      window.removeEventListener(\"blur\", pointerUpCallback);\n      if (isSelected) {\n        window.removeEventListener(\n          \"pointermove\",\n          pointerMoveCallback,\n          pointerMoveOptions\n        );\n      }\n\n      this.#hasBeenClicked = false;\n      if (!this._uiManager.endDragSession()) {\n        const { isMac } = FeatureTest.platform;\n        if (\n          (event.ctrlKey && !isMac) ||\n          event.shiftKey ||\n          (event.metaKey && isMac)\n        ) {\n          this.parent.toggleSelected(this);\n        } else {\n          this.parent.setSelected(this);\n        }\n      }\n    };\n    window.addEventListener(\"pointerup\", pointerUpCallback);\n    // If the user is using alt+tab during the dragging session, the pointerup\n    // event could be not fired, but a blur event is fired so we can use it in\n    // order to interrupt the dragging session.\n    window.addEventListener(\"blur\", pointerUpCallback);\n  }\n\n  moveInDOM() {\n    // Moving the editor in the DOM can be expensive, so we wait a bit before.\n    // It's important to not block the UI (for example when changing the font\n    // size in a FreeText).\n    if (this.#moveInDOMTimeout) {\n      clearTimeout(this.#moveInDOMTimeout);\n    }\n    this.#moveInDOMTimeout = setTimeout(() => {\n      this.#moveInDOMTimeout = null;\n      this.parent?.moveEditorInDOM(this);\n    }, 0);\n  }\n\n  _setParentAndPosition(parent, x, y) {\n    parent.changeParent(this);\n    this.x = x;\n    this.y = y;\n    this.fixAndSetPosition();\n  }\n\n  /**\n   * Convert the current rect into a page one.\n   */\n  getRect(tx, ty) {\n    const scale = this.parentScale;\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    const [pageX, pageY] = this.pageTranslation;\n    const shiftX = tx / scale;\n    const shiftY = ty / scale;\n    const x = this.x * pageWidth;\n    const y = this.y * pageHeight;\n    const width = this.width * pageWidth;\n    const height = this.height * pageHeight;\n\n    switch (this.rotation) {\n      case 0:\n        return [\n          x + shiftX + pageX,\n          pageHeight - y - shiftY - height + pageY,\n          x + shiftX + width + pageX,\n          pageHeight - y - shiftY + pageY,\n        ];\n      case 90:\n        return [\n          x + shiftY + pageX,\n          pageHeight - y + shiftX + pageY,\n          x + shiftY + height + pageX,\n          pageHeight - y + shiftX + width + pageY,\n        ];\n      case 180:\n        return [\n          x - shiftX - width + pageX,\n          pageHeight - y + shiftY + pageY,\n          x - shiftX + pageX,\n          pageHeight - y + shiftY + height + pageY,\n        ];\n      case 270:\n        return [\n          x - shiftY - height + pageX,\n          pageHeight - y - shiftX - width + pageY,\n          x - shiftY + pageX,\n          pageHeight - y - shiftX + pageY,\n        ];\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n  }\n\n  getRectInCurrentCoords(rect, pageHeight) {\n    const [x1, y1, x2, y2] = rect;\n\n    const width = x2 - x1;\n    const height = y2 - y1;\n\n    switch (this.rotation) {\n      case 0:\n        return [x1, pageHeight - y2, width, height];\n      case 90:\n        return [x1, pageHeight - y1, height, width];\n      case 180:\n        return [x2, pageHeight - y1, width, height];\n      case 270:\n        return [x2, pageHeight - y2, height, width];\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n  }\n\n  /**\n   * Executed once this editor has been rendered.\n   */\n  onceAdded() {}\n\n  /**\n   * Check if the editor contains something.\n   * @returns {boolean}\n   */\n  isEmpty() {\n    return false;\n  }\n\n  /**\n   * Enable edit mode.\n   */\n  enableEditMode() {\n    this.#isInEditMode = true;\n  }\n\n  /**\n   * Disable edit mode.\n   */\n  disableEditMode() {\n    this.#isInEditMode = false;\n  }\n\n  /**\n   * Check if the editor is edited.\n   * @returns {boolean}\n   */\n  isInEditMode() {\n    return this.#isInEditMode;\n  }\n\n  /**\n   * If it returns true, then this editor handles the keyboard\n   * events itself.\n   * @returns {boolean}\n   */\n  shouldGetKeyboardEvents() {\n    return this.#isResizerEnabledForKeyboard;\n  }\n\n  /**\n   * Check if this editor needs to be rebuilt or not.\n   * @returns {boolean}\n   */\n  needsToBeRebuilt() {\n    return this.div && !this.isAttachedToDOM;\n  }\n\n  /**\n   * Rebuild the editor in case it has been removed on undo.\n   *\n   * To implement in subclasses.\n   */\n  rebuild() {\n    this.div?.addEventListener(\"focusin\", this.#boundFocusin);\n    this.div?.addEventListener(\"focusout\", this.#boundFocusout);\n  }\n\n  /**\n   * Serialize the editor.\n   * The result of the serialization will be used to construct a\n   * new annotation to add to the pdf document.\n   *\n   * To implement in subclasses.\n   * @param {boolean} [isForCopying]\n   * @param {Object | null} [context]\n   * @returns {Object | null}\n   */\n  serialize(isForCopying = false, context = null) {\n    unreachable(\"An editor must be serializable\");\n  }\n\n  /**\n   * Deserialize the editor.\n   * The result of the deserialization is a new editor.\n   *\n   * @param {Object} data\n   * @param {AnnotationEditorLayer} parent\n   * @param {AnnotationEditorUIManager} uiManager\n   * @returns {AnnotationEditor | null}\n   */\n  static deserialize(data, parent, uiManager) {\n    const editor = new this.prototype.constructor({\n      parent,\n      id: parent.getNextId(),\n      uiManager,\n    });\n    editor.rotation = data.rotation;\n\n    const [pageWidth, pageHeight] = editor.pageDimensions;\n    const [x, y, width, height] = editor.getRectInCurrentCoords(\n      data.rect,\n      pageHeight\n    );\n    editor.x = x / pageWidth;\n    editor.y = y / pageHeight;\n    editor.width = width / pageWidth;\n    editor.height = height / pageHeight;\n\n    return editor;\n  }\n\n  /**\n   * Remove this editor.\n   * It's used on ctrl+backspace action.\n   */\n  remove() {\n    this.div.removeEventListener(\"focusin\", this.#boundFocusin);\n    this.div.removeEventListener(\"focusout\", this.#boundFocusout);\n\n    if (!this.isEmpty()) {\n      // The editor is removed but it can be back at some point thanks to\n      // undo/redo so we must commit it before.\n      this.commit();\n    }\n    if (this.parent) {\n      this.parent.remove(this);\n    } else {\n      this._uiManager.removeEditor(this);\n    }\n\n    // The editor is removed so we can remove the alt text button and if it's\n    // restored then it's up to the subclass to add it back.\n    this.#altTextButton?.remove();\n    this.#altTextButton = null;\n    this.#altTextTooltip = null;\n    if (this.#moveInDOMTimeout) {\n      clearTimeout(this.#moveInDOMTimeout);\n      this.#moveInDOMTimeout = null;\n    }\n    this.#stopResizing();\n    this.removeEditToolbar();\n  }\n\n  /**\n   * @returns {boolean} true if this editor can be resized.\n   */\n  get isResizable() {\n    return false;\n  }\n\n  /**\n   * Add the resizers to this editor.\n   */\n  makeResizable() {\n    if (this.isResizable) {\n      this.#createResizers();\n      this.#resizersDiv.classList.remove(\"hidden\");\n      bindEvents(this, this.div, [\"keydown\"]);\n    }\n  }\n\n  /**\n   * onkeydown callback.\n   * @param {KeyboardEvent} event\n   */\n  keydown(event) {\n    if (\n      !this.isResizable ||\n      event.target !== this.div ||\n      event.key !== \"Enter\"\n    ) {\n      return;\n    }\n    this._uiManager.setSelected(this);\n    this.#savedDimensions = {\n      savedX: this.x,\n      savedY: this.y,\n      savedWidth: this.width,\n      savedHeight: this.height,\n    };\n    const children = this.#resizersDiv.children;\n    if (!this.#allResizerDivs) {\n      this.#allResizerDivs = Array.from(children);\n      const boundResizerKeydown = this.#resizerKeydown.bind(this);\n      const boundResizerBlur = this.#resizerBlur.bind(this);\n      for (const div of this.#allResizerDivs) {\n        const name = div.getAttribute(\"data-resizer-name\");\n        div.setAttribute(\"role\", \"spinbutton\");\n        div.addEventListener(\"keydown\", boundResizerKeydown);\n        div.addEventListener(\"blur\", boundResizerBlur);\n        div.addEventListener(\"focus\", this.#resizerFocus.bind(this, name));\n        AnnotationEditor._l10nPromise\n          .get(`pdfjs-editor-resizer-label-${name}`)\n          .then(msg => div.setAttribute(\"aria-label\", msg));\n      }\n    }\n\n    // We want to have the resizers in the visual order, so we move the first\n    // (top-left) to the right place.\n    const first = this.#allResizerDivs[0];\n    let firstPosition = 0;\n    for (const div of children) {\n      if (div === first) {\n        break;\n      }\n      firstPosition++;\n    }\n    const nextFirstPosition =\n      (((360 - this.rotation + this.parentRotation) % 360) / 90) *\n      (this.#allResizerDivs.length / 4);\n\n    if (nextFirstPosition !== firstPosition) {\n      // We need to reorder the resizers in the DOM in order to have the focus\n      // on the top-left one.\n      if (nextFirstPosition < firstPosition) {\n        for (let i = 0; i < firstPosition - nextFirstPosition; i++) {\n          this.#resizersDiv.append(this.#resizersDiv.firstChild);\n        }\n      } else if (nextFirstPosition > firstPosition) {\n        for (let i = 0; i < nextFirstPosition - firstPosition; i++) {\n          this.#resizersDiv.firstChild.before(this.#resizersDiv.lastChild);\n        }\n      }\n\n      let i = 0;\n      for (const child of children) {\n        const div = this.#allResizerDivs[i++];\n        const name = div.getAttribute(\"data-resizer-name\");\n        AnnotationEditor._l10nPromise\n          .get(`pdfjs-editor-resizer-label-${name}`)\n          .then(msg => child.setAttribute(\"aria-label\", msg));\n      }\n    }\n\n    this.#setResizerTabIndex(0);\n    this.#isResizerEnabledForKeyboard = true;\n    this.#resizersDiv.firstChild.focus({ focusVisible: true });\n    event.preventDefault();\n    event.stopImmediatePropagation();\n  }\n\n  #resizerKeydown(event) {\n    AnnotationEditor._resizerKeyboardManager.exec(this, event);\n  }\n\n  #resizerBlur(event) {\n    if (\n      this.#isResizerEnabledForKeyboard &&\n      event.relatedTarget?.parentNode !== this.#resizersDiv\n    ) {\n      this.#stopResizing();\n    }\n  }\n\n  #resizerFocus(name) {\n    this.#focusedResizerName = this.#isResizerEnabledForKeyboard ? name : \"\";\n  }\n\n  #setResizerTabIndex(value) {\n    if (!this.#allResizerDivs) {\n      return;\n    }\n    for (const div of this.#allResizerDivs) {\n      div.tabIndex = value;\n    }\n  }\n\n  _resizeWithKeyboard(x, y) {\n    if (!this.#isResizerEnabledForKeyboard) {\n      return;\n    }\n    this.#resizerPointermove(this.#focusedResizerName, {\n      movementX: x,\n      movementY: y,\n    });\n  }\n\n  #stopResizing() {\n    this.#isResizerEnabledForKeyboard = false;\n    this.#setResizerTabIndex(-1);\n    if (this.#savedDimensions) {\n      const { savedX, savedY, savedWidth, savedHeight } = this.#savedDimensions;\n      this.#addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight);\n      this.#savedDimensions = null;\n    }\n  }\n\n  _stopResizingWithKeyboard() {\n    this.#stopResizing();\n    this.div.focus();\n  }\n\n  /**\n   * Select this editor.\n   */\n  select() {\n    this.makeResizable();\n    this.div?.classList.add(\"selectedEditor\");\n    this.addEditToolbar();\n    this.#editToolbar?.show();\n  }\n\n  /**\n   * Unselect this editor.\n   */\n  unselect() {\n    this.#resizersDiv?.classList.add(\"hidden\");\n    this.div?.classList.remove(\"selectedEditor\");\n    if (this.div?.contains(document.activeElement)) {\n      // Don't use this.div.blur() because we don't know where the focus will\n      // go.\n      this._uiManager.currentLayer.div.focus();\n    }\n    this.#editToolbar?.hide();\n  }\n\n  /**\n   * Update some parameters which have been changed through the UI.\n   * @param {number} type\n   * @param {*} value\n   */\n  updateParams(type, value) {}\n\n  /**\n   * When the user disables the editing mode some editors can change some of\n   * their properties.\n   */\n  disableEditing() {\n    if (this.#altTextButton) {\n      this.#altTextButton.hidden = true;\n    }\n  }\n\n  /**\n   * When the user enables the editing mode some editors can change some of\n   * their properties.\n   */\n  enableEditing() {\n    if (this.#altTextButton) {\n      this.#altTextButton.hidden = false;\n    }\n  }\n\n  /**\n   * The editor is about to be edited.\n   */\n  enterInEditMode() {}\n\n  /**\n   * @returns {HTMLElement | null} the element requiring an alt text.\n   */\n  getImageForAltText() {\n    return null;\n  }\n\n  /**\n   * Get the div which really contains the displayed content.\n   * @returns {HTMLDivElement | undefined}\n   */\n  get contentDiv() {\n    return this.div;\n  }\n\n  /**\n   * If true then the editor is currently edited.\n   * @type {boolean}\n   */\n  get isEditing() {\n    return this.#isEditing;\n  }\n\n  /**\n   * When set to true, it means that this editor is currently edited.\n   * @param {boolean} value\n   */\n  set isEditing(value) {\n    this.#isEditing = value;\n    if (!this.parent) {\n      return;\n    }\n    if (value) {\n      this.parent.setSelected(this);\n      this.parent.setActiveEditor(this);\n    } else {\n      this.parent.setActiveEditor(null);\n    }\n  }\n\n  /**\n   * Set the aspect ratio to use when resizing.\n   * @param {number} width\n   * @param {number} height\n   */\n  setAspectRatio(width, height) {\n    this.#keepAspectRatio = true;\n    const aspectRatio = width / height;\n    const { style } = this.div;\n    style.aspectRatio = aspectRatio;\n    style.height = \"auto\";\n  }\n\n  static get MIN_SIZE() {\n    return 16;\n  }\n}\n\n// This class is used to fake an editor which has been deleted.\nclass FakeEditor extends AnnotationEditor {\n  constructor(params) {\n    super(params);\n    this.annotationElementId = params.annotationElementId;\n    this.deleted = true;\n  }\n\n  serialize() {\n    return {\n      id: this.annotationElementId,\n      deleted: true,\n      pageIndex: this.pageIndex,\n    };\n  }\n}\n\nexport { AnnotationEditor };\n","/* Copyright 2023 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nclass Outliner {\n  #box;\n\n  #verticalEdges = [];\n\n  #intervals = [];\n\n  /**\n   * Construct an outliner.\n   * @param {Array<Object>} boxes - An array of axis-aligned rectangles.\n   * @param {number} borderWidth - The width of the border of the boxes, it\n   *   allows to make the boxes bigger (or smaller).\n   * @param {number} innerMargin - The margin between the boxes and the\n   *   outlines. It's important to not have a null innerMargin when we want to\n   *   draw the outline else the stroked outline could be clipped because of its\n   *   width.\n   * @param {boolean} isLTR - true if we're in LTR mode. It's used to determine\n   *   the last point of the boxes.\n   */\n  constructor(boxes, borderWidth = 0, innerMargin = 0, isLTR = true) {\n    let minX = Infinity;\n    let maxX = -Infinity;\n    let minY = Infinity;\n    let maxY = -Infinity;\n\n    // We round the coordinates to slightly reduce the number of edges in the\n    // final outlines.\n    const NUMBER_OF_DIGITS = 4;\n    const EPSILON = 10 ** -NUMBER_OF_DIGITS;\n\n    // The coordinates of the boxes are in the page coordinate system.\n    for (const { x, y, width, height } of boxes) {\n      const x1 = Math.floor((x - borderWidth) / EPSILON) * EPSILON;\n      const x2 = Math.ceil((x + width + borderWidth) / EPSILON) * EPSILON;\n      const y1 = Math.floor((y - borderWidth) / EPSILON) * EPSILON;\n      const y2 = Math.ceil((y + height + borderWidth) / EPSILON) * EPSILON;\n      const left = [x1, y1, y2, true];\n      const right = [x2, y1, y2, false];\n      this.#verticalEdges.push(left, right);\n\n      minX = Math.min(minX, x1);\n      maxX = Math.max(maxX, x2);\n      minY = Math.min(minY, y1);\n      maxY = Math.max(maxY, y2);\n    }\n\n    const bboxWidth = maxX - minX + 2 * innerMargin;\n    const bboxHeight = maxY - minY + 2 * innerMargin;\n    const shiftedMinX = minX - innerMargin;\n    const shiftedMinY = minY - innerMargin;\n    const lastEdge = this.#verticalEdges.at(isLTR ? -1 : -2);\n    const lastPoint = [lastEdge[0], lastEdge[2]];\n\n    // Convert the coordinates of the edges into box coordinates.\n    for (const edge of this.#verticalEdges) {\n      const [x, y1, y2] = edge;\n      edge[0] = (x - shiftedMinX) / bboxWidth;\n      edge[1] = (y1 - shiftedMinY) / bboxHeight;\n      edge[2] = (y2 - shiftedMinY) / bboxHeight;\n    }\n\n    this.#box = {\n      x: shiftedMinX,\n      y: shiftedMinY,\n      width: bboxWidth,\n      height: bboxHeight,\n      lastPoint,\n    };\n  }\n\n  getOutlines() {\n    // We begin to sort lexicographically the vertical edges by their abscissa,\n    // and then by their ordinate.\n    this.#verticalEdges.sort(\n      (a, b) => a[0] - b[0] || a[1] - b[1] || a[2] - b[2]\n    );\n\n    // We're now using a sweep line algorithm to find the outlines.\n    // We start with the leftmost vertical edge, and we're going to iterate\n    // over all the vertical edges from left to right.\n    // Each time we encounter a left edge, we're going to insert the interval\n    // [y1, y2] in the set of intervals.\n    // This set of intervals is used to break the vertical edges into chunks:\n    // we only take the part of the vertical edge that isn't in the union of\n    // the intervals.\n    const outlineVerticalEdges = [];\n    for (const edge of this.#verticalEdges) {\n      if (edge[3]) {\n        // Left edge.\n        outlineVerticalEdges.push(...this.#breakEdge(edge));\n        this.#insert(edge);\n      } else {\n        // Right edge.\n        this.#remove(edge);\n        outlineVerticalEdges.push(...this.#breakEdge(edge));\n      }\n    }\n    return this.#getOutlines(outlineVerticalEdges);\n  }\n\n  #getOutlines(outlineVerticalEdges) {\n    const edges = [];\n    const allEdges = new Set();\n\n    for (const edge of outlineVerticalEdges) {\n      const [x, y1, y2] = edge;\n      edges.push([x, y1, edge], [x, y2, edge]);\n    }\n\n    // We sort lexicographically the vertices of each edge by their ordinate and\n    // by their abscissa.\n    // Every pair (v_2i, v_{2i + 1}) of vertices defines a horizontal edge.\n    // So for every vertical edge, we're going to add the two vertical edges\n    // which are connected to it through a horizontal edge.\n    edges.sort((a, b) => a[1] - b[1] || a[0] - b[0]);\n    for (let i = 0, ii = edges.length; i < ii; i += 2) {\n      const edge1 = edges[i][2];\n      const edge2 = edges[i + 1][2];\n      edge1.push(edge2);\n      edge2.push(edge1);\n      allEdges.add(edge1);\n      allEdges.add(edge2);\n    }\n    const outlines = [];\n    let outline;\n\n    while (allEdges.size > 0) {\n      const edge = allEdges.values().next().value;\n      let [x, y1, y2, edge1, edge2] = edge;\n      allEdges.delete(edge);\n      let lastPointX = x;\n      let lastPointY = y1;\n\n      outline = [x, y2];\n      outlines.push(outline);\n\n      while (true) {\n        let e;\n        if (allEdges.has(edge1)) {\n          e = edge1;\n        } else if (allEdges.has(edge2)) {\n          e = edge2;\n        } else {\n          break;\n        }\n\n        allEdges.delete(e);\n        [x, y1, y2, edge1, edge2] = e;\n\n        if (lastPointX !== x) {\n          outline.push(lastPointX, lastPointY, x, lastPointY === y1 ? y1 : y2);\n          lastPointX = x;\n        }\n        lastPointY = lastPointY === y1 ? y2 : y1;\n      }\n      outline.push(lastPointX, lastPointY);\n    }\n    return { outlines, box: this.#box };\n  }\n\n  #binarySearch(y) {\n    const array = this.#intervals;\n    let start = 0;\n    let end = array.length - 1;\n\n    while (start <= end) {\n      const middle = (start + end) >> 1;\n      const y1 = array[middle][0];\n      if (y1 === y) {\n        return middle;\n      }\n      if (y1 < y) {\n        start = middle + 1;\n      } else {\n        end = middle - 1;\n      }\n    }\n    return end + 1;\n  }\n\n  #insert([, y1, y2]) {\n    const index = this.#binarySearch(y1);\n    this.#intervals.splice(index, 0, [y1, y2]);\n  }\n\n  #remove([, y1, y2]) {\n    const index = this.#binarySearch(y1);\n    for (let i = index; i < this.#intervals.length; i++) {\n      const [start, end] = this.#intervals[i];\n      if (start !== y1) {\n        break;\n      }\n      if (start === y1 && end === y2) {\n        this.#intervals.splice(i, 1);\n        return;\n      }\n    }\n    for (let i = index - 1; i >= 0; i--) {\n      const [start, end] = this.#intervals[i];\n      if (start !== y1) {\n        break;\n      }\n      if (start === y1 && end === y2) {\n        this.#intervals.splice(i, 1);\n        return;\n      }\n    }\n  }\n\n  #breakEdge(edge) {\n    const [x, y1, y2] = edge;\n    const results = [[x, y1, y2]];\n    const index = this.#binarySearch(y2);\n    for (let i = 0; i < index; i++) {\n      const [start, end] = this.#intervals[i];\n      for (let j = 0, jj = results.length; j < jj; j++) {\n        const [, y3, y4] = results[j];\n        if (end <= y3 || y4 <= start) {\n          // There is no intersection between the interval and the edge, hence\n          // we keep it as is.\n          continue;\n        }\n        if (y3 >= start) {\n          if (y4 > end) {\n            results[j][1] = end;\n          } else {\n            if (jj === 1) {\n              return [];\n            }\n            // The edge is included in the interval, hence we remove it.\n            results.splice(j, 1);\n            j--;\n            jj--;\n          }\n          continue;\n        }\n        results[j][2] = start;\n        if (y4 > end) {\n          results.push([x, end, y4]);\n        }\n      }\n    }\n    return results;\n  }\n}\n\nexport { Outliner };\n","/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./editor.js\").AnnotationEditor} AnnotationEditor */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./annotation_editor_layer.js\").AnnotationEditorLayer} AnnotationEditorLayer */\n\nimport {\n  AnnotationEditorParamsType,\n  AnnotationEditorPrefix,\n  AnnotationEditorType,\n  FeatureTest,\n  getUuid,\n  shadow,\n  Util,\n  warn,\n} from \"../../shared/util.js\";\nimport {\n  fetchData,\n  getColorValues,\n  getRGB,\n  PixelsPerInch,\n} from \"../display_utils.js\";\n\nfunction bindEvents(obj, element, names) {\n  for (const name of names) {\n    element.addEventListener(name, obj[name].bind(obj));\n  }\n}\n\n/**\n * Convert a number between 0 and 100 into an hex number between 0 and 255.\n * @param {number} opacity\n * @return {string}\n */\nfunction opacityToHex(opacity) {\n  return Math.round(Math.min(255, Math.max(1, 255 * opacity)))\n    .toString(16)\n    .padStart(2, \"0\");\n}\n\n/**\n * Class to create some unique ids for the different editors.\n */\nclass IdManager {\n  #id = 0;\n\n  /**\n   * Get a unique id.\n   * @returns {string}\n   */\n  getId() {\n    return `${AnnotationEditorPrefix}${this.#id++}`;\n  }\n}\n\n/**\n * Class to manage the images used by the editors.\n * The main idea is to try to minimize the memory used by the images.\n * The images are cached and reused when possible\n * We use a refCounter to know when an image is not used anymore but we need to\n * be able to restore an image after a remove+undo, so we keep a file reference\n * or an url one.\n */\nclass ImageManager {\n  #baseId = getUuid();\n\n  #id = 0;\n\n  #cache = null;\n\n  static get _isSVGFittingCanvas() {\n    // By default, Firefox doesn't rescale without preserving the aspect ratio\n    // when drawing an SVG image on a canvas, see https://bugzilla.mozilla.org/1547776.\n    // The \"workaround\" is to append \"svgView(preserveAspectRatio(none))\" to the\n    // url, but according to comment #15, it seems that it leads to unexpected\n    // behavior in Safari.\n    const svg = `data:image/svg+xml;charset=UTF-8,<svg viewBox=\"0 0 1 1\" width=\"1\" height=\"1\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"1\" height=\"1\" style=\"fill:red;\"/></svg>`;\n    const canvas = new OffscreenCanvas(1, 3);\n    const ctx = canvas.getContext(\"2d\");\n    const image = new Image();\n    image.src = svg;\n    const promise = image.decode().then(() => {\n      ctx.drawImage(image, 0, 0, 1, 1, 0, 0, 1, 3);\n      return new Uint32Array(ctx.getImageData(0, 0, 1, 1).data.buffer)[0] === 0;\n    });\n\n    return shadow(this, \"_isSVGFittingCanvas\", promise);\n  }\n\n  async #get(key, rawData) {\n    this.#cache ||= new Map();\n    let data = this.#cache.get(key);\n    if (data === null) {\n      // We already tried to load the image but it failed.\n      return null;\n    }\n    if (data?.bitmap) {\n      data.refCounter += 1;\n      return data;\n    }\n    try {\n      data ||= {\n        bitmap: null,\n        id: `image_${this.#baseId}_${this.#id++}`,\n        refCounter: 0,\n        isSvg: false,\n      };\n      let image;\n      if (typeof rawData === \"string\") {\n        data.url = rawData;\n        image = await fetchData(rawData, \"blob\");\n      } else {\n        image = data.file = rawData;\n      }\n\n      if (image.type === \"image/svg+xml\") {\n        // Unfortunately, createImageBitmap doesn't work with SVG images.\n        // (see https://bugzilla.mozilla.org/1841972).\n        const mustRemoveAspectRatioPromise = ImageManager._isSVGFittingCanvas;\n        const fileReader = new FileReader();\n        const imageElement = new Image();\n        const imagePromise = new Promise((resolve, reject) => {\n          imageElement.onload = () => {\n            data.bitmap = imageElement;\n            data.isSvg = true;\n            resolve();\n          };\n          fileReader.onload = async () => {\n            const url = (data.svgUrl = fileReader.result);\n            // We need to set the preserveAspectRatio to none in order to let\n            // the image fits the canvas when resizing.\n            imageElement.src = (await mustRemoveAspectRatioPromise)\n              ? `${url}#svgView(preserveAspectRatio(none))`\n              : url;\n          };\n          imageElement.onerror = fileReader.onerror = reject;\n        });\n        fileReader.readAsDataURL(image);\n        await imagePromise;\n      } else {\n        data.bitmap = await createImageBitmap(image);\n      }\n      data.refCounter = 1;\n    } catch (e) {\n      console.error(e);\n      data = null;\n    }\n    this.#cache.set(key, data);\n    if (data) {\n      this.#cache.set(data.id, data);\n    }\n    return data;\n  }\n\n  async getFromFile(file) {\n    const { lastModified, name, size, type } = file;\n    return this.#get(`${lastModified}_${name}_${size}_${type}`, file);\n  }\n\n  async getFromUrl(url) {\n    return this.#get(url, url);\n  }\n\n  async getFromId(id) {\n    this.#cache ||= new Map();\n    const data = this.#cache.get(id);\n    if (!data) {\n      return null;\n    }\n    if (data.bitmap) {\n      data.refCounter += 1;\n      return data;\n    }\n\n    if (data.file) {\n      return this.getFromFile(data.file);\n    }\n    return this.getFromUrl(data.url);\n  }\n\n  getSvgUrl(id) {\n    const data = this.#cache.get(id);\n    if (!data?.isSvg) {\n      return null;\n    }\n    return data.svgUrl;\n  }\n\n  deleteId(id) {\n    this.#cache ||= new Map();\n    const data = this.#cache.get(id);\n    if (!data) {\n      return;\n    }\n    data.refCounter -= 1;\n    if (data.refCounter !== 0) {\n      return;\n    }\n    data.bitmap = null;\n  }\n\n  // We can use the id only if it belongs this manager.\n  // We must take care of having the right manager because we can copy/paste\n  // some images from other documents, hence it'd be a pity to use an id from an\n  // other manager.\n  isValidId(id) {\n    return id.startsWith(`image_${this.#baseId}_`);\n  }\n}\n\n/**\n * Class to handle undo/redo.\n * Commands are just saved in a buffer.\n * If we hit some memory issues we could likely use a circular buffer.\n * It has to be used as a singleton.\n */\nclass CommandManager {\n  #commands = [];\n\n  #locked = false;\n\n  #maxSize;\n\n  #position = -1;\n\n  constructor(maxSize = 128) {\n    this.#maxSize = maxSize;\n  }\n\n  /**\n   * @typedef {Object} addOptions\n   * @property {function} cmd\n   * @property {function} undo\n   * @property {boolean} mustExec\n   * @property {number} type\n   * @property {boolean} overwriteIfSameType\n   * @property {boolean} keepUndo\n   */\n\n  /**\n   * Add a new couple of commands to be used in case of redo/undo.\n   * @param {addOptions} options\n   */\n  add({\n    cmd,\n    undo,\n    mustExec,\n    type = NaN,\n    overwriteIfSameType = false,\n    keepUndo = false,\n  }) {\n    if (mustExec) {\n      cmd();\n    }\n\n    if (this.#locked) {\n      return;\n    }\n\n    const save = { cmd, undo, type };\n    if (this.#position === -1) {\n      if (this.#commands.length > 0) {\n        // All the commands have been undone and then a new one is added\n        // hence we clear the queue.\n        this.#commands.length = 0;\n      }\n      this.#position = 0;\n      this.#commands.push(save);\n      return;\n    }\n\n    if (overwriteIfSameType && this.#commands[this.#position].type === type) {\n      // For example when we change a color we don't want to\n      // be able to undo all the steps, hence we only want to\n      // keep the last undoable action in this sequence of actions.\n      if (keepUndo) {\n        save.undo = this.#commands[this.#position].undo;\n      }\n      this.#commands[this.#position] = save;\n      return;\n    }\n\n    const next = this.#position + 1;\n    if (next === this.#maxSize) {\n      this.#commands.splice(0, 1);\n    } else {\n      this.#position = next;\n      if (next < this.#commands.length) {\n        this.#commands.splice(next);\n      }\n    }\n\n    this.#commands.push(save);\n  }\n\n  /**\n   * Undo the last command.\n   */\n  undo() {\n    if (this.#position === -1) {\n      // Nothing to undo.\n      return;\n    }\n\n    // Avoid to insert something during the undo execution.\n    this.#locked = true;\n    this.#commands[this.#position].undo();\n    this.#locked = false;\n\n    this.#position -= 1;\n  }\n\n  /**\n   * Redo the last command.\n   */\n  redo() {\n    if (this.#position < this.#commands.length - 1) {\n      this.#position += 1;\n\n      // Avoid to insert something during the redo execution.\n      this.#locked = true;\n      this.#commands[this.#position].cmd();\n      this.#locked = false;\n    }\n  }\n\n  /**\n   * Check if there is something to undo.\n   * @returns {boolean}\n   */\n  hasSomethingToUndo() {\n    return this.#position !== -1;\n  }\n\n  /**\n   * Check if there is something to redo.\n   * @returns {boolean}\n   */\n  hasSomethingToRedo() {\n    return this.#position < this.#commands.length - 1;\n  }\n\n  destroy() {\n    this.#commands = null;\n  }\n}\n\n/**\n * Class to handle the different keyboards shortcuts we can have on mac or\n * non-mac OSes.\n */\nclass KeyboardManager {\n  /**\n   * Create a new keyboard manager class.\n   * @param {Array<Array>} callbacks - an array containing an array of shortcuts\n   * and a callback to call.\n   * A shortcut is a string like `ctrl+c` or `mac+ctrl+c` for mac OS.\n   */\n  constructor(callbacks) {\n    this.buffer = [];\n    this.callbacks = new Map();\n    this.allKeys = new Set();\n\n    const { isMac } = FeatureTest.platform;\n    for (const [keys, callback, options = {}] of callbacks) {\n      for (const key of keys) {\n        const isMacKey = key.startsWith(\"mac+\");\n        if (isMac && isMacKey) {\n          this.callbacks.set(key.slice(4), { callback, options });\n          this.allKeys.add(key.split(\"+\").at(-1));\n        } else if (!isMac && !isMacKey) {\n          this.callbacks.set(key, { callback, options });\n          this.allKeys.add(key.split(\"+\").at(-1));\n        }\n      }\n    }\n  }\n\n  /**\n   * Serialize an event into a string in order to match a\n   * potential key for a callback.\n   * @param {KeyboardEvent} event\n   * @returns {string}\n   */\n  #serialize(event) {\n    if (event.altKey) {\n      this.buffer.push(\"alt\");\n    }\n    if (event.ctrlKey) {\n      this.buffer.push(\"ctrl\");\n    }\n    if (event.metaKey) {\n      this.buffer.push(\"meta\");\n    }\n    if (event.shiftKey) {\n      this.buffer.push(\"shift\");\n    }\n    this.buffer.push(event.key);\n    const str = this.buffer.join(\"+\");\n    this.buffer.length = 0;\n\n    return str;\n  }\n\n  /**\n   * Execute a callback, if any, for a given keyboard event.\n   * The self is used as `this` in the callback.\n   * @param {Object} self\n   * @param {KeyboardEvent} event\n   * @returns\n   */\n  exec(self, event) {\n    if (!this.allKeys.has(event.key)) {\n      return;\n    }\n    const info = this.callbacks.get(this.#serialize(event));\n    if (!info) {\n      return;\n    }\n    const {\n      callback,\n      options: { bubbles = false, args = [], checker = null },\n    } = info;\n\n    if (checker && !checker(self, event)) {\n      return;\n    }\n    callback.bind(self, ...args)();\n\n    // For example, ctrl+s in a FreeText must be handled by the viewer, hence\n    // the event must bubble.\n    if (!bubbles) {\n      event.stopPropagation();\n      event.preventDefault();\n    }\n  }\n}\n\nclass ColorManager {\n  static _colorsMapping = new Map([\n    [\"CanvasText\", [0, 0, 0]],\n    [\"Canvas\", [255, 255, 255]],\n  ]);\n\n  get _colors() {\n    if (\n      typeof PDFJSDev !== \"undefined\" &&\n      PDFJSDev.test(\"LIB\") &&\n      typeof document === \"undefined\"\n    ) {\n      return shadow(this, \"_colors\", ColorManager._colorsMapping);\n    }\n\n    const colors = new Map([\n      [\"CanvasText\", null],\n      [\"Canvas\", null],\n    ]);\n    getColorValues(colors);\n    return shadow(this, \"_colors\", colors);\n  }\n\n  /**\n   * In High Contrast Mode, the color on the screen is not always the\n   * real color used in the pdf.\n   * For example in some cases white can appear to be black but when saving\n   * we want to have white.\n   * @param {string} color\n   * @returns {Array<number>}\n   */\n  convert(color) {\n    const rgb = getRGB(color);\n    if (!window.matchMedia(\"(forced-colors: active)\").matches) {\n      return rgb;\n    }\n\n    for (const [name, RGB] of this._colors) {\n      if (RGB.every((x, i) => x === rgb[i])) {\n        return ColorManager._colorsMapping.get(name);\n      }\n    }\n    return rgb;\n  }\n\n  /**\n   * An input element must have its color value as a hex string\n   * and not as color name.\n   * So this function converts a name into an hex string.\n   * @param {string} name\n   * @returns {string}\n   */\n  getHexCode(name) {\n    const rgb = this._colors.get(name);\n    if (!rgb) {\n      return name;\n    }\n    return Util.makeHexColor(...rgb);\n  }\n}\n\n/**\n * A pdf has several pages and each of them when it will rendered\n * will have an AnnotationEditorLayer which will contain the some\n * new Annotations associated to an editor in order to modify them.\n *\n * This class is used to manage all the different layers, editors and\n * some action like copy/paste, undo/redo, ...\n */\nclass AnnotationEditorUIManager {\n  #activeEditor = null;\n\n  #allEditors = new Map();\n\n  #allLayers = new Map();\n\n  #altTextManager = null;\n\n  #annotationStorage = null;\n\n  #commandManager = new CommandManager();\n\n  #currentPageIndex = 0;\n\n  #deletedAnnotationsElementIds = new Set();\n\n  #draggingEditors = null;\n\n  #editorTypes = null;\n\n  #editorsToRescale = new Set();\n\n  #filterFactory = null;\n\n  #focusMainContainerTimeoutId = null;\n\n  #idManager = new IdManager();\n\n  #isEnabled = false;\n\n  #isWaiting = false;\n\n  #lastActiveElement = null;\n\n  #mode = AnnotationEditorType.NONE;\n\n  #selectedEditors = new Set();\n\n  #pageColors = null;\n\n  #boundBlur = this.blur.bind(this);\n\n  #boundFocus = this.focus.bind(this);\n\n  #boundCopy = this.copy.bind(this);\n\n  #boundCut = this.cut.bind(this);\n\n  #boundPaste = this.paste.bind(this);\n\n  #boundKeydown = this.keydown.bind(this);\n\n  #boundOnEditingAction = this.onEditingAction.bind(this);\n\n  #boundOnPageChanging = this.onPageChanging.bind(this);\n\n  #boundOnScaleChanging = this.onScaleChanging.bind(this);\n\n  #boundOnRotationChanging = this.onRotationChanging.bind(this);\n\n  #previousStates = {\n    isEditing: false,\n    isEmpty: true,\n    hasSomethingToUndo: false,\n    hasSomethingToRedo: false,\n    hasSelectedEditor: false,\n  };\n\n  #translation = [0, 0];\n\n  #translationTimeoutId = null;\n\n  #container = null;\n\n  #viewer = null;\n\n  static TRANSLATE_SMALL = 1; // page units.\n\n  static TRANSLATE_BIG = 10; // page units.\n\n  static get _keyboardManager() {\n    const proto = AnnotationEditorUIManager.prototype;\n\n    const arrowChecker = self => {\n      // If the focused element is an input, we don't want to handle the arrow.\n      // For example, sliders can be controlled with the arrow keys.\n      return (\n        self.#container.contains(document.activeElement) &&\n        self.hasSomethingToControl()\n      );\n    };\n\n    const textInputChecker = (_self, { target: el }) => {\n      if (el instanceof HTMLInputElement) {\n        const { type } = el;\n        return type !== \"text\" && type !== \"number\";\n      }\n      return true;\n    };\n\n    const small = this.TRANSLATE_SMALL;\n    const big = this.TRANSLATE_BIG;\n\n    return shadow(\n      this,\n      \"_keyboardManager\",\n      new KeyboardManager([\n        [\n          [\"ctrl+a\", \"mac+meta+a\"],\n          proto.selectAll,\n          { checker: textInputChecker },\n        ],\n        [[\"ctrl+z\", \"mac+meta+z\"], proto.undo, { checker: textInputChecker }],\n        [\n          // On mac, depending of the OS version, the event.key is either \"z\" or\n          // \"Z\" when the user presses \"meta+shift+z\".\n          [\n            \"ctrl+y\",\n            \"ctrl+shift+z\",\n            \"mac+meta+shift+z\",\n            \"ctrl+shift+Z\",\n            \"mac+meta+shift+Z\",\n          ],\n          proto.redo,\n          { checker: textInputChecker },\n        ],\n        [\n          [\n            \"Backspace\",\n            \"alt+Backspace\",\n            \"ctrl+Backspace\",\n            \"shift+Backspace\",\n            \"mac+Backspace\",\n            \"mac+alt+Backspace\",\n            \"mac+ctrl+Backspace\",\n            \"Delete\",\n            \"ctrl+Delete\",\n            \"shift+Delete\",\n            \"mac+Delete\",\n          ],\n          proto.delete,\n          { checker: textInputChecker },\n        ],\n        [\n          [\"Enter\", \"mac+Enter\"],\n          proto.addNewEditorFromKeyboard,\n          {\n            // Those shortcuts can be used in the toolbar for some other actions\n            // like zooming, hence we need to check if the container has the\n            // focus.\n            checker: (self, { target: el }) =>\n              !(el instanceof HTMLButtonElement) &&\n              self.#container.contains(el) &&\n              !self.isEnterHandled,\n          },\n        ],\n        [\n          [\" \", \"mac+ \"],\n          proto.addNewEditorFromKeyboard,\n          {\n            // Those shortcuts can be used in the toolbar for some other actions\n            // like zooming, hence we need to check if the container has the\n            // focus.\n            checker: self => self.#container.contains(document.activeElement),\n          },\n        ],\n        [[\"Escape\", \"mac+Escape\"], proto.unselectAll],\n        [\n          [\"ArrowLeft\", \"mac+ArrowLeft\"],\n          proto.translateSelectedEditors,\n          { args: [-small, 0], checker: arrowChecker },\n        ],\n        [\n          [\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"],\n          proto.translateSelectedEditors,\n          { args: [-big, 0], checker: arrowChecker },\n        ],\n        [\n          [\"ArrowRight\", \"mac+ArrowRight\"],\n          proto.translateSelectedEditors,\n          { args: [small, 0], checker: arrowChecker },\n        ],\n        [\n          [\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"],\n          proto.translateSelectedEditors,\n          { args: [big, 0], checker: arrowChecker },\n        ],\n        [\n          [\"ArrowUp\", \"mac+ArrowUp\"],\n          proto.translateSelectedEditors,\n          { args: [0, -small], checker: arrowChecker },\n        ],\n        [\n          [\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"],\n          proto.translateSelectedEditors,\n          { args: [0, -big], checker: arrowChecker },\n        ],\n        [\n          [\"ArrowDown\", \"mac+ArrowDown\"],\n          proto.translateSelectedEditors,\n          { args: [0, small], checker: arrowChecker },\n        ],\n        [\n          [\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"],\n          proto.translateSelectedEditors,\n          { args: [0, big], checker: arrowChecker },\n        ],\n      ])\n    );\n  }\n\n  constructor(\n    container,\n    viewer,\n    altTextManager,\n    eventBus,\n    pdfDocument,\n    pageColors\n  ) {\n    this.#container = container;\n    this.#viewer = viewer;\n    this.#altTextManager = altTextManager;\n    this._eventBus = eventBus;\n    this._eventBus._on(\"editingaction\", this.#boundOnEditingAction);\n    this._eventBus._on(\"pagechanging\", this.#boundOnPageChanging);\n    this._eventBus._on(\"scalechanging\", this.#boundOnScaleChanging);\n    this._eventBus._on(\"rotationchanging\", this.#boundOnRotationChanging);\n    this.#annotationStorage = pdfDocument.annotationStorage;\n    this.#filterFactory = pdfDocument.filterFactory;\n    this.#pageColors = pageColors;\n    this.viewParameters = {\n      realScale: PixelsPerInch.PDF_TO_CSS_UNITS,\n      rotation: 0,\n    };\n  }\n\n  destroy() {\n    this.#removeKeyboardManager();\n    this.#removeFocusManager();\n    this._eventBus._off(\"editingaction\", this.#boundOnEditingAction);\n    this._eventBus._off(\"pagechanging\", this.#boundOnPageChanging);\n    this._eventBus._off(\"scalechanging\", this.#boundOnScaleChanging);\n    this._eventBus._off(\"rotationchanging\", this.#boundOnRotationChanging);\n    for (const layer of this.#allLayers.values()) {\n      layer.destroy();\n    }\n    this.#allLayers.clear();\n    this.#allEditors.clear();\n    this.#editorsToRescale.clear();\n    this.#activeEditor = null;\n    this.#selectedEditors.clear();\n    this.#commandManager.destroy();\n    this.#altTextManager.destroy();\n    if (this.#focusMainContainerTimeoutId) {\n      clearTimeout(this.#focusMainContainerTimeoutId);\n      this.#focusMainContainerTimeoutId = null;\n    }\n    if (this.#translationTimeoutId) {\n      clearTimeout(this.#translationTimeoutId);\n      this.#translationTimeoutId = null;\n    }\n  }\n\n  get hcmFilter() {\n    return shadow(\n      this,\n      \"hcmFilter\",\n      this.#pageColors\n        ? this.#filterFactory.addHCMFilter(\n            this.#pageColors.foreground,\n            this.#pageColors.background\n          )\n        : \"none\"\n    );\n  }\n\n  get direction() {\n    return shadow(\n      this,\n      \"direction\",\n      getComputedStyle(this.#container).direction\n    );\n  }\n\n  editAltText(editor) {\n    this.#altTextManager?.editAltText(this, editor);\n  }\n\n  onPageChanging({ pageNumber }) {\n    this.#currentPageIndex = pageNumber - 1;\n  }\n\n  focusMainContainer() {\n    this.#container.focus();\n  }\n\n  findParent(x, y) {\n    for (const layer of this.#allLayers.values()) {\n      const {\n        x: layerX,\n        y: layerY,\n        width,\n        height,\n      } = layer.div.getBoundingClientRect();\n      if (\n        x >= layerX &&\n        x <= layerX + width &&\n        y >= layerY &&\n        y <= layerY + height\n      ) {\n        return layer;\n      }\n    }\n    return null;\n  }\n\n  disableUserSelect(value = false) {\n    this.#viewer.classList.toggle(\"noUserSelect\", value);\n  }\n\n  addShouldRescale(editor) {\n    this.#editorsToRescale.add(editor);\n  }\n\n  removeShouldRescale(editor) {\n    this.#editorsToRescale.delete(editor);\n  }\n\n  onScaleChanging({ scale }) {\n    this.commitOrRemove();\n    this.viewParameters.realScale = scale * PixelsPerInch.PDF_TO_CSS_UNITS;\n    for (const editor of this.#editorsToRescale) {\n      editor.onScaleChanging();\n    }\n  }\n\n  onRotationChanging({ pagesRotation }) {\n    this.commitOrRemove();\n    this.viewParameters.rotation = pagesRotation;\n  }\n\n  /**\n   * Add an editor in the annotation storage.\n   * @param {AnnotationEditor} editor\n   */\n  addToAnnotationStorage(editor) {\n    if (\n      !editor.isEmpty() &&\n      this.#annotationStorage &&\n      !this.#annotationStorage.has(editor.id)\n    ) {\n      this.#annotationStorage.setValue(editor.id, editor);\n    }\n  }\n\n  #addFocusManager() {\n    window.addEventListener(\"focus\", this.#boundFocus);\n    window.addEventListener(\"blur\", this.#boundBlur);\n  }\n\n  #removeFocusManager() {\n    window.removeEventListener(\"focus\", this.#boundFocus);\n    window.removeEventListener(\"blur\", this.#boundBlur);\n  }\n\n  blur() {\n    if (!this.hasSelection) {\n      return;\n    }\n    // When several editors are selected and the window loses focus, we want to\n    // keep the last active element in order to be able to focus it again when\n    // the window gets the focus back but we don't want to trigger any focus\n    // callbacks else only one editor will be selected.\n    const { activeElement } = document;\n    for (const editor of this.#selectedEditors) {\n      if (editor.div.contains(activeElement)) {\n        this.#lastActiveElement = [editor, activeElement];\n        editor._focusEventsAllowed = false;\n        break;\n      }\n    }\n  }\n\n  focus() {\n    if (!this.#lastActiveElement) {\n      return;\n    }\n    const [lastEditor, lastActiveElement] = this.#lastActiveElement;\n    this.#lastActiveElement = null;\n    lastActiveElement.addEventListener(\n      \"focusin\",\n      () => {\n        lastEditor._focusEventsAllowed = true;\n      },\n      { once: true }\n    );\n    lastActiveElement.focus();\n  }\n\n  #addKeyboardManager() {\n    // The keyboard events are caught at the container level in order to be able\n    // to execute some callbacks even if the current page doesn't have focus.\n    window.addEventListener(\"keydown\", this.#boundKeydown);\n  }\n\n  #removeKeyboardManager() {\n    window.removeEventListener(\"keydown\", this.#boundKeydown);\n  }\n\n  #addCopyPasteListeners() {\n    document.addEventListener(\"copy\", this.#boundCopy);\n    document.addEventListener(\"cut\", this.#boundCut);\n    document.addEventListener(\"paste\", this.#boundPaste);\n  }\n\n  #removeCopyPasteListeners() {\n    document.removeEventListener(\"copy\", this.#boundCopy);\n    document.removeEventListener(\"cut\", this.#boundCut);\n    document.removeEventListener(\"paste\", this.#boundPaste);\n  }\n\n  addEditListeners() {\n    this.#addKeyboardManager();\n    this.#addCopyPasteListeners();\n  }\n\n  removeEditListeners() {\n    this.#removeKeyboardManager();\n    this.#removeCopyPasteListeners();\n  }\n\n  /**\n   * Copy callback.\n   * @param {ClipboardEvent} event\n   */\n  copy(event) {\n    event.preventDefault();\n\n    // An editor is being edited so just commit it.\n    this.#activeEditor?.commitOrRemove();\n\n    if (!this.hasSelection) {\n      return;\n    }\n\n    const editors = [];\n    for (const editor of this.#selectedEditors) {\n      const serialized = editor.serialize(/* isForCopying = */ true);\n      if (serialized) {\n        editors.push(serialized);\n      }\n    }\n    if (editors.length === 0) {\n      return;\n    }\n\n    event.clipboardData.setData(\"application/pdfjs\", JSON.stringify(editors));\n  }\n\n  /**\n   * Cut callback.\n   * @param {ClipboardEvent} event\n   */\n  cut(event) {\n    this.copy(event);\n    this.delete();\n  }\n\n  /**\n   * Paste callback.\n   * @param {ClipboardEvent} event\n   */\n  paste(event) {\n    event.preventDefault();\n    const { clipboardData } = event;\n    for (const item of clipboardData.items) {\n      for (const editorType of this.#editorTypes) {\n        if (editorType.isHandlingMimeForPasting(item.type)) {\n          editorType.paste(item, this.currentLayer);\n          return;\n        }\n      }\n    }\n\n    let data = clipboardData.getData(\"application/pdfjs\");\n    if (!data) {\n      return;\n    }\n\n    try {\n      data = JSON.parse(data);\n    } catch (ex) {\n      warn(`paste: \"${ex.message}\".`);\n      return;\n    }\n\n    if (!Array.isArray(data)) {\n      return;\n    }\n\n    this.unselectAll();\n    const layer = this.currentLayer;\n\n    try {\n      const newEditors = [];\n      for (const editor of data) {\n        const deserializedEditor = layer.deserialize(editor);\n        if (!deserializedEditor) {\n          return;\n        }\n        newEditors.push(deserializedEditor);\n      }\n\n      const cmd = () => {\n        for (const editor of newEditors) {\n          this.#addEditorToLayer(editor);\n        }\n        this.#selectEditors(newEditors);\n      };\n      const undo = () => {\n        for (const editor of newEditors) {\n          editor.remove();\n        }\n      };\n      this.addCommands({ cmd, undo, mustExec: true });\n    } catch (ex) {\n      warn(`paste: \"${ex.message}\".`);\n    }\n  }\n\n  /**\n   * Keydown callback.\n   * @param {KeyboardEvent} event\n   */\n  keydown(event) {\n    if (!this.isEditorHandlingKeyboard) {\n      AnnotationEditorUIManager._keyboardManager.exec(this, event);\n    }\n  }\n\n  /**\n   * Execute an action for a given name.\n   * For example, the user can click on the \"Undo\" entry in the context menu\n   * and it'll trigger the undo action.\n   * @param {Object} details\n   */\n  onEditingAction(details) {\n    if ([\"undo\", \"redo\", \"delete\", \"selectAll\"].includes(details.name)) {\n      this[details.name]();\n    }\n  }\n\n  /**\n   * Update the different possible states of this manager, e.g. is there\n   * something to undo, redo, ...\n   * @param {Object} details\n   */\n  #dispatchUpdateStates(details) {\n    const hasChanged = Object.entries(details).some(\n      ([key, value]) => this.#previousStates[key] !== value\n    );\n\n    if (hasChanged) {\n      this._eventBus.dispatch(\"annotationeditorstateschanged\", {\n        source: this,\n        details: Object.assign(this.#previousStates, details),\n      });\n    }\n  }\n\n  #dispatchUpdateUI(details) {\n    this._eventBus.dispatch(\"annotationeditorparamschanged\", {\n      source: this,\n      details,\n    });\n  }\n\n  /**\n   * Set the editing state.\n   * It can be useful to temporarily disable it when the user is editing a\n   * FreeText annotation.\n   * @param {boolean} isEditing\n   */\n  setEditingState(isEditing) {\n    if (isEditing) {\n      this.#addFocusManager();\n      this.#addKeyboardManager();\n      this.#addCopyPasteListeners();\n      this.#dispatchUpdateStates({\n        isEditing: this.#mode !== AnnotationEditorType.NONE,\n        isEmpty: this.#isEmpty(),\n        hasSomethingToUndo: this.#commandManager.hasSomethingToUndo(),\n        hasSomethingToRedo: this.#commandManager.hasSomethingToRedo(),\n        hasSelectedEditor: false,\n      });\n    } else {\n      this.#removeFocusManager();\n      this.#removeKeyboardManager();\n      this.#removeCopyPasteListeners();\n      this.#dispatchUpdateStates({\n        isEditing: false,\n      });\n      this.disableUserSelect(false);\n    }\n  }\n\n  registerEditorTypes(types) {\n    if (this.#editorTypes) {\n      return;\n    }\n    this.#editorTypes = types;\n    for (const editorType of this.#editorTypes) {\n      this.#dispatchUpdateUI(editorType.defaultPropertiesToUpdate);\n    }\n  }\n\n  /**\n   * Get an id.\n   * @returns {string}\n   */\n  getId() {\n    return this.#idManager.getId();\n  }\n\n  get currentLayer() {\n    return this.#allLayers.get(this.#currentPageIndex);\n  }\n\n  getLayer(pageIndex) {\n    return this.#allLayers.get(pageIndex);\n  }\n\n  get currentPageIndex() {\n    return this.#currentPageIndex;\n  }\n\n  /**\n   * Add a new layer for a page which will contains the editors.\n   * @param {AnnotationEditorLayer} layer\n   */\n  addLayer(layer) {\n    this.#allLayers.set(layer.pageIndex, layer);\n    if (this.#isEnabled) {\n      layer.enable();\n    } else {\n      layer.disable();\n    }\n  }\n\n  /**\n   * Remove a layer.\n   * @param {AnnotationEditorLayer} layer\n   */\n  removeLayer(layer) {\n    this.#allLayers.delete(layer.pageIndex);\n  }\n\n  /**\n   * Change the editor mode (None, FreeText, Ink, ...)\n   * @param {number} mode\n   * @param {string|null} editId\n   * @param {boolean} [isFromKeyboard] - true if the mode change is due to a\n   *   keyboard action.\n   */\n  updateMode(mode, editId = null, isFromKeyboard = false) {\n    if (this.#mode === mode) {\n      return;\n    }\n    this.#mode = mode;\n    if (mode === AnnotationEditorType.NONE) {\n      this.setEditingState(false);\n      this.#disableAll();\n      return;\n    }\n    this.setEditingState(true);\n    this.#enableAll();\n    this.unselectAll();\n    for (const layer of this.#allLayers.values()) {\n      layer.updateMode(mode);\n    }\n    if (!editId && isFromKeyboard) {\n      this.addNewEditorFromKeyboard();\n      return;\n    }\n\n    if (!editId) {\n      return;\n    }\n    for (const editor of this.#allEditors.values()) {\n      if (editor.annotationElementId === editId) {\n        this.setSelected(editor);\n        editor.enterInEditMode();\n        break;\n      }\n    }\n  }\n\n  addNewEditorFromKeyboard() {\n    this.currentLayer.addNewEditor();\n  }\n\n  /**\n   * Update the toolbar if it's required to reflect the tool currently used.\n   * @param {number} mode\n   * @returns {undefined}\n   */\n  updateToolbar(mode) {\n    if (mode === this.#mode) {\n      return;\n    }\n    this._eventBus.dispatch(\"switchannotationeditormode\", {\n      source: this,\n      mode,\n    });\n  }\n\n  /**\n   * Update a parameter in the current editor or globally.\n   * @param {number} type\n   * @param {*} value\n   */\n  updateParams(type, value) {\n    if (!this.#editorTypes) {\n      return;\n    }\n    if (type === AnnotationEditorParamsType.CREATE) {\n      this.currentLayer.addNewEditor();\n      return;\n    }\n\n    for (const editor of this.#selectedEditors) {\n      editor.updateParams(type, value);\n    }\n\n    for (const editorType of this.#editorTypes) {\n      editorType.updateDefaultParams(type, value);\n    }\n  }\n\n  enableWaiting(mustWait = false) {\n    if (this.#isWaiting === mustWait) {\n      return;\n    }\n    this.#isWaiting = mustWait;\n    for (const layer of this.#allLayers.values()) {\n      if (mustWait) {\n        layer.disableClick();\n      } else {\n        layer.enableClick();\n      }\n      layer.div.classList.toggle(\"waiting\", mustWait);\n    }\n  }\n\n  /**\n   * Enable all the layers.\n   */\n  #enableAll() {\n    if (!this.#isEnabled) {\n      this.#isEnabled = true;\n      for (const layer of this.#allLayers.values()) {\n        layer.enable();\n      }\n    }\n  }\n\n  /**\n   * Disable all the layers.\n   */\n  #disableAll() {\n    this.unselectAll();\n    if (this.#isEnabled) {\n      this.#isEnabled = false;\n      for (const layer of this.#allLayers.values()) {\n        layer.disable();\n      }\n    }\n  }\n\n  /**\n   * Get all the editors belonging to a given page.\n   * @param {number} pageIndex\n   * @returns {Array<AnnotationEditor>}\n   */\n  getEditors(pageIndex) {\n    const editors = [];\n    for (const editor of this.#allEditors.values()) {\n      if (editor.pageIndex === pageIndex) {\n        editors.push(editor);\n      }\n    }\n    return editors;\n  }\n\n  /**\n   * Get an editor with the given id.\n   * @param {string} id\n   * @returns {AnnotationEditor}\n   */\n  getEditor(id) {\n    return this.#allEditors.get(id);\n  }\n\n  /**\n   * Add a new editor.\n   * @param {AnnotationEditor} editor\n   */\n  addEditor(editor) {\n    this.#allEditors.set(editor.id, editor);\n  }\n\n  /**\n   * Remove an editor.\n   * @param {AnnotationEditor} editor\n   */\n  removeEditor(editor) {\n    if (editor.div.contains(document.activeElement)) {\n      if (this.#focusMainContainerTimeoutId) {\n        clearTimeout(this.#focusMainContainerTimeoutId);\n      }\n      this.#focusMainContainerTimeoutId = setTimeout(() => {\n        // When the div is removed from DOM the focus can move on the\n        // document.body, so we need to move it back to the main container.\n        this.focusMainContainer();\n        this.#focusMainContainerTimeoutId = null;\n      }, 0);\n    }\n    this.#allEditors.delete(editor.id);\n    this.unselect(editor);\n    if (\n      !editor.annotationElementId ||\n      !this.#deletedAnnotationsElementIds.has(editor.annotationElementId)\n    ) {\n      this.#annotationStorage?.remove(editor.id);\n    }\n  }\n\n  /**\n   * The annotation element with the given id has been deleted.\n   * @param {AnnotationEditor} editor\n   */\n  addDeletedAnnotationElement(editor) {\n    this.#deletedAnnotationsElementIds.add(editor.annotationElementId);\n    editor.deleted = true;\n  }\n\n  /**\n   * Check if the annotation element with the given id has been deleted.\n   * @param {string} annotationElementId\n   * @returns {boolean}\n   */\n  isDeletedAnnotationElement(annotationElementId) {\n    return this.#deletedAnnotationsElementIds.has(annotationElementId);\n  }\n\n  /**\n   * The annotation element with the given id have been restored.\n   * @param {AnnotationEditor} editor\n   */\n  removeDeletedAnnotationElement(editor) {\n    this.#deletedAnnotationsElementIds.delete(editor.annotationElementId);\n    editor.deleted = false;\n  }\n\n  /**\n   * Add an editor to the layer it belongs to or add it to the global map.\n   * @param {AnnotationEditor} editor\n   */\n  #addEditorToLayer(editor) {\n    const layer = this.#allLayers.get(editor.pageIndex);\n    if (layer) {\n      layer.addOrRebuild(editor);\n    } else {\n      this.addEditor(editor);\n    }\n  }\n\n  /**\n   * Set the given editor as the active one.\n   * @param {AnnotationEditor} editor\n   */\n  setActiveEditor(editor) {\n    if (this.#activeEditor === editor) {\n      return;\n    }\n\n    this.#activeEditor = editor;\n    if (editor) {\n      this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    }\n  }\n\n  /**\n   * Add or remove an editor the current selection.\n   * @param {AnnotationEditor} editor\n   */\n  toggleSelected(editor) {\n    if (this.#selectedEditors.has(editor)) {\n      this.#selectedEditors.delete(editor);\n      editor.unselect();\n      this.#dispatchUpdateStates({\n        hasSelectedEditor: this.hasSelection,\n      });\n      return;\n    }\n    this.#selectedEditors.add(editor);\n    editor.select();\n    this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: true,\n    });\n  }\n\n  /**\n   * Set the last selected editor.\n   * @param {AnnotationEditor} editor\n   */\n  setSelected(editor) {\n    for (const ed of this.#selectedEditors) {\n      if (ed !== editor) {\n        ed.unselect();\n      }\n    }\n    this.#selectedEditors.clear();\n\n    this.#selectedEditors.add(editor);\n    editor.select();\n    this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: true,\n    });\n  }\n\n  /**\n   * Check if the editor is selected.\n   * @param {AnnotationEditor} editor\n   */\n  isSelected(editor) {\n    return this.#selectedEditors.has(editor);\n  }\n\n  get firstSelectedEditor() {\n    return this.#selectedEditors.values().next().value;\n  }\n\n  /**\n   * Unselect an editor.\n   * @param {AnnotationEditor} editor\n   */\n  unselect(editor) {\n    editor.unselect();\n    this.#selectedEditors.delete(editor);\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: this.hasSelection,\n    });\n  }\n\n  get hasSelection() {\n    return this.#selectedEditors.size !== 0;\n  }\n\n  get isEnterHandled() {\n    return (\n      this.#selectedEditors.size === 1 &&\n      this.firstSelectedEditor.isEnterHandled\n    );\n  }\n\n  /**\n   * Undo the last command.\n   */\n  undo() {\n    this.#commandManager.undo();\n    this.#dispatchUpdateStates({\n      hasSomethingToUndo: this.#commandManager.hasSomethingToUndo(),\n      hasSomethingToRedo: true,\n      isEmpty: this.#isEmpty(),\n    });\n  }\n\n  /**\n   * Redo the last undoed command.\n   */\n  redo() {\n    this.#commandManager.redo();\n    this.#dispatchUpdateStates({\n      hasSomethingToUndo: true,\n      hasSomethingToRedo: this.#commandManager.hasSomethingToRedo(),\n      isEmpty: this.#isEmpty(),\n    });\n  }\n\n  /**\n   * Add a command to execute (cmd) and another one to undo it.\n   * @param {Object} params\n   */\n  addCommands(params) {\n    this.#commandManager.add(params);\n    this.#dispatchUpdateStates({\n      hasSomethingToUndo: true,\n      hasSomethingToRedo: false,\n      isEmpty: this.#isEmpty(),\n    });\n  }\n\n  #isEmpty() {\n    if (this.#allEditors.size === 0) {\n      return true;\n    }\n\n    if (this.#allEditors.size === 1) {\n      for (const editor of this.#allEditors.values()) {\n        return editor.isEmpty();\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Delete the current editor or all.\n   */\n  delete() {\n    this.commitOrRemove();\n    if (!this.hasSelection) {\n      return;\n    }\n\n    const editors = [...this.#selectedEditors];\n    const cmd = () => {\n      for (const editor of editors) {\n        editor.remove();\n      }\n    };\n    const undo = () => {\n      for (const editor of editors) {\n        this.#addEditorToLayer(editor);\n      }\n    };\n\n    this.addCommands({ cmd, undo, mustExec: true });\n  }\n\n  commitOrRemove() {\n    // An editor is being edited so just commit it.\n    this.#activeEditor?.commitOrRemove();\n  }\n\n  hasSomethingToControl() {\n    return this.#activeEditor || this.hasSelection;\n  }\n\n  /**\n   * Select the editors.\n   * @param {Array<AnnotationEditor>} editors\n   */\n  #selectEditors(editors) {\n    this.#selectedEditors.clear();\n    for (const editor of editors) {\n      if (editor.isEmpty()) {\n        continue;\n      }\n      this.#selectedEditors.add(editor);\n      editor.select();\n    }\n    this.#dispatchUpdateStates({ hasSelectedEditor: true });\n  }\n\n  /**\n   * Select all the editors.\n   */\n  selectAll() {\n    for (const editor of this.#selectedEditors) {\n      editor.commit();\n    }\n    this.#selectEditors(this.#allEditors.values());\n  }\n\n  /**\n   * Unselect all the selected editors.\n   */\n  unselectAll() {\n    if (this.#activeEditor) {\n      // An editor is being edited so just commit it.\n      this.#activeEditor.commitOrRemove();\n      return;\n    }\n\n    if (!this.hasSelection) {\n      return;\n    }\n    for (const editor of this.#selectedEditors) {\n      editor.unselect();\n    }\n    this.#selectedEditors.clear();\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: false,\n    });\n  }\n\n  translateSelectedEditors(x, y, noCommit = false) {\n    if (!noCommit) {\n      this.commitOrRemove();\n    }\n    if (!this.hasSelection) {\n      return;\n    }\n\n    this.#translation[0] += x;\n    this.#translation[1] += y;\n    const [totalX, totalY] = this.#translation;\n    const editors = [...this.#selectedEditors];\n\n    // We don't want to have an undo/redo for each translation so we wait a bit\n    // before adding the command to the command manager.\n    const TIME_TO_WAIT = 1000;\n\n    if (this.#translationTimeoutId) {\n      clearTimeout(this.#translationTimeoutId);\n    }\n\n    this.#translationTimeoutId = setTimeout(() => {\n      this.#translationTimeoutId = null;\n      this.#translation[0] = this.#translation[1] = 0;\n\n      this.addCommands({\n        cmd: () => {\n          for (const editor of editors) {\n            if (this.#allEditors.has(editor.id)) {\n              editor.translateInPage(totalX, totalY);\n            }\n          }\n        },\n        undo: () => {\n          for (const editor of editors) {\n            if (this.#allEditors.has(editor.id)) {\n              editor.translateInPage(-totalX, -totalY);\n            }\n          }\n        },\n        mustExec: false,\n      });\n    }, TIME_TO_WAIT);\n\n    for (const editor of editors) {\n      editor.translateInPage(x, y);\n    }\n  }\n\n  /**\n   * Set up the drag session for moving the selected editors.\n   */\n  setUpDragSession() {\n    // Note: don't use any references to the editor's parent which can be null\n    // if the editor belongs to a destroyed page.\n    if (!this.hasSelection) {\n      return;\n    }\n    // Avoid to have spurious text selection in the text layer when dragging.\n    this.disableUserSelect(true);\n    this.#draggingEditors = new Map();\n    for (const editor of this.#selectedEditors) {\n      this.#draggingEditors.set(editor, {\n        savedX: editor.x,\n        savedY: editor.y,\n        savedPageIndex: editor.pageIndex,\n        newX: 0,\n        newY: 0,\n        newPageIndex: -1,\n      });\n    }\n  }\n\n  /**\n   * Ends the drag session.\n   * @returns {boolean} true if at least one editor has been moved.\n   */\n  endDragSession() {\n    if (!this.#draggingEditors) {\n      return false;\n    }\n    this.disableUserSelect(false);\n    const map = this.#draggingEditors;\n    this.#draggingEditors = null;\n    let mustBeAddedInUndoStack = false;\n\n    for (const [{ x, y, pageIndex }, value] of map) {\n      value.newX = x;\n      value.newY = y;\n      value.newPageIndex = pageIndex;\n      mustBeAddedInUndoStack ||=\n        x !== value.savedX ||\n        y !== value.savedY ||\n        pageIndex !== value.savedPageIndex;\n    }\n\n    if (!mustBeAddedInUndoStack) {\n      return false;\n    }\n\n    const move = (editor, x, y, pageIndex) => {\n      if (this.#allEditors.has(editor.id)) {\n        // The editor can be undone/redone on a page which is not visible (and\n        // which potentially has no annotation editor layer), hence we need to\n        // use the pageIndex instead of the parent.\n        const parent = this.#allLayers.get(pageIndex);\n        if (parent) {\n          editor._setParentAndPosition(parent, x, y);\n        } else {\n          editor.pageIndex = pageIndex;\n          editor.x = x;\n          editor.y = y;\n        }\n      }\n    };\n\n    this.addCommands({\n      cmd: () => {\n        for (const [editor, { newX, newY, newPageIndex }] of map) {\n          move(editor, newX, newY, newPageIndex);\n        }\n      },\n      undo: () => {\n        for (const [editor, { savedX, savedY, savedPageIndex }] of map) {\n          move(editor, savedX, savedY, savedPageIndex);\n        }\n      },\n      mustExec: true,\n    });\n\n    return true;\n  }\n\n  /**\n   * Drag the set of selected editors.\n   * @param {number} tx\n   * @param {number} ty\n   */\n  dragSelectedEditors(tx, ty) {\n    if (!this.#draggingEditors) {\n      return;\n    }\n    for (const editor of this.#draggingEditors.keys()) {\n      editor.drag(tx, ty);\n    }\n  }\n\n  /**\n   * Rebuild the editor (usually on undo/redo actions) on a potentially\n   * non-rendered page.\n   * @param {AnnotationEditor} editor\n   */\n  rebuild(editor) {\n    if (editor.parent === null) {\n      const parent = this.getLayer(editor.pageIndex);\n      if (parent) {\n        parent.changeParent(editor);\n        parent.addOrRebuild(editor);\n      } else {\n        this.addEditor(editor);\n        this.addToAnnotationStorage(editor);\n        editor.rebuild();\n      }\n    } else {\n      editor.parent.addOrRebuild(editor);\n    }\n  }\n\n  get isEditorHandlingKeyboard() {\n    return (\n      this.getActive()?.shouldGetKeyboardEvents() ||\n      (this.#selectedEditors.size === 1 &&\n        this.firstSelectedEditor.shouldGetKeyboardEvents())\n    );\n  }\n\n  /**\n   * Is the current editor the one passed as argument?\n   * @param {AnnotationEditor} editor\n   * @returns\n   */\n  isActive(editor) {\n    return this.#activeEditor === editor;\n  }\n\n  /**\n   * Get the current active editor.\n   * @returns {AnnotationEditor|null}\n   */\n  getActive() {\n    return this.#activeEditor;\n  }\n\n  /**\n   * Get the current editor mode.\n   * @returns {number}\n   */\n  getMode() {\n    return this.#mode;\n  }\n\n  get imageManager() {\n    return shadow(this, \"imageManager\", new ImageManager());\n  }\n}\n\nexport {\n  AnnotationEditorUIManager,\n  bindEvents,\n  ColorManager,\n  CommandManager,\n  KeyboardManager,\n  opacityToHex,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  AbortException,\n  assert,\n  PromiseCapability,\n  warn,\n} from \"../shared/util.js\";\nimport {\n  createResponseStatusError,\n  extractFilenameFromHeader,\n  validateRangeRequestCapabilities,\n  validateResponseStatus,\n} from \"./network_utils.js\";\n\nif (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n  throw new Error(\n    'Module \"./fetch_stream.js\" shall not be used with MOZCENTRAL builds.'\n  );\n}\n\nfunction createFetchOptions(headers, withCredentials, abortController) {\n  return {\n    method: \"GET\",\n    headers,\n    signal: abortController.signal,\n    mode: \"cors\",\n    credentials: withCredentials ? \"include\" : \"same-origin\",\n    redirect: \"follow\",\n  };\n}\n\nfunction createHeaders(httpHeaders) {\n  const headers = new Headers();\n  for (const property in httpHeaders) {\n    const value = httpHeaders[property];\n    if (value === undefined) {\n      continue;\n    }\n    headers.append(property, value);\n  }\n  return headers;\n}\n\nfunction getArrayBuffer(val) {\n  if (val instanceof Uint8Array) {\n    return val.buffer;\n  }\n  if (val instanceof ArrayBuffer) {\n    return val;\n  }\n  warn(`getArrayBuffer - unexpected data format: ${val}`);\n  return new Uint8Array(val).buffer;\n}\n\n/** @implements {IPDFStream} */\nclass PDFFetchStream {\n  constructor(source) {\n    this.source = source;\n    this.isHttp = /^https?:/i.test(source.url);\n    this.httpHeaders = (this.isHttp && source.httpHeaders) || {};\n\n    this._fullRequestReader = null;\n    this._rangeRequestReaders = [];\n  }\n\n  get _progressiveDataLength() {\n    return this._fullRequestReader?._loaded ?? 0;\n  }\n\n  getFullReader() {\n    assert(\n      !this._fullRequestReader,\n      \"PDFFetchStream.getFullReader can only be called once.\"\n    );\n    this._fullRequestReader = new PDFFetchStreamReader(this);\n    return this._fullRequestReader;\n  }\n\n  getRangeReader(begin, end) {\n    if (end <= this._progressiveDataLength) {\n      return null;\n    }\n    const reader = new PDFFetchStreamRangeReader(this, begin, end);\n    this._rangeRequestReaders.push(reader);\n    return reader;\n  }\n\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n\n    for (const reader of this._rangeRequestReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n  }\n}\n\n/** @implements {IPDFStreamReader} */\nclass PDFFetchStreamReader {\n  constructor(stream) {\n    this._stream = stream;\n    this._reader = null;\n    this._loaded = 0;\n    this._filename = null;\n    const source = stream.source;\n    this._withCredentials = source.withCredentials || false;\n    this._contentLength = source.length;\n    this._headersCapability = new PromiseCapability();\n    this._disableRange = source.disableRange || false;\n    this._rangeChunkSize = source.rangeChunkSize;\n    if (!this._rangeChunkSize && !this._disableRange) {\n      this._disableRange = true;\n    }\n\n    this._abortController = new AbortController();\n    this._isStreamingSupported = !source.disableStream;\n    this._isRangeSupported = !source.disableRange;\n\n    this._headers = createHeaders(this._stream.httpHeaders);\n\n    const url = source.url;\n    fetch(\n      url,\n      createFetchOptions(\n        this._headers,\n        this._withCredentials,\n        this._abortController\n      )\n    )\n      .then(response => {\n        if (!validateResponseStatus(response.status)) {\n          throw createResponseStatusError(response.status, url);\n        }\n        this._reader = response.body.getReader();\n        this._headersCapability.resolve();\n\n        const getResponseHeader = name => {\n          return response.headers.get(name);\n        };\n        const { allowRangeRequests, suggestedLength } =\n          validateRangeRequestCapabilities({\n            getResponseHeader,\n            isHttp: this._stream.isHttp,\n            rangeChunkSize: this._rangeChunkSize,\n            disableRange: this._disableRange,\n          });\n\n        this._isRangeSupported = allowRangeRequests;\n        // Setting right content length.\n        this._contentLength = suggestedLength || this._contentLength;\n\n        this._filename = extractFilenameFromHeader(getResponseHeader);\n\n        // We need to stop reading when range is supported and streaming is\n        // disabled.\n        if (!this._isStreamingSupported && this._isRangeSupported) {\n          this.cancel(new AbortException(\"Streaming is disabled.\"));\n        }\n      })\n      .catch(this._headersCapability.reject);\n\n    this.onProgress = null;\n  }\n\n  get headersReady() {\n    return this._headersCapability.promise;\n  }\n\n  get filename() {\n    return this._filename;\n  }\n\n  get contentLength() {\n    return this._contentLength;\n  }\n\n  get isRangeSupported() {\n    return this._isRangeSupported;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  async read() {\n    await this._headersCapability.promise;\n    const { value, done } = await this._reader.read();\n    if (done) {\n      return { value, done };\n    }\n    this._loaded += value.byteLength;\n    this.onProgress?.({\n      loaded: this._loaded,\n      total: this._contentLength,\n    });\n\n    return { value: getArrayBuffer(value), done: false };\n  }\n\n  cancel(reason) {\n    this._reader?.cancel(reason);\n    this._abortController.abort();\n  }\n}\n\n/** @implements {IPDFStreamRangeReader} */\nclass PDFFetchStreamRangeReader {\n  constructor(stream, begin, end) {\n    this._stream = stream;\n    this._reader = null;\n    this._loaded = 0;\n    const source = stream.source;\n    this._withCredentials = source.withCredentials || false;\n    this._readCapability = new PromiseCapability();\n    this._isStreamingSupported = !source.disableStream;\n\n    this._abortController = new AbortController();\n    this._headers = createHeaders(this._stream.httpHeaders);\n    this._headers.append(\"Range\", `bytes=${begin}-${end - 1}`);\n\n    const url = source.url;\n    fetch(\n      url,\n      createFetchOptions(\n        this._headers,\n        this._withCredentials,\n        this._abortController\n      )\n    )\n      .then(response => {\n        if (!validateResponseStatus(response.status)) {\n          throw createResponseStatusError(response.status, url);\n        }\n        this._readCapability.resolve();\n        this._reader = response.body.getReader();\n      })\n      .catch(this._readCapability.reject);\n\n    this.onProgress = null;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  async read() {\n    await this._readCapability.promise;\n    const { value, done } = await this._reader.read();\n    if (done) {\n      return { value, done };\n    }\n    this._loaded += value.byteLength;\n    this.onProgress?.({ loaded: this._loaded });\n\n    return { value: getArrayBuffer(value), done: false };\n  }\n\n  cancel(reason) {\n    this._reader?.cancel(reason);\n    this._abortController.abort();\n  }\n}\n\nexport { PDFFetchStream };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  assert,\n  bytesToString,\n  FeatureTest,\n  isNodeJS,\n  shadow,\n  string32,\n  unreachable,\n  warn,\n} from \"../shared/util.js\";\n\nclass FontLoader {\n  #systemFonts = new Set();\n\n  constructor({\n    ownerDocument = globalThis.document,\n    styleElement = null, // For testing only.\n  }) {\n    this._document = ownerDocument;\n\n    this.nativeFontFaces = new Set();\n    this.styleElement =\n      typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")\n        ? styleElement\n        : null;\n\n    if (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"MOZCENTRAL\")) {\n      this.loadingRequests = [];\n      this.loadTestFontId = 0;\n    }\n  }\n\n  addNativeFontFace(nativeFontFace) {\n    this.nativeFontFaces.add(nativeFontFace);\n    this._document.fonts.add(nativeFontFace);\n  }\n\n  removeNativeFontFace(nativeFontFace) {\n    this.nativeFontFaces.delete(nativeFontFace);\n    this._document.fonts.delete(nativeFontFace);\n  }\n\n  insertRule(rule) {\n    if (!this.styleElement) {\n      this.styleElement = this._document.createElement(\"style\");\n      this._document.documentElement\n        .getElementsByTagName(\"head\")[0]\n        .append(this.styleElement);\n    }\n    const styleSheet = this.styleElement.sheet;\n    styleSheet.insertRule(rule, styleSheet.cssRules.length);\n  }\n\n  clear() {\n    for (const nativeFontFace of this.nativeFontFaces) {\n      this._document.fonts.delete(nativeFontFace);\n    }\n    this.nativeFontFaces.clear();\n    this.#systemFonts.clear();\n\n    if (this.styleElement) {\n      // Note: ChildNode.remove doesn't throw if the parentNode is undefined.\n      this.styleElement.remove();\n      this.styleElement = null;\n    }\n  }\n\n  async loadSystemFont({ systemFontInfo: info, _inspectFont }) {\n    if (!info || this.#systemFonts.has(info.loadedName)) {\n      return;\n    }\n    assert(\n      !this.disableFontFace,\n      \"loadSystemFont shouldn't be called when `disableFontFace` is set.\"\n    );\n\n    if (this.isFontLoadingAPISupported) {\n      const { loadedName, src, style } = info;\n      const fontFace = new FontFace(loadedName, src, style);\n      this.addNativeFontFace(fontFace);\n      try {\n        await fontFace.load();\n        this.#systemFonts.add(loadedName);\n        _inspectFont?.(info);\n      } catch {\n        warn(\n          `Cannot load system font: ${info.baseFontName}, installing it could help to improve PDF rendering.`\n        );\n\n        this.removeNativeFontFace(fontFace);\n      }\n      return;\n    }\n\n    unreachable(\n      \"Not implemented: loadSystemFont without the Font Loading API.\"\n    );\n  }\n\n  async bind(font) {\n    // Add the font to the DOM only once; skip if the font is already loaded.\n    if (font.attached || (font.missingFile && !font.systemFontInfo)) {\n      return;\n    }\n    font.attached = true;\n\n    if (font.systemFontInfo) {\n      await this.loadSystemFont(font);\n      return;\n    }\n\n    if (this.isFontLoadingAPISupported) {\n      const nativeFontFace = font.createNativeFontFace();\n      if (nativeFontFace) {\n        this.addNativeFontFace(nativeFontFace);\n        try {\n          await nativeFontFace.loaded;\n        } catch (ex) {\n          warn(`Failed to load font '${nativeFontFace.family}': '${ex}'.`);\n\n          // When font loading failed, fall back to the built-in font renderer.\n          font.disableFontFace = true;\n          throw ex;\n        }\n      }\n      return; // The font was, asynchronously, loaded.\n    }\n\n    // !this.isFontLoadingAPISupported\n    const rule = font.createFontFaceRule();\n    if (rule) {\n      this.insertRule(rule);\n\n      if (this.isSyncFontLoadingSupported) {\n        return; // The font was, synchronously, loaded.\n      }\n      if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n        throw new Error(\"Not implemented: async font loading\");\n      }\n      await new Promise(resolve => {\n        const request = this._queueLoadingCallback(resolve);\n        this._prepareFontLoadEvent(font, request);\n      });\n      // The font was, asynchronously, loaded.\n    }\n  }\n\n  get isFontLoadingAPISupported() {\n    const hasFonts = !!this._document?.fonts;\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      return shadow(\n        this,\n        \"isFontLoadingAPISupported\",\n        hasFonts && !this.styleElement\n      );\n    }\n    return shadow(this, \"isFontLoadingAPISupported\", hasFonts);\n  }\n\n  get isSyncFontLoadingSupported() {\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n      return shadow(this, \"isSyncFontLoadingSupported\", true);\n    }\n\n    let supported = false;\n    if (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"CHROME\")) {\n      if (isNodeJS) {\n        // Node.js - we can pretend that sync font loading is supported.\n        supported = true;\n      } else if (\n        typeof navigator !== \"undefined\" &&\n        typeof navigator?.userAgent === \"string\" &&\n        // User agent string sniffing is bad, but there is no reliable way to\n        // tell if the font is fully loaded and ready to be used with canvas.\n        /Mozilla\\/5.0.*?rv:\\d+.*? Gecko/.test(navigator.userAgent)\n      ) {\n        // Firefox, from version 14, supports synchronous font loading.\n        supported = true;\n      }\n    }\n    return shadow(this, \"isSyncFontLoadingSupported\", supported);\n  }\n\n  _queueLoadingCallback(callback) {\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n      throw new Error(\"Not implemented: _queueLoadingCallback\");\n    }\n\n    function completeRequest() {\n      assert(!request.done, \"completeRequest() cannot be called twice.\");\n      request.done = true;\n\n      // Sending all completed requests in order of how they were queued.\n      while (loadingRequests.length > 0 && loadingRequests[0].done) {\n        const otherRequest = loadingRequests.shift();\n        setTimeout(otherRequest.callback, 0);\n      }\n    }\n\n    const { loadingRequests } = this;\n    const request = {\n      done: false,\n      complete: completeRequest,\n      callback,\n    };\n    loadingRequests.push(request);\n    return request;\n  }\n\n  get _loadTestFont() {\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n      throw new Error(\"Not implemented: _loadTestFont\");\n    }\n\n    // This is a CFF font with 1 glyph for '.' that fills its entire width\n    // and height.\n    const testFont = atob(\n      \"T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQA\" +\n        \"FQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAA\" +\n        \"ALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgA\" +\n        \"AAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1\" +\n        \"AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD\" +\n        \"6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACM\" +\n        \"AooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4D\" +\n        \"IP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAA\" +\n        \"AAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUA\" +\n        \"AQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgAB\" +\n        \"AAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABY\" +\n        \"AAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAA\" +\n        \"AC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" +\n        \"AAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" +\n        \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" +\n        \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" +\n        \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" +\n        \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAA\" +\n        \"AAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQAC\" +\n        \"AQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3\" +\n        \"Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTj\" +\n        \"FQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==\"\n    );\n    return shadow(this, \"_loadTestFont\", testFont);\n  }\n\n  _prepareFontLoadEvent(font, request) {\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n      throw new Error(\"Not implemented: _prepareFontLoadEvent\");\n    }\n\n    /** Hack begin */\n    // There's currently no event when a font has finished downloading so the\n    // following code is a dirty hack to 'guess' when a font is ready.\n    // It's assumed fonts are loaded in order, so add a known test font after\n    // the desired fonts and then test for the loading of that test font.\n\n    function int32(data, offset) {\n      return (\n        (data.charCodeAt(offset) << 24) |\n        (data.charCodeAt(offset + 1) << 16) |\n        (data.charCodeAt(offset + 2) << 8) |\n        (data.charCodeAt(offset + 3) & 0xff)\n      );\n    }\n    function spliceString(s, offset, remove, insert) {\n      const chunk1 = s.substring(0, offset);\n      const chunk2 = s.substring(offset + remove);\n      return chunk1 + insert + chunk2;\n    }\n    let i, ii;\n\n    // The temporary canvas is used to determine if fonts are loaded.\n    const canvas = this._document.createElement(\"canvas\");\n    canvas.width = 1;\n    canvas.height = 1;\n    const ctx = canvas.getContext(\"2d\");\n\n    let called = 0;\n    function isFontReady(name, callback) {\n      // With setTimeout clamping this gives the font ~100ms to load.\n      if (++called > 30) {\n        warn(\"Load test font never loaded.\");\n        callback();\n        return;\n      }\n      ctx.font = \"30px \" + name;\n      ctx.fillText(\".\", 0, 20);\n      const imageData = ctx.getImageData(0, 0, 1, 1);\n      if (imageData.data[3] > 0) {\n        callback();\n        return;\n      }\n      setTimeout(isFontReady.bind(null, name, callback));\n    }\n\n    const loadTestFontId = `lt${Date.now()}${this.loadTestFontId++}`;\n    // Chromium seems to cache fonts based on a hash of the actual font data,\n    // so the font must be modified for each load test else it will appear to\n    // be loaded already.\n    // TODO: This could maybe be made faster by avoiding the btoa of the full\n    // font by splitting it in chunks before hand and padding the font id.\n    let data = this._loadTestFont;\n    const COMMENT_OFFSET = 976; // has to be on 4 byte boundary (for checksum)\n    data = spliceString(\n      data,\n      COMMENT_OFFSET,\n      loadTestFontId.length,\n      loadTestFontId\n    );\n    // CFF checksum is important for IE, adjusting it\n    const CFF_CHECKSUM_OFFSET = 16;\n    const XXXX_VALUE = 0x58585858; // the \"comment\" filled with 'X'\n    let checksum = int32(data, CFF_CHECKSUM_OFFSET);\n    for (i = 0, ii = loadTestFontId.length - 3; i < ii; i += 4) {\n      checksum = (checksum - XXXX_VALUE + int32(loadTestFontId, i)) | 0;\n    }\n    if (i < loadTestFontId.length) {\n      // align to 4 bytes boundary\n      checksum = (checksum - XXXX_VALUE + int32(loadTestFontId + \"XXX\", i)) | 0;\n    }\n    data = spliceString(data, CFF_CHECKSUM_OFFSET, 4, string32(checksum));\n\n    const url = `url(data:font/opentype;base64,${btoa(data)});`;\n    const rule = `@font-face {font-family:\"${loadTestFontId}\";src:${url}}`;\n    this.insertRule(rule);\n\n    const div = this._document.createElement(\"div\");\n    div.style.visibility = \"hidden\";\n    div.style.width = div.style.height = \"10px\";\n    div.style.position = \"absolute\";\n    div.style.top = div.style.left = \"0px\";\n\n    for (const name of [font.loadedName, loadTestFontId]) {\n      const span = this._document.createElement(\"span\");\n      span.textContent = \"Hi\";\n      span.style.fontFamily = name;\n      div.append(span);\n    }\n    this._document.body.append(div);\n\n    isFontReady(loadTestFontId, () => {\n      div.remove();\n      request.complete();\n    });\n    /** Hack end */\n  }\n}\n\nclass FontFaceObject {\n  constructor(\n    translatedData,\n    {\n      isEvalSupported = true,\n      disableFontFace = false,\n      ignoreErrors = false,\n      inspectFont = null,\n    }\n  ) {\n    this.compiledGlyphs = Object.create(null);\n    // importing translated data\n    for (const i in translatedData) {\n      this[i] = translatedData[i];\n    }\n    this.isEvalSupported = isEvalSupported !== false;\n    this.disableFontFace = disableFontFace === true;\n    this.ignoreErrors = ignoreErrors === true;\n    this._inspectFont = inspectFont;\n  }\n\n  createNativeFontFace() {\n    if (!this.data || this.disableFontFace) {\n      return null;\n    }\n    let nativeFontFace;\n    if (!this.cssFontInfo) {\n      nativeFontFace = new FontFace(this.loadedName, this.data, {});\n    } else {\n      const css = {\n        weight: this.cssFontInfo.fontWeight,\n      };\n      if (this.cssFontInfo.italicAngle) {\n        css.style = `oblique ${this.cssFontInfo.italicAngle}deg`;\n      }\n      nativeFontFace = new FontFace(\n        this.cssFontInfo.fontFamily,\n        this.data,\n        css\n      );\n    }\n\n    this._inspectFont?.(this);\n    return nativeFontFace;\n  }\n\n  createFontFaceRule() {\n    if (!this.data || this.disableFontFace) {\n      return null;\n    }\n    const data = bytesToString(this.data);\n    // Add the @font-face rule to the document.\n    const url = `url(data:${this.mimetype};base64,${btoa(data)});`;\n    let rule;\n    if (!this.cssFontInfo) {\n      rule = `@font-face {font-family:\"${this.loadedName}\";src:${url}}`;\n    } else {\n      let css = `font-weight: ${this.cssFontInfo.fontWeight};`;\n      if (this.cssFontInfo.italicAngle) {\n        css += `font-style: oblique ${this.cssFontInfo.italicAngle}deg;`;\n      }\n      rule = `@font-face {font-family:\"${this.cssFontInfo.fontFamily}\";${css}src:${url}}`;\n    }\n\n    this._inspectFont?.(this, url);\n    return rule;\n  }\n\n  getPathGenerator(objs, character) {\n    if (this.compiledGlyphs[character] !== undefined) {\n      return this.compiledGlyphs[character];\n    }\n\n    let cmds;\n    try {\n      cmds = objs.get(this.loadedName + \"_path_\" + character);\n    } catch (ex) {\n      if (!this.ignoreErrors) {\n        throw ex;\n      }\n      warn(`getPathGenerator - ignoring character: \"${ex}\".`);\n\n      return (this.compiledGlyphs[character] = function (c, size) {\n        // No-op function, to allow rendering to continue.\n      });\n    }\n\n    // If we can, compile cmds into JS for MAXIMUM SPEED...\n    if (this.isEvalSupported && FeatureTest.isEvalSupported) {\n      const jsBuf = [];\n      for (const current of cmds) {\n        const args = current.args !== undefined ? current.args.join(\",\") : \"\";\n        jsBuf.push(\"c.\", current.cmd, \"(\", args, \");\\n\");\n      }\n      // eslint-disable-next-line no-new-func\n      return (this.compiledGlyphs[character] = new Function(\n        \"c\",\n        \"size\",\n        jsBuf.join(\"\")\n      ));\n    }\n    // ... but fall back on using Function.prototype.apply() if we're\n    // blocked from using eval() for whatever reason (like CSP policies).\n    return (this.compiledGlyphs[character] = function (c, size) {\n      for (const current of cmds) {\n        if (current.cmd === \"scale\") {\n          current.args = [size, -size];\n        }\n        // eslint-disable-next-line prefer-spread\n        c[current.cmd].apply(c, current.args);\n      }\n    });\n  }\n}\n\nexport { FontFaceObject, FontLoader };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { objectFromMap } from \"../shared/util.js\";\n\nclass Metadata {\n  #metadataMap;\n\n  #data;\n\n  constructor({ parsedData, rawData }) {\n    this.#metadataMap = parsedData;\n    this.#data = rawData;\n  }\n\n  getRaw() {\n    return this.#data;\n  }\n\n  get(name) {\n    return this.#metadataMap.get(name) ?? null;\n  }\n\n  getAll() {\n    return objectFromMap(this.#metadataMap);\n  }\n\n  has(name) {\n    return this.#metadataMap.has(name);\n  }\n}\n\nexport { Metadata };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert, PromiseCapability, stringToBytes } from \"../shared/util.js\";\nimport {\n  createResponseStatusError,\n  extractFilenameFromHeader,\n  validateRangeRequestCapabilities,\n} from \"./network_utils.js\";\n\nif (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n  throw new Error(\n    'Module \"./network.js\" shall not be used with MOZCENTRAL builds.'\n  );\n}\n\nconst OK_RESPONSE = 200;\nconst PARTIAL_CONTENT_RESPONSE = 206;\n\nfunction getArrayBuffer(xhr) {\n  const data = xhr.response;\n  if (typeof data !== \"string\") {\n    return data;\n  }\n  return stringToBytes(data).buffer;\n}\n\nclass NetworkManager {\n  constructor(url, args = {}) {\n    this.url = url;\n    this.isHttp = /^https?:/i.test(url);\n    this.httpHeaders = (this.isHttp && args.httpHeaders) || Object.create(null);\n    this.withCredentials = args.withCredentials || false;\n\n    this.currXhrId = 0;\n    this.pendingRequests = Object.create(null);\n  }\n\n  requestRange(begin, end, listeners) {\n    const args = {\n      begin,\n      end,\n    };\n    for (const prop in listeners) {\n      args[prop] = listeners[prop];\n    }\n    return this.request(args);\n  }\n\n  requestFull(listeners) {\n    return this.request(listeners);\n  }\n\n  request(args) {\n    const xhr = new XMLHttpRequest();\n    const xhrId = this.currXhrId++;\n    const pendingRequest = (this.pendingRequests[xhrId] = { xhr });\n\n    xhr.open(\"GET\", this.url);\n    xhr.withCredentials = this.withCredentials;\n    for (const property in this.httpHeaders) {\n      const value = this.httpHeaders[property];\n      if (value === undefined) {\n        continue;\n      }\n      xhr.setRequestHeader(property, value);\n    }\n    if (this.isHttp && \"begin\" in args && \"end\" in args) {\n      xhr.setRequestHeader(\"Range\", `bytes=${args.begin}-${args.end - 1}`);\n      pendingRequest.expectedStatus = PARTIAL_CONTENT_RESPONSE;\n    } else {\n      pendingRequest.expectedStatus = OK_RESPONSE;\n    }\n    xhr.responseType = \"arraybuffer\";\n\n    if (args.onError) {\n      xhr.onerror = function (evt) {\n        args.onError(xhr.status);\n      };\n    }\n    xhr.onreadystatechange = this.onStateChange.bind(this, xhrId);\n    xhr.onprogress = this.onProgress.bind(this, xhrId);\n\n    pendingRequest.onHeadersReceived = args.onHeadersReceived;\n    pendingRequest.onDone = args.onDone;\n    pendingRequest.onError = args.onError;\n    pendingRequest.onProgress = args.onProgress;\n\n    xhr.send(null);\n\n    return xhrId;\n  }\n\n  onProgress(xhrId, evt) {\n    const pendingRequest = this.pendingRequests[xhrId];\n    if (!pendingRequest) {\n      return; // Maybe abortRequest was called...\n    }\n    pendingRequest.onProgress?.(evt);\n  }\n\n  onStateChange(xhrId, evt) {\n    const pendingRequest = this.pendingRequests[xhrId];\n    if (!pendingRequest) {\n      return; // Maybe abortRequest was called...\n    }\n\n    const xhr = pendingRequest.xhr;\n    if (xhr.readyState >= 2 && pendingRequest.onHeadersReceived) {\n      pendingRequest.onHeadersReceived();\n      delete pendingRequest.onHeadersReceived;\n    }\n\n    if (xhr.readyState !== 4) {\n      return;\n    }\n\n    if (!(xhrId in this.pendingRequests)) {\n      // The XHR request might have been aborted in onHeadersReceived()\n      // callback, in which case we should abort request.\n      return;\n    }\n\n    delete this.pendingRequests[xhrId];\n\n    // Success status == 0 can be on ftp, file and other protocols.\n    if (xhr.status === 0 && this.isHttp) {\n      pendingRequest.onError?.(xhr.status);\n      return;\n    }\n    const xhrStatus = xhr.status || OK_RESPONSE;\n\n    // From http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35.2:\n    // \"A server MAY ignore the Range header\". This means it's possible to\n    // get a 200 rather than a 206 response from a range request.\n    const ok_response_on_range_request =\n      xhrStatus === OK_RESPONSE &&\n      pendingRequest.expectedStatus === PARTIAL_CONTENT_RESPONSE;\n\n    if (\n      !ok_response_on_range_request &&\n      xhrStatus !== pendingRequest.expectedStatus\n    ) {\n      pendingRequest.onError?.(xhr.status);\n      return;\n    }\n\n    const chunk = getArrayBuffer(xhr);\n    if (xhrStatus === PARTIAL_CONTENT_RESPONSE) {\n      const rangeHeader = xhr.getResponseHeader(\"Content-Range\");\n      const matches = /bytes (\\d+)-(\\d+)\\/(\\d+)/.exec(rangeHeader);\n      pendingRequest.onDone({\n        begin: parseInt(matches[1], 10),\n        chunk,\n      });\n    } else if (chunk) {\n      pendingRequest.onDone({\n        begin: 0,\n        chunk,\n      });\n    } else {\n      pendingRequest.onError?.(xhr.status);\n    }\n  }\n\n  getRequestXhr(xhrId) {\n    return this.pendingRequests[xhrId].xhr;\n  }\n\n  isPendingRequest(xhrId) {\n    return xhrId in this.pendingRequests;\n  }\n\n  abortRequest(xhrId) {\n    const xhr = this.pendingRequests[xhrId].xhr;\n    delete this.pendingRequests[xhrId];\n    xhr.abort();\n  }\n}\n\n/** @implements {IPDFStream} */\nclass PDFNetworkStream {\n  constructor(source) {\n    this._source = source;\n    this._manager = new NetworkManager(source.url, {\n      httpHeaders: source.httpHeaders,\n      withCredentials: source.withCredentials,\n    });\n    this._rangeChunkSize = source.rangeChunkSize;\n    this._fullRequestReader = null;\n    this._rangeRequestReaders = [];\n  }\n\n  _onRangeRequestReaderClosed(reader) {\n    const i = this._rangeRequestReaders.indexOf(reader);\n    if (i >= 0) {\n      this._rangeRequestReaders.splice(i, 1);\n    }\n  }\n\n  getFullReader() {\n    assert(\n      !this._fullRequestReader,\n      \"PDFNetworkStream.getFullReader can only be called once.\"\n    );\n    this._fullRequestReader = new PDFNetworkStreamFullRequestReader(\n      this._manager,\n      this._source\n    );\n    return this._fullRequestReader;\n  }\n\n  getRangeReader(begin, end) {\n    const reader = new PDFNetworkStreamRangeRequestReader(\n      this._manager,\n      begin,\n      end\n    );\n    reader.onClosed = this._onRangeRequestReaderClosed.bind(this);\n    this._rangeRequestReaders.push(reader);\n    return reader;\n  }\n\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n\n    for (const reader of this._rangeRequestReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n  }\n}\n\n/** @implements {IPDFStreamReader} */\nclass PDFNetworkStreamFullRequestReader {\n  constructor(manager, source) {\n    this._manager = manager;\n\n    const args = {\n      onHeadersReceived: this._onHeadersReceived.bind(this),\n      onDone: this._onDone.bind(this),\n      onError: this._onError.bind(this),\n      onProgress: this._onProgress.bind(this),\n    };\n    this._url = source.url;\n    this._fullRequestId = manager.requestFull(args);\n    this._headersReceivedCapability = new PromiseCapability();\n    this._disableRange = source.disableRange || false;\n    this._contentLength = source.length; // Optional\n    this._rangeChunkSize = source.rangeChunkSize;\n    if (!this._rangeChunkSize && !this._disableRange) {\n      this._disableRange = true;\n    }\n\n    this._isStreamingSupported = false;\n    this._isRangeSupported = false;\n\n    this._cachedChunks = [];\n    this._requests = [];\n    this._done = false;\n    this._storedError = undefined;\n    this._filename = null;\n\n    this.onProgress = null;\n  }\n\n  _onHeadersReceived() {\n    const fullRequestXhrId = this._fullRequestId;\n    const fullRequestXhr = this._manager.getRequestXhr(fullRequestXhrId);\n\n    const getResponseHeader = name => {\n      return fullRequestXhr.getResponseHeader(name);\n    };\n    const { allowRangeRequests, suggestedLength } =\n      validateRangeRequestCapabilities({\n        getResponseHeader,\n        isHttp: this._manager.isHttp,\n        rangeChunkSize: this._rangeChunkSize,\n        disableRange: this._disableRange,\n      });\n\n    if (allowRangeRequests) {\n      this._isRangeSupported = true;\n    }\n    // Setting right content length.\n    this._contentLength = suggestedLength || this._contentLength;\n\n    this._filename = extractFilenameFromHeader(getResponseHeader);\n\n    if (this._isRangeSupported) {\n      // NOTE: by cancelling the full request, and then issuing range\n      // requests, there will be an issue for sites where you can only\n      // request the pdf once. However, if this is the case, then the\n      // server should not be returning that it can support range requests.\n      this._manager.abortRequest(fullRequestXhrId);\n    }\n\n    this._headersReceivedCapability.resolve();\n  }\n\n  _onDone(data) {\n    if (data) {\n      if (this._requests.length > 0) {\n        const requestCapability = this._requests.shift();\n        requestCapability.resolve({ value: data.chunk, done: false });\n      } else {\n        this._cachedChunks.push(data.chunk);\n      }\n    }\n    this._done = true;\n    if (this._cachedChunks.length > 0) {\n      return;\n    }\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({ value: undefined, done: true });\n    }\n    this._requests.length = 0;\n  }\n\n  _onError(status) {\n    this._storedError = createResponseStatusError(status, this._url);\n    this._headersReceivedCapability.reject(this._storedError);\n    for (const requestCapability of this._requests) {\n      requestCapability.reject(this._storedError);\n    }\n    this._requests.length = 0;\n    this._cachedChunks.length = 0;\n  }\n\n  _onProgress(evt) {\n    this.onProgress?.({\n      loaded: evt.loaded,\n      total: evt.lengthComputable ? evt.total : this._contentLength,\n    });\n  }\n\n  get filename() {\n    return this._filename;\n  }\n\n  get isRangeSupported() {\n    return this._isRangeSupported;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  get contentLength() {\n    return this._contentLength;\n  }\n\n  get headersReady() {\n    return this._headersReceivedCapability.promise;\n  }\n\n  async read() {\n    if (this._storedError) {\n      throw this._storedError;\n    }\n    if (this._cachedChunks.length > 0) {\n      const chunk = this._cachedChunks.shift();\n      return { value: chunk, done: false };\n    }\n    if (this._done) {\n      return { value: undefined, done: true };\n    }\n    const requestCapability = new PromiseCapability();\n    this._requests.push(requestCapability);\n    return requestCapability.promise;\n  }\n\n  cancel(reason) {\n    this._done = true;\n    this._headersReceivedCapability.reject(reason);\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({ value: undefined, done: true });\n    }\n    this._requests.length = 0;\n    if (this._manager.isPendingRequest(this._fullRequestId)) {\n      this._manager.abortRequest(this._fullRequestId);\n    }\n    this._fullRequestReader = null;\n  }\n}\n\n/** @implements {IPDFStreamRangeReader} */\nclass PDFNetworkStreamRangeRequestReader {\n  constructor(manager, begin, end) {\n    this._manager = manager;\n\n    const args = {\n      onDone: this._onDone.bind(this),\n      onError: this._onError.bind(this),\n      onProgress: this._onProgress.bind(this),\n    };\n    this._url = manager.url;\n    this._requestId = manager.requestRange(begin, end, args);\n    this._requests = [];\n    this._queuedChunk = null;\n    this._done = false;\n    this._storedError = undefined;\n\n    this.onProgress = null;\n    this.onClosed = null;\n  }\n\n  _close() {\n    this.onClosed?.(this);\n  }\n\n  _onDone(data) {\n    const chunk = data.chunk;\n    if (this._requests.length > 0) {\n      const requestCapability = this._requests.shift();\n      requestCapability.resolve({ value: chunk, done: false });\n    } else {\n      this._queuedChunk = chunk;\n    }\n    this._done = true;\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({ value: undefined, done: true });\n    }\n    this._requests.length = 0;\n    this._close();\n  }\n\n  _onError(status) {\n    this._storedError = createResponseStatusError(status, this._url);\n    for (const requestCapability of this._requests) {\n      requestCapability.reject(this._storedError);\n    }\n    this._requests.length = 0;\n    this._queuedChunk = null;\n  }\n\n  _onProgress(evt) {\n    if (!this.isStreamingSupported) {\n      this.onProgress?.({ loaded: evt.loaded });\n    }\n  }\n\n  get isStreamingSupported() {\n    return false;\n  }\n\n  async read() {\n    if (this._storedError) {\n      throw this._storedError;\n    }\n    if (this._queuedChunk !== null) {\n      const chunk = this._queuedChunk;\n      this._queuedChunk = null;\n      return { value: chunk, done: false };\n    }\n    if (this._done) {\n      return { value: undefined, done: true };\n    }\n    const requestCapability = new PromiseCapability();\n    this._requests.push(requestCapability);\n    return requestCapability.promise;\n  }\n\n  cancel(reason) {\n    this._done = true;\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({ value: undefined, done: true });\n    }\n    this._requests.length = 0;\n    if (this._manager.isPendingRequest(this._requestId)) {\n      this._manager.abortRequest(this._requestId);\n    }\n    this._close();\n  }\n}\n\nexport { PDFNetworkStream };\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { stringToBytes } from \"../shared/util.js\";\n\n// This getFilenameFromContentDispositionHeader function is adapted from\n// https://github.com/Rob--W/open-in-browser/blob/7e2e35a38b8b4e981b11da7b2f01df0149049e92/extension/content-disposition.js\n// with the following changes:\n// - Modified to conform to PDF.js's coding style.\n// - Move return to the end of the function to prevent Babel from dropping the\n//   function declarations.\n\n/**\n * Extract file name from the Content-Disposition HTTP response header.\n *\n * @param {string} contentDisposition\n * @returns {string} Filename, if found in the Content-Disposition header.\n */\nfunction getFilenameFromContentDispositionHeader(contentDisposition) {\n  let needsEncodingFixup = true;\n\n  // filename*=ext-value (\"ext-value\" from RFC 5987, referenced by RFC 6266).\n  let tmp = toParamRegExp(\"filename\\\\*\", \"i\").exec(contentDisposition);\n  if (tmp) {\n    tmp = tmp[1];\n    let filename = rfc2616unquote(tmp);\n    filename = unescape(filename);\n    filename = rfc5987decode(filename);\n    filename = rfc2047decode(filename);\n    return fixupEncoding(filename);\n  }\n\n  // Continuations (RFC 2231 section 3, referenced by RFC 5987 section 3.1).\n  // filename*n*=part\n  // filename*n=part\n  tmp = rfc2231getparam(contentDisposition);\n  if (tmp) {\n    // RFC 2047, section\n    const filename = rfc2047decode(tmp);\n    return fixupEncoding(filename);\n  }\n\n  // filename=value (RFC 5987, section 4.1).\n  tmp = toParamRegExp(\"filename\", \"i\").exec(contentDisposition);\n  if (tmp) {\n    tmp = tmp[1];\n    let filename = rfc2616unquote(tmp);\n    filename = rfc2047decode(filename);\n    return fixupEncoding(filename);\n  }\n\n  // After this line there are only function declarations. We cannot put\n  // \"return\" here for readability because babel would then drop the function\n  // declarations...\n  function toParamRegExp(attributePattern, flags) {\n    return new RegExp(\n      \"(?:^|;)\\\\s*\" +\n        attributePattern +\n        \"\\\\s*=\\\\s*\" +\n        // Captures: value = token | quoted-string\n        // (RFC 2616, section 3.6 and referenced by RFC 6266 4.1)\n        \"(\" +\n        '[^\";\\\\s][^;\\\\s]*' +\n        \"|\" +\n        '\"(?:[^\"\\\\\\\\]|\\\\\\\\\"?)+\"?' +\n        \")\",\n      flags\n    );\n  }\n  function textdecode(encoding, value) {\n    if (encoding) {\n      if (!/^[\\x00-\\xFF]+$/.test(value)) {\n        return value;\n      }\n      try {\n        const decoder = new TextDecoder(encoding, { fatal: true });\n        const buffer = stringToBytes(value);\n        value = decoder.decode(buffer);\n        needsEncodingFixup = false;\n      } catch {\n        // TextDecoder constructor threw - unrecognized encoding.\n      }\n    }\n    return value;\n  }\n  function fixupEncoding(value) {\n    if (needsEncodingFixup && /[\\x80-\\xff]/.test(value)) {\n      // Maybe multi-byte UTF-8.\n      value = textdecode(\"utf-8\", value);\n      if (needsEncodingFixup) {\n        // Try iso-8859-1 encoding.\n        value = textdecode(\"iso-8859-1\", value);\n      }\n    }\n    return value;\n  }\n  function rfc2231getparam(contentDispositionStr) {\n    const matches = [];\n    let match;\n    // Iterate over all filename*n= and filename*n*= with n being an integer\n    // of at least zero. Any non-zero number must not start with '0'.\n    const iter = toParamRegExp(\"filename\\\\*((?!0\\\\d)\\\\d+)(\\\\*?)\", \"ig\");\n    while ((match = iter.exec(contentDispositionStr)) !== null) {\n      let [, n, quot, part] = match; // eslint-disable-line prefer-const\n      n = parseInt(n, 10);\n      if (n in matches) {\n        // Ignore anything after the invalid second filename*0.\n        if (n === 0) {\n          break;\n        }\n        continue;\n      }\n      matches[n] = [quot, part];\n    }\n    const parts = [];\n    for (let n = 0; n < matches.length; ++n) {\n      if (!(n in matches)) {\n        // Numbers must be consecutive. Truncate when there is a hole.\n        break;\n      }\n      let [quot, part] = matches[n]; // eslint-disable-line prefer-const\n      part = rfc2616unquote(part);\n      if (quot) {\n        part = unescape(part);\n        if (n === 0) {\n          part = rfc5987decode(part);\n        }\n      }\n      parts.push(part);\n    }\n    return parts.join(\"\");\n  }\n  function rfc2616unquote(value) {\n    if (value.startsWith('\"')) {\n      const parts = value.slice(1).split('\\\\\"');\n      // Find the first unescaped \" and terminate there.\n      for (let i = 0; i < parts.length; ++i) {\n        const quotindex = parts[i].indexOf('\"');\n        if (quotindex !== -1) {\n          parts[i] = parts[i].slice(0, quotindex);\n          parts.length = i + 1; // Truncates and stop the iteration.\n        }\n        parts[i] = parts[i].replaceAll(/\\\\(.)/g, \"$1\");\n      }\n      value = parts.join('\"');\n    }\n    return value;\n  }\n  function rfc5987decode(extvalue) {\n    // Decodes \"ext-value\" from RFC 5987.\n    const encodingend = extvalue.indexOf(\"'\");\n    if (encodingend === -1) {\n      // Some servers send \"filename*=\" without encoding 'language' prefix,\n      // e.g. in https://github.com/Rob--W/open-in-browser/issues/26\n      // Let's accept the value like Firefox (57) (Chrome 62 rejects it).\n      return extvalue;\n    }\n    const encoding = extvalue.slice(0, encodingend);\n    const langvalue = extvalue.slice(encodingend + 1);\n    // Ignore language (RFC 5987 section 3.2.1, and RFC 6266 section 4.1 ).\n    const value = langvalue.replace(/^[^']*'/, \"\");\n    return textdecode(encoding, value);\n  }\n  function rfc2047decode(value) {\n    // RFC 2047-decode the result. Firefox tried to drop support for it, but\n    // backed out because some servers use it - https://bugzil.la/875615\n    // Firefox's condition for decoding is here: https://searchfox.org/mozilla-central/rev/4a590a5a15e35d88a3b23dd6ac3c471cf85b04a8/netwerk/mime/nsMIMEHeaderParamImpl.cpp#742-748\n\n    // We are more strict and only recognize RFC 2047-encoding if the value\n    // starts with \"=?\", since then it is likely that the full value is\n    // RFC 2047-encoded.\n\n    // Firefox also decodes words even where RFC 2047 section 5 states:\n    // \"An 'encoded-word' MUST NOT appear within a 'quoted-string'.\"\n    if (!value.startsWith(\"=?\") || /[\\x00-\\x19\\x80-\\xff]/.test(value)) {\n      return value;\n    }\n    // RFC 2047, section 2.4\n    // encoded-word = \"=?\" charset \"?\" encoding \"?\" encoded-text \"?=\"\n    // charset = token (but let's restrict to characters that denote a\n    //       possibly valid encoding).\n    // encoding = q or b\n    // encoded-text = any printable ASCII character other than ? or space.\n    //        ... but Firefox permits ? and space.\n    return value.replaceAll(\n      /=\\?([\\w-]*)\\?([QqBb])\\?((?:[^?]|\\?(?!=))*)\\?=/g,\n      function (matches, charset, encoding, text) {\n        if (encoding === \"q\" || encoding === \"Q\") {\n          // RFC 2047 section 4.2.\n          text = text.replaceAll(\"_\", \" \");\n          text = text.replaceAll(/=([0-9a-fA-F]{2})/g, function (match, hex) {\n            return String.fromCharCode(parseInt(hex, 16));\n          });\n          return textdecode(charset, text);\n        } // else encoding is b or B - base64 (RFC 2047 section 4.1)\n        try {\n          text = atob(text);\n        } catch {}\n        return textdecode(charset, text);\n      }\n    );\n  }\n\n  return \"\";\n}\n\nexport { getFilenameFromContentDispositionHeader };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  assert,\n  MissingPDFException,\n  UnexpectedResponseException,\n} from \"../shared/util.js\";\nimport { getFilenameFromContentDispositionHeader } from \"./content_disposition.js\";\nimport { isPdfFile } from \"./display_utils.js\";\n\nfunction validateRangeRequestCapabilities({\n  getResponseHeader,\n  isHttp,\n  rangeChunkSize,\n  disableRange,\n}) {\n  if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n    assert(\n      Number.isInteger(rangeChunkSize) && rangeChunkSize > 0,\n      \"rangeChunkSize must be an integer larger than zero.\"\n    );\n  }\n  const returnValues = {\n    allowRangeRequests: false,\n    suggestedLength: undefined,\n  };\n\n  const length = parseInt(getResponseHeader(\"Content-Length\"), 10);\n  if (!Number.isInteger(length)) {\n    return returnValues;\n  }\n\n  returnValues.suggestedLength = length;\n\n  if (length <= 2 * rangeChunkSize) {\n    // The file size is smaller than the size of two chunks, so it does not\n    // make any sense to abort the request and retry with a range request.\n    return returnValues;\n  }\n\n  if (disableRange || !isHttp) {\n    return returnValues;\n  }\n  if (getResponseHeader(\"Accept-Ranges\") !== \"bytes\") {\n    return returnValues;\n  }\n\n  const contentEncoding = getResponseHeader(\"Content-Encoding\") || \"identity\";\n  if (contentEncoding !== \"identity\") {\n    return returnValues;\n  }\n\n  returnValues.allowRangeRequests = true;\n  return returnValues;\n}\n\nfunction extractFilenameFromHeader(getResponseHeader) {\n  const contentDisposition = getResponseHeader(\"Content-Disposition\");\n  if (contentDisposition) {\n    let filename = getFilenameFromContentDispositionHeader(contentDisposition);\n    if (filename.includes(\"%\")) {\n      try {\n        filename = decodeURIComponent(filename);\n      } catch {}\n    }\n    if (isPdfFile(filename)) {\n      return filename;\n    }\n  }\n  return null;\n}\n\nfunction createResponseStatusError(status, url) {\n  if (status === 404 || (status === 0 && url.startsWith(\"file:\"))) {\n    return new MissingPDFException('Missing PDF \"' + url + '\".');\n  }\n  return new UnexpectedResponseException(\n    `Unexpected server response (${status}) while retrieving PDF \"${url}\".`,\n    status\n  );\n}\n\nfunction validateResponseStatus(status) {\n  return status === 200 || status === 206;\n}\n\nexport {\n  createResponseStatusError,\n  extractFilenameFromHeader,\n  validateRangeRequestCapabilities,\n  validateResponseStatus,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  AbortException,\n  assert,\n  isNodeJS,\n  MissingPDFException,\n  PromiseCapability,\n} from \"../shared/util.js\";\nimport {\n  extractFilenameFromHeader,\n  validateRangeRequestCapabilities,\n} from \"./network_utils.js\";\n\nif (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n  throw new Error(\n    'Module \"./node_stream.js\" shall not be used with MOZCENTRAL builds.'\n  );\n}\n\nlet fs, http, https, url;\nif (isNodeJS) {\n  // Native packages.\n  fs = await import(/* webpackIgnore: true */ \"fs\");\n  http = await import(/* webpackIgnore: true */ \"http\");\n  https = await import(/* webpackIgnore: true */ \"https\");\n  url = await import(/* webpackIgnore: true */ \"url\");\n}\n\nconst fileUriRegex = /^file:\\/\\/\\/[a-zA-Z]:\\//;\n\nfunction parseUrl(sourceUrl) {\n  const parsedUrl = url.parse(sourceUrl);\n  if (parsedUrl.protocol === \"file:\" || parsedUrl.host) {\n    return parsedUrl;\n  }\n  // Prepending 'file:///' to Windows absolute path.\n  if (/^[a-z]:[/\\\\]/i.test(sourceUrl)) {\n    return url.parse(`file:///${sourceUrl}`);\n  }\n  // Changes protocol to 'file:' if url refers to filesystem.\n  if (!parsedUrl.host) {\n    parsedUrl.protocol = \"file:\";\n  }\n  return parsedUrl;\n}\n\nclass PDFNodeStream {\n  constructor(source) {\n    this.source = source;\n    this.url = parseUrl(source.url);\n    this.isHttp =\n      this.url.protocol === \"http:\" || this.url.protocol === \"https:\";\n    // Check if url refers to filesystem.\n    this.isFsUrl = this.url.protocol === \"file:\";\n    this.httpHeaders = (this.isHttp && source.httpHeaders) || {};\n\n    this._fullRequestReader = null;\n    this._rangeRequestReaders = [];\n  }\n\n  get _progressiveDataLength() {\n    return this._fullRequestReader?._loaded ?? 0;\n  }\n\n  getFullReader() {\n    assert(\n      !this._fullRequestReader,\n      \"PDFNodeStream.getFullReader can only be called once.\"\n    );\n    this._fullRequestReader = this.isFsUrl\n      ? new PDFNodeStreamFsFullReader(this)\n      : new PDFNodeStreamFullReader(this);\n    return this._fullRequestReader;\n  }\n\n  getRangeReader(start, end) {\n    if (end <= this._progressiveDataLength) {\n      return null;\n    }\n    const rangeReader = this.isFsUrl\n      ? new PDFNodeStreamFsRangeReader(this, start, end)\n      : new PDFNodeStreamRangeReader(this, start, end);\n    this._rangeRequestReaders.push(rangeReader);\n    return rangeReader;\n  }\n\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n\n    for (const reader of this._rangeRequestReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n  }\n}\n\nclass BaseFullReader {\n  constructor(stream) {\n    this._url = stream.url;\n    this._done = false;\n    this._storedError = null;\n    this.onProgress = null;\n    const source = stream.source;\n    this._contentLength = source.length; // optional\n    this._loaded = 0;\n    this._filename = null;\n\n    this._disableRange = source.disableRange || false;\n    this._rangeChunkSize = source.rangeChunkSize;\n    if (!this._rangeChunkSize && !this._disableRange) {\n      this._disableRange = true;\n    }\n\n    this._isStreamingSupported = !source.disableStream;\n    this._isRangeSupported = !source.disableRange;\n\n    this._readableStream = null;\n    this._readCapability = new PromiseCapability();\n    this._headersCapability = new PromiseCapability();\n  }\n\n  get headersReady() {\n    return this._headersCapability.promise;\n  }\n\n  get filename() {\n    return this._filename;\n  }\n\n  get contentLength() {\n    return this._contentLength;\n  }\n\n  get isRangeSupported() {\n    return this._isRangeSupported;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  async read() {\n    await this._readCapability.promise;\n    if (this._done) {\n      return { value: undefined, done: true };\n    }\n    if (this._storedError) {\n      throw this._storedError;\n    }\n\n    const chunk = this._readableStream.read();\n    if (chunk === null) {\n      this._readCapability = new PromiseCapability();\n      return this.read();\n    }\n    this._loaded += chunk.length;\n    this.onProgress?.({\n      loaded: this._loaded,\n      total: this._contentLength,\n    });\n\n    // Ensure that `read()` method returns ArrayBuffer.\n    const buffer = new Uint8Array(chunk).buffer;\n    return { value: buffer, done: false };\n  }\n\n  cancel(reason) {\n    // Call `this._error()` method when cancel is called\n    // before _readableStream is set.\n    if (!this._readableStream) {\n      this._error(reason);\n      return;\n    }\n    this._readableStream.destroy(reason);\n  }\n\n  _error(reason) {\n    this._storedError = reason;\n    this._readCapability.resolve();\n  }\n\n  _setReadableStream(readableStream) {\n    this._readableStream = readableStream;\n    readableStream.on(\"readable\", () => {\n      this._readCapability.resolve();\n    });\n\n    readableStream.on(\"end\", () => {\n      // Destroy readable to minimize resource usage.\n      readableStream.destroy();\n      this._done = true;\n      this._readCapability.resolve();\n    });\n\n    readableStream.on(\"error\", reason => {\n      this._error(reason);\n    });\n\n    // We need to stop reading when range is supported and streaming is\n    // disabled.\n    if (!this._isStreamingSupported && this._isRangeSupported) {\n      this._error(new AbortException(\"streaming is disabled\"));\n    }\n\n    // Destroy ReadableStream if already in errored state.\n    if (this._storedError) {\n      this._readableStream.destroy(this._storedError);\n    }\n  }\n}\n\nclass BaseRangeReader {\n  constructor(stream) {\n    this._url = stream.url;\n    this._done = false;\n    this._storedError = null;\n    this.onProgress = null;\n    this._loaded = 0;\n    this._readableStream = null;\n    this._readCapability = new PromiseCapability();\n    const source = stream.source;\n    this._isStreamingSupported = !source.disableStream;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  async read() {\n    await this._readCapability.promise;\n    if (this._done) {\n      return { value: undefined, done: true };\n    }\n    if (this._storedError) {\n      throw this._storedError;\n    }\n\n    const chunk = this._readableStream.read();\n    if (chunk === null) {\n      this._readCapability = new PromiseCapability();\n      return this.read();\n    }\n    this._loaded += chunk.length;\n    this.onProgress?.({ loaded: this._loaded });\n\n    // Ensure that `read()` method returns ArrayBuffer.\n    const buffer = new Uint8Array(chunk).buffer;\n    return { value: buffer, done: false };\n  }\n\n  cancel(reason) {\n    // Call `this._error()` method when cancel is called\n    // before _readableStream is set.\n    if (!this._readableStream) {\n      this._error(reason);\n      return;\n    }\n    this._readableStream.destroy(reason);\n  }\n\n  _error(reason) {\n    this._storedError = reason;\n    this._readCapability.resolve();\n  }\n\n  _setReadableStream(readableStream) {\n    this._readableStream = readableStream;\n    readableStream.on(\"readable\", () => {\n      this._readCapability.resolve();\n    });\n\n    readableStream.on(\"end\", () => {\n      // Destroy readableStream to minimize resource usage.\n      readableStream.destroy();\n      this._done = true;\n      this._readCapability.resolve();\n    });\n\n    readableStream.on(\"error\", reason => {\n      this._error(reason);\n    });\n\n    // Destroy readableStream if already in errored state.\n    if (this._storedError) {\n      this._readableStream.destroy(this._storedError);\n    }\n  }\n}\n\nfunction createRequestOptions(parsedUrl, headers) {\n  return {\n    protocol: parsedUrl.protocol,\n    auth: parsedUrl.auth,\n    host: parsedUrl.hostname,\n    port: parsedUrl.port,\n    path: parsedUrl.path,\n    method: \"GET\",\n    headers,\n  };\n}\n\nclass PDFNodeStreamFullReader extends BaseFullReader {\n  constructor(stream) {\n    super(stream);\n\n    const handleResponse = response => {\n      if (response.statusCode === 404) {\n        const error = new MissingPDFException(`Missing PDF \"${this._url}\".`);\n        this._storedError = error;\n        this._headersCapability.reject(error);\n        return;\n      }\n      this._headersCapability.resolve();\n      this._setReadableStream(response);\n\n      const getResponseHeader = name => {\n        // Make sure that headers name are in lower case, as mentioned\n        // here: https://nodejs.org/api/http.html#http_message_headers.\n        return this._readableStream.headers[name.toLowerCase()];\n      };\n      const { allowRangeRequests, suggestedLength } =\n        validateRangeRequestCapabilities({\n          getResponseHeader,\n          isHttp: stream.isHttp,\n          rangeChunkSize: this._rangeChunkSize,\n          disableRange: this._disableRange,\n        });\n\n      this._isRangeSupported = allowRangeRequests;\n      // Setting right content length.\n      this._contentLength = suggestedLength || this._contentLength;\n\n      this._filename = extractFilenameFromHeader(getResponseHeader);\n    };\n\n    this._request = null;\n    if (this._url.protocol === \"http:\") {\n      this._request = http.request(\n        createRequestOptions(this._url, stream.httpHeaders),\n        handleResponse\n      );\n    } else {\n      this._request = https.request(\n        createRequestOptions(this._url, stream.httpHeaders),\n        handleResponse\n      );\n    }\n\n    this._request.on(\"error\", reason => {\n      this._storedError = reason;\n      this._headersCapability.reject(reason);\n    });\n    // Note: `request.end(data)` is used to write `data` to request body\n    // and notify end of request. But one should always call `request.end()`\n    // even if there is no data to write -- (to notify the end of request).\n    this._request.end();\n  }\n}\n\nclass PDFNodeStreamRangeReader extends BaseRangeReader {\n  constructor(stream, start, end) {\n    super(stream);\n\n    this._httpHeaders = {};\n    for (const property in stream.httpHeaders) {\n      const value = stream.httpHeaders[property];\n      if (value === undefined) {\n        continue;\n      }\n      this._httpHeaders[property] = value;\n    }\n    this._httpHeaders.Range = `bytes=${start}-${end - 1}`;\n\n    const handleResponse = response => {\n      if (response.statusCode === 404) {\n        const error = new MissingPDFException(`Missing PDF \"${this._url}\".`);\n        this._storedError = error;\n        return;\n      }\n      this._setReadableStream(response);\n    };\n\n    this._request = null;\n    if (this._url.protocol === \"http:\") {\n      this._request = http.request(\n        createRequestOptions(this._url, this._httpHeaders),\n        handleResponse\n      );\n    } else {\n      this._request = https.request(\n        createRequestOptions(this._url, this._httpHeaders),\n        handleResponse\n      );\n    }\n\n    this._request.on(\"error\", reason => {\n      this._storedError = reason;\n    });\n    this._request.end();\n  }\n}\n\nclass PDFNodeStreamFsFullReader extends BaseFullReader {\n  constructor(stream) {\n    super(stream);\n\n    let path = decodeURIComponent(this._url.path);\n\n    // Remove the extra slash to get right path from url like `file:///C:/`\n    if (fileUriRegex.test(this._url.href)) {\n      path = path.replace(/^\\//, \"\");\n    }\n\n    fs.lstat(path, (error, stat) => {\n      if (error) {\n        if (error.code === \"ENOENT\") {\n          error = new MissingPDFException(`Missing PDF \"${path}\".`);\n        }\n        this._storedError = error;\n        this._headersCapability.reject(error);\n        return;\n      }\n      // Setting right content length.\n      this._contentLength = stat.size;\n\n      this._setReadableStream(fs.createReadStream(path));\n      this._headersCapability.resolve();\n    });\n  }\n}\n\nclass PDFNodeStreamFsRangeReader extends BaseRangeReader {\n  constructor(stream, start, end) {\n    super(stream);\n\n    let path = decodeURIComponent(this._url.path);\n\n    // Remove the extra slash to get right path from url like `file:///C:/`\n    if (fileUriRegex.test(this._url.href)) {\n      path = path.replace(/^\\//, \"\");\n    }\n\n    this._setReadableStream(fs.createReadStream(path, { start, end: end - 1 }));\n  }\n}\n\nexport { PDFNodeStream };\n","/* Copyright 2020 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  BaseCanvasFactory,\n  BaseCMapReaderFactory,\n  BaseFilterFactory,\n  BaseStandardFontDataFactory,\n} from \"./base_factory.js\";\nimport { isNodeJS, warn } from \"../shared/util.js\";\n\nif (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n  throw new Error(\n    'Module \"./node_utils.js\" shall not be used with MOZCENTRAL builds.'\n  );\n}\n\nlet fs, canvas, path2d_polyfill;\nif (isNodeJS) {\n  // Native packages.\n  fs = await import(/* webpackIgnore: true */ \"fs\");\n  // Optional, third-party, packages.\n  try {\n    canvas = await import(/* webpackIgnore: true */ \"canvas\");\n  } catch {}\n  try {\n    path2d_polyfill = await import(/* webpackIgnore: true */ \"path2d-polyfill\");\n  } catch {}\n}\n\nif (typeof PDFJSDev !== \"undefined\" && !PDFJSDev.test(\"SKIP_BABEL\")) {\n  (function checkDOMMatrix() {\n    if (globalThis.DOMMatrix || !isNodeJS) {\n      return;\n    }\n    const DOMMatrix = canvas?.DOMMatrix;\n\n    if (DOMMatrix) {\n      globalThis.DOMMatrix = DOMMatrix;\n    } else {\n      warn(\"Cannot polyfill `DOMMatrix`, rendering may be broken.\");\n    }\n  })();\n\n  (function checkPath2D() {\n    if (globalThis.Path2D || !isNodeJS) {\n      return;\n    }\n    const CanvasRenderingContext2D = canvas?.CanvasRenderingContext2D;\n    const polyfillPath2D = path2d_polyfill?.polyfillPath2D;\n\n    if (CanvasRenderingContext2D && polyfillPath2D) {\n      globalThis.CanvasRenderingContext2D = CanvasRenderingContext2D;\n      polyfillPath2D(globalThis);\n    } else {\n      warn(\"Cannot polyfill `Path2D`, rendering may be broken.\");\n    }\n  })();\n}\n\nconst fetchData = function (url) {\n  return new Promise((resolve, reject) => {\n    fs.readFile(url, (error, data) => {\n      if (error || !data) {\n        reject(new Error(error));\n        return;\n      }\n      resolve(new Uint8Array(data));\n    });\n  });\n};\n\nclass NodeFilterFactory extends BaseFilterFactory {}\n\nclass NodeCanvasFactory extends BaseCanvasFactory {\n  /**\n   * @ignore\n   */\n  _createCanvas(width, height) {\n    return canvas.createCanvas(width, height);\n  }\n}\n\nclass NodeCMapReaderFactory extends BaseCMapReaderFactory {\n  /**\n   * @ignore\n   */\n  _fetchData(url, compressionType) {\n    return fetchData(url).then(data => {\n      return { cMapData: data, compressionType };\n    });\n  }\n}\n\nclass NodeStandardFontDataFactory extends BaseStandardFontDataFactory {\n  /**\n   * @ignore\n   */\n  _fetchData(url) {\n    return fetchData(url);\n  }\n}\n\nexport {\n  NodeCanvasFactory,\n  NodeCMapReaderFactory,\n  NodeFilterFactory,\n  NodeStandardFontDataFactory,\n};\n","/* Copyright 2020 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { objectFromMap, unreachable, warn } from \"../shared/util.js\";\nimport { MurmurHash3_64 } from \"../shared/murmurhash3.js\";\n\nconst INTERNAL = Symbol(\"INTERNAL\");\n\nclass OptionalContentGroup {\n  #visible = true;\n\n  constructor(name, intent) {\n    this.name = name;\n    this.intent = intent;\n  }\n\n  /**\n   * @type {boolean}\n   */\n  get visible() {\n    return this.#visible;\n  }\n\n  /**\n   * @ignore\n   */\n  _setVisible(internal, visible) {\n    if (internal !== INTERNAL) {\n      unreachable(\"Internal method `_setVisible` called.\");\n    }\n    this.#visible = visible;\n  }\n}\n\nclass OptionalContentConfig {\n  #cachedGetHash = null;\n\n  #groups = new Map();\n\n  #initialHash = null;\n\n  #order = null;\n\n  constructor(data) {\n    this.name = null;\n    this.creator = null;\n\n    if (data === null) {\n      return;\n    }\n    this.name = data.name;\n    this.creator = data.creator;\n    this.#order = data.order;\n    for (const group of data.groups) {\n      this.#groups.set(\n        group.id,\n        new OptionalContentGroup(group.name, group.intent)\n      );\n    }\n\n    if (data.baseState === \"OFF\") {\n      for (const group of this.#groups.values()) {\n        group._setVisible(INTERNAL, false);\n      }\n    }\n\n    for (const on of data.on) {\n      this.#groups.get(on)._setVisible(INTERNAL, true);\n    }\n\n    for (const off of data.off) {\n      this.#groups.get(off)._setVisible(INTERNAL, false);\n    }\n\n    // The following code must always run *last* in the constructor.\n    this.#initialHash = this.getHash();\n  }\n\n  #evaluateVisibilityExpression(array) {\n    const length = array.length;\n    if (length < 2) {\n      return true;\n    }\n    const operator = array[0];\n    for (let i = 1; i < length; i++) {\n      const element = array[i];\n      let state;\n      if (Array.isArray(element)) {\n        state = this.#evaluateVisibilityExpression(element);\n      } else if (this.#groups.has(element)) {\n        state = this.#groups.get(element).visible;\n      } else {\n        warn(`Optional content group not found: ${element}`);\n        return true;\n      }\n      switch (operator) {\n        case \"And\":\n          if (!state) {\n            return false;\n          }\n          break;\n        case \"Or\":\n          if (state) {\n            return true;\n          }\n          break;\n        case \"Not\":\n          return !state;\n        default:\n          return true;\n      }\n    }\n    return operator === \"And\";\n  }\n\n  isVisible(group) {\n    if (this.#groups.size === 0) {\n      return true;\n    }\n    if (!group) {\n      warn(\"Optional content group not defined.\");\n      return true;\n    }\n    if (group.type === \"OCG\") {\n      if (!this.#groups.has(group.id)) {\n        warn(`Optional content group not found: ${group.id}`);\n        return true;\n      }\n      return this.#groups.get(group.id).visible;\n    } else if (group.type === \"OCMD\") {\n      // Per the spec, the expression should be preferred if available.\n      if (group.expression) {\n        return this.#evaluateVisibilityExpression(group.expression);\n      }\n      if (!group.policy || group.policy === \"AnyOn\") {\n        // Default\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n          if (this.#groups.get(id).visible) {\n            return true;\n          }\n        }\n        return false;\n      } else if (group.policy === \"AllOn\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n          if (!this.#groups.get(id).visible) {\n            return false;\n          }\n        }\n        return true;\n      } else if (group.policy === \"AnyOff\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n          if (!this.#groups.get(id).visible) {\n            return true;\n          }\n        }\n        return false;\n      } else if (group.policy === \"AllOff\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n          if (this.#groups.get(id).visible) {\n            return false;\n          }\n        }\n        return true;\n      }\n      warn(`Unknown optional content policy ${group.policy}.`);\n      return true;\n    }\n    warn(`Unknown group type ${group.type}.`);\n    return true;\n  }\n\n  setVisibility(id, visible = true) {\n    if (!this.#groups.has(id)) {\n      warn(`Optional content group not found: ${id}`);\n      return;\n    }\n    this.#groups.get(id)._setVisible(INTERNAL, !!visible);\n\n    this.#cachedGetHash = null;\n  }\n\n  get hasInitialVisibility() {\n    return this.#initialHash === null || this.getHash() === this.#initialHash;\n  }\n\n  getOrder() {\n    if (!this.#groups.size) {\n      return null;\n    }\n    if (this.#order) {\n      return this.#order.slice();\n    }\n    return [...this.#groups.keys()];\n  }\n\n  getGroups() {\n    return this.#groups.size > 0 ? objectFromMap(this.#groups) : null;\n  }\n\n  getGroup(id) {\n    return this.#groups.get(id) || null;\n  }\n\n  getHash() {\n    if (this.#cachedGetHash !== null) {\n      return this.#cachedGetHash;\n    }\n    const hash = new MurmurHash3_64();\n\n    for (const [id, group] of this.#groups) {\n      hash.update(`${id}:${group.visible}`);\n    }\n    return (this.#cachedGetHash = hash.hexdigest());\n  }\n}\n\nexport { OptionalContentConfig };\n","/* Copyright 2015 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./display_utils\").PageViewport} PageViewport */\n/** @typedef {import(\"./api\").TextContent} TextContent */\n\nimport {\n  AbortException,\n  FeatureTest,\n  PromiseCapability,\n  Util,\n} from \"../shared/util.js\";\nimport { setLayerDimensions } from \"./display_utils.js\";\n\n/**\n * Text layer render parameters.\n *\n * @typedef {Object} TextLayerRenderParameters\n * @property {ReadableStream | TextContent} textContentSource - Text content to\n *   render, i.e. the value returned by the page's `streamTextContent` or\n *   `getTextContent` method.\n * @property {HTMLElement} container - The DOM node that will contain the text\n *   runs.\n * @property {PageViewport} viewport - The target viewport to properly layout\n *   the text runs.\n * @property {Array<HTMLElement>} [textDivs] - HTML elements that correspond to\n *   the text items of the textContent input.\n *   This is output and shall initially be set to an empty array.\n * @property {WeakMap<HTMLElement,Object>} [textDivProperties] - Some properties\n *   weakly mapped to the HTML elements used to render the text.\n * @property {Array<string>} [textContentItemsStr] - Strings that correspond to\n *   the `str` property of the text items of the textContent input.\n *   This is output and shall initially be set to an empty array.\n * @property {boolean} [isOffscreenCanvasSupported] true if we can use\n *   OffscreenCanvas to measure string widths.\n */\n\n/**\n * Text layer update parameters.\n *\n * @typedef {Object} TextLayerUpdateParameters\n * @property {HTMLElement} container - The DOM node that will contain the text\n *   runs.\n * @property {PageViewport} viewport - The target viewport to properly layout\n *   the text runs.\n * @property {Array<HTMLElement>} [textDivs] - HTML elements that correspond to\n *   the text items of the textContent input.\n *   This is output and shall initially be set to an empty array.\n * @property {WeakMap<HTMLElement,Object>} [textDivProperties] - Some properties\n *   weakly mapped to the HTML elements used to render the text.\n * @property {boolean} [isOffscreenCanvasSupported] true if we can use\n *   OffscreenCanvas to measure string widths.\n * @property {boolean} [mustRotate] true if the text layer must be rotated.\n * @property {boolean} [mustRescale] true if the text layer contents must be\n *   rescaled.\n */\n\nconst MAX_TEXT_DIVS_TO_RENDER = 100000;\nconst DEFAULT_FONT_SIZE = 30;\nconst DEFAULT_FONT_ASCENT = 0.8;\nconst ascentCache = new Map();\n\nfunction getCtx(size, isOffscreenCanvasSupported) {\n  let ctx;\n  if (isOffscreenCanvasSupported && FeatureTest.isOffscreenCanvasSupported) {\n    ctx = new OffscreenCanvas(size, size).getContext(\"2d\", { alpha: false });\n  } else {\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = canvas.height = size;\n    ctx = canvas.getContext(\"2d\", { alpha: false });\n  }\n\n  return ctx;\n}\n\nfunction getAscent(fontFamily, isOffscreenCanvasSupported) {\n  const cachedAscent = ascentCache.get(fontFamily);\n  if (cachedAscent) {\n    return cachedAscent;\n  }\n\n  const ctx = getCtx(DEFAULT_FONT_SIZE, isOffscreenCanvasSupported);\n\n  ctx.font = `${DEFAULT_FONT_SIZE}px ${fontFamily}`;\n  const metrics = ctx.measureText(\"\");\n\n  // Both properties aren't available by default in Firefox.\n  let ascent = metrics.fontBoundingBoxAscent;\n  let descent = Math.abs(metrics.fontBoundingBoxDescent);\n  if (ascent) {\n    const ratio = ascent / (ascent + descent);\n    ascentCache.set(fontFamily, ratio);\n\n    ctx.canvas.width = ctx.canvas.height = 0;\n    return ratio;\n  }\n\n  // Try basic heuristic to guess ascent/descent.\n  // Draw a g with baseline at 0,0 and then get the line\n  // number where a pixel has non-null red component (starting\n  // from bottom).\n  ctx.strokeStyle = \"red\";\n  ctx.clearRect(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE);\n  ctx.strokeText(\"g\", 0, 0);\n  let pixels = ctx.getImageData(\n    0,\n    0,\n    DEFAULT_FONT_SIZE,\n    DEFAULT_FONT_SIZE\n  ).data;\n  descent = 0;\n  for (let i = pixels.length - 1 - 3; i >= 0; i -= 4) {\n    if (pixels[i] > 0) {\n      descent = Math.ceil(i / 4 / DEFAULT_FONT_SIZE);\n      break;\n    }\n  }\n\n  // Draw an A with baseline at 0,DEFAULT_FONT_SIZE and then get the line\n  // number where a pixel has non-null red component (starting\n  // from top).\n  ctx.clearRect(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE);\n  ctx.strokeText(\"A\", 0, DEFAULT_FONT_SIZE);\n  pixels = ctx.getImageData(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE).data;\n  ascent = 0;\n  for (let i = 0, ii = pixels.length; i < ii; i += 4) {\n    if (pixels[i] > 0) {\n      ascent = DEFAULT_FONT_SIZE - Math.floor(i / 4 / DEFAULT_FONT_SIZE);\n      break;\n    }\n  }\n\n  ctx.canvas.width = ctx.canvas.height = 0;\n\n  if (ascent) {\n    const ratio = ascent / (ascent + descent);\n    ascentCache.set(fontFamily, ratio);\n    return ratio;\n  }\n\n  ascentCache.set(fontFamily, DEFAULT_FONT_ASCENT);\n  return DEFAULT_FONT_ASCENT;\n}\n\nfunction appendText(task, geom, styles) {\n  // Initialize all used properties to keep the caches monomorphic.\n  const textDiv = document.createElement(\"span\");\n  const textDivProperties = {\n    angle: 0,\n    canvasWidth: 0,\n    hasText: geom.str !== \"\",\n    hasEOL: geom.hasEOL,\n    fontSize: 0,\n  };\n  task._textDivs.push(textDiv);\n\n  const tx = Util.transform(task._transform, geom.transform);\n  let angle = Math.atan2(tx[1], tx[0]);\n  const style = styles[geom.fontName];\n  if (style.vertical) {\n    angle += Math.PI / 2;\n  }\n\n  const fontFamily =\n    (task._fontInspectorEnabled && style.fontSubstitution) || style.fontFamily;\n  const fontHeight = Math.hypot(tx[2], tx[3]);\n  const fontAscent =\n    fontHeight * getAscent(fontFamily, task._isOffscreenCanvasSupported);\n\n  let left, top;\n  if (angle === 0) {\n    left = tx[4];\n    top = tx[5] - fontAscent;\n  } else {\n    left = tx[4] + fontAscent * Math.sin(angle);\n    top = tx[5] - fontAscent * Math.cos(angle);\n  }\n\n  const scaleFactorStr = \"calc(var(--scale-factor)*\";\n  const divStyle = textDiv.style;\n  // Setting the style properties individually, rather than all at once,\n  // should be OK since the `textDiv` isn't appended to the document yet.\n  if (task._container === task._rootContainer) {\n    divStyle.left = `${((100 * left) / task._pageWidth).toFixed(2)}%`;\n    divStyle.top = `${((100 * top) / task._pageHeight).toFixed(2)}%`;\n  } else {\n    // We're in a marked content span, hence we can't use percents.\n    divStyle.left = `${scaleFactorStr}${left.toFixed(2)}px)`;\n    divStyle.top = `${scaleFactorStr}${top.toFixed(2)}px)`;\n  }\n  divStyle.fontSize = `${scaleFactorStr}${fontHeight.toFixed(2)}px)`;\n  divStyle.fontFamily = fontFamily;\n\n  textDivProperties.fontSize = fontHeight;\n\n  // Keeps screen readers from pausing on every new text span.\n  textDiv.setAttribute(\"role\", \"presentation\");\n\n  textDiv.textContent = geom.str;\n  // geom.dir may be 'ttb' for vertical texts.\n  textDiv.dir = geom.dir;\n\n  // `fontName` is only used by the FontInspector, and we only use `dataset`\n  // here to make the font name available in the debugger.\n  if (task._fontInspectorEnabled) {\n    textDiv.dataset.fontName =\n      style.fontSubstitutionLoadedName || geom.fontName;\n  }\n  if (angle !== 0) {\n    textDivProperties.angle = angle * (180 / Math.PI);\n  }\n  // We don't bother scaling single-char text divs, because it has very\n  // little effect on text highlighting. This makes scrolling on docs with\n  // lots of such divs a lot faster.\n  let shouldScaleText = false;\n  if (geom.str.length > 1) {\n    shouldScaleText = true;\n  } else if (geom.str !== \" \" && geom.transform[0] !== geom.transform[3]) {\n    const absScaleX = Math.abs(geom.transform[0]),\n      absScaleY = Math.abs(geom.transform[3]);\n    // When the horizontal/vertical scaling differs significantly, also scale\n    // even single-char text to improve highlighting (fixes issue11713.pdf).\n    if (\n      absScaleX !== absScaleY &&\n      Math.max(absScaleX, absScaleY) / Math.min(absScaleX, absScaleY) > 1.5\n    ) {\n      shouldScaleText = true;\n    }\n  }\n  if (shouldScaleText) {\n    textDivProperties.canvasWidth = style.vertical ? geom.height : geom.width;\n  }\n  task._textDivProperties.set(textDiv, textDivProperties);\n  if (task._isReadableStream) {\n    task._layoutText(textDiv);\n  }\n}\n\nfunction layout(params) {\n  const { div, scale, properties, ctx, prevFontSize, prevFontFamily } = params;\n  const { style } = div;\n  let transform = \"\";\n  if (properties.canvasWidth !== 0 && properties.hasText) {\n    const { fontFamily } = style;\n    const { canvasWidth, fontSize } = properties;\n\n    if (prevFontSize !== fontSize || prevFontFamily !== fontFamily) {\n      ctx.font = `${fontSize * scale}px ${fontFamily}`;\n      params.prevFontSize = fontSize;\n      params.prevFontFamily = fontFamily;\n    }\n\n    // Only measure the width for multi-char text divs, see `appendText`.\n    const { width } = ctx.measureText(div.textContent);\n\n    if (width > 0) {\n      transform = `scaleX(${(canvasWidth * scale) / width})`;\n    }\n  }\n  if (properties.angle !== 0) {\n    transform = `rotate(${properties.angle}deg) ${transform}`;\n  }\n  if (transform.length > 0) {\n    style.transform = transform;\n  }\n}\n\nfunction render(task) {\n  if (task._canceled) {\n    return;\n  }\n  const textDivs = task._textDivs;\n  const capability = task._capability;\n  const textDivsLength = textDivs.length;\n\n  // No point in rendering many divs as it would make the browser\n  // unusable even after the divs are rendered.\n  if (textDivsLength > MAX_TEXT_DIVS_TO_RENDER) {\n    capability.resolve();\n    return;\n  }\n\n  if (!task._isReadableStream) {\n    for (const textDiv of textDivs) {\n      task._layoutText(textDiv);\n    }\n  }\n  capability.resolve();\n}\n\nclass TextLayerRenderTask {\n  constructor({\n    textContentSource,\n    container,\n    viewport,\n    textDivs,\n    textDivProperties,\n    textContentItemsStr,\n    isOffscreenCanvasSupported,\n  }) {\n    this._textContentSource = textContentSource;\n    this._isReadableStream = textContentSource instanceof ReadableStream;\n    this._container = this._rootContainer = container;\n    this._textDivs = textDivs || [];\n    this._textContentItemsStr = textContentItemsStr || [];\n    this._isOffscreenCanvasSupported = isOffscreenCanvasSupported;\n    this._fontInspectorEnabled = !!globalThis.FontInspector?.enabled;\n\n    this._reader = null;\n    this._textDivProperties = textDivProperties || new WeakMap();\n    this._canceled = false;\n    this._capability = new PromiseCapability();\n    this._layoutTextParams = {\n      prevFontSize: null,\n      prevFontFamily: null,\n      div: null,\n      scale: viewport.scale * (globalThis.devicePixelRatio || 1),\n      properties: null,\n      ctx: getCtx(0, isOffscreenCanvasSupported),\n    };\n    const { pageWidth, pageHeight, pageX, pageY } = viewport.rawDims;\n    this._transform = [1, 0, 0, -1, -pageX, pageY + pageHeight];\n    this._pageWidth = pageWidth;\n    this._pageHeight = pageHeight;\n\n    setLayerDimensions(container, viewport);\n\n    // Always clean-up the temporary canvas once rendering is no longer pending.\n    this._capability.promise\n      .finally(() => {\n        this._layoutTextParams = null;\n      })\n      .catch(() => {\n        // Avoid \"Uncaught promise\" messages in the console.\n      });\n  }\n\n  /**\n   * Promise for textLayer rendering task completion.\n   * @type {Promise<void>}\n   */\n  get promise() {\n    return this._capability.promise;\n  }\n\n  /**\n   * Cancel rendering of the textLayer.\n   */\n  cancel() {\n    this._canceled = true;\n    if (this._reader) {\n      this._reader\n        .cancel(new AbortException(\"TextLayer task cancelled.\"))\n        .catch(() => {\n          // Avoid \"Uncaught promise\" messages in the console.\n        });\n      this._reader = null;\n    }\n    this._capability.reject(new AbortException(\"TextLayer task cancelled.\"));\n  }\n\n  /**\n   * @private\n   */\n  _processItems(items, styleCache) {\n    for (const item of items) {\n      if (item.str === undefined) {\n        if (\n          item.type === \"beginMarkedContentProps\" ||\n          item.type === \"beginMarkedContent\"\n        ) {\n          const parent = this._container;\n          this._container = document.createElement(\"span\");\n          this._container.classList.add(\"markedContent\");\n          if (item.id !== null) {\n            this._container.setAttribute(\"id\", `${item.id}`);\n          }\n          parent.append(this._container);\n        } else if (item.type === \"endMarkedContent\") {\n          this._container = this._container.parentNode;\n        }\n        continue;\n      }\n      this._textContentItemsStr.push(item.str);\n      appendText(this, item, styleCache);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _layoutText(textDiv) {\n    const textDivProperties = (this._layoutTextParams.properties =\n      this._textDivProperties.get(textDiv));\n    this._layoutTextParams.div = textDiv;\n    layout(this._layoutTextParams);\n\n    if (textDivProperties.hasText) {\n      this._container.append(textDiv);\n    }\n    if (textDivProperties.hasEOL) {\n      const br = document.createElement(\"br\");\n      br.setAttribute(\"role\", \"presentation\");\n      this._container.append(br);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _render() {\n    const capability = new PromiseCapability();\n    let styleCache = Object.create(null);\n\n    if (this._isReadableStream) {\n      const pump = () => {\n        this._reader.read().then(({ value, done }) => {\n          if (done) {\n            capability.resolve();\n            return;\n          }\n\n          Object.assign(styleCache, value.styles);\n          this._processItems(value.items, styleCache);\n          pump();\n        }, capability.reject);\n      };\n\n      this._reader = this._textContentSource.getReader();\n      pump();\n    } else if (this._textContentSource) {\n      const { items, styles } = this._textContentSource;\n      this._processItems(items, styles);\n      capability.resolve();\n    } else {\n      throw new Error('No \"textContentSource\" parameter specified.');\n    }\n\n    capability.promise.then(() => {\n      styleCache = null;\n      render(this);\n    }, this._capability.reject);\n  }\n}\n\n/**\n * @param {TextLayerRenderParameters} params\n * @returns {TextLayerRenderTask}\n */\nfunction renderTextLayer(params) {\n  const task = new TextLayerRenderTask(params);\n  task._render();\n  return task;\n}\n\n/**\n * @param {TextLayerUpdateParameters} params\n * @returns {undefined}\n */\nfunction updateTextLayer({\n  container,\n  viewport,\n  textDivs,\n  textDivProperties,\n  isOffscreenCanvasSupported,\n  mustRotate = true,\n  mustRescale = true,\n}) {\n  if (mustRotate) {\n    setLayerDimensions(container, { rotation: viewport.rotation });\n  }\n\n  if (mustRescale) {\n    const ctx = getCtx(0, isOffscreenCanvasSupported);\n    const scale = viewport.scale * (globalThis.devicePixelRatio || 1);\n    const params = {\n      prevFontSize: null,\n      prevFontFamily: null,\n      div: null,\n      scale,\n      properties: null,\n      ctx,\n    };\n    for (const div of textDivs) {\n      params.properties = textDivProperties.get(div);\n      params.div = div;\n      layout(params);\n    }\n  }\n}\n\nexport { renderTextLayer, TextLayerRenderTask, updateTextLayer };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"../interfaces\").IPDFStream} IPDFStream */\n/** @typedef {import(\"../interfaces\").IPDFStreamReader} IPDFStreamReader */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../interfaces\").IPDFStreamRangeReader} IPDFStreamRangeReader */\n\nimport { assert, PromiseCapability } from \"../shared/util.js\";\nimport { isPdfFile } from \"./display_utils.js\";\n\n/** @implements {IPDFStream} */\nclass PDFDataTransportStream {\n  constructor(\n    {\n      length,\n      initialData,\n      progressiveDone = false,\n      contentDispositionFilename = null,\n      disableRange = false,\n      disableStream = false,\n    },\n    pdfDataRangeTransport\n  ) {\n    assert(\n      pdfDataRangeTransport,\n      'PDFDataTransportStream - missing required \"pdfDataRangeTransport\" argument.'\n    );\n\n    this._queuedChunks = [];\n    this._progressiveDone = progressiveDone;\n    this._contentDispositionFilename = contentDispositionFilename;\n\n    if (initialData?.length > 0) {\n      // Prevent any possible issues by only transferring a Uint8Array that\n      // completely \"utilizes\" its underlying ArrayBuffer.\n      const buffer =\n        initialData instanceof Uint8Array &&\n        initialData.byteLength === initialData.buffer.byteLength\n          ? initialData.buffer\n          : new Uint8Array(initialData).buffer;\n      this._queuedChunks.push(buffer);\n    }\n\n    this._pdfDataRangeTransport = pdfDataRangeTransport;\n    this._isStreamingSupported = !disableStream;\n    this._isRangeSupported = !disableRange;\n    this._contentLength = length;\n\n    this._fullRequestReader = null;\n    this._rangeReaders = [];\n\n    this._pdfDataRangeTransport.addRangeListener((begin, chunk) => {\n      this._onReceiveData({ begin, chunk });\n    });\n\n    this._pdfDataRangeTransport.addProgressListener((loaded, total) => {\n      this._onProgress({ loaded, total });\n    });\n\n    this._pdfDataRangeTransport.addProgressiveReadListener(chunk => {\n      this._onReceiveData({ chunk });\n    });\n\n    this._pdfDataRangeTransport.addProgressiveDoneListener(() => {\n      this._onProgressiveDone();\n    });\n\n    this._pdfDataRangeTransport.transportReady();\n  }\n\n  _onReceiveData({ begin, chunk }) {\n    // Prevent any possible issues by only transferring a Uint8Array that\n    // completely \"utilizes\" its underlying ArrayBuffer.\n    const buffer =\n      chunk instanceof Uint8Array &&\n      chunk.byteLength === chunk.buffer.byteLength\n        ? chunk.buffer\n        : new Uint8Array(chunk).buffer;\n\n    if (begin === undefined) {\n      if (this._fullRequestReader) {\n        this._fullRequestReader._enqueue(buffer);\n      } else {\n        this._queuedChunks.push(buffer);\n      }\n    } else {\n      const found = this._rangeReaders.some(function (rangeReader) {\n        if (rangeReader._begin !== begin) {\n          return false;\n        }\n        rangeReader._enqueue(buffer);\n        return true;\n      });\n      assert(\n        found,\n        \"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.\"\n      );\n    }\n  }\n\n  get _progressiveDataLength() {\n    return this._fullRequestReader?._loaded ?? 0;\n  }\n\n  _onProgress(evt) {\n    if (evt.total === undefined) {\n      // Reporting to first range reader, if it exists.\n      this._rangeReaders[0]?.onProgress?.({ loaded: evt.loaded });\n    } else {\n      this._fullRequestReader?.onProgress?.({\n        loaded: evt.loaded,\n        total: evt.total,\n      });\n    }\n  }\n\n  _onProgressiveDone() {\n    this._fullRequestReader?.progressiveDone();\n    this._progressiveDone = true;\n  }\n\n  _removeRangeReader(reader) {\n    const i = this._rangeReaders.indexOf(reader);\n    if (i >= 0) {\n      this._rangeReaders.splice(i, 1);\n    }\n  }\n\n  getFullReader() {\n    assert(\n      !this._fullRequestReader,\n      \"PDFDataTransportStream.getFullReader can only be called once.\"\n    );\n    const queuedChunks = this._queuedChunks;\n    this._queuedChunks = null;\n    return new PDFDataTransportStreamReader(\n      this,\n      queuedChunks,\n      this._progressiveDone,\n      this._contentDispositionFilename\n    );\n  }\n\n  getRangeReader(begin, end) {\n    if (end <= this._progressiveDataLength) {\n      return null;\n    }\n    const reader = new PDFDataTransportStreamRangeReader(this, begin, end);\n    this._pdfDataRangeTransport.requestDataRange(begin, end);\n    this._rangeReaders.push(reader);\n    return reader;\n  }\n\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n\n    for (const reader of this._rangeReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n    this._pdfDataRangeTransport.abort();\n  }\n}\n\n/** @implements {IPDFStreamReader} */\nclass PDFDataTransportStreamReader {\n  constructor(\n    stream,\n    queuedChunks,\n    progressiveDone = false,\n    contentDispositionFilename = null\n  ) {\n    this._stream = stream;\n    this._done = progressiveDone || false;\n    this._filename = isPdfFile(contentDispositionFilename)\n      ? contentDispositionFilename\n      : null;\n    this._queuedChunks = queuedChunks || [];\n    this._loaded = 0;\n    for (const chunk of this._queuedChunks) {\n      this._loaded += chunk.byteLength;\n    }\n    this._requests = [];\n    this._headersReady = Promise.resolve();\n    stream._fullRequestReader = this;\n\n    this.onProgress = null;\n  }\n\n  _enqueue(chunk) {\n    if (this._done) {\n      return; // Ignore new data.\n    }\n    if (this._requests.length > 0) {\n      const requestCapability = this._requests.shift();\n      requestCapability.resolve({ value: chunk, done: false });\n    } else {\n      this._queuedChunks.push(chunk);\n    }\n    this._loaded += chunk.byteLength;\n  }\n\n  get headersReady() {\n    return this._headersReady;\n  }\n\n  get filename() {\n    return this._filename;\n  }\n\n  get isRangeSupported() {\n    return this._stream._isRangeSupported;\n  }\n\n  get isStreamingSupported() {\n    return this._stream._isStreamingSupported;\n  }\n\n  get contentLength() {\n    return this._stream._contentLength;\n  }\n\n  async read() {\n    if (this._queuedChunks.length > 0) {\n      const chunk = this._queuedChunks.shift();\n      return { value: chunk, done: false };\n    }\n    if (this._done) {\n      return { value: undefined, done: true };\n    }\n    const requestCapability = new PromiseCapability();\n    this._requests.push(requestCapability);\n    return requestCapability.promise;\n  }\n\n  cancel(reason) {\n    this._done = true;\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({ value: undefined, done: true });\n    }\n    this._requests.length = 0;\n  }\n\n  progressiveDone() {\n    if (this._done) {\n      return;\n    }\n    this._done = true;\n  }\n}\n\n/** @implements {IPDFStreamRangeReader} */\nclass PDFDataTransportStreamRangeReader {\n  constructor(stream, begin, end) {\n    this._stream = stream;\n    this._begin = begin;\n    this._end = end;\n    this._queuedChunk = null;\n    this._requests = [];\n    this._done = false;\n\n    this.onProgress = null;\n  }\n\n  _enqueue(chunk) {\n    if (this._done) {\n      return; // ignore new data\n    }\n    if (this._requests.length === 0) {\n      this._queuedChunk = chunk;\n    } else {\n      const requestsCapability = this._requests.shift();\n      requestsCapability.resolve({ value: chunk, done: false });\n      for (const requestCapability of this._requests) {\n        requestCapability.resolve({ value: undefined, done: true });\n      }\n      this._requests.length = 0;\n    }\n    this._done = true;\n    this._stream._removeRangeReader(this);\n  }\n\n  get isStreamingSupported() {\n    return false;\n  }\n\n  async read() {\n    if (this._queuedChunk) {\n      const chunk = this._queuedChunk;\n      this._queuedChunk = null;\n      return { value: chunk, done: false };\n    }\n    if (this._done) {\n      return { value: undefined, done: true };\n    }\n    const requestCapability = new PromiseCapability();\n    this._requests.push(requestCapability);\n    return requestCapability.promise;\n  }\n\n  cancel(reason) {\n    this._done = true;\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({ value: undefined, done: true });\n    }\n    this._requests.length = 0;\n    this._stream._removeRangeReader(this);\n  }\n}\n\nexport { PDFDataTransportStream };\n","/* Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @typedef {Object} GlobalWorkerOptionsType\n * @property {Worker | null} workerPort - Defines global port for worker\n *   process. Overrides the `workerSrc` option.\n * @property {string} workerSrc - A string containing the path and filename\n *   of the worker file.\n *\n *   NOTE: The `workerSrc` option should always be set, in order to prevent any\n *         issues when using the PDF.js library.\n */\n\n/** @type {GlobalWorkerOptionsType} */\nconst GlobalWorkerOptions = Object.create(null);\n\nGlobalWorkerOptions.workerPort = null;\nGlobalWorkerOptions.workerSrc = \"\";\n\nexport { GlobalWorkerOptions };\n","/* Copyright 2021 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./annotation_storage\").AnnotationStorage} AnnotationStorage */\n/** @typedef {import(\"./display_utils\").PageViewport} PageViewport */\n/** @typedef {import(\"../../web/interfaces\").IPDFLinkService} IPDFLinkService */\n\nimport { XfaText } from \"./xfa_text.js\";\n\n/**\n * @typedef {Object} XfaLayerParameters\n * @property {PageViewport} viewport\n * @property {HTMLDivElement} div\n * @property {Object} xfaHtml\n * @property {AnnotationStorage} [annotationStorage]\n * @property {IPDFLinkService} linkService\n * @property {string} [intent] - (default value is 'display').\n */\n\nclass XfaLayer {\n  static setupStorage(html, id, element, storage, intent) {\n    const storedData = storage.getValue(id, { value: null });\n    switch (element.name) {\n      case \"textarea\":\n        if (storedData.value !== null) {\n          html.textContent = storedData.value;\n        }\n        if (intent === \"print\") {\n          break;\n        }\n        html.addEventListener(\"input\", event => {\n          storage.setValue(id, { value: event.target.value });\n        });\n        break;\n      case \"input\":\n        if (\n          element.attributes.type === \"radio\" ||\n          element.attributes.type === \"checkbox\"\n        ) {\n          if (storedData.value === element.attributes.xfaOn) {\n            html.setAttribute(\"checked\", true);\n          } else if (storedData.value === element.attributes.xfaOff) {\n            // The checked attribute may have been set when opening the file,\n            // unset through the UI and we're here because of printing.\n            html.removeAttribute(\"checked\");\n          }\n          if (intent === \"print\") {\n            break;\n          }\n          html.addEventListener(\"change\", event => {\n            storage.setValue(id, {\n              value: event.target.checked\n                ? event.target.getAttribute(\"xfaOn\")\n                : event.target.getAttribute(\"xfaOff\"),\n            });\n          });\n        } else {\n          if (storedData.value !== null) {\n            html.setAttribute(\"value\", storedData.value);\n          }\n          if (intent === \"print\") {\n            break;\n          }\n          html.addEventListener(\"input\", event => {\n            storage.setValue(id, { value: event.target.value });\n          });\n        }\n        break;\n      case \"select\":\n        if (storedData.value !== null) {\n          html.setAttribute(\"value\", storedData.value);\n          for (const option of element.children) {\n            if (option.attributes.value === storedData.value) {\n              option.attributes.selected = true;\n            } else if (option.attributes.hasOwnProperty(\"selected\")) {\n              delete option.attributes.selected;\n            }\n          }\n        }\n        html.addEventListener(\"input\", event => {\n          const options = event.target.options;\n          const value =\n            options.selectedIndex === -1\n              ? \"\"\n              : options[options.selectedIndex].value;\n          storage.setValue(id, { value });\n        });\n        break;\n    }\n  }\n\n  static setAttributes({ html, element, storage = null, intent, linkService }) {\n    const { attributes } = element;\n    const isHTMLAnchorElement = html instanceof HTMLAnchorElement;\n\n    if (attributes.type === \"radio\") {\n      // Avoid to have a radio group when printing with the same as one\n      // already displayed.\n      attributes.name = `${attributes.name}-${intent}`;\n    }\n    for (const [key, value] of Object.entries(attributes)) {\n      if (value === null || value === undefined) {\n        continue;\n      }\n\n      switch (key) {\n        case \"class\":\n          if (value.length) {\n            html.setAttribute(key, value.join(\" \"));\n          }\n          break;\n        case \"dataId\":\n          // We don't need to add dataId in the html object but it can\n          // be useful to know its value when writing printing tests:\n          // in this case, don't skip dataId to have its value.\n          break;\n        case \"id\":\n          html.setAttribute(\"data-element-id\", value);\n          break;\n        case \"style\":\n          Object.assign(html.style, value);\n          break;\n        case \"textContent\":\n          html.textContent = value;\n          break;\n        default:\n          if (!isHTMLAnchorElement || (key !== \"href\" && key !== \"newWindow\")) {\n            html.setAttribute(key, value);\n          }\n      }\n    }\n\n    if (isHTMLAnchorElement) {\n      linkService.addLinkAttributes(\n        html,\n        attributes.href,\n        attributes.newWindow\n      );\n    }\n\n    // Set the value after the others to be sure to overwrite any other values.\n    if (storage && attributes.dataId) {\n      this.setupStorage(html, attributes.dataId, element, storage);\n    }\n  }\n\n  /**\n   * Render the XFA layer.\n   *\n   * @param {XfaLayerParameters} parameters\n   */\n  static render(parameters) {\n    const storage = parameters.annotationStorage;\n    const linkService = parameters.linkService;\n    const root = parameters.xfaHtml;\n    const intent = parameters.intent || \"display\";\n    const rootHtml = document.createElement(root.name);\n    if (root.attributes) {\n      this.setAttributes({\n        html: rootHtml,\n        element: root,\n        intent,\n        linkService,\n      });\n    }\n\n    const isNotForRichText = intent !== \"richText\";\n    const rootDiv = parameters.div;\n    rootDiv.append(rootHtml);\n\n    if (parameters.viewport) {\n      const transform = `matrix(${parameters.viewport.transform.join(\",\")})`;\n      rootDiv.style.transform = transform;\n    }\n\n    // Set defaults.\n    if (isNotForRichText) {\n      rootDiv.setAttribute(\"class\", \"xfaLayer xfaFont\");\n    }\n\n    // Text nodes used for the text highlighter.\n    const textDivs = [];\n\n    // In the rich text context, it's possible to just have a text node without\n    // a root element, so we handle this case here (see issue 17215).\n    if (root.children.length === 0) {\n      if (root.value) {\n        const node = document.createTextNode(root.value);\n        rootHtml.append(node);\n        if (isNotForRichText && XfaText.shouldBuildText(root.name)) {\n          textDivs.push(node);\n        }\n      }\n      return { textDivs };\n    }\n\n    const stack = [[root, -1, rootHtml]];\n\n    while (stack.length > 0) {\n      const [parent, i, html] = stack.at(-1);\n      if (i + 1 === parent.children.length) {\n        stack.pop();\n        continue;\n      }\n\n      const child = parent.children[++stack.at(-1)[1]];\n      if (child === null) {\n        continue;\n      }\n\n      const { name } = child;\n      if (name === \"#text\") {\n        const node = document.createTextNode(child.value);\n        textDivs.push(node);\n        html.append(node);\n        continue;\n      }\n\n      const childHtml = child?.attributes?.xmlns\n        ? document.createElementNS(child.attributes.xmlns, name)\n        : document.createElement(name);\n\n      html.append(childHtml);\n      if (child.attributes) {\n        this.setAttributes({\n          html: childHtml,\n          element: child,\n          storage,\n          intent,\n          linkService,\n        });\n      }\n\n      if (child.children?.length > 0) {\n        stack.push([child, -1, childHtml]);\n      } else if (child.value) {\n        const node = document.createTextNode(child.value);\n        if (isNotForRichText && XfaText.shouldBuildText(name)) {\n          textDivs.push(node);\n        }\n        childHtml.append(node);\n      }\n    }\n\n    /**\n     * TODO: re-enable that stuff once we've JS implementation.\n     * See https://bugzilla.mozilla.org/show_bug.cgi?id=1719465.\n     *\n     * for (const el of rootDiv.querySelectorAll(\n     * \".xfaDisabled input, .xfaDisabled textarea\"\n     * )) {\n     * el.setAttribute(\"disabled\", true);\n     * }\n     * for (const el of rootDiv.querySelectorAll(\n     * \".xfaReadOnly input, .xfaReadOnly textarea\"\n     * )) {\n     * el.setAttribute(\"readOnly\", true);\n     * }\n     */\n\n    for (const el of rootDiv.querySelectorAll(\n      \".xfaNonInteractive input, .xfaNonInteractive textarea\"\n    )) {\n      el.setAttribute(\"readOnly\", true);\n    }\n\n    return {\n      textDivs,\n    };\n  }\n\n  /**\n   * Update the XFA layer.\n   *\n   * @param {XfaLayerParameters} parameters\n   */\n  static update(parameters) {\n    const transform = `matrix(${parameters.viewport.transform.join(\",\")})`;\n    parameters.div.style.transform = transform;\n    parameters.div.hidden = false;\n  }\n}\n\nexport { XfaLayer };\n","/* Copyright 2021 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./api\").TextContent} TextContent */\n\nclass XfaText {\n  /**\n   * Walk an XFA tree and create an array of text nodes that is compatible\n   * with a regular PDFs TextContent. Currently, only TextItem.str is supported,\n   * all other fields and styles haven't been implemented.\n   *\n   * @param {Object} xfa - An XFA fake DOM object.\n   *\n   * @returns {TextContent}\n   */\n  static textContent(xfa) {\n    const items = [];\n    const output = {\n      items,\n      styles: Object.create(null),\n    };\n    function walk(node) {\n      if (!node) {\n        return;\n      }\n      let str = null;\n      const name = node.name;\n      if (name === \"#text\") {\n        str = node.value;\n      } else if (!XfaText.shouldBuildText(name)) {\n        return;\n      } else if (node?.attributes?.textContent) {\n        str = node.attributes.textContent;\n      } else if (node.value) {\n        str = node.value;\n      }\n      if (str !== null) {\n        items.push({\n          str,\n        });\n      }\n      if (!node.children) {\n        return;\n      }\n      for (const child of node.children) {\n        walk(child);\n      }\n    }\n    walk(xfa);\n    return output;\n  }\n\n  /**\n   * @param {string} name - DOM node name. (lower case)\n   *\n   * @returns {boolean} true if the DOM node should have a corresponding text\n   * node.\n   */\n  static shouldBuildText(name) {\n    return !(\n      name === \"textarea\" ||\n      name === \"input\" ||\n      name === \"option\" ||\n      name === \"select\"\n    );\n  }\n}\n\nexport { XfaText };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./display/api\").OnProgressParameters} OnProgressParameters */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./display/api\").PDFDocumentLoadingTask} PDFDocumentLoadingTask */\n/** @typedef {import(\"./display/api\").PDFDocumentProxy} PDFDocumentProxy */\n/** @typedef {import(\"./display/api\").PDFPageProxy} PDFPageProxy */\n/** @typedef {import(\"./display/api\").RenderTask} RenderTask */\n/** @typedef {import(\"./display/display_utils\").PageViewport} PageViewport */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./display/text_layer\").TextLayerRenderTask} TextLayerRenderTask */\n\nimport {\n  AbortException,\n  AnnotationEditorParamsType,\n  AnnotationEditorType,\n  AnnotationMode,\n  CMapCompressionType,\n  createValidAbsoluteUrl,\n  FeatureTest,\n  ImageKind,\n  InvalidPDFException,\n  MissingPDFException,\n  normalizeUnicode,\n  OPS,\n  PasswordResponses,\n  PermissionFlag,\n  PromiseCapability,\n  shadow,\n  UnexpectedResponseException,\n  Util,\n  VerbosityLevel,\n} from \"./shared/util.js\";\nimport {\n  build,\n  getDocument,\n  PDFDataRangeTransport,\n  PDFWorker,\n  version,\n} from \"./display/api.js\";\nimport {\n  DOMSVGFactory,\n  fetchData,\n  getFilenameFromUrl,\n  getPdfFilenameFromUrl,\n  getXfaPageViewport,\n  isDataScheme,\n  isPdfFile,\n  noContextMenu,\n  PDFDateString,\n  PixelsPerInch,\n  RenderingCancelledException,\n  setLayerDimensions,\n} from \"./display/display_utils.js\";\nimport { renderTextLayer, updateTextLayer } from \"./display/text_layer.js\";\nimport { AnnotationEditorLayer } from \"./display/editor/annotation_editor_layer.js\";\nimport { AnnotationEditorUIManager } from \"./display/editor/tools.js\";\nimport { AnnotationLayer } from \"./display/annotation_layer.js\";\nimport { DrawLayer } from \"./display/draw_layer.js\";\nimport { GlobalWorkerOptions } from \"./display/worker_options.js\";\nimport { Outliner } from \"./display/editor/outliner.js\";\nimport { XfaLayer } from \"./display/xfa_layer.js\";\n\n/* eslint-disable-next-line no-unused-vars */\nconst pdfjsVersion =\n  typeof PDFJSDev !== \"undefined\" ? PDFJSDev.eval(\"BUNDLE_VERSION\") : void 0;\n/* eslint-disable-next-line no-unused-vars */\nconst pdfjsBuild =\n  typeof PDFJSDev !== \"undefined\" ? PDFJSDev.eval(\"BUNDLE_BUILD\") : void 0;\n\nexport {\n  AbortException,\n  AnnotationEditorLayer,\n  AnnotationEditorParamsType,\n  AnnotationEditorType,\n  AnnotationEditorUIManager,\n  AnnotationLayer,\n  AnnotationMode,\n  build,\n  CMapCompressionType,\n  createValidAbsoluteUrl,\n  DOMSVGFactory,\n  DrawLayer,\n  FeatureTest,\n  fetchData,\n  getDocument,\n  getFilenameFromUrl,\n  getPdfFilenameFromUrl,\n  getXfaPageViewport,\n  GlobalWorkerOptions,\n  ImageKind,\n  InvalidPDFException,\n  isDataScheme,\n  isPdfFile,\n  MissingPDFException,\n  noContextMenu,\n  normalizeUnicode,\n  OPS,\n  Outliner,\n  PasswordResponses,\n  PDFDataRangeTransport,\n  PDFDateString,\n  PDFWorker,\n  PermissionFlag,\n  PixelsPerInch,\n  PromiseCapability,\n  RenderingCancelledException,\n  renderTextLayer,\n  setLayerDimensions,\n  shadow,\n  UnexpectedResponseException,\n  updateTextLayer,\n  Util,\n  VerbosityLevel,\n  version,\n  XfaLayer,\n};\n","/* Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  AbortException,\n  assert,\n  MissingPDFException,\n  PasswordException,\n  PromiseCapability,\n  UnexpectedResponseException,\n  UnknownErrorException,\n  unreachable,\n} from \"./util.js\";\n\nconst CallbackKind = {\n  UNKNOWN: 0,\n  DATA: 1,\n  ERROR: 2,\n};\n\nconst StreamKind = {\n  UNKNOWN: 0,\n  CANCEL: 1,\n  CANCEL_COMPLETE: 2,\n  CLOSE: 3,\n  ENQUEUE: 4,\n  ERROR: 5,\n  PULL: 6,\n  PULL_COMPLETE: 7,\n  START_COMPLETE: 8,\n};\n\nfunction wrapReason(reason) {\n  if (\n    !(\n      reason instanceof Error ||\n      (typeof reason === \"object\" && reason !== null)\n    )\n  ) {\n    unreachable(\n      'wrapReason: Expected \"reason\" to be a (possibly cloned) Error.'\n    );\n  }\n  switch (reason.name) {\n    case \"AbortException\":\n      return new AbortException(reason.message);\n    case \"MissingPDFException\":\n      return new MissingPDFException(reason.message);\n    case \"PasswordException\":\n      return new PasswordException(reason.message, reason.code);\n    case \"UnexpectedResponseException\":\n      return new UnexpectedResponseException(reason.message, reason.status);\n    case \"UnknownErrorException\":\n      return new UnknownErrorException(reason.message, reason.details);\n    default:\n      return new UnknownErrorException(reason.message, reason.toString());\n  }\n}\n\nclass MessageHandler {\n  constructor(sourceName, targetName, comObj) {\n    this.sourceName = sourceName;\n    this.targetName = targetName;\n    this.comObj = comObj;\n    this.callbackId = 1;\n    this.streamId = 1;\n    this.streamSinks = Object.create(null);\n    this.streamControllers = Object.create(null);\n    this.callbackCapabilities = Object.create(null);\n    this.actionHandler = Object.create(null);\n\n    this._onComObjOnMessage = event => {\n      const data = event.data;\n      if (data.targetName !== this.sourceName) {\n        return;\n      }\n      if (data.stream) {\n        this.#processStreamMessage(data);\n        return;\n      }\n      if (data.callback) {\n        const callbackId = data.callbackId;\n        const capability = this.callbackCapabilities[callbackId];\n        if (!capability) {\n          throw new Error(`Cannot resolve callback ${callbackId}`);\n        }\n        delete this.callbackCapabilities[callbackId];\n\n        if (data.callback === CallbackKind.DATA) {\n          capability.resolve(data.data);\n        } else if (data.callback === CallbackKind.ERROR) {\n          capability.reject(wrapReason(data.reason));\n        } else {\n          throw new Error(\"Unexpected callback case\");\n        }\n        return;\n      }\n      const action = this.actionHandler[data.action];\n      if (!action) {\n        throw new Error(`Unknown action from worker: ${data.action}`);\n      }\n      if (data.callbackId) {\n        const cbSourceName = this.sourceName;\n        const cbTargetName = data.sourceName;\n\n        new Promise(function (resolve) {\n          resolve(action(data.data));\n        }).then(\n          function (result) {\n            comObj.postMessage({\n              sourceName: cbSourceName,\n              targetName: cbTargetName,\n              callback: CallbackKind.DATA,\n              callbackId: data.callbackId,\n              data: result,\n            });\n          },\n          function (reason) {\n            comObj.postMessage({\n              sourceName: cbSourceName,\n              targetName: cbTargetName,\n              callback: CallbackKind.ERROR,\n              callbackId: data.callbackId,\n              reason: wrapReason(reason),\n            });\n          }\n        );\n        return;\n      }\n      if (data.streamId) {\n        this.#createStreamSink(data);\n        return;\n      }\n      action(data.data);\n    };\n    comObj.addEventListener(\"message\", this._onComObjOnMessage);\n  }\n\n  on(actionName, handler) {\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      assert(\n        typeof handler === \"function\",\n        'MessageHandler.on: Expected \"handler\" to be a function.'\n      );\n    }\n    const ah = this.actionHandler;\n    if (ah[actionName]) {\n      throw new Error(`There is already an actionName called \"${actionName}\"`);\n    }\n    ah[actionName] = handler;\n  }\n\n  /**\n   * Sends a message to the comObj to invoke the action with the supplied data.\n   * @param {string} actionName - Action to call.\n   * @param {JSON} data - JSON data to send.\n   * @param {Array} [transfers] - List of transfers/ArrayBuffers.\n   */\n  send(actionName, data, transfers) {\n    this.comObj.postMessage(\n      {\n        sourceName: this.sourceName,\n        targetName: this.targetName,\n        action: actionName,\n        data,\n      },\n      transfers\n    );\n  }\n\n  /**\n   * Sends a message to the comObj to invoke the action with the supplied data.\n   * Expects that the other side will callback with the response.\n   * @param {string} actionName - Action to call.\n   * @param {JSON} data - JSON data to send.\n   * @param {Array} [transfers] - List of transfers/ArrayBuffers.\n   * @returns {Promise} Promise to be resolved with response data.\n   */\n  sendWithPromise(actionName, data, transfers) {\n    const callbackId = this.callbackId++;\n    const capability = new PromiseCapability();\n    this.callbackCapabilities[callbackId] = capability;\n    try {\n      this.comObj.postMessage(\n        {\n          sourceName: this.sourceName,\n          targetName: this.targetName,\n          action: actionName,\n          callbackId,\n          data,\n        },\n        transfers\n      );\n    } catch (ex) {\n      capability.reject(ex);\n    }\n    return capability.promise;\n  }\n\n  /**\n   * Sends a message to the comObj to invoke the action with the supplied data.\n   * Expect that the other side will callback to signal 'start_complete'.\n   * @param {string} actionName - Action to call.\n   * @param {JSON} data - JSON data to send.\n   * @param {Object} queueingStrategy - Strategy to signal backpressure based on\n   *                 internal queue.\n   * @param {Array} [transfers] - List of transfers/ArrayBuffers.\n   * @returns {ReadableStream} ReadableStream to read data in chunks.\n   */\n  sendWithStream(actionName, data, queueingStrategy, transfers) {\n    const streamId = this.streamId++,\n      sourceName = this.sourceName,\n      targetName = this.targetName,\n      comObj = this.comObj;\n\n    return new ReadableStream(\n      {\n        start: controller => {\n          const startCapability = new PromiseCapability();\n          this.streamControllers[streamId] = {\n            controller,\n            startCall: startCapability,\n            pullCall: null,\n            cancelCall: null,\n            isClosed: false,\n          };\n          comObj.postMessage(\n            {\n              sourceName,\n              targetName,\n              action: actionName,\n              streamId,\n              data,\n              desiredSize: controller.desiredSize,\n            },\n            transfers\n          );\n          // Return Promise for Async process, to signal success/failure.\n          return startCapability.promise;\n        },\n\n        pull: controller => {\n          const pullCapability = new PromiseCapability();\n          this.streamControllers[streamId].pullCall = pullCapability;\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.PULL,\n            streamId,\n            desiredSize: controller.desiredSize,\n          });\n          // Returning Promise will not call \"pull\"\n          // again until current pull is resolved.\n          return pullCapability.promise;\n        },\n\n        cancel: reason => {\n          assert(reason instanceof Error, \"cancel must have a valid reason\");\n          const cancelCapability = new PromiseCapability();\n          this.streamControllers[streamId].cancelCall = cancelCapability;\n          this.streamControllers[streamId].isClosed = true;\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.CANCEL,\n            streamId,\n            reason: wrapReason(reason),\n          });\n          // Return Promise to signal success or failure.\n          return cancelCapability.promise;\n        },\n      },\n      queueingStrategy\n    );\n  }\n\n  #createStreamSink(data) {\n    const streamId = data.streamId,\n      sourceName = this.sourceName,\n      targetName = data.sourceName,\n      comObj = this.comObj;\n    const self = this,\n      action = this.actionHandler[data.action];\n\n    const streamSink = {\n      enqueue(chunk, size = 1, transfers) {\n        if (this.isCancelled) {\n          return;\n        }\n        const lastDesiredSize = this.desiredSize;\n        this.desiredSize -= size;\n        // Enqueue decreases the desiredSize property of sink,\n        // so when it changes from positive to negative,\n        // set ready as unresolved promise.\n        if (lastDesiredSize > 0 && this.desiredSize <= 0) {\n          this.sinkCapability = new PromiseCapability();\n          this.ready = this.sinkCapability.promise;\n        }\n        comObj.postMessage(\n          {\n            sourceName,\n            targetName,\n            stream: StreamKind.ENQUEUE,\n            streamId,\n            chunk,\n          },\n          transfers\n        );\n      },\n\n      close() {\n        if (this.isCancelled) {\n          return;\n        }\n        this.isCancelled = true;\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.CLOSE,\n          streamId,\n        });\n        delete self.streamSinks[streamId];\n      },\n\n      error(reason) {\n        assert(reason instanceof Error, \"error must have a valid reason\");\n        if (this.isCancelled) {\n          return;\n        }\n        this.isCancelled = true;\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.ERROR,\n          streamId,\n          reason: wrapReason(reason),\n        });\n      },\n\n      sinkCapability: new PromiseCapability(),\n      onPull: null,\n      onCancel: null,\n      isCancelled: false,\n      desiredSize: data.desiredSize,\n      ready: null,\n    };\n\n    streamSink.sinkCapability.resolve();\n    streamSink.ready = streamSink.sinkCapability.promise;\n    this.streamSinks[streamId] = streamSink;\n\n    new Promise(function (resolve) {\n      resolve(action(data.data, streamSink));\n    }).then(\n      function () {\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.START_COMPLETE,\n          streamId,\n          success: true,\n        });\n      },\n      function (reason) {\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.START_COMPLETE,\n          streamId,\n          reason: wrapReason(reason),\n        });\n      }\n    );\n  }\n\n  #processStreamMessage(data) {\n    const streamId = data.streamId,\n      sourceName = this.sourceName,\n      targetName = data.sourceName,\n      comObj = this.comObj;\n    const streamController = this.streamControllers[streamId],\n      streamSink = this.streamSinks[streamId];\n\n    switch (data.stream) {\n      case StreamKind.START_COMPLETE:\n        if (data.success) {\n          streamController.startCall.resolve();\n        } else {\n          streamController.startCall.reject(wrapReason(data.reason));\n        }\n        break;\n      case StreamKind.PULL_COMPLETE:\n        if (data.success) {\n          streamController.pullCall.resolve();\n        } else {\n          streamController.pullCall.reject(wrapReason(data.reason));\n        }\n        break;\n      case StreamKind.PULL:\n        // Ignore any pull after close is called.\n        if (!streamSink) {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.PULL_COMPLETE,\n            streamId,\n            success: true,\n          });\n          break;\n        }\n        // Pull increases the desiredSize property of sink, so when it changes\n        // from negative to positive, set ready property as resolved promise.\n        if (streamSink.desiredSize <= 0 && data.desiredSize > 0) {\n          streamSink.sinkCapability.resolve();\n        }\n        // Reset desiredSize property of sink on every pull.\n        streamSink.desiredSize = data.desiredSize;\n\n        new Promise(function (resolve) {\n          resolve(streamSink.onPull?.());\n        }).then(\n          function () {\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              stream: StreamKind.PULL_COMPLETE,\n              streamId,\n              success: true,\n            });\n          },\n          function (reason) {\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              stream: StreamKind.PULL_COMPLETE,\n              streamId,\n              reason: wrapReason(reason),\n            });\n          }\n        );\n        break;\n      case StreamKind.ENQUEUE:\n        assert(streamController, \"enqueue should have stream controller\");\n        if (streamController.isClosed) {\n          break;\n        }\n        streamController.controller.enqueue(data.chunk);\n        break;\n      case StreamKind.CLOSE:\n        assert(streamController, \"close should have stream controller\");\n        if (streamController.isClosed) {\n          break;\n        }\n        streamController.isClosed = true;\n        streamController.controller.close();\n        this.#deleteStreamController(streamController, streamId);\n        break;\n      case StreamKind.ERROR:\n        assert(streamController, \"error should have stream controller\");\n        streamController.controller.error(wrapReason(data.reason));\n        this.#deleteStreamController(streamController, streamId);\n        break;\n      case StreamKind.CANCEL_COMPLETE:\n        if (data.success) {\n          streamController.cancelCall.resolve();\n        } else {\n          streamController.cancelCall.reject(wrapReason(data.reason));\n        }\n        this.#deleteStreamController(streamController, streamId);\n        break;\n      case StreamKind.CANCEL:\n        if (!streamSink) {\n          break;\n        }\n\n        new Promise(function (resolve) {\n          resolve(streamSink.onCancel?.(wrapReason(data.reason)));\n        }).then(\n          function () {\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              stream: StreamKind.CANCEL_COMPLETE,\n              streamId,\n              success: true,\n            });\n          },\n          function (reason) {\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              stream: StreamKind.CANCEL_COMPLETE,\n              streamId,\n              reason: wrapReason(reason),\n            });\n          }\n        );\n        streamSink.sinkCapability.reject(wrapReason(data.reason));\n        streamSink.isCancelled = true;\n        delete this.streamSinks[streamId];\n        break;\n      default:\n        throw new Error(\"Unexpected stream case\");\n    }\n  }\n\n  async #deleteStreamController(streamController, streamId) {\n    // Delete the `streamController` only when the start, pull, and cancel\n    // capabilities have settled, to prevent `TypeError`s.\n    await Promise.allSettled([\n      streamController.startCall?.promise,\n      streamController.pullCall?.promise,\n      streamController.cancelCall?.promise,\n    ]);\n    delete this.streamControllers[streamId];\n  }\n\n  destroy() {\n    this.comObj.removeEventListener(\"message\", this._onComObjOnMessage);\n  }\n}\n\nexport { MessageHandler };\n","/* Copyright 2014 Opera Software ASA\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n *\n * Based on https://code.google.com/p/smhasher/wiki/MurmurHash3.\n * Hashes roughly 100 KB per millisecond on i7 3.4 GHz.\n */\n\nimport { isArrayBuffer } from \"./util.js\";\n\nconst SEED = 0xc3d2e1f0;\n// Workaround for missing math precision in JS.\nconst MASK_HIGH = 0xffff0000;\nconst MASK_LOW = 0xffff;\n\nclass MurmurHash3_64 {\n  constructor(seed) {\n    this.h1 = seed ? seed & 0xffffffff : SEED;\n    this.h2 = seed ? seed & 0xffffffff : SEED;\n  }\n\n  update(input) {\n    let data, length;\n    if (typeof input === \"string\") {\n      data = new Uint8Array(input.length * 2);\n      length = 0;\n      for (let i = 0, ii = input.length; i < ii; i++) {\n        const code = input.charCodeAt(i);\n        if (code <= 0xff) {\n          data[length++] = code;\n        } else {\n          data[length++] = code >>> 8;\n          data[length++] = code & 0xff;\n        }\n      }\n    } else if (isArrayBuffer(input)) {\n      data = input.slice();\n      length = data.byteLength;\n    } else {\n      throw new Error(\n        \"Wrong data format in MurmurHash3_64_update. \" +\n          \"Input must be a string or array.\"\n      );\n    }\n\n    const blockCounts = length >> 2;\n    const tailLength = length - blockCounts * 4;\n    // We don't care about endianness here.\n    const dataUint32 = new Uint32Array(data.buffer, 0, blockCounts);\n    let k1 = 0,\n      k2 = 0;\n    let h1 = this.h1,\n      h2 = this.h2;\n    const C1 = 0xcc9e2d51,\n      C2 = 0x1b873593;\n    const C1_LOW = C1 & MASK_LOW,\n      C2_LOW = C2 & MASK_LOW;\n\n    for (let i = 0; i < blockCounts; i++) {\n      if (i & 1) {\n        k1 = dataUint32[i];\n        k1 = ((k1 * C1) & MASK_HIGH) | ((k1 * C1_LOW) & MASK_LOW);\n        k1 = (k1 << 15) | (k1 >>> 17);\n        k1 = ((k1 * C2) & MASK_HIGH) | ((k1 * C2_LOW) & MASK_LOW);\n        h1 ^= k1;\n        h1 = (h1 << 13) | (h1 >>> 19);\n        h1 = h1 * 5 + 0xe6546b64;\n      } else {\n        k2 = dataUint32[i];\n        k2 = ((k2 * C1) & MASK_HIGH) | ((k2 * C1_LOW) & MASK_LOW);\n        k2 = (k2 << 15) | (k2 >>> 17);\n        k2 = ((k2 * C2) & MASK_HIGH) | ((k2 * C2_LOW) & MASK_LOW);\n        h2 ^= k2;\n        h2 = (h2 << 13) | (h2 >>> 19);\n        h2 = h2 * 5 + 0xe6546b64;\n      }\n    }\n\n    k1 = 0;\n\n    switch (tailLength) {\n      case 3:\n        k1 ^= data[blockCounts * 4 + 2] << 16;\n      /* falls through */\n      case 2:\n        k1 ^= data[blockCounts * 4 + 1] << 8;\n      /* falls through */\n      case 1:\n        k1 ^= data[blockCounts * 4];\n        /* falls through */\n\n        k1 = ((k1 * C1) & MASK_HIGH) | ((k1 * C1_LOW) & MASK_LOW);\n        k1 = (k1 << 15) | (k1 >>> 17);\n        k1 = ((k1 * C2) & MASK_HIGH) | ((k1 * C2_LOW) & MASK_LOW);\n        if (blockCounts & 1) {\n          h1 ^= k1;\n        } else {\n          h2 ^= k1;\n        }\n    }\n\n    this.h1 = h1;\n    this.h2 = h2;\n  }\n\n  hexdigest() {\n    let h1 = this.h1,\n      h2 = this.h2;\n\n    h1 ^= h2 >>> 1;\n    h1 = ((h1 * 0xed558ccd) & MASK_HIGH) | ((h1 * 0x8ccd) & MASK_LOW);\n    h2 =\n      ((h2 * 0xff51afd7) & MASK_HIGH) |\n      (((((h2 << 16) | (h1 >>> 16)) * 0xafd7ed55) & MASK_HIGH) >>> 16);\n    h1 ^= h2 >>> 1;\n    h1 = ((h1 * 0x1a85ec53) & MASK_HIGH) | ((h1 * 0xec53) & MASK_LOW);\n    h2 =\n      ((h2 * 0xc4ceb9fe) & MASK_HIGH) |\n      (((((h2 << 16) | (h1 >>> 16)) * 0xb9fe1a85) & MASK_HIGH) >>> 16);\n    h1 ^= h2 >>> 1;\n\n    return (\n      (h1 >>> 0).toString(16).padStart(8, \"0\") +\n      (h2 >>> 0).toString(16).padStart(8, \"0\")\n    );\n  }\n}\n\nexport { MurmurHash3_64 };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* globals process */\n\n// NW.js / Electron is a browser context, but copies some Node.js objects; see\n// http://docs.nwjs.io/en/latest/For%20Users/Advanced/JavaScript%20Contexts%20in%20NW.js/#access-nodejs-and-nwjs-api-in-browser-context\n// https://www.electronjs.org/docs/api/process#processversionselectron-readonly\n// https://www.electronjs.org/docs/api/process#processtype-readonly\nconst isNodeJS =\n  (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n  typeof process === \"object\" &&\n  process + \"\" === \"[object process]\" &&\n  !process.versions.nw &&\n  !(process.versions.electron && process.type && process.type !== \"browser\");\n\nconst IDENTITY_MATRIX = [1, 0, 0, 1, 0, 0];\nconst FONT_IDENTITY_MATRIX = [0.001, 0, 0, 0.001, 0, 0];\n\nconst MAX_IMAGE_SIZE_TO_CACHE = 10e6; // Ten megabytes.\n\n// Represent the percentage of the height of a single-line field over\n// the font size. Acrobat seems to use this value.\nconst LINE_FACTOR = 1.35;\nconst LINE_DESCENT_FACTOR = 0.35;\nconst BASELINE_FACTOR = LINE_DESCENT_FACTOR / LINE_FACTOR;\n\n/**\n * Refer to the `WorkerTransport.getRenderingIntent`-method in the API, to see\n * how these flags are being used:\n *  - ANY, DISPLAY, and PRINT are the normal rendering intents, note the\n *    `PDFPageProxy.{render, getOperatorList, getAnnotations}`-methods.\n *  - ANNOTATIONS_FORMS, ANNOTATIONS_STORAGE, ANNOTATIONS_DISABLE control which\n *    annotations are rendered onto the canvas (i.e. by being included in the\n *    operatorList), note the `PDFPageProxy.{render, getOperatorList}`-methods\n *    and their `annotationMode`-option.\n *  - OPLIST is used with the `PDFPageProxy.getOperatorList`-method, note the\n *    `OperatorList`-constructor (on the worker-thread).\n */\nconst RenderingIntentFlag = {\n  ANY: 0x01,\n  DISPLAY: 0x02,\n  PRINT: 0x04,\n  SAVE: 0x08,\n  ANNOTATIONS_FORMS: 0x10,\n  ANNOTATIONS_STORAGE: 0x20,\n  ANNOTATIONS_DISABLE: 0x40,\n  OPLIST: 0x100,\n};\n\nconst AnnotationMode = {\n  DISABLE: 0,\n  ENABLE: 1,\n  ENABLE_FORMS: 2,\n  ENABLE_STORAGE: 3,\n};\n\nconst AnnotationEditorPrefix = \"pdfjs_internal_editor_\";\n\nconst AnnotationEditorType = {\n  DISABLE: -1,\n  NONE: 0,\n  FREETEXT: 3,\n  HIGHLIGHT: 9,\n  STAMP: 13,\n  INK: 15,\n};\n\nconst AnnotationEditorParamsType = {\n  RESIZE: 1,\n  CREATE: 2,\n  FREETEXT_SIZE: 11,\n  FREETEXT_COLOR: 12,\n  FREETEXT_OPACITY: 13,\n  INK_COLOR: 21,\n  INK_THICKNESS: 22,\n  INK_OPACITY: 23,\n};\n\n// Permission flags from Table 22, Section 7.6.3.2 of the PDF specification.\nconst PermissionFlag = {\n  PRINT: 0x04,\n  MODIFY_CONTENTS: 0x08,\n  COPY: 0x10,\n  MODIFY_ANNOTATIONS: 0x20,\n  FILL_INTERACTIVE_FORMS: 0x100,\n  COPY_FOR_ACCESSIBILITY: 0x200,\n  ASSEMBLE: 0x400,\n  PRINT_HIGH_QUALITY: 0x800,\n};\n\nconst TextRenderingMode = {\n  FILL: 0,\n  STROKE: 1,\n  FILL_STROKE: 2,\n  INVISIBLE: 3,\n  FILL_ADD_TO_PATH: 4,\n  STROKE_ADD_TO_PATH: 5,\n  FILL_STROKE_ADD_TO_PATH: 6,\n  ADD_TO_PATH: 7,\n  FILL_STROKE_MASK: 3,\n  ADD_TO_PATH_FLAG: 4,\n};\n\nconst ImageKind = {\n  GRAYSCALE_1BPP: 1,\n  RGB_24BPP: 2,\n  RGBA_32BPP: 3,\n};\n\nconst AnnotationType = {\n  TEXT: 1,\n  LINK: 2,\n  FREETEXT: 3,\n  LINE: 4,\n  SQUARE: 5,\n  CIRCLE: 6,\n  POLYGON: 7,\n  POLYLINE: 8,\n  HIGHLIGHT: 9,\n  UNDERLINE: 10,\n  SQUIGGLY: 11,\n  STRIKEOUT: 12,\n  STAMP: 13,\n  CARET: 14,\n  INK: 15,\n  POPUP: 16,\n  FILEATTACHMENT: 17,\n  SOUND: 18,\n  MOVIE: 19,\n  WIDGET: 20,\n  SCREEN: 21,\n  PRINTERMARK: 22,\n  TRAPNET: 23,\n  WATERMARK: 24,\n  THREED: 25,\n  REDACT: 26,\n};\n\nconst AnnotationReplyType = {\n  GROUP: \"Group\",\n  REPLY: \"R\",\n};\n\nconst AnnotationFlag = {\n  INVISIBLE: 0x01,\n  HIDDEN: 0x02,\n  PRINT: 0x04,\n  NOZOOM: 0x08,\n  NOROTATE: 0x10,\n  NOVIEW: 0x20,\n  READONLY: 0x40,\n  LOCKED: 0x80,\n  TOGGLENOVIEW: 0x100,\n  LOCKEDCONTENTS: 0x200,\n};\n\nconst AnnotationFieldFlag = {\n  READONLY: 0x0000001,\n  REQUIRED: 0x0000002,\n  NOEXPORT: 0x0000004,\n  MULTILINE: 0x0001000,\n  PASSWORD: 0x0002000,\n  NOTOGGLETOOFF: 0x0004000,\n  RADIO: 0x0008000,\n  PUSHBUTTON: 0x0010000,\n  COMBO: 0x0020000,\n  EDIT: 0x0040000,\n  SORT: 0x0080000,\n  FILESELECT: 0x0100000,\n  MULTISELECT: 0x0200000,\n  DONOTSPELLCHECK: 0x0400000,\n  DONOTSCROLL: 0x0800000,\n  COMB: 0x1000000,\n  RICHTEXT: 0x2000000,\n  RADIOSINUNISON: 0x2000000,\n  COMMITONSELCHANGE: 0x4000000,\n};\n\nconst AnnotationBorderStyleType = {\n  SOLID: 1,\n  DASHED: 2,\n  BEVELED: 3,\n  INSET: 4,\n  UNDERLINE: 5,\n};\n\nconst AnnotationActionEventType = {\n  E: \"Mouse Enter\",\n  X: \"Mouse Exit\",\n  D: \"Mouse Down\",\n  U: \"Mouse Up\",\n  Fo: \"Focus\",\n  Bl: \"Blur\",\n  PO: \"PageOpen\",\n  PC: \"PageClose\",\n  PV: \"PageVisible\",\n  PI: \"PageInvisible\",\n  K: \"Keystroke\",\n  F: \"Format\",\n  V: \"Validate\",\n  C: \"Calculate\",\n};\n\nconst DocumentActionEventType = {\n  WC: \"WillClose\",\n  WS: \"WillSave\",\n  DS: \"DidSave\",\n  WP: \"WillPrint\",\n  DP: \"DidPrint\",\n};\n\nconst PageActionEventType = {\n  O: \"PageOpen\",\n  C: \"PageClose\",\n};\n\nconst VerbosityLevel = {\n  ERRORS: 0,\n  WARNINGS: 1,\n  INFOS: 5,\n};\n\nconst CMapCompressionType = {\n  NONE: 0,\n  BINARY: 1,\n};\n\n// All the possible operations for an operator list.\nconst OPS = {\n  // Intentionally start from 1 so it is easy to spot bad operators that will be\n  // 0's.\n  // PLEASE NOTE: We purposely keep any removed operators commented out, since\n  //              re-numbering the list would risk breaking third-party users.\n  dependency: 1,\n  setLineWidth: 2,\n  setLineCap: 3,\n  setLineJoin: 4,\n  setMiterLimit: 5,\n  setDash: 6,\n  setRenderingIntent: 7,\n  setFlatness: 8,\n  setGState: 9,\n  save: 10,\n  restore: 11,\n  transform: 12,\n  moveTo: 13,\n  lineTo: 14,\n  curveTo: 15,\n  curveTo2: 16,\n  curveTo3: 17,\n  closePath: 18,\n  rectangle: 19,\n  stroke: 20,\n  closeStroke: 21,\n  fill: 22,\n  eoFill: 23,\n  fillStroke: 24,\n  eoFillStroke: 25,\n  closeFillStroke: 26,\n  closeEOFillStroke: 27,\n  endPath: 28,\n  clip: 29,\n  eoClip: 30,\n  beginText: 31,\n  endText: 32,\n  setCharSpacing: 33,\n  setWordSpacing: 34,\n  setHScale: 35,\n  setLeading: 36,\n  setFont: 37,\n  setTextRenderingMode: 38,\n  setTextRise: 39,\n  moveText: 40,\n  setLeadingMoveText: 41,\n  setTextMatrix: 42,\n  nextLine: 43,\n  showText: 44,\n  showSpacedText: 45,\n  nextLineShowText: 46,\n  nextLineSetSpacingShowText: 47,\n  setCharWidth: 48,\n  setCharWidthAndBounds: 49,\n  setStrokeColorSpace: 50,\n  setFillColorSpace: 51,\n  setStrokeColor: 52,\n  setStrokeColorN: 53,\n  setFillColor: 54,\n  setFillColorN: 55,\n  setStrokeGray: 56,\n  setFillGray: 57,\n  setStrokeRGBColor: 58,\n  setFillRGBColor: 59,\n  setStrokeCMYKColor: 60,\n  setFillCMYKColor: 61,\n  shadingFill: 62,\n  beginInlineImage: 63,\n  beginImageData: 64,\n  endInlineImage: 65,\n  paintXObject: 66,\n  markPoint: 67,\n  markPointProps: 68,\n  beginMarkedContent: 69,\n  beginMarkedContentProps: 70,\n  endMarkedContent: 71,\n  beginCompat: 72,\n  endCompat: 73,\n  paintFormXObjectBegin: 74,\n  paintFormXObjectEnd: 75,\n  beginGroup: 76,\n  endGroup: 77,\n  // beginAnnotations: 78,\n  // endAnnotations: 79,\n  beginAnnotation: 80,\n  endAnnotation: 81,\n  // paintJpegXObject: 82,\n  paintImageMaskXObject: 83,\n  paintImageMaskXObjectGroup: 84,\n  paintImageXObject: 85,\n  paintInlineImageXObject: 86,\n  paintInlineImageXObjectGroup: 87,\n  paintImageXObjectRepeat: 88,\n  paintImageMaskXObjectRepeat: 89,\n  paintSolidColorImageMask: 90,\n  constructPath: 91,\n};\n\nconst PasswordResponses = {\n  NEED_PASSWORD: 1,\n  INCORRECT_PASSWORD: 2,\n};\n\nlet verbosity = VerbosityLevel.WARNINGS;\n\nfunction setVerbosityLevel(level) {\n  if (Number.isInteger(level)) {\n    verbosity = level;\n  }\n}\n\nfunction getVerbosityLevel() {\n  return verbosity;\n}\n\n// A notice for devs. These are good for things that are helpful to devs, such\n// as warning that Workers were disabled, which is important to devs but not\n// end users.\nfunction info(msg) {\n  if (verbosity >= VerbosityLevel.INFOS) {\n    console.log(`Info: ${msg}`);\n  }\n}\n\n// Non-fatal warnings.\nfunction warn(msg) {\n  if (verbosity >= VerbosityLevel.WARNINGS) {\n    console.log(`Warning: ${msg}`);\n  }\n}\n\nfunction unreachable(msg) {\n  throw new Error(msg);\n}\n\nfunction assert(cond, msg) {\n  if (!cond) {\n    unreachable(msg);\n  }\n}\n\n// Checks if URLs use one of the allowed protocols, e.g. to avoid XSS.\nfunction _isValidProtocol(url) {\n  switch (url?.protocol) {\n    case \"http:\":\n    case \"https:\":\n    case \"ftp:\":\n    case \"mailto:\":\n    case \"tel:\":\n      return true;\n    default:\n      return false;\n  }\n}\n\n/**\n * Attempts to create a valid absolute URL.\n *\n * @param {URL|string} url - An absolute, or relative, URL.\n * @param {URL|string} [baseUrl] - An absolute URL.\n * @param {Object} [options]\n * @returns Either a valid {URL}, or `null` otherwise.\n */\nfunction createValidAbsoluteUrl(url, baseUrl = null, options = null) {\n  if (!url) {\n    return null;\n  }\n  try {\n    if (options && typeof url === \"string\") {\n      // Let URLs beginning with \"www.\" default to using the \"http://\" protocol.\n      if (options.addDefaultProtocol && url.startsWith(\"www.\")) {\n        const dots = url.match(/\\./g);\n        // Avoid accidentally matching a *relative* URL pointing to a file named\n        // e.g. \"www.pdf\" or similar.\n        if (dots?.length >= 2) {\n          url = `http://${url}`;\n        }\n      }\n\n      // According to ISO 32000-1:2008, section 12.6.4.7, URIs should be encoded\n      // in 7-bit ASCII. Some bad PDFs use UTF-8 encoding; see bug 1122280.\n      if (options.tryConvertEncoding) {\n        try {\n          url = stringToUTF8String(url);\n        } catch {}\n      }\n    }\n\n    const absoluteUrl = baseUrl ? new URL(url, baseUrl) : new URL(url);\n    if (_isValidProtocol(absoluteUrl)) {\n      return absoluteUrl;\n    }\n  } catch {\n    /* `new URL()` will throw on incorrect data. */\n  }\n  return null;\n}\n\nfunction shadow(obj, prop, value, nonSerializable = false) {\n  if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n    assert(\n      prop in obj,\n      `shadow: Property \"${prop && prop.toString()}\" not found in object.`\n    );\n  }\n  Object.defineProperty(obj, prop, {\n    value,\n    enumerable: !nonSerializable,\n    configurable: true,\n    writable: false,\n  });\n  return value;\n}\n\n/**\n * @type {any}\n */\nconst BaseException = (function BaseExceptionClosure() {\n  // eslint-disable-next-line no-shadow\n  function BaseException(message, name) {\n    if (this.constructor === BaseException) {\n      unreachable(\"Cannot initialize BaseException.\");\n    }\n    this.message = message;\n    this.name = name;\n  }\n  BaseException.prototype = new Error();\n  BaseException.constructor = BaseException;\n\n  return BaseException;\n})();\n\nclass PasswordException extends BaseException {\n  constructor(msg, code) {\n    super(msg, \"PasswordException\");\n    this.code = code;\n  }\n}\n\nclass UnknownErrorException extends BaseException {\n  constructor(msg, details) {\n    super(msg, \"UnknownErrorException\");\n    this.details = details;\n  }\n}\n\nclass InvalidPDFException extends BaseException {\n  constructor(msg) {\n    super(msg, \"InvalidPDFException\");\n  }\n}\n\nclass MissingPDFException extends BaseException {\n  constructor(msg) {\n    super(msg, \"MissingPDFException\");\n  }\n}\n\nclass UnexpectedResponseException extends BaseException {\n  constructor(msg, status) {\n    super(msg, \"UnexpectedResponseException\");\n    this.status = status;\n  }\n}\n\n/**\n * Error caused during parsing PDF data.\n */\nclass FormatError extends BaseException {\n  constructor(msg) {\n    super(msg, \"FormatError\");\n  }\n}\n\n/**\n * Error used to indicate task cancellation.\n */\nclass AbortException extends BaseException {\n  constructor(msg) {\n    super(msg, \"AbortException\");\n  }\n}\n\nfunction bytesToString(bytes) {\n  if (typeof bytes !== \"object\" || bytes?.length === undefined) {\n    unreachable(\"Invalid argument for bytesToString\");\n  }\n  const length = bytes.length;\n  const MAX_ARGUMENT_COUNT = 8192;\n  if (length < MAX_ARGUMENT_COUNT) {\n    return String.fromCharCode.apply(null, bytes);\n  }\n  const strBuf = [];\n  for (let i = 0; i < length; i += MAX_ARGUMENT_COUNT) {\n    const chunkEnd = Math.min(i + MAX_ARGUMENT_COUNT, length);\n    const chunk = bytes.subarray(i, chunkEnd);\n    strBuf.push(String.fromCharCode.apply(null, chunk));\n  }\n  return strBuf.join(\"\");\n}\n\nfunction stringToBytes(str) {\n  if (typeof str !== \"string\") {\n    unreachable(\"Invalid argument for stringToBytes\");\n  }\n  const length = str.length;\n  const bytes = new Uint8Array(length);\n  for (let i = 0; i < length; ++i) {\n    bytes[i] = str.charCodeAt(i) & 0xff;\n  }\n  return bytes;\n}\n\nfunction string32(value) {\n  if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n    assert(\n      typeof value === \"number\" && Math.abs(value) < 2 ** 32,\n      `string32: Unexpected input \"${value}\".`\n    );\n  }\n  return String.fromCharCode(\n    (value >> 24) & 0xff,\n    (value >> 16) & 0xff,\n    (value >> 8) & 0xff,\n    value & 0xff\n  );\n}\n\nfunction objectSize(obj) {\n  return Object.keys(obj).length;\n}\n\n// Ensure that the returned Object has a `null` prototype; hence why\n// `Object.fromEntries(...)` is not used.\nfunction objectFromMap(map) {\n  const obj = Object.create(null);\n  for (const [key, value] of map) {\n    obj[key] = value;\n  }\n  return obj;\n}\n\n// Checks the endianness of the platform.\nfunction isLittleEndian() {\n  const buffer8 = new Uint8Array(4);\n  buffer8[0] = 1;\n  const view32 = new Uint32Array(buffer8.buffer, 0, 1);\n  return view32[0] === 1;\n}\n\n// Checks if it's possible to eval JS expressions.\nfunction isEvalSupported() {\n  try {\n    new Function(\"\"); // eslint-disable-line no-new, no-new-func\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nclass FeatureTest {\n  static get isLittleEndian() {\n    return shadow(this, \"isLittleEndian\", isLittleEndian());\n  }\n\n  static get isEvalSupported() {\n    return shadow(this, \"isEvalSupported\", isEvalSupported());\n  }\n\n  static get isOffscreenCanvasSupported() {\n    return shadow(\n      this,\n      \"isOffscreenCanvasSupported\",\n      typeof OffscreenCanvas !== \"undefined\"\n    );\n  }\n\n  static get platform() {\n    if (\n      (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n      (typeof navigator !== \"undefined\" &&\n        typeof navigator?.platform === \"string\")\n    ) {\n      return shadow(this, \"platform\", {\n        isMac: navigator.platform.includes(\"Mac\"),\n      });\n    }\n    return shadow(this, \"platform\", { isMac: false });\n  }\n\n  static get isCSSRoundSupported() {\n    return shadow(\n      this,\n      \"isCSSRoundSupported\",\n      globalThis.CSS?.supports?.(\"width: round(1.5px, 1px)\")\n    );\n  }\n}\n\nconst hexNumbers = [...Array(256).keys()].map(n =>\n  n.toString(16).padStart(2, \"0\")\n);\n\nclass Util {\n  static makeHexColor(r, g, b) {\n    return `#${hexNumbers[r]}${hexNumbers[g]}${hexNumbers[b]}`;\n  }\n\n  // Apply a scaling matrix to some min/max values.\n  // If a scaling factor is negative then min and max must be\n  // swaped.\n  static scaleMinMax(transform, minMax) {\n    let temp;\n    if (transform[0]) {\n      if (transform[0] < 0) {\n        temp = minMax[0];\n        minMax[0] = minMax[1];\n        minMax[1] = temp;\n      }\n      minMax[0] *= transform[0];\n      minMax[1] *= transform[0];\n\n      if (transform[3] < 0) {\n        temp = minMax[2];\n        minMax[2] = minMax[3];\n        minMax[3] = temp;\n      }\n      minMax[2] *= transform[3];\n      minMax[3] *= transform[3];\n    } else {\n      temp = minMax[0];\n      minMax[0] = minMax[2];\n      minMax[2] = temp;\n      temp = minMax[1];\n      minMax[1] = minMax[3];\n      minMax[3] = temp;\n\n      if (transform[1] < 0) {\n        temp = minMax[2];\n        minMax[2] = minMax[3];\n        minMax[3] = temp;\n      }\n      minMax[2] *= transform[1];\n      minMax[3] *= transform[1];\n\n      if (transform[2] < 0) {\n        temp = minMax[0];\n        minMax[0] = minMax[1];\n        minMax[1] = temp;\n      }\n      minMax[0] *= transform[2];\n      minMax[1] *= transform[2];\n    }\n    minMax[0] += transform[4];\n    minMax[1] += transform[4];\n    minMax[2] += transform[5];\n    minMax[3] += transform[5];\n  }\n\n  // Concatenates two transformation matrices together and returns the result.\n  static transform(m1, m2) {\n    return [\n      m1[0] * m2[0] + m1[2] * m2[1],\n      m1[1] * m2[0] + m1[3] * m2[1],\n      m1[0] * m2[2] + m1[2] * m2[3],\n      m1[1] * m2[2] + m1[3] * m2[3],\n      m1[0] * m2[4] + m1[2] * m2[5] + m1[4],\n      m1[1] * m2[4] + m1[3] * m2[5] + m1[5],\n    ];\n  }\n\n  // For 2d affine transforms\n  static applyTransform(p, m) {\n    const xt = p[0] * m[0] + p[1] * m[2] + m[4];\n    const yt = p[0] * m[1] + p[1] * m[3] + m[5];\n    return [xt, yt];\n  }\n\n  static applyInverseTransform(p, m) {\n    const d = m[0] * m[3] - m[1] * m[2];\n    const xt = (p[0] * m[3] - p[1] * m[2] + m[2] * m[5] - m[4] * m[3]) / d;\n    const yt = (-p[0] * m[1] + p[1] * m[0] + m[4] * m[1] - m[5] * m[0]) / d;\n    return [xt, yt];\n  }\n\n  // Applies the transform to the rectangle and finds the minimum axially\n  // aligned bounding box.\n  static getAxialAlignedBoundingBox(r, m) {\n    const p1 = this.applyTransform(r, m);\n    const p2 = this.applyTransform(r.slice(2, 4), m);\n    const p3 = this.applyTransform([r[0], r[3]], m);\n    const p4 = this.applyTransform([r[2], r[1]], m);\n    return [\n      Math.min(p1[0], p2[0], p3[0], p4[0]),\n      Math.min(p1[1], p2[1], p3[1], p4[1]),\n      Math.max(p1[0], p2[0], p3[0], p4[0]),\n      Math.max(p1[1], p2[1], p3[1], p4[1]),\n    ];\n  }\n\n  static inverseTransform(m) {\n    const d = m[0] * m[3] - m[1] * m[2];\n    return [\n      m[3] / d,\n      -m[1] / d,\n      -m[2] / d,\n      m[0] / d,\n      (m[2] * m[5] - m[4] * m[3]) / d,\n      (m[4] * m[1] - m[5] * m[0]) / d,\n    ];\n  }\n\n  // This calculation uses Singular Value Decomposition.\n  // The SVD can be represented with formula A = USV. We are interested in the\n  // matrix S here because it represents the scale values.\n  static singularValueDecompose2dScale(m) {\n    const transpose = [m[0], m[2], m[1], m[3]];\n\n    // Multiply matrix m with its transpose.\n    const a = m[0] * transpose[0] + m[1] * transpose[2];\n    const b = m[0] * transpose[1] + m[1] * transpose[3];\n    const c = m[2] * transpose[0] + m[3] * transpose[2];\n    const d = m[2] * transpose[1] + m[3] * transpose[3];\n\n    // Solve the second degree polynomial to get roots.\n    const first = (a + d) / 2;\n    const second = Math.sqrt((a + d) ** 2 - 4 * (a * d - c * b)) / 2;\n    const sx = first + second || 1;\n    const sy = first - second || 1;\n\n    // Scale values are the square roots of the eigenvalues.\n    return [Math.sqrt(sx), Math.sqrt(sy)];\n  }\n\n  // Normalize rectangle rect=[x1, y1, x2, y2] so that (x1,y1) < (x2,y2)\n  // For coordinate systems whose origin lies in the bottom-left, this\n  // means normalization to (BL,TR) ordering. For systems with origin in the\n  // top-left, this means (TL,BR) ordering.\n  static normalizeRect(rect) {\n    const r = rect.slice(0); // clone rect\n    if (rect[0] > rect[2]) {\n      r[0] = rect[2];\n      r[2] = rect[0];\n    }\n    if (rect[1] > rect[3]) {\n      r[1] = rect[3];\n      r[3] = rect[1];\n    }\n    return r;\n  }\n\n  // Returns a rectangle [x1, y1, x2, y2] corresponding to the\n  // intersection of rect1 and rect2. If no intersection, returns 'null'\n  // The rectangle coordinates of rect1, rect2 should be [x1, y1, x2, y2]\n  static intersect(rect1, rect2) {\n    const xLow = Math.max(\n      Math.min(rect1[0], rect1[2]),\n      Math.min(rect2[0], rect2[2])\n    );\n    const xHigh = Math.min(\n      Math.max(rect1[0], rect1[2]),\n      Math.max(rect2[0], rect2[2])\n    );\n    if (xLow > xHigh) {\n      return null;\n    }\n    const yLow = Math.max(\n      Math.min(rect1[1], rect1[3]),\n      Math.min(rect2[1], rect2[3])\n    );\n    const yHigh = Math.min(\n      Math.max(rect1[1], rect1[3]),\n      Math.max(rect2[1], rect2[3])\n    );\n    if (yLow > yHigh) {\n      return null;\n    }\n\n    return [xLow, yLow, xHigh, yHigh];\n  }\n\n  // From https://github.com/adobe-webplatform/Snap.svg/blob/b365287722a72526000ac4bfcf0ce4cac2faa015/src/path.js#L852\n  static bezierBoundingBox(x0, y0, x1, y1, x2, y2, x3, y3) {\n    const tvalues = [],\n      bounds = [[], []];\n    let a, b, c, t, t1, t2, b2ac, sqrtb2ac;\n    for (let i = 0; i < 2; ++i) {\n      if (i === 0) {\n        b = 6 * x0 - 12 * x1 + 6 * x2;\n        a = -3 * x0 + 9 * x1 - 9 * x2 + 3 * x3;\n        c = 3 * x1 - 3 * x0;\n      } else {\n        b = 6 * y0 - 12 * y1 + 6 * y2;\n        a = -3 * y0 + 9 * y1 - 9 * y2 + 3 * y3;\n        c = 3 * y1 - 3 * y0;\n      }\n      if (Math.abs(a) < 1e-12) {\n        if (Math.abs(b) < 1e-12) {\n          continue;\n        }\n        t = -c / b;\n        if (0 < t && t < 1) {\n          tvalues.push(t);\n        }\n        continue;\n      }\n      b2ac = b * b - 4 * c * a;\n      sqrtb2ac = Math.sqrt(b2ac);\n      if (b2ac < 0) {\n        continue;\n      }\n      t1 = (-b + sqrtb2ac) / (2 * a);\n      if (0 < t1 && t1 < 1) {\n        tvalues.push(t1);\n      }\n      t2 = (-b - sqrtb2ac) / (2 * a);\n      if (0 < t2 && t2 < 1) {\n        tvalues.push(t2);\n      }\n    }\n\n    let j = tvalues.length,\n      mt;\n    const jlen = j;\n    while (j--) {\n      t = tvalues[j];\n      mt = 1 - t;\n      bounds[0][j] =\n        mt * mt * mt * x0 +\n        3 * mt * mt * t * x1 +\n        3 * mt * t * t * x2 +\n        t * t * t * x3;\n      bounds[1][j] =\n        mt * mt * mt * y0 +\n        3 * mt * mt * t * y1 +\n        3 * mt * t * t * y2 +\n        t * t * t * y3;\n    }\n\n    bounds[0][jlen] = x0;\n    bounds[1][jlen] = y0;\n    bounds[0][jlen + 1] = x3;\n    bounds[1][jlen + 1] = y3;\n    bounds[0].length = bounds[1].length = jlen + 2;\n\n    return [\n      Math.min(...bounds[0]),\n      Math.min(...bounds[1]),\n      Math.max(...bounds[0]),\n      Math.max(...bounds[1]),\n    ];\n  }\n}\n\nconst PDFStringTranslateTable = [\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x2d8,\n  0x2c7, 0x2c6, 0x2d9, 0x2dd, 0x2db, 0x2da, 0x2dc, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n  0, 0, 0, 0, 0, 0, 0, 0, 0x2022, 0x2020, 0x2021, 0x2026, 0x2014, 0x2013, 0x192,\n  0x2044, 0x2039, 0x203a, 0x2212, 0x2030, 0x201e, 0x201c, 0x201d, 0x2018,\n  0x2019, 0x201a, 0x2122, 0xfb01, 0xfb02, 0x141, 0x152, 0x160, 0x178, 0x17d,\n  0x131, 0x142, 0x153, 0x161, 0x17e, 0, 0x20ac,\n];\n\nfunction stringToPDFString(str) {\n  // See section 7.9.2.2 Text String Type.\n  // The string can contain some language codes bracketed with 0x0b,\n  // so we must remove them.\n  if (str[0] >= \"\\xEF\") {\n    let encoding;\n    if (str[0] === \"\\xFE\" && str[1] === \"\\xFF\") {\n      encoding = \"utf-16be\";\n      if (str.length % 2 === 1) {\n        str = str.slice(0, -1);\n      }\n    } else if (str[0] === \"\\xFF\" && str[1] === \"\\xFE\") {\n      encoding = \"utf-16le\";\n      if (str.length % 2 === 1) {\n        str = str.slice(0, -1);\n      }\n    } else if (str[0] === \"\\xEF\" && str[1] === \"\\xBB\" && str[2] === \"\\xBF\") {\n      encoding = \"utf-8\";\n    }\n\n    if (encoding) {\n      try {\n        const decoder = new TextDecoder(encoding, { fatal: true });\n        const buffer = stringToBytes(str);\n        const decoded = decoder.decode(buffer);\n        if (!decoded.includes(\"\\x1b\")) {\n          return decoded;\n        }\n        return decoded.replaceAll(/\\x1b[^\\x1b]*(?:\\x1b|$)/g, \"\");\n      } catch (ex) {\n        warn(`stringToPDFString: \"${ex}\".`);\n      }\n    }\n  }\n  // ISO Latin 1\n  const strBuf = [];\n  for (let i = 0, ii = str.length; i < ii; i++) {\n    const charCode = str.charCodeAt(i);\n    if (charCode === 0x1b) {\n      // eslint-disable-next-line no-empty\n      while (++i < ii && str.charCodeAt(i) !== 0x1b) {}\n      continue;\n    }\n    const code = PDFStringTranslateTable[charCode];\n    strBuf.push(code ? String.fromCharCode(code) : str.charAt(i));\n  }\n  return strBuf.join(\"\");\n}\n\nfunction stringToUTF8String(str) {\n  return decodeURIComponent(escape(str));\n}\n\nfunction utf8StringToString(str) {\n  return unescape(encodeURIComponent(str));\n}\n\nfunction isArrayBuffer(v) {\n  return typeof v === \"object\" && v?.byteLength !== undefined;\n}\n\nfunction isArrayEqual(arr1, arr2) {\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n  for (let i = 0, ii = arr1.length; i < ii; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction getModificationDate(date = new Date()) {\n  const buffer = [\n    date.getUTCFullYear().toString(),\n    (date.getUTCMonth() + 1).toString().padStart(2, \"0\"),\n    date.getUTCDate().toString().padStart(2, \"0\"),\n    date.getUTCHours().toString().padStart(2, \"0\"),\n    date.getUTCMinutes().toString().padStart(2, \"0\"),\n    date.getUTCSeconds().toString().padStart(2, \"0\"),\n  ];\n\n  return buffer.join(\"\");\n}\n\nclass PromiseCapability {\n  #settled = false;\n\n  constructor() {\n    /**\n     * @type {Promise<any>} The Promise object.\n     */\n    this.promise = new Promise((resolve, reject) => {\n      /**\n       * @type {function} Fulfills the Promise.\n       */\n      this.resolve = data => {\n        this.#settled = true;\n        resolve(data);\n      };\n\n      /**\n       * @type {function} Rejects the Promise.\n       */\n      this.reject = reason => {\n        if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n          assert(reason instanceof Error, 'Expected valid \"reason\" argument.');\n        }\n        this.#settled = true;\n        reject(reason);\n      };\n    });\n  }\n\n  /**\n   * @type {boolean} If the Promise has been fulfilled/rejected.\n   */\n  get settled() {\n    return this.#settled;\n  }\n}\n\nlet NormalizeRegex = null;\nlet NormalizationMap = null;\nfunction normalizeUnicode(str) {\n  if (!NormalizeRegex) {\n    // In order to generate the following regex:\n    //  - create a PDF containing all the chars in the range 0000-FFFF with\n    //    a NFKC which is different of the char.\n    //  - copy and paste all those chars and get the ones where NFKC is\n    //    required.\n    // It appears that most the chars here contain some ligatures.\n    NormalizeRegex =\n      /([\\u00a0\\u00b5\\u037e\\u0eb3\\u2000-\\u200a\\u202f\\u2126\\ufb00-\\ufb04\\ufb06\\ufb20-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40-\\ufb41\\ufb43-\\ufb44\\ufb46-\\ufba1\\ufba4-\\ufba9\\ufbae-\\ufbb1\\ufbd3-\\ufbdc\\ufbde-\\ufbe7\\ufbea-\\ufbf8\\ufbfc-\\ufbfd\\ufc00-\\ufc5d\\ufc64-\\ufcf1\\ufcf5-\\ufd3d\\ufd88\\ufdf4\\ufdfa-\\ufdfb\\ufe71\\ufe77\\ufe79\\ufe7b\\ufe7d]+)|(\\ufb05+)/gu;\n    NormalizationMap = new Map([[\"ﬅ\", \"ſt\"]]);\n  }\n  return str.replaceAll(NormalizeRegex, (_, p1, p2) => {\n    return p1 ? p1.normalize(\"NFKC\") : NormalizationMap.get(p2);\n  });\n}\n\nfunction getUuid() {\n  if (\n    (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n    (typeof crypto !== \"undefined\" && typeof crypto?.randomUUID === \"function\")\n  ) {\n    return crypto.randomUUID();\n  }\n  const buf = new Uint8Array(32);\n  if (\n    typeof crypto !== \"undefined\" &&\n    typeof crypto?.getRandomValues === \"function\"\n  ) {\n    crypto.getRandomValues(buf);\n  } else {\n    for (let i = 0; i < 32; i++) {\n      buf[i] = Math.floor(Math.random() * 255);\n    }\n  }\n  return bytesToString(buf);\n}\n\nconst AnnotationPrefix = \"pdfjs_internal_id_\";\n\nexport {\n  AbortException,\n  AnnotationActionEventType,\n  AnnotationBorderStyleType,\n  AnnotationEditorParamsType,\n  AnnotationEditorPrefix,\n  AnnotationEditorType,\n  AnnotationFieldFlag,\n  AnnotationFlag,\n  AnnotationMode,\n  AnnotationPrefix,\n  AnnotationReplyType,\n  AnnotationType,\n  assert,\n  BaseException,\n  BASELINE_FACTOR,\n  bytesToString,\n  CMapCompressionType,\n  createValidAbsoluteUrl,\n  DocumentActionEventType,\n  FeatureTest,\n  FONT_IDENTITY_MATRIX,\n  FormatError,\n  getModificationDate,\n  getUuid,\n  getVerbosityLevel,\n  IDENTITY_MATRIX,\n  ImageKind,\n  info,\n  InvalidPDFException,\n  isArrayBuffer,\n  isArrayEqual,\n  isNodeJS,\n  LINE_DESCENT_FACTOR,\n  LINE_FACTOR,\n  MAX_IMAGE_SIZE_TO_CACHE,\n  MissingPDFException,\n  normalizeUnicode,\n  objectFromMap,\n  objectSize,\n  OPS,\n  PageActionEventType,\n  PasswordException,\n  PasswordResponses,\n  PermissionFlag,\n  PromiseCapability,\n  RenderingIntentFlag,\n  setVerbosityLevel,\n  shadow,\n  string32,\n  stringToBytes,\n  stringToPDFString,\n  stringToUTF8String,\n  TextRenderingMode,\n  UnexpectedResponseException,\n  UnknownErrorException,\n  unreachable,\n  utf8StringToString,\n  Util,\n  VerbosityLevel,\n  warn,\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","var webpackQueues = typeof Symbol === \"function\" ? Symbol(\"webpack queues\") : \"__webpack_queues__\";\nvar webpackExports = typeof Symbol === \"function\" ? Symbol(\"webpack exports\") : \"__webpack_exports__\";\nvar webpackError = typeof Symbol === \"function\" ? Symbol(\"webpack error\") : \"__webpack_error__\";\nvar resolveQueue = (queue) => {\n\tif(queue && queue.d < 1) {\n\t\tqueue.d = 1;\n\t\tqueue.forEach((fn) => (fn.r--));\n\t\tqueue.forEach((fn) => (fn.r-- ? fn.r++ : fn()));\n\t}\n}\nvar wrapDeps = (deps) => (deps.map((dep) => {\n\tif(dep !== null && typeof dep === \"object\") {\n\t\tif(dep[webpackQueues]) return dep;\n\t\tif(dep.then) {\n\t\t\tvar queue = [];\n\t\t\tqueue.d = 0;\n\t\t\tdep.then((r) => {\n\t\t\t\tobj[webpackExports] = r;\n\t\t\t\tresolveQueue(queue);\n\t\t\t}, (e) => {\n\t\t\t\tobj[webpackError] = e;\n\t\t\t\tresolveQueue(queue);\n\t\t\t});\n\t\t\tvar obj = {};\n\t\t\tobj[webpackQueues] = (fn) => (fn(queue));\n\t\t\treturn obj;\n\t\t}\n\t}\n\tvar ret = {};\n\tret[webpackQueues] = x => {};\n\tret[webpackExports] = dep;\n\treturn ret;\n}));\n__webpack_require__.a = (module, body, hasAwait) => {\n\tvar queue;\n\thasAwait && ((queue = []).d = -1);\n\tvar depQueues = new Set();\n\tvar exports = module.exports;\n\tvar currentDeps;\n\tvar outerResolve;\n\tvar reject;\n\tvar promise = new Promise((resolve, rej) => {\n\t\treject = rej;\n\t\touterResolve = resolve;\n\t});\n\tpromise[webpackExports] = exports;\n\tpromise[webpackQueues] = (fn) => (queue && fn(queue), depQueues.forEach(fn), promise[\"catch\"](x => {}));\n\tmodule.exports = promise;\n\tbody((deps) => {\n\t\tcurrentDeps = wrapDeps(deps);\n\t\tvar fn;\n\t\tvar getResult = () => (currentDeps.map((d) => {\n\t\t\tif(d[webpackError]) throw d[webpackError];\n\t\t\treturn d[webpackExports];\n\t\t}))\n\t\tvar promise = new Promise((resolve) => {\n\t\t\tfn = () => (resolve(getResult));\n\t\t\tfn.r = 0;\n\t\t\tvar fnQueue = (q) => (q !== queue && !depQueues.has(q) && (depQueues.add(q), q && !q.d && (fn.r++, q.push(fn))));\n\t\t\tcurrentDeps.map((dep) => (dep[webpackQueues](fnQueue)));\n\t\t});\n\t\treturn fn.r ? promise : getResult();\n\t}, (err) => ((err ? reject(promise[webpackError] = err) : outerResolve(exports)), resolveQueue(queue)));\n\tqueue && queue.d < 0 && (queue.d = 0);\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","","// startup\n// Load entry module and return exports\n// This entry module used 'module' so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(907);\n",""],"mappings":"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"},"metadata":{},"sourceType":"module"}